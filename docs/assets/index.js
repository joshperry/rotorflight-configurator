import"./modulepreload-polyfill.js";import{s as it,g as We,i as LF,a as $F,_ as DF}from"./localization.js";import{c as ep,g as ng}from"./_commonjsHelpers.js";import{i as Gr,w as kF,D as UF}from"./slider.js";import{W as BF,S as VF,a as HF,O as XF,P as YF,A as zF,D as WF,C as jF,G as qF,b as rg}from"./vendor-three.js";import{m as KF,l as tp,a as np,b as rp,c as QF,s as ZF,e as JF}from"./vendor-d3.js";const gd=1,md=2,ig=4,eI=8,tI=16,nI=1,rI=2,iI=4,oI=8,sI=16,aI=1,lI=2,cI=4,uI=1,dI=2,Vt=Symbol(),fI="http://www.w3.org/1999/xhtml",ip=!1;var Jo=Array.isArray,_I=Array.prototype.indexOf,Cd=Array.from,og=Object.defineProperty,Vi=Object.getOwnPropertyDescriptor,sg=Object.getOwnPropertyDescriptors,ag=Object.prototype,pI=Array.prototype,Va=Object.getPrototypeOf,op=Object.isExtensible;function hI(n){return typeof n=="function"}const et=()=>{};function gI(n){return n()}function Yu(n){for(var e=0;e<n.length;e++)n[e]()}const fn=2,lg=4,Ha=8,Xa=16,Sr=32,to=64,vd=128,un=256,la=512,On=1024,mr=2048,ui=4096,pr=8192,Ed=16384,Sd=32768,es=65536,cg=1<<17,sp=1<<18,mI=1<<19,ug=1<<20,zu=1<<21,hr=Symbol("$state"),CI=Symbol("legacy props"),vI=Symbol("");function dg(n){return n===this.v}function Rd(n,e){return n!=n?e==e:n!==e||n!==null&&typeof n=="object"||typeof n=="function"}function EI(n,e){return n!==e}function Fd(n){return!Rd(n,this.v)}function SI(n){throw new Error("https://svelte.dev/e/effect_in_teardown")}function RI(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function FI(n){throw new Error("https://svelte.dev/e/effect_orphan")}function II(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function bI(n){throw new Error("https://svelte.dev/e/props_invalid_value")}function TI(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function OI(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function PI(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}let no=!1,AI=!1;function MI(){no=!0}const NI=[];function Qn(n,e=!1){return Js(n,new Map,"",NI)}function Js(n,e,t,r,i=null){if(typeof n=="object"&&n!==null){var o=e.get(n);if(o!==void 0)return o;if(n instanceof Map)return new Map(n);if(n instanceof Set)return new Set(n);if(Jo(n)){var s=Array(n.length);e.set(n,s),i!==null&&e.set(i,s);for(var l=0;l<n.length;l+=1){var a=n[l];l in n&&(s[l]=Js(a,e,t,r))}return s}if(Va(n)===ag){s={},e.set(n,s),i!==null&&e.set(i,s);for(var c in n)s[c]=Js(n[c],e,t,r);return s}if(n instanceof Date)return structuredClone(n);if(typeof n.toJSON=="function")return Js(n.toJSON(),e,t,r,n)}if(n instanceof EventTarget)return n;try{return structuredClone(n)}catch{return n}}function fg(n){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}let ht=null;function ap(n){ht=n}function we(n,e=!1,t){var r=ht={p:ht,c:null,d:!1,e:null,m:!1,s:n,x:null,l:null};no&&!e&&(ht.l={s:null,u:null,r1:[],r2:Ki(!1)}),ts(()=>{r.d=!0})}function Ge(n){const e=ht;if(e!==null){n!==void 0&&(e.x=n);const s=e.e;if(s!==null){var t=Ke,r=je;e.e=null;try{for(var i=0;i<s.length;i++){var o=s[i];er(o.effect),Pn(o.reaction),oo(o.fn)}}finally{er(t),Pn(r)}}ht=e.p,e.m=!0}return n||{}}function ro(){return!no||ht!==null&&ht.l===null}function Rn(n){if(typeof n!="object"||n===null||hr in n)return n;const e=Va(n);if(e!==ag&&e!==pI)return n;var t=new Map,r=Jo(n),i=pe(0),o=je,s=l=>{var a=je;Pn(o);var c=l();return Pn(a),c};return r&&t.set("length",pe(n.length)),new Proxy(n,{defineProperty(l,a,c){(!("value"in c)||c.configurable===!1||c.enumerable===!1||c.writable===!1)&&TI();var u=t.get(a);return u===void 0?u=s(()=>{var p=pe(c.value);return t.set(a,p),p}):ce(u,c.value,!0),!0},deleteProperty(l,a){var c=t.get(a);if(c===void 0){if(a in l){const h=s(()=>pe(Vt));t.set(a,h),Nc(i)}}else{if(r&&typeof a=="string"){var u=t.get("length"),p=Number(a);Number.isInteger(p)&&p<u.v&&ce(u,p)}ce(c,Vt),Nc(i)}return!0},get(l,a,c){if(a===hr)return n;var u=t.get(a),p=a in l;if(u===void 0&&(!p||Vi(l,a)?.writable)&&(u=s(()=>{var g=Rn(p?l[a]:Vt),f=pe(g);return f}),t.set(a,u)),u!==void 0){var h=b(u);return h===Vt?void 0:h}return Reflect.get(l,a,c)},getOwnPropertyDescriptor(l,a){var c=Reflect.getOwnPropertyDescriptor(l,a);if(c&&"value"in c){var u=t.get(a);u&&(c.value=b(u))}else if(c===void 0){var p=t.get(a),h=p?.v;if(p!==void 0&&h!==Vt)return{enumerable:!0,configurable:!0,value:h,writable:!0}}return c},has(l,a){if(a===hr)return!0;var c=t.get(a),u=c!==void 0&&c.v!==Vt||Reflect.has(l,a);if(c!==void 0||Ke!==null&&(!u||Vi(l,a)?.writable)){c===void 0&&(c=s(()=>{var h=u?Rn(l[a]):Vt,g=pe(h);return g}),t.set(a,c));var p=b(c);if(p===Vt)return!1}return u},set(l,a,c,u){var p=t.get(a),h=a in l;if(r&&a==="length")for(var g=c;g<p.v;g+=1){var f=t.get(g+"");f!==void 0?ce(f,Vt):g in l&&(f=s(()=>pe(Vt)),t.set(g+"",f))}if(p===void 0)(!h||Vi(l,a)?.writable)&&(p=s(()=>pe(void 0)),ce(p,Rn(c)),t.set(a,p));else{h=p.v!==Vt;var d=s(()=>Rn(c));ce(p,d)}var _=Reflect.getOwnPropertyDescriptor(l,a);if(_?.set&&_.set.call(u,c),!h){if(r&&typeof a=="string"){var m=t.get("length"),C=Number(a);Number.isInteger(C)&&C>=m.v&&ce(m,C+1)}Nc(i)}return!0},ownKeys(l){b(i);var a=Reflect.ownKeys(l).filter(p=>{var h=t.get(p);return h===void 0||h.v!==Vt});for(var[c,u]of t)u.v!==Vt&&!(c in l)&&a.push(c);return a},setPrototypeOf(){OI()}})}function Nc(n,e=1){ce(n,n.v+e)}function lp(n){try{if(n!==null&&typeof n=="object"&&hr in n)return n[hr]}catch{}return n}function xI(n,e){return Object.is(lp(n),lp(e))}function qi(n){var e=fn|mr,t=je!==null&&(je.f&fn)!==0?je:null;return Ke===null||t!==null&&(t.f&un)!==0?e|=un:Ke.f|=ug,{ctx:ht,deps:null,effects:null,equals:dg,f:e,fn:n,reactions:null,rv:0,v:null,wv:0,parent:t??Ke}}function ue(n){const e=qi(n);return Pg(e),e}function ca(n){const e=qi(n);return e.equals=Fd,e}function _g(n){var e=n.effects;if(e!==null){n.effects=null;for(var t=0;t<e.length;t+=1)Cr(e[t])}}function yI(n){for(var e=n.parent;e!==null;){if((e.f&fn)===0)return e;e=e.parent}return null}function pg(n){var e,t=Ke;er(yI(n));try{_g(n),e=xg(n)}finally{er(t)}return e}function hg(n){var e=pg(n);if(n.equals(e)||(n.v=e,n.wv=Mg()),!so){var t=($r||(n.f&un)!==0)&&n.deps!==null?ui:On;tr(n,t)}}const Ho=new Map;function Ki(n,e){var t={f:0,v:n,reactions:null,equals:dg,rv:0,wv:0};return t}function pe(n,e){const t=Ki(n);return Pg(t),t}function Id(n,e=!1,t=!0){const r=Ki(n);return e||(r.equals=Fd),no&&t&&ht!==null&&ht.l!==null&&(ht.l.s??=[]).push(r),r}function ce(n,e,t=!1){je!==null&&(!Kn||(je.f&sp)!==0)&&ro()&&(je.f&(fn|Xa|sp))!==0&&!(Tn?.[1].includes(n)&&Tn[0]===je)&&PI();let r=t?Rn(e):e;return Xo(n,r)}function Xo(n,e){if(!n.equals(e)){var t=n.v;so?Ho.set(n,e):Ho.set(n,t),n.v=e,(n.f&fn)!==0&&((n.f&mr)!==0&&pg(n),tr(n,(n.f&un)===0?On:ui)),n.wv=Mg(),gg(n,mr),ro()&&Ke!==null&&(Ke.f&On)!==0&&(Ke.f&(Sr|to))===0&&(vn===null?XI([n]):vn.push(n))}return e}function gg(n,e){var t=n.reactions;if(t!==null)for(var r=ro(),i=t.length,o=0;o<i;o++){var s=t[o],l=s.f;(l&mr)===0&&(!r&&s===Ke||(tr(s,e),(l&(On|un))!==0&&((l&fn)!==0?gg(s,ui):Od(s))))}}function wI(){console.warn("https://svelte.dev/e/select_multiple_invalid_value")}let GI=!1;var cp,mg,Cg,vg;function LI(){if(cp===void 0){cp=window,mg=/Firefox/.test(navigator.userAgent);var n=Element.prototype,e=Node.prototype,t=Text.prototype;Cg=Vi(e,"firstChild").get,vg=Vi(e,"nextSibling").get,op(n)&&(n.__click=void 0,n.__className=void 0,n.__attributes=null,n.__style=void 0,n.__e=void 0),op(t)&&(t.__t=void 0)}}function Ya(n=""){return document.createTextNode(n)}function Lr(n){return Cg.call(n)}function za(n){return vg.call(n)}function W(n,e){return Lr(n)}function me(n,e){{var t=Lr(n);return t instanceof Comment&&t.data===""?za(t):t}}function K(n,e=1,t=!1){let r=n;for(;e--;)r=za(r);return r}function $I(n){n.textContent=""}function Eg(n){Ke===null&&je===null&&FI(),je!==null&&(je.f&un)!==0&&Ke===null&&RI(),so&&SI()}function DI(n,e){var t=e.last;t===null?e.last=e.first=n:(t.next=n,n.prev=t,e.last=n)}function io(n,e,t,r=!0){var i=Ke,o={ctx:ht,deps:null,nodes_start:null,nodes_end:null,f:n|mr,first:null,fn:e,last:null,next:null,parent:i,prev:null,teardown:null,transitions:null,wv:0};if(t)try{Td(o),o.f|=Sd}catch(a){throw Cr(o),a}else e!==null&&Od(o);var s=t&&o.deps===null&&o.first===null&&o.nodes_start===null&&o.teardown===null&&(o.f&(ug|vd))===0;if(!s&&r&&(i!==null&&DI(o,i),je!==null&&(je.f&fn)!==0)){var l=je;(l.effects??=[]).push(o)}return o}function ts(n){const e=io(Ha,null,!1);return tr(e,On),e.teardown=n,e}function bn(n){Eg();var e=Ke!==null&&(Ke.f&Sr)!==0&&ht!==null&&!ht.m;if(e){var t=ht;(t.e??=[]).push({fn:n,effect:Ke,reaction:je})}else{var r=oo(n);return r}}function kI(n){return Eg(),ns(n)}function UI(n){const e=io(to,n,!0);return(t={})=>new Promise(r=>{t.outro?Yo(e,()=>{Cr(e),r(void 0)}):(Cr(e),r(void 0))})}function oo(n){return io(lg,n,!1)}function ns(n){return io(Ha,n,!0)}function Ae(n,e=[],t=qi){const r=e.map(t);return rs(()=>n(...r.map(b)))}function rs(n,e=0){return io(Ha|Xa|e,n,!0)}function ri(n,e=!0){return io(Ha|Sr,n,!0,e)}function Sg(n){var e=n.teardown;if(e!==null){const t=so,r=je;up(!0),Pn(null);try{e.call(null)}finally{up(t),Pn(r)}}}function Rg(n,e=!1){var t=n.first;for(n.first=n.last=null;t!==null;){var r=t.next;(t.f&to)!==0?t.parent=null:Cr(t,e),t=r}}function BI(n){for(var e=n.first;e!==null;){var t=e.next;(e.f&Sr)===0&&Cr(e),e=t}}function Cr(n,e=!0){var t=!1;(e||(n.f&mI)!==0)&&n.nodes_start!==null&&n.nodes_end!==null&&(Fg(n.nodes_start,n.nodes_end),t=!0),Rg(n,e&&!t),pa(n,0),tr(n,Ed);var r=n.transitions;if(r!==null)for(const o of r)o.stop();Sg(n);var i=n.parent;i!==null&&i.first!==null&&Ig(n),n.next=n.prev=n.teardown=n.ctx=n.deps=n.fn=n.nodes_start=n.nodes_end=null}function Fg(n,e){for(;n!==null;){var t=n===e?null:za(n);n.remove(),n=t}}function Ig(n){var e=n.parent,t=n.prev,r=n.next;t!==null&&(t.next=r),r!==null&&(r.prev=t),e!==null&&(e.first===n&&(e.first=r),e.last===n&&(e.last=t))}function Yo(n,e){var t=[];bd(n,t,!0),bg(t,()=>{Cr(n),e&&e()})}function bg(n,e){var t=n.length;if(t>0){var r=()=>--t||e();for(var i of n)i.out(r)}else e()}function bd(n,e,t){if((n.f&pr)===0){if(n.f^=pr,n.transitions!==null)for(const s of n.transitions)(s.is_global||t)&&e.push(s);for(var r=n.first;r!==null;){var i=r.next,o=(r.f&es)!==0||(r.f&Sr)!==0;bd(r,e,o?t:!1),r=i}}}function ua(n){Tg(n,!0)}function Tg(n,e){if((n.f&pr)!==0){n.f^=pr;for(var t=n.first;t!==null;){var r=t.next,i=(t.f&es)!==0||(t.f&Sr)!==0;Tg(t,i?e:!1),t=r}if(n.transitions!==null)for(const o of n.transitions)(o.is_global||e)&&o.in()}}let da=[];function VI(){var n=da;da=[],Yu(n)}function Wa(n){da.length===0&&queueMicrotask(VI),da.push(n)}function HI(n){var e=Ke;if((e.f&Sd)===0){if((e.f&vd)===0)throw n;e.fn(n)}else Og(n,e)}function Og(n,e){for(;e!==null;){if((e.f&vd)!==0)try{e.fn(n);return}catch{}e=e.parent}throw n}let Wu=!1,fa=null,ti=!1,so=!1;function up(n){so=n}let ea=[];let je=null,Kn=!1;function Pn(n){je=n}let Ke=null;function er(n){Ke=n}let Tn=null;function Pg(n){je!==null&&je.f&zu&&(Tn===null?Tn=[je,[n]]:Tn[1].push(n))}let Ht=null,an=0,vn=null;function XI(n){vn=n}let Ag=1,_a=0,$r=!1,yr=null;function Mg(){return++Ag}function ja(n){var e=n.f;if((e&mr)!==0)return!0;if((e&ui)!==0){var t=n.deps,r=(e&un)!==0;if(t!==null){var i,o,s=(e&la)!==0,l=r&&Ke!==null&&!$r,a=t.length;if(s||l){var c=n,u=c.parent;for(i=0;i<a;i++)o=t[i],(s||!o?.reactions?.includes(c))&&(o.reactions??=[]).push(c);s&&(c.f^=la),l&&u!==null&&(u.f&un)===0&&(c.f^=un)}for(i=0;i<a;i++)if(o=t[i],ja(o)&&hg(o),o.wv>n.wv)return!0}(!r||Ke!==null&&!$r)&&tr(n,On)}return!1}function Ng(n,e,t=!0){var r=n.reactions;if(r!==null)for(var i=0;i<r.length;i++){var o=r[i];Tn?.[1].includes(n)&&Tn[0]===je||((o.f&fn)!==0?Ng(o,e,!1):e===o&&(t?tr(o,mr):(o.f&On)!==0&&tr(o,ui),Od(o)))}}function xg(n){var e=Ht,t=an,r=vn,i=je,o=$r,s=Tn,l=ht,a=Kn,c=n.f;Ht=null,an=0,vn=null,$r=(c&un)!==0&&(Kn||!ti||je===null),je=(c&(Sr|to))===0?n:null,Tn=null,ap(n.ctx),Kn=!1,_a++,n.f|=zu;try{var u=(0,n.fn)(),p=n.deps;if(Ht!==null){var h;if(pa(n,an),p!==null&&an>0)for(p.length=an+Ht.length,h=0;h<Ht.length;h++)p[an+h]=Ht[h];else n.deps=p=Ht;if(!$r||(c&fn)!==0&&n.reactions!==null)for(h=an;h<p.length;h++)(p[h].reactions??=[]).push(n)}else p!==null&&an<p.length&&(pa(n,an),p.length=an);if(ro()&&vn!==null&&!Kn&&p!==null&&(n.f&(fn|ui|mr))===0)for(h=0;h<vn.length;h++)Ng(vn[h],n);return i!==null&&i!==n&&(_a++,vn!==null&&(r===null?r=vn:r.push(...vn))),u}catch(g){HI(g)}finally{Ht=e,an=t,vn=r,je=i,$r=o,Tn=s,ap(l),Kn=a,n.f^=zu}}function YI(n,e){let t=e.reactions;if(t!==null){var r=_I.call(t,n);if(r!==-1){var i=t.length-1;i===0?t=e.reactions=null:(t[r]=t[i],t.pop())}}t===null&&(e.f&fn)!==0&&(Ht===null||!Ht.includes(e))&&(tr(e,ui),(e.f&(un|la))===0&&(e.f^=la),_g(e),pa(e,0))}function pa(n,e){var t=n.deps;if(t!==null)for(var r=e;r<t.length;r++)YI(n,t[r])}function Td(n){var e=n.f;if((e&Ed)===0){tr(n,On);var t=Ke,r=ti;Ke=n,ti=!0;try{(e&Xa)!==0?BI(n):Rg(n),Sg(n);var i=xg(n);n.teardown=typeof i=="function"?i:null,n.wv=Ag;var o;ip&&AI&&(n.f&mr)!==0&&n.deps}finally{ti=r,Ke=t}}}function zI(){try{II()}catch(n){if(fa!==null)Og(n,fa);else throw n}}function WI(){var n=ti;try{var e=0;for(ti=!0;ea.length>0;){e++>1e3&&zI();var t=ea,r=t.length;ea=[];for(var i=0;i<r;i++){var o=qI(t[i]);jI(o)}Ho.clear()}}finally{Wu=!1,ti=n,fa=null}}function jI(n){var e=n.length;if(e!==0)for(var t=0;t<e;t++){var r=n[t];(r.f&(Ed|pr))===0&&ja(r)&&(Td(r),r.deps===null&&r.first===null&&r.nodes_start===null&&(r.teardown===null?Ig(r):r.fn=null))}}function Od(n){Wu||(Wu=!0,queueMicrotask(WI));for(var e=fa=n;e.parent!==null;){e=e.parent;var t=e.f;if((t&(to|Sr))!==0){if((t&On)===0)return;e.f^=On}}ea.push(e)}function qI(n){for(var e=[],t=n;t!==null;){var r=t.f,i=(r&(Sr|to))!==0,o=i&&(r&On)!==0;if(!o&&(r&pr)===0){(r&lg)!==0?e.push(t):i?t.f^=On:ja(t)&&Td(t);var s=t.first;if(s!==null){t=s;continue}}var l=t.parent;for(t=t.next;t===null&&l!==null;)t=l.next,l=l.parent}return e}function b(n){var e=n.f,t=(e&fn)!==0;if(yr!==null&&yr.add(n),je!==null&&!Kn){if(!Tn?.[1].includes(n)||Tn[0]!==je){var r=je.deps;n.rv<_a&&(n.rv=_a,Ht===null&&r!==null&&r[an]===n?an++:Ht===null?Ht=[n]:(!$r||!Ht.includes(n))&&Ht.push(n))}}else if(t&&n.deps===null&&n.effects===null){var i=n,o=i.parent;o!==null&&(o.f&un)===0&&(i.f^=un)}return t&&(i=n,ja(i)&&hg(i)),so&&Ho.has(n)?Ho.get(n):n.v}function KI(n){var e=yr;yr=new Set;var t=yr,r;try{if(_n(n),e!==null)for(r of yr)e.add(r)}finally{yr=e}return t}function QI(n){var e=KI(()=>_n(n));for(var t of e)if((t.f&cg)!==0)for(const r of t.deps||[])(r.f&fn)===0&&Xo(r,r.v);else Xo(t,t.v)}function _n(n){var e=Kn;try{return Kn=!0,n()}finally{Kn=e}}const ZI=-7169;function tr(n,e){n.f=n.f&ZI|e}function JI(n){if(!(typeof n!="object"||!n||n instanceof EventTarget)){if(hr in n)ju(n);else if(!Array.isArray(n))for(let e in n){const t=n[e];typeof t=="object"&&t&&hr in t&&ju(t)}}}function ju(n,e=new Set){if(typeof n=="object"&&n!==null&&!(n instanceof EventTarget)&&!e.has(n)){e.add(n),n instanceof Date&&n.getTime();for(let r in n)try{ju(n[r],e)}catch{}const t=Va(n);if(t!==Object.prototype&&t!==Array.prototype&&t!==Map.prototype&&t!==Set.prototype&&t!==Date.prototype){const r=sg(t);for(let i in r){const o=r[i].get;if(o)try{o.call(n)}catch{}}}}}let dp=!1;function eb(){dp||(dp=!0,document.addEventListener("reset",n=>{Promise.resolve().then(()=>{if(!n.defaultPrevented)for(const e of n.target.elements)e.__on_r?.()})},{capture:!0}))}function tb(n,e,t,r=!0){r&&t();for(var i of e)n.addEventListener(i,t);ts(()=>{for(var o of e)n.removeEventListener(o,t)})}function qa(n){var e=je,t=Ke;Pn(null),er(null);try{return n()}finally{Pn(e),er(t)}}function Pd(n,e,t,r=t){n.addEventListener(e,()=>qa(t));const i=n.__on_r;i?n.__on_r=()=>{i(),r(!0)}:n.__on_r=()=>r(!0),eb()}const yg=new Set,qu=new Set;function nb(n,e,t,r={}){function i(o){if(r.capture||Mo.call(e,o),!o.cancelBubble)return qa(()=>t?.call(this,o))}return n.startsWith("pointer")||n.startsWith("touch")||n==="wheel"?Wa(()=>{e.addEventListener(n,i,r)}):e.addEventListener(n,i,r),i}function Go(n,e,t,r,i){var o={capture:r,passive:i},s=nb(n,e,t,o);(e===document.body||e===window||e===document||e instanceof HTMLMediaElement)&&ts(()=>{e.removeEventListener(n,s,o)})}function pn(n){for(var e=0;e<n.length;e++)yg.add(n[e]);for(var t of qu)t(n)}function Mo(n){var e=this,t=e.ownerDocument,r=n.type,i=n.composedPath?.()||[],o=i[0]||n.target,s=0,l=n.__root;if(l){var a=i.indexOf(l);if(a!==-1&&(e===document||e===window)){n.__root=e;return}var c=i.indexOf(e);if(c===-1)return;a<=c&&(s=a)}if(o=i[s]||n.target,o!==e){og(n,"currentTarget",{configurable:!0,get(){return o||t}});var u=je,p=Ke;Pn(null),er(null);try{for(var h,g=[];o!==null;){var f=o.assignedSlot||o.parentNode||o.host||null;try{var d=o["__"+r];if(d!=null&&(!o.disabled||n.target===o))if(Jo(d)){var[_,...m]=d;_.apply(o,[n,...m])}else d.call(o,n)}catch(C){h?g.push(C):h=C}if(n.cancelBubble||f===e||f===null)break;o=f}if(h){for(let C of g)queueMicrotask(()=>{throw C});throw h}}finally{n.__root=e,delete n.currentTarget,Pn(u),er(p)}}}function wg(n){var e=document.createElement("template");return e.innerHTML=n.replaceAll("<!>","<!---->"),e.content}function zo(n,e){var t=Ke;t.nodes_start===null&&(t.nodes_start=n,t.nodes_end=e)}function ne(n,e){var t=(e&uI)!==0,r=(e&dI)!==0,i,o=!n.startsWith("<!>");return()=>{i===void 0&&(i=wg(o?n:"<!>"+n),t||(i=Lr(i)));var s=r||mg?document.importNode(i,!0):i.cloneNode(!0);if(t){var l=Lr(s),a=s.lastChild;zo(l,a)}else zo(s,s);return s}}function rb(n=""){{var e=Ya(n+"");return zo(e,e),e}}function Ct(){var n=document.createDocumentFragment(),e=document.createComment(""),t=Ya();return n.append(e,t),zo(e,t),n}function Z(n,e){n!==null&&n.before(e)}const ib=["touchstart","touchmove"];function ob(n){return ib.includes(n)}let Ku=!0;function Ee(n,e){var t=e==null?"":typeof e=="object"?e+"":e;t!==(n.__t??=n.nodeValue)&&(n.__t=t,n.nodeValue=t+"")}function Rr(n,e){return sb(n,e)}const xi=new Map;function sb(n,{target:e,anchor:t,props:r={},events:i,context:o,intro:s=!0}){LI();var l=new Set,a=p=>{for(var h=0;h<p.length;h++){var g=p[h];if(!l.has(g)){l.add(g);var f=ob(g);e.addEventListener(g,Mo,{passive:f});var d=xi.get(g);d===void 0?(document.addEventListener(g,Mo,{passive:f}),xi.set(g,1)):xi.set(g,d+1)}}};a(Cd(yg)),qu.add(a);var c=void 0,u=UI(()=>{var p=t??e.appendChild(Ya());return ri(()=>{if(o){we({});var h=ht;h.c=o}i&&(r.$$events=i),Ku=s,c=n(p,r)||{},Ku=!0,o&&Ge()}),()=>{for(var h of l){e.removeEventListener(h,Mo);var g=xi.get(h);--g===0?(document.removeEventListener(h,Mo),xi.delete(h)):xi.set(h,g)}qu.delete(a),p!==t&&p.parentNode?.removeChild(p)}});return Qu.set(c,u),c}let Qu=new WeakMap;function ni(n,e){const t=Qu.get(n);return t?(Qu.delete(n),t(e)):Promise.resolve()}function Ot(n,e,...t){var r=n,i=et,o;rs(()=>{i!==(i=e())&&(o&&(Cr(o),o=null),o=ri(()=>i(r,...t)))},es)}function di(n){ht===null&&fg(),no&&ht.l!==null?ab(ht).m.push(n):bn(()=>{const e=_n(n);if(typeof e=="function")return e})}function Ka(n){ht===null&&fg(),di(()=>()=>_n(n))}function ab(n){var e=n.l;return e.u??={a:[],b:[],m:[]}}function Ce(n,e,[t,r]=[0,0]){var i=n,o=null,s=null,l=Vt,a=t>0?es:0,c=!1;const u=(h,g=!0)=>{c=!0,p(g,h)},p=(h,g)=>{l!==(l=h)&&(l?(o?ua(o):g&&(o=ri(()=>g(i))),s&&Yo(s,()=>{s=null})):(s?ua(s):g&&(s=ri(()=>g(i,[t+1,r]))),o&&Yo(o,()=>{o=null})))};rs(()=>{c=!1,e(u),c||p(null,null)},a)}function lb(n,e,t){var r=n,i=Vt,o,s=ro()?EI:Rd;rs(()=>{s(i,i=e())&&(o&&Yo(o),o=ri(()=>t(r)))})}function cb(n,e){ns(()=>{var t=e();for(var r in t){var i=t[r];i?n.style.setProperty(r,i):n.style.removeProperty(r)}})}function is(n,e){return e}function ub(n,e,t,r){for(var i=[],o=e.length,s=0;s<o;s++)bd(e[s].e,i,!0);var l=o>0&&i.length===0&&t!==null;if(l){var a=t.parentNode;$I(a),a.append(t),r.clear(),Nr(n,e[0].prev,e[o-1].next)}bg(i,()=>{for(var c=0;c<o;c++){var u=e[c];l||(r.delete(u.k),Nr(n,u.prev,u.next)),Cr(u.e,!l)}})}function xt(n,e,t,r,i,o=null){var s=n,l={flags:e,items:new Map,first:null},a=(e&ig)!==0;if(a){var c=n;s=c.appendChild(Ya())}var u=null,p=!1,h=ca(()=>{var g=t();return Jo(g)?g:g==null?[]:Cd(g)});rs(()=>{var g=b(h),f=g.length;p&&f===0||(p=f===0,db(g,l,s,i,e,r,t),o!==null&&(f===0?u?ua(u):u=ri(()=>o(s)):u!==null&&Yo(u,()=>{u=null})),b(h))})}function db(n,e,t,r,i,o,s){var l=(i&eI)!==0,a=(i&(gd|md))!==0,c=n.length,u=e.items,p=e.first,h=p,g,f=null,d,_=[],m=[],C,R,S,F;if(l)for(F=0;F<c;F+=1)C=n[F],R=o(C,F),S=u.get(R),S!==void 0&&(S.a?.measure(),(d??=new Set).add(S));for(F=0;F<c;F+=1){if(C=n[F],R=o(C,F),S=u.get(R),S===void 0){var I=h?h.e.nodes_start:t;f=_b(I,e,f,f===null?e.first:f.next,C,R,F,r,i,s),u.set(R,f),_=[],m=[],h=f.next;continue}if(a&&fb(S,C,F,i),(S.e.f&pr)!==0&&(ua(S.e),l&&(S.a?.unfix(),(d??=new Set).delete(S))),S!==h){if(g!==void 0&&g.has(S)){if(_.length<m.length){var T=m[0],P;f=T.prev;var y=_[0],L=_[_.length-1];for(P=0;P<_.length;P+=1)fp(_[P],T,t);for(P=0;P<m.length;P+=1)g.delete(m[P]);Nr(e,y.prev,L.next),Nr(e,f,y),Nr(e,L,T),h=T,f=L,F-=1,_=[],m=[]}else g.delete(S),fp(S,h,t),Nr(e,S.prev,S.next),Nr(e,S,f===null?e.first:f.next),Nr(e,f,S),f=S;continue}for(_=[],m=[];h!==null&&h.k!==R;)(h.e.f&pr)===0&&(g??=new Set).add(h),m.push(h),h=h.next;if(h===null)continue;S=h}_.push(S),f=S,h=S.next}if(h!==null||g!==void 0){for(var G=g===void 0?[]:Cd(g);h!==null;)(h.e.f&pr)===0&&G.push(h),h=h.next;var U=G.length;if(U>0){var M=(i&ig)!==0&&c===0?t:null;if(l){for(F=0;F<U;F+=1)G[F].a?.measure();for(F=0;F<U;F+=1)G[F].a?.fix()}ub(e,G,M,u)}}l&&Wa(()=>{if(d!==void 0)for(S of d)S.a?.apply()}),Ke.first=e.first&&e.first.e,Ke.last=f&&f.e}function fb(n,e,t,r){(r&gd)!==0&&Xo(n.v,e),(r&md)!==0?Xo(n.i,t):n.i=t}function _b(n,e,t,r,i,o,s,l,a,c){var u=(a&gd)!==0,p=(a&tI)===0,h=u?p?Id(i,!1,!1):Ki(i):i,g=(a&md)===0?s:Ki(s),f={i:g,v:h,k:o,a:null,e:null,prev:t,next:r};try{return f.e=ri(()=>l(n,h,g,c),GI),f.e.prev=t&&t.e,f.e.next=r&&r.e,t===null?e.first=f:(t.next=f,t.e.next=f.e),r!==null&&(r.prev=f,r.e.prev=f.e),f}finally{}}function fp(n,e,t){for(var r=n.next?n.next.e.nodes_start:t,i=e?e.e.nodes_start:t,o=n.e.nodes_start;o!==r;){var s=za(o);i.before(o),o=s}}function Nr(n,e,t){e===null?n.first=t:(e.next=t,e.e.next=t&&t.e),t!==null&&(t.prev=e,t.e.prev=e&&e.e)}function fi(n,e,t=!1,r=!1,i=!1){var o=n,s="";Ae(()=>{var l=Ke;if(s!==(s=e()??"")&&(l.nodes_start!==null&&(Fg(l.nodes_start,l.nodes_end),l.nodes_start=l.nodes_end=null),s!=="")){var a=s+"";t?a=`<svg>${a}</svg>`:r&&(a=`<math>${a}</math>`);var c=wg(a);if((t||r)&&(c=Lr(c)),zo(Lr(c),c.lastChild),t||r)for(;Lr(c);)o.before(Lr(c));else o.before(c)}})}function pb(n,e,t){oo(()=>{var r=_n(()=>e(n,t?.())||{});if(r?.destroy)return()=>r.destroy()})}function Gg(n){var e,t,r="";if(typeof n=="string"||typeof n=="number")r+=n;else if(typeof n=="object")if(Array.isArray(n)){var i=n.length;for(e=0;e<i;e++)n[e]&&(t=Gg(n[e]))&&(r&&(r+=" "),r+=t)}else for(t in n)n[t]&&(r&&(r+=" "),r+=t);return r}function hb(){for(var n,e,t=0,r="",i=arguments.length;t<i;t++)(n=arguments[t])&&(e=Gg(n))&&(r&&(r+=" "),r+=e);return r}function Wo(n){return typeof n=="object"?hb(n):n??""}const _p=[...` 	
\r\f \v\uFEFF`];function gb(n,e,t){var r=n==null?"":""+n;if(e&&(r=r?r+" "+e:e),t){for(var i in t)if(t[i])r=r?r+" "+i:i;else if(r.length)for(var o=i.length,s=0;(s=r.indexOf(i,s))>=0;){var l=s+o;(s===0||_p.includes(r[s-1]))&&(l===r.length||_p.includes(r[l]))?r=(s===0?"":r.substring(0,s))+r.substring(l+1):s=l}}return r===""?null:r}function pp(n,e=!1){var t=e?" !important;":";",r="";for(var i in n){var o=n[i];o!=null&&o!==""&&(r+=" "+i+": "+o+t)}return r}function mb(n,e){if(e){var t="",r,i;return Array.isArray(e)?(r=e[0],i=e[1]):r=e,r&&(t+=pp(r)),i&&(t+=pp(i,!0)),t=t.trim(),t===""?null:t}return String(n)}function ii(n,e,t,r,i,o){var s=n.__className;if(s!==t||s===void 0){var l=gb(t,r,o);l==null?n.removeAttribute("class"):n.className=l,n.__className=t}else if(o&&i!==o)for(var a in o){var c=!!o[a];(i==null||c!==!!i[a])&&n.classList.toggle(a,c)}return o}function xc(n,e={},t,r){for(var i in t){var o=t[i];e[i]!==o&&(t[i]==null?n.style.removeProperty(i):n.style.setProperty(i,o,r))}}function ha(n,e,t,r){var i=n.__style;if(i!==e){var o=mb(e,r);o==null?n.removeAttribute("style"):n.style.cssText=o,n.__style=e}else r&&(Array.isArray(r)?(xc(n,t?.[0],r[0]),xc(n,t?.[1],r[1],"important")):xc(n,t,r));return r}function Lg(n,e,t){if(n.multiple){if(e==null)return;if(!Jo(e))return wI();for(var r of n.options)r.selected=e.includes(Lo(r));return}for(r of n.options){var i=Lo(r);if(xI(i,e)){r.selected=!0;return}}(!t||e!==void 0)&&(n.selectedIndex=-1)}function Cb(n){var e=new MutationObserver(()=>{Lg(n,n.__value)});e.observe(n,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),ts(()=>{e.disconnect()})}function vr(n,e,t=e){var r=!0;Pd(n,"change",i=>{var o=i?"[selected]":":checked",s;if(n.multiple)s=[].map.call(n.querySelectorAll(o),Lo);else{var l=n.querySelector(o)??n.querySelector("option:not([disabled])");s=l&&Lo(l)}t(s)}),oo(()=>{var i=e();if(Lg(n,i,r),r&&i===void 0){var o=n.querySelector(":checked");o!==null&&(i=Lo(o),t(i))}n.__value=i,r=!1}),Cb(n)}function Lo(n){return"__value"in n?n.__value:n.value}const vb=Symbol("is custom element"),Eb=Symbol("is html");function os(n,e,t,r){var i=Sb(n);i[e]!==(i[e]=t)&&(e==="loading"&&(n[vI]=t),t==null?n.removeAttribute(e):typeof t!="string"&&Rb(n).includes(e)?n[e]=t:n.setAttribute(e,t))}function Sb(n){return n.__attributes??={[vb]:n.nodeName.includes("-"),[Eb]:n.namespaceURI===fI}}var hp=new Map;function Rb(n){var e=hp.get(n.nodeName);if(e)return e;hp.set(n.nodeName,e=[]);for(var t,r=n,i=Element.prototype;i!==r;){t=sg(r);for(var o in t)t[o].set&&e.push(o);r=Va(r)}return e}const Fb=()=>performance.now(),dr={tick:n=>requestAnimationFrame(n),now:()=>Fb(),tasks:new Set};function $g(){const n=dr.now();dr.tasks.forEach(e=>{e.c(n)||(dr.tasks.delete(e),e.f())}),dr.tasks.size!==0&&dr.tick($g)}function Ib(n){let e;return dr.tasks.size===0&&dr.tick($g),{promise:new Promise(t=>{dr.tasks.add(e={c:n,f:t})}),abort(){dr.tasks.delete(e)}}}function Bs(n,e){qa(()=>{n.dispatchEvent(new CustomEvent(e))})}function bb(n){if(n==="float")return"cssFloat";if(n==="offset")return"cssOffset";if(n.startsWith("--"))return n;const e=n.split("-");return e.length===1?e[0]:e[0]+e.slice(1).map(t=>t[0].toUpperCase()+t.slice(1)).join("")}function gp(n){const e={},t=n.split(";");for(const r of t){const[i,o]=r.split(":");if(!i||o===void 0)break;const s=bb(i.trim());e[s]=o.trim()}return e}const Tb=n=>n;function ke(n,e,t,r){var i=(n&aI)!==0,o=(n&lI)!==0,s=i&&o,l=(n&cI)!==0,a=s?"both":i?"in":"out",c,u=e.inert,p=e.style.overflow,h,g;function f(){var R=je,S=Ke;Pn(null),er(null);try{return c??=t()(e,r?.()??{},{direction:a})}finally{Pn(R),er(S)}}var d={is_global:l,in(){if(e.inert=u,!i){g?.abort(),g?.reset?.();return}o||h?.abort(),Bs(e,"introstart"),h=Zu(e,f(),g,1,()=>{Bs(e,"introend"),h?.abort(),h=c=void 0,e.style.overflow=p})},out(R){if(!o){R?.(),c=void 0;return}e.inert=!0,Bs(e,"outrostart"),g=Zu(e,f(),h,0,()=>{Bs(e,"outroend"),R?.()})},stop:()=>{h?.abort(),g?.abort()}},_=Ke;if((_.transitions??=[]).push(d),i&&Ku){var m=l;if(!m){for(var C=_.parent;C&&(C.f&es)!==0;)for(;(C=C.parent)&&(C.f&Xa)===0;);m=!C||(C.f&Sd)!==0}m&&oo(()=>{_n(()=>d.in())})}}function Zu(n,e,t,r,i){var o=r===1;if(hI(e)){var s,l=!1;return Wa(()=>{if(!l){var _=e({direction:o?"in":"out"});s=Zu(n,_,t,r,i)}}),{abort:()=>{l=!0,s?.abort()},deactivate:()=>s.deactivate(),reset:()=>s.reset(),t:()=>s.t()}}if(t?.deactivate(),!e?.duration)return i(),{abort:et,deactivate:et,reset:et,t:()=>r};const{delay:a=0,css:c,tick:u,easing:p=Tb}=e;var h=[];if(o&&t===void 0&&(u&&u(0,1),c)){var g=gp(c(0,1));h.push(g,g)}var f=()=>1-r,d=n.animate(h,{duration:a,fill:"forwards"});return d.onfinish=()=>{d.cancel();var _=t?.t()??1-r;t?.abort();var m=r-_,C=e.duration*Math.abs(m),R=[];if(C>0){var S=!1;if(c)for(var F=Math.ceil(C/16.666666666666668),I=0;I<=F;I+=1){var T=_+m*p(I/F),P=gp(c(T,1-T));R.push(P),S||=P.overflow==="hidden"}S&&(n.style.overflow="hidden"),f=()=>{var y=d.currentTime;return _+m*p(y/C)},u&&Ib(()=>{if(d.playState!=="running")return!1;var y=f();return u(y,1-y),!0})}d=n.animate(R,{duration:C,fill:"forwards"}),d.onfinish=()=>{f=()=>r,u?.(r,1-r),i()}},{abort:()=>{d&&(d.cancel(),d.effect=null,d.onfinish=et)},deactivate:()=>{i=et},reset:()=>{r===0&&u?.(1,0)},t:()=>f()}}function Ob(n,e,t=e){var r=ro();Pd(n,"input",i=>{var o=i?n.defaultValue:n.value;if(o=yc(n)?wc(o):o,t(o),r&&o!==(o=e())){var s=n.selectionStart,l=n.selectionEnd;n.value=o??"",l!==null&&(n.selectionStart=s,n.selectionEnd=Math.min(l,n.value.length))}}),_n(e)==null&&n.value&&t(yc(n)?wc(n.value):n.value),ns(()=>{var i=e();yc(n)&&i===wc(n.value)||n.type==="date"&&!i&&!n.value||i!==n.value&&(n.value=i??"")})}function Pb(n,e,t=e){Pd(n,"change",r=>{var i=r?n.defaultChecked:n.checked;t(i)}),_n(e)==null&&t(n.checked),ns(()=>{var r=e();n.checked=!!r})}function yc(n){var e=n.type;return e==="number"||e==="range"}function wc(n){return n===""?null:+n}function mp(n,e){return n===e||n?.[hr]===e}function Hi(n={},e,t,r){return oo(()=>{var i,o;return ns(()=>{i=o,o=[],_n(()=>{n!==t(...o)&&(e(n,...o),i&&mp(t(...i),n)&&e(null,...i))})}),()=>{Wa(()=>{o&&mp(t(...o),n)&&e(null,...o)})}}),n}function Dg(n,e){tb(window,["resize"],()=>qa(()=>e(window[n])))}function Ad(n=!1){const e=ht,t=e.l.u;if(!t)return;let r=()=>JI(e.s);if(n){let i=0,o={};const s=qi(()=>{let l=!1;const a=e.s;for(const c in a)a[c]!==o[c]&&(o[c]=a[c],l=!0);return l&&i++,i});r=()=>b(s)}t.b.length&&kI(()=>{Cp(e,r),Yu(t.b)}),bn(()=>{const i=_n(()=>t.m.map(gI));return()=>{for(const o of i)typeof o=="function"&&o()}}),t.a.length&&bn(()=>{Cp(e,r),Yu(t.a)})}function Cp(n,e){if(n.l.s)for(const t of n.l.s)b(t);e()}function Md(n){var e=Ki(0);return function(){return arguments.length===1?(ce(e,b(e)+1),arguments[0]):(b(e),n())}}function kg(n,e,t){if(n==null)return e(void 0),et;const r=_n(()=>n.subscribe(e,t));return r.unsubscribe?()=>r.unsubscribe():r}const yi=[];function Ug(n,e=et){let t=null;const r=new Set;function i(l){if(Rd(n,l)&&(n=l,t)){const a=!yi.length;for(const c of r)c[1](),yi.push(c,n);if(a){for(let c=0;c<yi.length;c+=2)yi[c][0](yi[c+1]);yi.length=0}}}function o(l){i(l(n))}function s(l,a=et){const c=[l,a];return r.add(c),r.size===1&&(t=e(i,o)||et),l(n),()=>{r.delete(c),r.size===0&&t&&(t(),t=null)}}return{set:i,update:o,subscribe:s}}function Ab(n){let e;return kg(n,t=>e=t)(),e}let Vs=!1,Ju=Symbol();function vt(n,e,t){const r=t[e]??={store:null,source:Id(void 0),unsubscribe:et};if(r.store!==n&&!(Ju in t))if(r.unsubscribe(),r.store=n??null,n==null)r.source.v=void 0,r.unsubscribe=et;else{var i=!0;r.unsubscribe=kg(n,o=>{i?r.source.v=o:ce(r.source,o)}),i=!1}return n&&Ju in t?Ab(n):b(r.source)}function Et(){const n={};function e(){ts(()=>{for(var t in n)n[t].unsubscribe();og(n,Ju,{enumerable:!1,value:!0})})}return[n,e]}function Mb(n){var e=Vs;try{return Vs=!1,[n(),Vs]}finally{Vs=e}}function vp(n){return n.ctx?.d??!1}function ft(n,e,t,r){var i=(t&nI)!==0,o=!no||(t&rI)!==0,s=(t&oI)!==0,l=(t&sI)!==0,a=!1,c;s?[c,a]=Mb(()=>n[e]):c=n[e];var u=hr in n||CI in n,p=s&&(Vi(n,e)?.set??(u&&e in n&&(T=>n[e]=T)))||void 0,h=r,g=!0,f=!1,d=()=>(f=!0,g&&(g=!1,l?h=_n(r):h=r),h);c===void 0&&r!==void 0&&(p&&o&&bI(),c=d(),p&&p(c));var _;if(o)_=()=>{var T=n[e];return T===void 0?d():(g=!0,f=!1,T)};else{var m=(i?qi:ca)(()=>n[e]);m.f|=cg,_=()=>{var T=b(m);return T!==void 0&&(h=void 0),T===void 0?h:T}}if((t&iI)===0&&o)return _;if(p){var C=n.$$legacy;return function(T,P){return arguments.length>0?((!o||!P||C||a)&&p(P?_():T),T):_()}}var R=!1,S=!1,F=Id(c),I=qi(()=>{var T=_(),P=b(F);return R?(R=!1,S=!0,P):(S=!1,F.v=T)});return s&&b(I),i||(I.equals=Fd),function(T,P){if(yr!==null&&(R=S,_(),b(F)),arguments.length>0){const y=P?b(I):o&&s?Rn(T):T;if(!I.equals(y)){if(R=!0,ce(F,y),f&&h!==void 0&&(h=y),vp(I))return T;_n(()=>b(I))}return T}return vp(I)?I.v:b(I)}}var Ep={};/**
  * multiple-select - Multiple select is a jQuery plugin to select multiple elements with checkboxes :).
  *
  * @version v1.7.0
  * @homepage http://multiple-select.wenzhixin.net.cn
  * @author wenzhixin <wenzhixin2010@gmail.com> (http://wenzhixin.net.cn/)
  * @license MIT
  */var Sp;function Nb(){if(Sp)return Ep;Sp=1;function n(v){return n=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(E){return typeof E}:function(E){return E&&typeof Symbol=="function"&&E.constructor===Symbol&&E!==Symbol.prototype?"symbol":typeof E},n(v)}function e(v,E){if(!(v instanceof E))throw new TypeError("Cannot call a class as a function")}function t(v,E){for(var A=0;A<E.length;A++){var B=E[A];B.enumerable=B.enumerable||!1,B.configurable=!0,"value"in B&&(B.writable=!0),Object.defineProperty(v,(H=B.key,X=void 0,typeof(X=function(q,Q){if(typeof q!="object"||q===null)return q;var se=q[Symbol.toPrimitive];if(se!==void 0){var Se=se.call(q,Q);if(typeof Se!="object")return Se;throw new TypeError("@@toPrimitive must return a primitive value.")}return(Q==="string"?String:Number)(q)}(H,"string"))=="symbol"?X:String(X)),B)}var H,X}function r(v,E,A){return E&&t(v.prototype,E),Object.defineProperty(v,"prototype",{writable:!1}),v}function i(v,E){return function(A){if(Array.isArray(A))return A}(v)||function(A,B){var H=A==null?null:typeof Symbol<"u"&&A[Symbol.iterator]||A["@@iterator"];if(H!=null){var X,q,Q,se,Se=[],Fe=!0,Ne=!1;try{if(Q=(H=H.call(A)).next,B!==0)for(;!(Fe=(X=Q.call(H)).done)&&(Se.push(X.value),Se.length!==B);Fe=!0);}catch(Pe){Ne=!0,q=Pe}finally{try{if(!Fe&&H.return!=null&&(se=H.return(),Object(se)!==se))return}finally{if(Ne)throw q}}return Se}}(v,E)||s(v,E)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function o(v){return function(E){if(Array.isArray(E))return l(E)}(v)||function(E){if(typeof Symbol<"u"&&E[Symbol.iterator]!=null||E["@@iterator"]!=null)return Array.from(E)}(v)||s(v)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function s(v,E){if(v){if(typeof v=="string")return l(v,E);var A=Object.prototype.toString.call(v).slice(8,-1);return A==="Object"&&v.constructor&&(A=v.constructor.name),A==="Map"||A==="Set"?Array.from(v):A==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(A)?l(v,E):void 0}}function l(v,E){(E==null||E>v.length)&&(E=v.length);for(var A=0,B=new Array(E);A<E;A++)B[A]=v[A];return B}function a(v,E){var A=typeof Symbol<"u"&&v[Symbol.iterator]||v["@@iterator"];if(!A){if(Array.isArray(v)||(A=s(v))||E){A&&(v=A);var B=0,H=function(){};return{s:H,n:function(){return B>=v.length?{done:!0}:{done:!1,value:v[B++]}},e:function(se){throw se},f:H}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var X,q=!0,Q=!1;return{s:function(){A=A.call(v)},n:function(){var se=A.next();return q=se.done,se},e:function(se){Q=!0,X=se},f:function(){try{q||A.return==null||A.return()}finally{if(Q)throw X}}}}var c=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof ep<"u"?ep:typeof self<"u"?self:{},u=function(v){return v&&v.Math==Math&&v},p=u(typeof globalThis=="object"&&globalThis)||u(typeof window=="object"&&window)||u(typeof self=="object"&&self)||u(typeof c=="object"&&c)||function(){return this}()||c||Function("return this")(),h={},g=function(v){try{return!!v()}catch{return!0}},f=!g(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7}),d=!g(function(){var v=function(){}.bind();return typeof v!="function"||v.hasOwnProperty("prototype")}),_=d,m=Function.prototype.call,C=_?m.bind(m):function(){return m.apply(m,arguments)},R={},S={}.propertyIsEnumerable,F=Object.getOwnPropertyDescriptor,I=F&&!S.call({1:2},1);R.f=I?function(v){var E=F(this,v);return!!E&&E.enumerable}:S;var T,P,y=function(v,E){return{enumerable:!(1&v),configurable:!(2&v),writable:!(4&v),value:E}},L=d,G=Function.prototype,U=G.call,M=L&&G.bind.bind(U,U),N=L?M:function(v){return function(){return U.apply(v,arguments)}},w=N,x=w({}.toString),k=w("".slice),O=function(v){return k(x(v),8,-1)},D=g,Y=O,z=Object,ee=N("".split),re=D(function(){return!z("z").propertyIsEnumerable(0)})?function(v){return Y(v)=="String"?ee(v,""):z(v)}:z,le=function(v){return v==null},J=le,oe=TypeError,ae=function(v){if(J(v))throw oe("Can't call method on "+v);return v},de=re,ie=ae,te=function(v){return de(ie(v))},fe=typeof document=="object"&&document.all,Re={all:fe,IS_HTMLDDA:fe===void 0&&fe!==void 0},$e=Re.all,Ve=Re.IS_HTMLDDA?function(v){return typeof v=="function"||v===$e}:function(v){return typeof v=="function"},tt=Ve,en=Re.all,ot=Re.IS_HTMLDDA?function(v){return typeof v=="object"?v!==null:tt(v)||v===en}:function(v){return typeof v=="object"?v!==null:tt(v)},jt=p,Nn=Ve,hn=function(v,E){return arguments.length<2?(A=jt[v],Nn(A)?A:void 0):jt[v]&&jt[v][E];var A},Br=N({}.isPrototypeOf),pi=p,Xn=typeof navigator<"u"&&String(navigator.userAgent)||"",Yn=pi.process,xn=pi.Deno,yn=Yn&&Yn.versions||xn&&xn.version,Vr=yn&&yn.v8;Vr&&(P=(T=Vr.split("."))[0]>0&&T[0]<4?1:+(T[0]+T[1])),!P&&Xn&&(!(T=Xn.match(/Edge\/(\d+)/))||T[1]>=74)&&(T=Xn.match(/Chrome\/(\d+)/))&&(P=+T[1]);var zn=P,Hr=zn,Xr=g,hi=p.String,or=!!Object.getOwnPropertySymbols&&!Xr(function(){var v=Symbol();return!hi(v)||!(Object(v)instanceof Symbol)||!Symbol.sham&&Hr&&Hr<41}),sr=or&&!Symbol.sham&&typeof Symbol.iterator=="symbol",tn=hn,br=Ve,uo=Br,fo=Object,gs=sr?function(v){return typeof v=="symbol"}:function(v){var E=tn("Symbol");return br(E)&&uo(E.prototype,fo(v))},gi=String,Yr=function(v){try{return gi(v)}catch{return"Object"}},pl=Ve,zr=Yr,hl=TypeError,_o=function(v){if(pl(v))return v;throw hl(zr(v)+" is not a function")},Ft=_o,Tr=le,mi=function(v,E){var A=v[E];return Tr(A)?void 0:Ft(A)},po=C,Ci=Ve,ho=ot,ms=TypeError,Cs={exports:{}},nn=p,Or=Object.defineProperty,vi=function(v,E){try{Or(nn,v,{value:E,configurable:!0,writable:!0})}catch{nn[v]=E}return E},vs=vi,Ei="__core-js_shared__",Si=p[Ei]||vs(Ei,{}),gn=Si;(Cs.exports=function(v,E){return gn[v]||(gn[v]=E!==void 0?E:{})})("versions",[]).push({version:"3.30.2",mode:"global",copyright:"© 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.30.2/LICENSE",source:"https://github.com/zloirock/core-js"});var Ri=Cs.exports,Es=ae,Ss=Object,Wn=function(v){return Ss(Es(v))},gl=Wn,be=N({}.hasOwnProperty),j=Object.hasOwn||function(v,E){return be(gl(v),E)},he=N,Ie=0,st=Math.random(),At=he(1 .toString),gt=function(v){return"Symbol("+(v===void 0?"":v)+")_"+At(++Ie+st,36)},Lt=Ri,mn=j,Wr=gt,go=or,Mt=sr,ar=p.Symbol,Fi=Lt("wks"),mC=Mt?ar.for||ar:ar&&ar.withoutSetter||Wr,rn=function(v){return mn(Fi,v)||(Fi[v]=go&&mn(ar,v)?ar[v]:mC("Symbol."+v)),Fi[v]},CC=C,uf=ot,df=gs,vC=mi,EC=function(v,E){var A,B;if(Ci(A=v.toString)&&!ho(B=po(A,v))||Ci(A=v.valueOf)&&!ho(B=po(A,v)))return B;throw ms("Can't convert object to primitive value")},SC=TypeError,RC=rn("toPrimitive"),IC=function(v,E){if(!uf(v)||df(v))return v;var A,B=vC(v,RC);if(B){if(A=CC(B,v,E),!uf(A)||df(A))return A;throw SC("Can't convert object to primitive value")}return EC(v)},bC=gs,ml=function(v){var E=IC(v,"string");return bC(E)?E:E+""},ff=ot,Cl=p.document,TC=ff(Cl)&&ff(Cl.createElement),vl=function(v){return TC?Cl.createElement(v):{}},OC=vl,_f=!f&&!g(function(){return Object.defineProperty(OC("div"),"a",{get:function(){return 7}}).a!=7}),PC=f,AC=C,MC=R,NC=y,xC=te,yC=ml,wC=j,GC=_f,pf=Object.getOwnPropertyDescriptor;h.f=PC?pf:function(v,E){if(v=xC(v),E=yC(E),GC)try{return pf(v,E)}catch{}if(wC(v,E))return NC(!AC(MC.f,v,E),v[E])};var Pr={},hf=f&&g(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!=42}),LC=ot,$C=String,DC=TypeError,wn=function(v){if(LC(v))return v;throw DC($C(v)+" is not an object")},kC=f,UC=_f,BC=hf,Rs=wn,gf=ml,VC=TypeError,El=Object.defineProperty,HC=Object.getOwnPropertyDescriptor,Sl="enumerable",Rl="configurable",Fl="writable";Pr.f=kC?BC?function(v,E,A){if(Rs(v),E=gf(E),Rs(A),typeof v=="function"&&E==="prototype"&&"value"in A&&Fl in A&&!A[Fl]){var B=HC(v,E);B&&B[Fl]&&(v[E]=A.value,A={configurable:Rl in A?A[Rl]:B[Rl],enumerable:Sl in A?A[Sl]:B[Sl],writable:!1})}return El(v,E,A)}:El:function(v,E,A){if(Rs(v),E=gf(E),Rs(A),UC)try{return El(v,E,A)}catch{}if("get"in A||"set"in A)throw VC("Accessors not supported");return"value"in A&&(v[E]=A.value),v};var XC=Pr,YC=y,Fs=f?function(v,E,A){return XC.f(v,E,YC(1,A))}:function(v,E,A){return v[E]=A,v},mf={exports:{}},Il=f,zC=j,Cf=Function.prototype,WC=Il&&Object.getOwnPropertyDescriptor,bl=zC(Cf,"name"),Is={EXISTS:bl,PROPER:bl&&function(){}.name==="something",CONFIGURABLE:bl&&(!Il||Il&&WC(Cf,"name").configurable)},jC=Ve,Tl=Si,qC=N(Function.toString);jC(Tl.inspectSource)||(Tl.inspectSource=function(v){return qC(v)});var Ol,bs,Pl,vf=Tl.inspectSource,KC=Ve,Ef=p.WeakMap,QC=KC(Ef)&&/native code/.test(String(Ef)),ZC=gt,Sf=Ri("keys"),Rf=function(v){return Sf[v]||(Sf[v]=ZC(v))},Al={},JC=QC,Ff=p,e0=Fs,Ml=j,Nl=Si,t0=Rf,n0=Al,If="Object already initialized",bf=Ff.TypeError,r0=Ff.WeakMap;if(JC||Nl.state){var jn=Nl.state||(Nl.state=new r0);jn.get=jn.get,jn.has=jn.has,jn.set=jn.set,Ol=function(v,E){if(jn.has(v))throw bf(If);return E.facade=v,jn.set(v,E),E},bs=function(v){return jn.get(v)||{}},Pl=function(v){return jn.has(v)}}else{var Ii=t0("state");n0[Ii]=!0,Ol=function(v,E){if(Ml(v,Ii))throw bf(If);return E.facade=v,e0(v,Ii,E),E},bs=function(v){return Ml(v,Ii)?v[Ii]:{}},Pl=function(v){return Ml(v,Ii)}}var xl={get:bs,enforce:function(v){return Pl(v)?bs(v):Ol(v,{})}},yl=N,i0=g,o0=Ve,Ts=j,wl=f,s0=Is.CONFIGURABLE,a0=vf,l0=xl.enforce,c0=xl.get,Tf=String,Os=Object.defineProperty,u0=yl("".slice),d0=yl("".replace),f0=yl([].join),_0=wl&&!i0(function(){return Os(function(){},"length",{value:8}).length!==8}),p0=String(String).split("String"),h0=mf.exports=function(v,E,A){u0(Tf(E),0,7)==="Symbol("&&(E="["+d0(Tf(E),/^Symbol\(([^)]*)\)/,"$1")+"]"),A&&A.getter&&(E="get "+E),A&&A.setter&&(E="set "+E),(!Ts(v,"name")||s0&&v.name!==E)&&(wl?Os(v,"name",{value:E,configurable:!0}):v.name=E),_0&&A&&Ts(A,"arity")&&v.length!==A.arity&&Os(v,"length",{value:A.arity});try{A&&Ts(A,"constructor")&&A.constructor?wl&&Os(v,"prototype",{writable:!1}):v.prototype&&(v.prototype=void 0)}catch{}var B=l0(v);return Ts(B,"source")||(B.source=f0(p0,typeof E=="string"?E:"")),v};Function.prototype.toString=h0(function(){return o0(this)&&c0(this).source||a0(this)},"toString");var Of=mf.exports,g0=Ve,m0=Pr,C0=Of,v0=vi,Ps=function(v,E,A,B){B||(B={});var H=B.enumerable,X=B.name!==void 0?B.name:E;if(g0(A)&&C0(A,X,B),B.global)H?v[E]=A:v0(E,A);else{try{B.unsafe?v[E]&&(H=!0):delete v[E]}catch{}H?v[E]=A:m0.f(v,E,{value:A,enumerable:!1,configurable:!B.nonConfigurable,writable:!B.nonWritable})}return v},Pf={},E0=Math.ceil,S0=Math.floor,R0=Math.trunc||function(v){var E=+v;return(E>0?S0:E0)(E)},As=function(v){var E=+v;return E!=E||E===0?0:R0(E)},F0=As,I0=Math.max,b0=Math.min,Gl=function(v,E){var A=F0(v);return A<0?I0(A+E,0):b0(A,E)},T0=As,O0=Math.min,Ll=function(v){return v>0?O0(T0(v),9007199254740991):0},P0=Ll,bi=function(v){return P0(v.length)},A0=te,M0=Gl,N0=bi,Af=function(v){return function(E,A,B){var H,X=A0(E),q=N0(X),Q=M0(B,q);if(v&&A!=A){for(;q>Q;)if((H=X[Q++])!=H)return!0}else for(;q>Q;Q++)if((v||Q in X)&&X[Q]===A)return v||Q||0;return!v&&-1}},Mf={includes:Af(!0),indexOf:Af(!1)},$l=j,x0=te,y0=Mf.indexOf,w0=Al,Nf=N([].push),xf=function(v,E){var A,B=x0(v),H=0,X=[];for(A in B)!$l(w0,A)&&$l(B,A)&&Nf(X,A);for(;E.length>H;)$l(B,A=E[H++])&&(~y0(X,A)||Nf(X,A));return X},Dl=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],G0=xf,L0=Dl.concat("length","prototype");Pf.f=Object.getOwnPropertyNames||function(v){return G0(v,L0)};var kl={};kl.f=Object.getOwnPropertySymbols;var $0=hn,D0=Pf,k0=kl,U0=wn,B0=N([].concat),V0=$0("Reflect","ownKeys")||function(v){var E=D0.f(U0(v)),A=k0.f;return A?B0(E,A(v)):E},H0=j,X0=V0,Y0=h,z0=Pr,W0=g,j0=Ve,q0=/#|\.prototype\./,mo=function(v,E){var A=Q0[K0(v)];return A==J0||A!=Z0&&(j0(E)?W0(E):!!E)},K0=mo.normalize=function(v){return String(v).replace(q0,".").toLowerCase()},Q0=mo.data={},Z0=mo.NATIVE="N",J0=mo.POLYFILL="P",ev=mo,Ul=p,tv=h.f,nv=Fs,rv=Ps,iv=vi,ov=function(v,E,A){for(var B=X0(E),H=z0.f,X=Y0.f,q=0;q<B.length;q++){var Q=B[q];H0(v,Q)||A||H(v,Q,X(E,Q))}},sv=ev,qt=function(v,E){var A,B,H,X,q,Q=v.target,se=v.global,Se=v.stat;if(A=se?Ul:Se?Ul[Q]||iv(Q,{}):(Ul[Q]||{}).prototype)for(B in E){if(X=E[B],H=v.dontCallGetSet?(q=tv(A,B))&&q.value:A[B],!sv(se?B:Q+(Se?".":"#")+B,v.forced)&&H!==void 0){if(typeof X==typeof H)continue;ov(X,H)}(v.sham||H&&H.sham)&&nv(X,"sham",!0),rv(A,B,X,v)}},yf={};yf[rn("toStringTag")]="z";var Bl=String(yf)==="[object z]",av=Bl,lv=Ve,Ms=O,cv=rn("toStringTag"),uv=Object,dv=Ms(function(){return arguments}())=="Arguments",Vl=av?Ms:function(v){var E,A,B;return v===void 0?"Undefined":v===null?"Null":typeof(A=function(H,X){try{return H[X]}catch{}}(E=uv(v),cv))=="string"?A:dv?Ms(E):(B=Ms(E))=="Object"&&lv(E.callee)?"Arguments":B},fv=Vl,_v=String,Ar=function(v){if(fv(v)==="Symbol")throw TypeError("Cannot convert a Symbol value to a string");return _v(v)},pv=wn,wf=function(){var v=pv(this),E="";return v.hasIndices&&(E+="d"),v.global&&(E+="g"),v.ignoreCase&&(E+="i"),v.multiline&&(E+="m"),v.dotAll&&(E+="s"),v.unicode&&(E+="u"),v.unicodeSets&&(E+="v"),v.sticky&&(E+="y"),E},Hl=g,Xl=p.RegExp,Yl=Hl(function(){var v=Xl("a","y");return v.lastIndex=2,v.exec("abcd")!=null});Yl||Hl(function(){return!Xl("a","y").sticky});var Gf={BROKEN_CARET:Yl||Hl(function(){var v=Xl("^r","gy");return v.lastIndex=2,v.exec("str")!=null}),UNSUPPORTED_Y:Yl},Lf={},hv=xf,gv=Dl,Ns=Object.keys||function(v){return hv(v,gv)},mv=f,Cv=hf,vv=Pr,Ev=wn,Sv=te,Rv=Ns;Lf.f=mv&&!Cv?Object.defineProperties:function(v,E){Ev(v);for(var A,B=Sv(E),H=Rv(E),X=H.length,q=0;X>q;)vv.f(v,A=H[q++],B[A]);return v};var xs,Fv=hn("document","documentElement"),Iv=wn,bv=Lf,$f=Dl,Tv=Al,Ov=Fv,Pv=vl,zl="prototype",Wl="script",Df=Rf("IE_PROTO"),jl=function(){},kf=function(v){return"<"+Wl+">"+v+"</"+Wl+">"},Uf=function(v){v.write(kf("")),v.close();var E=v.parentWindow.Object;return v=null,E},ys=function(){try{xs=new ActiveXObject("htmlfile")}catch{}var v,E,A;ys=typeof document<"u"?document.domain&&xs?Uf(xs):(E=Pv("iframe"),A="java"+Wl+":",E.style.display="none",Ov.appendChild(E),E.src=String(A),(v=E.contentWindow.document).open(),v.write(kf("document.F=Object")),v.close(),v.F):Uf(xs);for(var B=$f.length;B--;)delete ys[zl][$f[B]];return ys()};Tv[Df]=!0;var Bf,ql,Vf=Object.create||function(v,E){var A;return v!==null?(jl[zl]=Iv(v),A=new jl,jl[zl]=null,A[Df]=v):A=ys(),E===void 0?A:bv.f(A,E)},Av=g,Mv=p.RegExp,Nv=Av(function(){var v=Mv(".","s");return!(v.dotAll&&v.exec(`
`)&&v.flags==="s")}),xv=g,yv=p.RegExp,wv=xv(function(){var v=yv("(?<a>b)","g");return v.exec("b").groups.a!=="b"||"b".replace(v,"$<a>c")!=="bc"}),Ti=C,ws=N,Gv=Ar,Lv=wf,$v=Gf,Dv=Vf,kv=xl.get,Uv=Nv,Bv=wv,Vv=Ri("native-string-replace",String.prototype.replace),Gs=RegExp.prototype.exec,Kl=Gs,Hv=ws("".charAt),Xv=ws("".indexOf),Yv=ws("".replace),Ql=ws("".slice),Zl=(ql=/b*/g,Ti(Gs,Bf=/a/,"a"),Ti(Gs,ql,"a"),Bf.lastIndex!==0||ql.lastIndex!==0),Hf=$v.BROKEN_CARET,Jl=/()??/.exec("")[1]!==void 0;(Zl||Jl||Hf||Uv||Bv)&&(Kl=function(v){var E,A,B,H,X,q,Q,se=this,Se=kv(se),Fe=Gv(v),Ne=Se.raw;if(Ne)return Ne.lastIndex=se.lastIndex,E=Ti(Kl,Ne,Fe),se.lastIndex=Ne.lastIndex,E;var Pe=Se.groups,Me=Hf&&se.sticky,Qe=Ti(Lv,se),_t=se.source,Tt=0,Kt=Fe;if(Me&&(Qe=Yv(Qe,"y",""),Xv(Qe,"g")===-1&&(Qe+="g"),Kt=Ql(Fe,se.lastIndex),se.lastIndex>0&&(!se.multiline||se.multiline&&Hv(Fe,se.lastIndex-1)!==`
`)&&(_t="(?: "+_t+")",Kt=" "+Kt,Tt++),A=new RegExp("^(?:"+_t+")",Qe)),Jl&&(A=new RegExp("^"+_t+"$(?!\\s)",Qe)),Zl&&(B=se.lastIndex),H=Ti(Gs,Me?A:se,Kt),Me?H?(H.input=Ql(H.input,Tt),H[0]=Ql(H[0],Tt),H.index=se.lastIndex,se.lastIndex+=H[0].length):se.lastIndex=0:Zl&&H&&(se.lastIndex=se.global?H.index+H[0].length:B),Jl&&H&&H.length>1&&Ti(Vv,H[0],A,function(){for(X=1;X<arguments.length-2;X++)arguments[X]===void 0&&(H[X]=void 0)}),H&&Pe)for(H.groups=q=Dv(null),X=0;X<Pe.length;X++)q[(Q=Pe[X])[0]]=H[Q[1]];return H});var Co=Kl;qt({target:"RegExp",proto:!0,forced:/./.exec!==Co},{exec:Co});var zv=O,Wv=N,ec=function(v){if(zv(v)==="Function")return Wv(v)},Xf=ec,Yf=Ps,jv=Co,zf=g,Wf=rn,qv=Fs,Kv=Wf("species"),tc=RegExp.prototype,nc=function(v,E,A,B){var H=Wf(v),X=!zf(function(){var Se={};return Se[H]=function(){return 7},""[v](Se)!=7}),q=X&&!zf(function(){var Se=!1,Fe=/a/;return v==="split"&&((Fe={}).constructor={},Fe.constructor[Kv]=function(){return Fe},Fe.flags="",Fe[H]=/./[H]),Fe.exec=function(){return Se=!0,null},Fe[H](""),!Se});if(!X||!q||A){var Q=Xf(/./[H]),se=E(H,""[v],function(Se,Fe,Ne,Pe,Me){var Qe=Xf(Se),_t=Fe.exec;return _t===jv||_t===tc.exec?X&&!Me?{done:!0,value:Q(Fe,Ne,Pe)}:{done:!0,value:Qe(Ne,Fe,Pe)}:{done:!1}});Yf(String.prototype,v,se[0]),Yf(tc,H,se[1])}B&&qv(tc[H],"sham",!0)},Qv=Object.is||function(v,E){return v===E?v!==0||1/v==1/E:v!=v&&E!=E},jf=C,Zv=wn,Jv=Ve,eE=O,tE=Co,nE=TypeError,rc=function(v,E){var A=v.exec;if(Jv(A)){var B=jf(A,v,E);return B!==null&&Zv(B),B}if(eE(v)==="RegExp")return jf(tE,v,E);throw nE("RegExp#exec called on incompatible receiver")},rE=C,iE=wn,oE=le,sE=ae,qf=Qv,Kf=Ar,aE=mi,lE=rc;nc("search",function(v,E,A){return[function(B){var H=sE(this),X=oE(B)?void 0:aE(B,v);return X?rE(X,B,H):new RegExp(B)[v](Kf(H))},function(B){var H=iE(this),X=Kf(B),q=A(E,H,X);if(q.done)return q.value;var Q=H.lastIndex;qf(Q,0)||(H.lastIndex=0);var se=lE(H,X);return qf(H.lastIndex,Q)||(H.lastIndex=Q),se===null?-1:se.index}]});var cE=rn,uE=Vf,dE=Pr.f,ic=cE("unscopables"),oc=Array.prototype;oc[ic]==null&&dE(oc,ic,{configurable:!0,value:uE(null)});var Qf=function(v){oc[ic][v]=!0},fE=Mf.includes,_E=Qf;qt({target:"Array",proto:!0,forced:g(function(){return!Array(1).includes()})},{includes:function(v){return fE(this,v,arguments.length>1?arguments[1]:void 0)}}),_E("includes");var pE=ot,hE=O,gE=rn("match"),Zf=function(v){var E;return pE(v)&&((E=v[gE])!==void 0?!!E:hE(v)=="RegExp")},mE=Zf,CE=TypeError,vE=rn("match"),EE=qt,SE=function(v){if(mE(v))throw CE("The method doesn't accept regular expressions");return v},RE=ae,Jf=Ar,FE=function(v){var E=/./;try{"/./"[v](E)}catch{try{return E[vE]=!1,"/./"[v](E)}catch{}}return!1},IE=N("".indexOf);EE({target:"String",proto:!0,forced:!FE("includes")},{includes:function(v){return!!~IE(Jf(RE(this)),Jf(SE(v)),arguments.length>1?arguments[1]:void 0)}});var e_=`	
\v\f\r                　\u2028\u2029\uFEFF`,bE=ae,TE=Ar,sc=e_,t_=N("".replace),OE=RegExp("^["+sc+"]+"),PE=RegExp("(^|[^"+sc+"])["+sc+"]+$"),AE=function(v){return function(E){var A=TE(bE(E));return 1&v&&(A=t_(A,OE,"")),2&v&&(A=t_(A,PE,"$1")),A}},ME={trim:AE(3)},NE=Is.PROPER,xE=g,n_=e_,yE=ME.trim;qt({target:"String",proto:!0,forced:function(v){return xE(function(){return!!n_[v]()||"​᠎"[v]()!=="​᠎"||NE&&n_[v].name!==v})}("trim")},{trim:function(){return yE(this)}});var wE=O,ac=Array.isArray||function(v){return wE(v)=="Array"},GE=TypeError,LE=ml,$E=Pr,DE=y,lc=function(v,E,A){var B=LE(E);B in v?$E.f(v,B,DE(0,A)):v[B]=A},kE=N,UE=g,r_=Ve,BE=Vl,VE=vf,i_=function(){},HE=[],o_=hn("Reflect","construct"),cc=/^\s*(?:class|function)\b/,XE=kE(cc.exec),YE=!cc.exec(i_),vo=function(v){if(!r_(v))return!1;try{return o_(i_,HE,v),!0}catch{return!1}},s_=function(v){if(!r_(v))return!1;switch(BE(v)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return YE||!!XE(cc,VE(v))}catch{return!0}};s_.sham=!0;var uc=!o_||UE(function(){var v;return vo(vo.call)||!vo(Object)||!vo(function(){v=!0})||v})?s_:vo,a_=ac,zE=uc,WE=ot,jE=rn("species"),l_=Array,qE=function(v){var E;return a_(v)&&(E=v.constructor,(zE(E)&&(E===l_||a_(E.prototype))||WE(E)&&(E=E[jE])===null)&&(E=void 0)),E===void 0?l_:E},c_=function(v,E){return new(qE(v))(E===0?0:E)},KE=g,QE=zn,ZE=rn("species"),Ls=function(v){return QE>=51||!KE(function(){var E=[];return(E.constructor={})[ZE]=function(){return{foo:1}},E[v](Boolean).foo!==1})},JE=qt,eS=g,tS=ac,nS=ot,rS=Wn,iS=bi,u_=function(v){if(v>9007199254740991)throw GE("Maximum allowed index exceeded");return v},d_=lc,oS=c_,sS=Ls,aS=zn,f_=rn("isConcatSpreadable"),lS=aS>=51||!eS(function(){var v=[];return v[f_]=!1,v.concat()[0]!==v}),cS=function(v){if(!nS(v))return!1;var E=v[f_];return E!==void 0?!!E:tS(v)};JE({target:"Array",proto:!0,arity:1,forced:!lS||!sS("concat")},{concat:function(v){var E,A,B,H,X,q=rS(this),Q=oS(q,0),se=0;for(E=-1,B=arguments.length;E<B;E++)if(cS(X=E===-1?q:arguments[E]))for(H=iS(X),u_(se+H),A=0;A<H;A++,se++)A in X&&d_(Q,se,X[A]);else u_(se+1),d_(Q,se++,X);return Q.length=se,Q}});var __=f,uS=N,dS=C,fS=g,dc=Ns,_S=kl,pS=R,hS=Wn,gS=re,Oi=Object.assign,p_=Object.defineProperty,mS=uS([].concat),CS=!Oi||fS(function(){if(__&&Oi({b:1},Oi(p_({},"a",{enumerable:!0,get:function(){p_(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var v={},E={},A=Symbol(),B="abcdefghijklmnopqrst";return v[A]=7,B.split("").forEach(function(H){E[H]=H}),Oi({},v)[A]!=7||dc(Oi({},E)).join("")!=B})?function(v,E){for(var A=hS(v),B=arguments.length,H=1,X=_S.f,q=pS.f;B>H;)for(var Q,se=gS(arguments[H++]),Se=X?mS(dc(se),X(se)):dc(se),Fe=Se.length,Ne=0;Fe>Ne;)Q=Se[Ne++],__&&!dS(q,se,Q)||(A[Q]=se[Q]);return A}:Oi,h_=CS;qt({target:"Object",stat:!0,arity:2,forced:Object.assign!==h_},{assign:h_});var g_={name:"",placeholder:"",classes:"",classPrefix:"",data:void 0,locale:void 0,selectAll:!0,single:void 0,singleRadio:!1,multiple:!1,hideOptgroupCheckboxes:!1,multipleWidth:80,width:void 0,size:void 0,dropWidth:void 0,maxHeight:250,maxHeightUnit:"px",position:"bottom",displayValues:!1,displayTitle:!1,displayDelimiter:", ",minimumCountSelected:3,ellipsis:!1,isOpen:!1,keepOpen:!1,openOnHover:!1,container:null,filter:!1,filterGroup:!1,filterPlaceholder:"",filterAcceptOnEnter:!1,filterByDataLength:void 0,customFilter:function(v){var E=v.text,A=v.label,B=v.search;return(A||E).includes(B)},showClear:!1,animate:void 0,styler:function(){return!1},textTemplate:function(v){return v[0].innerHTML.trim()},labelTemplate:function(v){return v[0].getAttribute("label")},onOpen:function(){return!1},onClose:function(){return!1},onCheckAll:function(){return!1},onUncheckAll:function(){return!1},onFocus:function(){return!1},onBlur:function(){return!1},onOptgroupClick:function(){return!1},onBeforeClick:function(){return!0},onClick:function(){return!1},onFilter:function(){return!1},onClear:function(){return!1},onAfterCreate:function(){return!1}},fc={formatSelectAll:function(){return"[Select all]"},formatAllSelected:function(){return"All selected"},formatCountSelected:function(v,E){return"".concat(v," of ").concat(E," selected")},formatNoMatchesFound:function(){return"No matches found"}};Object.assign(g_,fc);var on={BLOCK_ROWS:500,CLUSTER_BLOCKS:4,DEFAULTS:g_,METHODS:["getOptions","refreshOptions","getData","getSelects","setSelects","enable","disable","open","close","check","uncheck","checkAll","uncheckAll","checkInvert","focus","blur","refresh","destroy"],LOCALES:{en:fc,"en-US":fc}},vS=d,m_=Function.prototype,C_=m_.apply,v_=m_.call,E_=typeof Reflect=="object"&&Reflect.apply||(vS?v_.bind(C_):function(){return v_.apply(C_,arguments)}),ES=uc,SS=Yr,RS=TypeError,S_=wn,FS=function(v){if(ES(v))return v;throw RS(SS(v)+" is not a constructor")},IS=le,bS=rn("species"),_c=N,TS=As,OS=Ar,PS=ae,AS=_c("".charAt),R_=_c("".charCodeAt),MS=_c("".slice),NS=function(v){return function(E,A){var B,H,X=OS(PS(E)),q=TS(A),Q=X.length;return q<0||q>=Q?v?"":void 0:(B=R_(X,q))<55296||B>56319||q+1===Q||(H=R_(X,q+1))<56320||H>57343?v?AS(X,q):B:v?MS(X,q,q+2):H-56320+(B-55296<<10)+65536}},xS={charAt:NS(!0)}.charAt,F_=function(v,E,A){return E+(A?xS(v,E).length:1)},I_=Gl,yS=bi,wS=lc,GS=Array,LS=Math.max,$S=E_,Eo=C,pc=N,DS=nc,kS=wn,US=le,BS=Zf,b_=ae,VS=function(v,E){var A,B=S_(v).constructor;return B===void 0||IS(A=S_(B)[bS])?E:FS(A)},HS=F_,XS=Ll,hc=Ar,YS=mi,T_=function(v,E,A){for(var B=yS(v),H=I_(E,B),X=I_(A===void 0?B:A,B),q=GS(LS(X-H,0)),Q=0;H<X;H++,Q++)wS(q,Q,v[H]);return q.length=Q,q},O_=rc,zS=Co,WS=g,Pi=Gf.UNSUPPORTED_Y,P_=4294967295,jS=Math.min,A_=[].push,qS=pc(/./.exec),Ai=pc(A_),So=pc("".slice);DS("split",function(v,E,A){var B;return B="abbc".split(/(b)*/)[1]=="c"||"test".split(/(?:)/,-1).length!=4||"ab".split(/(?:ab)*/).length!=2||".".split(/(.?)(.?)/).length!=4||".".split(/()()/).length>1||"".split(/.?/).length?function(H,X){var q=hc(b_(this)),Q=X===void 0?P_:X>>>0;if(Q===0)return[];if(H===void 0)return[q];if(!BS(H))return Eo(E,q,H,Q);for(var se,Se,Fe,Ne=[],Pe=(H.ignoreCase?"i":"")+(H.multiline?"m":"")+(H.unicode?"u":"")+(H.sticky?"y":""),Me=0,Qe=new RegExp(H.source,Pe+"g");(se=Eo(zS,Qe,q))&&!((Se=Qe.lastIndex)>Me&&(Ai(Ne,So(q,Me,se.index)),se.length>1&&se.index<q.length&&$S(A_,Ne,T_(se,1)),Fe=se[0].length,Me=Se,Ne.length>=Q));)Qe.lastIndex===se.index&&Qe.lastIndex++;return Me===q.length?!Fe&&qS(Qe,"")||Ai(Ne,""):Ai(Ne,So(q,Me)),Ne.length>Q?T_(Ne,0,Q):Ne}:"0".split(void 0,0).length?function(H,X){return H===void 0&&X===0?[]:Eo(E,this,H,X)}:E,[function(H,X){var q=b_(this),Q=US(H)?void 0:YS(H,v);return Q?Eo(Q,H,q,X):Eo(B,hc(q),H,X)},function(H,X){var q=kS(this),Q=hc(H),se=A(B,q,Q,X,B!==E);if(se.done)return se.value;var Se=VS(q,RegExp),Fe=q.unicode,Ne=(q.ignoreCase?"i":"")+(q.multiline?"m":"")+(q.unicode?"u":"")+(Pi?"g":"y"),Pe=new Se(Pi?"^(?:"+q.source+")":q,Ne),Me=X===void 0?P_:X>>>0;if(Me===0)return[];if(Q.length===0)return O_(Pe,Q)===null?[Q]:[];for(var Qe=0,_t=0,Tt=[];_t<Q.length;){Pe.lastIndex=Pi?0:_t;var Kt,kt=O_(Pe,Pi?So(Q,_t):Q);if(kt===null||(Kt=jS(XS(Pe.lastIndex+(Pi?_t:0)),Q.length))===Qe)_t=HS(Q,_t,Fe);else{if(Ai(Tt,So(Q,Qe,_t)),Tt.length===Me)return Tt;for(var Cn=1;Cn<=kt.length-1;Cn++)if(Ai(Tt,kt[Cn]),Tt.length===Me)return Tt;_t=Qe=Kt}}return Ai(Tt,So(Q,Qe)),Tt}]},!!WS(function(){var v=/(?:)/,E=v.exec;v.exec=function(){return E.apply(this,arguments)};var A="ab".split(v);return A.length!==2||A[0]!=="a"||A[1]!=="b"}),Pi);var KS=g,gc=function(v,E){var A=[][v];return!!A&&KS(function(){A.call(null,E||function(){return 1},1)})},QS=qt,ZS=re,JS=te,eR=gc,tR=N([].join);QS({target:"Array",proto:!0,forced:ZS!=Object||!eR("join",",")},{join:function(v){return tR(JS(this),v===void 0?",":v)}});var M_=Of,nR=Pr,rR=f,iR=Is.EXISTS,N_=N,oR=function(v,E,A){return A.get&&M_(A.get,E,{getter:!0}),A.set&&M_(A.set,E,{setter:!0}),nR.f(v,E,A)},x_=Function.prototype,sR=N_(x_.toString),y_=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,aR=N_(y_.exec);rR&&!iR&&oR(x_,"name",{configurable:!0,get:function(){try{return aR(y_,sR(this))[1]}catch{return""}}});var lR=_o,cR=d,uR=ec(ec.bind),dR=function(v,E){return lR(v),E===void 0?v:cR?uR(v,E):function(){return v.apply(E,arguments)}},fR=re,_R=Wn,pR=bi,hR=c_,w_=N([].push),$s=function(v){var E=v==1,A=v==2,B=v==3,H=v==4,X=v==6,q=v==7,Q=v==5||X;return function(se,Se,Fe,Ne){for(var Pe,Me,Qe=_R(se),_t=fR(Qe),Tt=dR(Se,Fe),Kt=pR(_t),kt=0,Cn=Ne||hR,Mr=E?Cn(se,Kt):A||q?Cn(se,0):void 0;Kt>kt;kt++)if((Q||kt in _t)&&(Me=Tt(Pe=_t[kt],kt,Qe),v))if(E)Mr[kt]=Me;else if(Me)switch(v){case 3:return!0;case 5:return Pe;case 6:return kt;case 2:w_(Mr,Pe)}else switch(v){case 4:return!1;case 7:w_(Mr,Pe)}return X?-1:B||H?H:Mr}},Ds={forEach:$s(0),map:$s(1),filter:$s(2),find:$s(5)},gR=qt,mR=Ds.find,CR=Qf,mc="find",G_=!0;mc in[]&&Array(1)[mc](function(){G_=!1}),gR({target:"Array",proto:!0,forced:G_},{find:function(v){return mR(this,v,arguments.length>1?arguments[1]:void 0)}}),CR(mc);var vR=Vl,ER=Bl?{}.toString:function(){return"[object "+vR(this)+"]"};Bl||Ps(Object.prototype,"toString",ER,{unsafe:!0});var SR=Ds.map;qt({target:"Array",proto:!0,forced:!Ls("map")},{map:function(v){return SR(this,v,arguments.length>1?arguments[1]:void 0)}});var RR=f,L_=N,FR=Ns,IR=te,bR=L_(R.f),TR=L_([].push),OR=function(v){return function(E){for(var A,B=IR(E),H=FR(B),X=H.length,q=0,Q=[];X>q;)A=H[q++],RR&&!bR(B,A)||TR(Q,v?[A,B[A]]:B[A]);return Q}},PR={entries:OR(!0)}.entries;qt({target:"Object",stat:!0},{entries:function(v){return PR(v)}});var AR=Wn,$_=Ns;qt({target:"Object",stat:!0,forced:g(function(){$_(1)})},{keys:function(v){return $_(AR(v))}});var MR=Ds.filter;qt({target:"Array",proto:!0,forced:!Ls("filter")},{filter:function(v){return MR(this,v,arguments.length>1?arguments[1]:void 0)}});var Cc=vl("span").classList,D_=Cc&&Cc.constructor&&Cc.constructor.prototype,NR=D_===Object.prototype?void 0:D_,xR=Ds.forEach,k_=p,U_={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},yR=NR,vc=gc("forEach")?[].forEach:function(v){return xR(this,v,arguments.length>1?arguments[1]:void 0)},wR=Fs,B_=function(v){if(v&&v.forEach!==vc)try{wR(v,"forEach",vc)}catch{v.forEach=vc}};for(var Ec in U_)U_[Ec]&&B_(k_[Ec]&&k_[Ec].prototype);B_(yR);var GR=N([].slice),LR=qt,V_=ac,$R=uc,DR=ot,H_=Gl,kR=bi,UR=te,BR=lc,VR=rn,HR=GR,XR=Ls("slice"),YR=VR("species"),Sc=Array,zR=Math.max;LR({target:"Array",proto:!0,forced:!XR},{slice:function(v,E){var A,B,H,X=UR(this),q=kR(X),Q=H_(v,q),se=H_(E===void 0?q:E,q);if(V_(X)&&(A=X.constructor,($R(A)&&(A===Sc||V_(A.prototype))||DR(A)&&(A=A[YR])===null)&&(A=void 0),A===Sc||A===void 0))return HR(X,Q,se);for(B=new(A===void 0?Sc:A)(zR(se-Q,0)),H=0;Q<se;Q++,H++)Q in X&&BR(B,H,X[Q]);return B.length=H,B}});var WR=C,jR=j,qR=Br,KR=wf,X_=RegExp.prototype,QR=Is.PROPER,ZR=Ps,JR=wn,Y_=Ar,eF=g,tF=function(v){var E=v.flags;return E!==void 0||"flags"in X_||jR(v,"flags")||!qR(X_,v)?E:WR(KR,v)},Rc="toString",z_=RegExp.prototype[Rc],nF=eF(function(){return z_.call({source:"a",flags:"b"})!="/a/b"}),rF=QR&&z_.name!=Rc;(nF||rF)&&ZR(RegExp.prototype,Rc,function(){var v=JR(this);return"/"+Y_(v.source)+"/"+Y_(tF(v))},{unsafe:!0});var iF=function(){function v(E){var A=this;e(this,v),this.rows=E.rows,this.scrollEl=E.scrollEl,this.contentEl=E.contentEl,this.callback=E.callback,this.cache={},this.scrollTop=this.scrollEl.scrollTop,this.initDOM(this.rows),this.scrollEl.scrollTop=this.scrollTop,this.lastCluster=0;var B=function(){A.lastCluster!==(A.lastCluster=A.getNum())&&(A.initDOM(A.rows),A.callback())};this.scrollEl.addEventListener("scroll",B,!1),this.destroy=function(){A.contentEl.innerHtml="",A.scrollEl.removeEventListener("scroll",B,!1)}}return r(v,[{key:"initDOM",value:function(E){this.clusterHeight===void 0&&(this.cache.scrollTop=this.scrollEl.scrollTop,this.cache.data=this.contentEl.innerHTML=E[0]+E[0]+E[0],this.getRowsHeight(E));var A=this.initData(E,this.getNum()),B=A.rows.join(""),H=this.checkChanges("data",B),X=this.checkChanges("top",A.topOffset),q=this.checkChanges("bottom",A.bottomOffset),Q=[];H&&X?(A.topOffset&&Q.push(this.getExtra("top",A.topOffset)),Q.push(B),A.bottomOffset&&Q.push(this.getExtra("bottom",A.bottomOffset)),this.contentEl.innerHTML=Q.join("")):q&&(this.contentEl.lastChild.style.height="".concat(A.bottomOffset,"px"))}},{key:"getRowsHeight",value:function(){if(this.itemHeight===void 0){var E=this.contentEl.children,A=E[Math.floor(E.length/2)];this.itemHeight=A.offsetHeight}this.blockHeight=this.itemHeight*on.BLOCK_ROWS,this.clusterRows=on.BLOCK_ROWS*on.CLUSTER_BLOCKS,this.clusterHeight=this.blockHeight*on.CLUSTER_BLOCKS}},{key:"getNum",value:function(){return this.scrollTop=this.scrollEl.scrollTop,Math.floor(this.scrollTop/(this.clusterHeight-this.blockHeight))||0}},{key:"initData",value:function(E,A){if(E.length<on.BLOCK_ROWS)return{topOffset:0,bottomOffset:0,rowsAbove:0,rows:E};var B=Math.max((this.clusterRows-on.BLOCK_ROWS)*A,0),H=B+this.clusterRows,X=Math.max(B*this.itemHeight,0),q=Math.max((E.length-H)*this.itemHeight,0),Q=[],se=B;X<1&&se++;for(var Se=B;Se<H;Se++)E[Se]&&Q.push(E[Se]);return this.dataStart=B,this.dataEnd=H,{topOffset:X,bottomOffset:q,rowsAbove:se,rows:Q}}},{key:"checkChanges",value:function(E,A){var B=A!==this.cache[E];return this.cache[E]=A,B}},{key:"getExtra",value:function(E,A){var B=document.createElement("li");return B.className="virtual-scroll-".concat(E),A&&(B.style.height="".concat(A,"px")),B.outerHTML}}]),v}(),Fc=N,oF=Wn,sF=Math.floor,Ic=Fc("".charAt),aF=Fc("".replace),bc=Fc("".slice),lF=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,cF=/\$([$&'`]|\d{1,2})/g,uF=E_,W_=C,ks=N,dF=nc,fF=g,_F=wn,pF=Ve,hF=le,gF=As,mF=Ll,Mi=Ar,CF=ae,vF=F_,EF=mi,SF=function(v,E,A,B,H,X){var q=A+v.length,Q=B.length,se=cF;return H!==void 0&&(H=oF(H),se=lF),aF(X,se,function(Se,Fe){var Ne;switch(Ic(Fe,0)){case"$":return"$";case"&":return v;case"`":return bc(E,0,A);case"'":return bc(E,q);case"<":Ne=H[bc(Fe,1,-1)];break;default:var Pe=+Fe;if(Pe===0)return Se;if(Pe>Q){var Me=sF(Pe/10);return Me===0?Se:Me<=Q?B[Me-1]===void 0?Ic(Fe,1):B[Me-1]+Ic(Fe,1):Se}Ne=B[Pe-1]}return Ne===void 0?"":Ne})},RF=rc,Tc=rn("replace"),FF=Math.max,IF=Math.min,bF=ks([].concat),Oc=ks([].push),j_=ks("".indexOf),q_=ks("".slice),TF="a".replace(/./,"$0")==="$0",K_=!!/./[Tc]&&/./[Tc]("a","$0")==="";dF("replace",function(v,E,A){var B=K_?"$":"$0";return[function(H,X){var q=CF(this),Q=hF(H)?void 0:EF(H,Tc);return Q?W_(Q,H,q,X):W_(E,Mi(q),H,X)},function(H,X){var q=_F(this),Q=Mi(H);if(typeof X=="string"&&j_(X,B)===-1&&j_(X,"$<")===-1){var se=A(E,q,Q,X);if(se.done)return se.value}var Se=pF(X);Se||(X=Mi(X));var Fe=q.global;if(Fe){var Ne=q.unicode;q.lastIndex=0}for(var Pe=[];;){var Me=RF(q,Q);if(Me===null||(Oc(Pe,Me),!Fe))break;Mi(Me[0])===""&&(q.lastIndex=vF(Q,mF(q.lastIndex),Ne))}for(var Qe,_t="",Tt=0,Kt=0;Kt<Pe.length;Kt++){for(var kt=Mi((Me=Pe[Kt])[0]),Cn=FF(IF(gF(Me.index),Q.length),0),Mr=[],Ac=1;Ac<Me.length;Ac++)Oc(Mr,(Qe=Me[Ac])===void 0?Qe:String(Qe));var Mc=Me.groups;if(Se){var Z_=bF([kt],Mr,Cn,Q);Mc!==void 0&&Oc(Z_,Mc);var J_=Mi(uF(X,void 0,Z_))}else J_=SF(kt,Q,Cn,Mr,Mc,X);Cn>=Tt&&(_t+=q_(Q,Tt,Cn)+J_,Tt=Cn+kt.length)}return _t+q_(Q,Tt)}]},!!fF(function(){var v=/./;return v.exec=function(){var E=[];return E.groups={a:"7"},E},"".replace(v,"$<a>")!=="7"})||!TF||K_);var OF=_o,PF=Wn,AF=re,MF=bi,NF=TypeError,xF=function(v){return function(E,A,B,H){OF(A);var X=PF(E),q=AF(X),Q=MF(X),se=v?Q-1:0,Se=v?-1:1;if(B<2)for(;;){if(se in q){H=q[se],se+=Se;break}if(se+=Se,v?se<0:Q<=se)throw NF("Reduce of empty array with no initial value")}for(;v?se>=0:Q>se;se+=Se)se in q&&(H=A(H,q[se],se,X));return H}},yF={left:xF(!1)},wF=typeof process<"u"&&O(process)=="process",GF=yF.left;qt({target:"Array",proto:!0,forced:!wF&&zn>79&&zn<83||!gc("reduce")},{reduce:function(v){var E=arguments.length;return GF(this,v,E,E>1?arguments[1]:void 0)}});var Ni=function(v){return v.normalize?v.normalize("NFD").replace(/[\u0300-\u036F]/g,""):[{base:"A",letters:/[\u0041\u24B6\uFF21\u00C0\u00C1\u00C2\u1EA6\u1EA4\u1EAA\u1EA8\u00C3\u0100\u0102\u1EB0\u1EAE\u1EB4\u1EB2\u0226\u01E0\u00C4\u01DE\u1EA2\u00C5\u01FA\u01CD\u0200\u0202\u1EA0\u1EAC\u1EB6\u1E00\u0104\u023A\u2C6F]/g},{base:"AA",letters:/[\uA732]/g},{base:"AE",letters:/[\u00C6\u01FC\u01E2]/g},{base:"AO",letters:/[\uA734]/g},{base:"AU",letters:/[\uA736]/g},{base:"AV",letters:/[\uA738\uA73A]/g},{base:"AY",letters:/[\uA73C]/g},{base:"B",letters:/[\u0042\u24B7\uFF22\u1E02\u1E04\u1E06\u0243\u0182\u0181]/g},{base:"C",letters:/[\u0043\u24B8\uFF23\u0106\u0108\u010A\u010C\u00C7\u1E08\u0187\u023B\uA73E]/g},{base:"D",letters:/[\u0044\u24B9\uFF24\u1E0A\u010E\u1E0C\u1E10\u1E12\u1E0E\u0110\u018B\u018A\u0189\uA779]/g},{base:"DZ",letters:/[\u01F1\u01C4]/g},{base:"Dz",letters:/[\u01F2\u01C5]/g},{base:"E",letters:/[\u0045\u24BA\uFF25\u00C8\u00C9\u00CA\u1EC0\u1EBE\u1EC4\u1EC2\u1EBC\u0112\u1E14\u1E16\u0114\u0116\u00CB\u1EBA\u011A\u0204\u0206\u1EB8\u1EC6\u0228\u1E1C\u0118\u1E18\u1E1A\u0190\u018E]/g},{base:"F",letters:/[\u0046\u24BB\uFF26\u1E1E\u0191\uA77B]/g},{base:"G",letters:/[\u0047\u24BC\uFF27\u01F4\u011C\u1E20\u011E\u0120\u01E6\u0122\u01E4\u0193\uA7A0\uA77D\uA77E]/g},{base:"H",letters:/[\u0048\u24BD\uFF28\u0124\u1E22\u1E26\u021E\u1E24\u1E28\u1E2A\u0126\u2C67\u2C75\uA78D]/g},{base:"I",letters:/[\u0049\u24BE\uFF29\u00CC\u00CD\u00CE\u0128\u012A\u012C\u0130\u00CF\u1E2E\u1EC8\u01CF\u0208\u020A\u1ECA\u012E\u1E2C\u0197]/g},{base:"J",letters:/[\u004A\u24BF\uFF2A\u0134\u0248]/g},{base:"K",letters:/[\u004B\u24C0\uFF2B\u1E30\u01E8\u1E32\u0136\u1E34\u0198\u2C69\uA740\uA742\uA744\uA7A2]/g},{base:"L",letters:/[\u004C\u24C1\uFF2C\u013F\u0139\u013D\u1E36\u1E38\u013B\u1E3C\u1E3A\u0141\u023D\u2C62\u2C60\uA748\uA746\uA780]/g},{base:"LJ",letters:/[\u01C7]/g},{base:"Lj",letters:/[\u01C8]/g},{base:"M",letters:/[\u004D\u24C2\uFF2D\u1E3E\u1E40\u1E42\u2C6E\u019C]/g},{base:"N",letters:/[\u004E\u24C3\uFF2E\u01F8\u0143\u00D1\u1E44\u0147\u1E46\u0145\u1E4A\u1E48\u0220\u019D\uA790\uA7A4]/g},{base:"NJ",letters:/[\u01CA]/g},{base:"Nj",letters:/[\u01CB]/g},{base:"O",letters:/[\u004F\u24C4\uFF2F\u00D2\u00D3\u00D4\u1ED2\u1ED0\u1ED6\u1ED4\u00D5\u1E4C\u022C\u1E4E\u014C\u1E50\u1E52\u014E\u022E\u0230\u00D6\u022A\u1ECE\u0150\u01D1\u020C\u020E\u01A0\u1EDC\u1EDA\u1EE0\u1EDE\u1EE2\u1ECC\u1ED8\u01EA\u01EC\u00D8\u01FE\u0186\u019F\uA74A\uA74C]/g},{base:"OI",letters:/[\u01A2]/g},{base:"OO",letters:/[\uA74E]/g},{base:"OU",letters:/[\u0222]/g},{base:"P",letters:/[\u0050\u24C5\uFF30\u1E54\u1E56\u01A4\u2C63\uA750\uA752\uA754]/g},{base:"Q",letters:/[\u0051\u24C6\uFF31\uA756\uA758\u024A]/g},{base:"R",letters:/[\u0052\u24C7\uFF32\u0154\u1E58\u0158\u0210\u0212\u1E5A\u1E5C\u0156\u1E5E\u024C\u2C64\uA75A\uA7A6\uA782]/g},{base:"S",letters:/[\u0053\u24C8\uFF33\u1E9E\u015A\u1E64\u015C\u1E60\u0160\u1E66\u1E62\u1E68\u0218\u015E\u2C7E\uA7A8\uA784]/g},{base:"T",letters:/[\u0054\u24C9\uFF34\u1E6A\u0164\u1E6C\u021A\u0162\u1E70\u1E6E\u0166\u01AC\u01AE\u023E\uA786]/g},{base:"TZ",letters:/[\uA728]/g},{base:"U",letters:/[\u0055\u24CA\uFF35\u00D9\u00DA\u00DB\u0168\u1E78\u016A\u1E7A\u016C\u00DC\u01DB\u01D7\u01D5\u01D9\u1EE6\u016E\u0170\u01D3\u0214\u0216\u01AF\u1EEA\u1EE8\u1EEE\u1EEC\u1EF0\u1EE4\u1E72\u0172\u1E76\u1E74\u0244]/g},{base:"V",letters:/[\u0056\u24CB\uFF36\u1E7C\u1E7E\u01B2\uA75E\u0245]/g},{base:"VY",letters:/[\uA760]/g},{base:"W",letters:/[\u0057\u24CC\uFF37\u1E80\u1E82\u0174\u1E86\u1E84\u1E88\u2C72]/g},{base:"X",letters:/[\u0058\u24CD\uFF38\u1E8A\u1E8C]/g},{base:"Y",letters:/[\u0059\u24CE\uFF39\u1EF2\u00DD\u0176\u1EF8\u0232\u1E8E\u0178\u1EF6\u1EF4\u01B3\u024E\u1EFE]/g},{base:"Z",letters:/[\u005A\u24CF\uFF3A\u0179\u1E90\u017B\u017D\u1E92\u1E94\u01B5\u0224\u2C7F\u2C6B\uA762]/g},{base:"a",letters:/[\u0061\u24D0\uFF41\u1E9A\u00E0\u00E1\u00E2\u1EA7\u1EA5\u1EAB\u1EA9\u00E3\u0101\u0103\u1EB1\u1EAF\u1EB5\u1EB3\u0227\u01E1\u00E4\u01DF\u1EA3\u00E5\u01FB\u01CE\u0201\u0203\u1EA1\u1EAD\u1EB7\u1E01\u0105\u2C65\u0250]/g},{base:"aa",letters:/[\uA733]/g},{base:"ae",letters:/[\u00E6\u01FD\u01E3]/g},{base:"ao",letters:/[\uA735]/g},{base:"au",letters:/[\uA737]/g},{base:"av",letters:/[\uA739\uA73B]/g},{base:"ay",letters:/[\uA73D]/g},{base:"b",letters:/[\u0062\u24D1\uFF42\u1E03\u1E05\u1E07\u0180\u0183\u0253]/g},{base:"c",letters:/[\u0063\u24D2\uFF43\u0107\u0109\u010B\u010D\u00E7\u1E09\u0188\u023C\uA73F\u2184]/g},{base:"d",letters:/[\u0064\u24D3\uFF44\u1E0B\u010F\u1E0D\u1E11\u1E13\u1E0F\u0111\u018C\u0256\u0257\uA77A]/g},{base:"dz",letters:/[\u01F3\u01C6]/g},{base:"e",letters:/[\u0065\u24D4\uFF45\u00E8\u00E9\u00EA\u1EC1\u1EBF\u1EC5\u1EC3\u1EBD\u0113\u1E15\u1E17\u0115\u0117\u00EB\u1EBB\u011B\u0205\u0207\u1EB9\u1EC7\u0229\u1E1D\u0119\u1E19\u1E1B\u0247\u025B\u01DD]/g},{base:"f",letters:/[\u0066\u24D5\uFF46\u1E1F\u0192\uA77C]/g},{base:"g",letters:/[\u0067\u24D6\uFF47\u01F5\u011D\u1E21\u011F\u0121\u01E7\u0123\u01E5\u0260\uA7A1\u1D79\uA77F]/g},{base:"h",letters:/[\u0068\u24D7\uFF48\u0125\u1E23\u1E27\u021F\u1E25\u1E29\u1E2B\u1E96\u0127\u2C68\u2C76\u0265]/g},{base:"hv",letters:/[\u0195]/g},{base:"i",letters:/[\u0069\u24D8\uFF49\u00EC\u00ED\u00EE\u0129\u012B\u012D\u00EF\u1E2F\u1EC9\u01D0\u0209\u020B\u1ECB\u012F\u1E2D\u0268\u0131]/g},{base:"j",letters:/[\u006A\u24D9\uFF4A\u0135\u01F0\u0249]/g},{base:"k",letters:/[\u006B\u24DA\uFF4B\u1E31\u01E9\u1E33\u0137\u1E35\u0199\u2C6A\uA741\uA743\uA745\uA7A3]/g},{base:"l",letters:/[\u006C\u24DB\uFF4C\u0140\u013A\u013E\u1E37\u1E39\u013C\u1E3D\u1E3B\u017F\u0142\u019A\u026B\u2C61\uA749\uA781\uA747]/g},{base:"lj",letters:/[\u01C9]/g},{base:"m",letters:/[\u006D\u24DC\uFF4D\u1E3F\u1E41\u1E43\u0271\u026F]/g},{base:"n",letters:/[\u006E\u24DD\uFF4E\u01F9\u0144\u00F1\u1E45\u0148\u1E47\u0146\u1E4B\u1E49\u019E\u0272\u0149\uA791\uA7A5]/g},{base:"nj",letters:/[\u01CC]/g},{base:"o",letters:/[\u006F\u24DE\uFF4F\u00F2\u00F3\u00F4\u1ED3\u1ED1\u1ED7\u1ED5\u00F5\u1E4D\u022D\u1E4F\u014D\u1E51\u1E53\u014F\u022F\u0231\u00F6\u022B\u1ECF\u0151\u01D2\u020D\u020F\u01A1\u1EDD\u1EDB\u1EE1\u1EDF\u1EE3\u1ECD\u1ED9\u01EB\u01ED\u00F8\u01FF\u0254\uA74B\uA74D\u0275]/g},{base:"oi",letters:/[\u01A3]/g},{base:"ou",letters:/[\u0223]/g},{base:"oo",letters:/[\uA74F]/g},{base:"p",letters:/[\u0070\u24DF\uFF50\u1E55\u1E57\u01A5\u1D7D\uA751\uA753\uA755]/g},{base:"q",letters:/[\u0071\u24E0\uFF51\u024B\uA757\uA759]/g},{base:"r",letters:/[\u0072\u24E1\uFF52\u0155\u1E59\u0159\u0211\u0213\u1E5B\u1E5D\u0157\u1E5F\u024D\u027D\uA75B\uA7A7\uA783]/g},{base:"s",letters:/[\u0073\u24E2\uFF53\u00DF\u015B\u1E65\u015D\u1E61\u0161\u1E67\u1E63\u1E69\u0219\u015F\u023F\uA7A9\uA785\u1E9B]/g},{base:"t",letters:/[\u0074\u24E3\uFF54\u1E6B\u1E97\u0165\u1E6D\u021B\u0163\u1E71\u1E6F\u0167\u01AD\u0288\u2C66\uA787]/g},{base:"tz",letters:/[\uA729]/g},{base:"u",letters:/[\u0075\u24E4\uFF55\u00F9\u00FA\u00FB\u0169\u1E79\u016B\u1E7B\u016D\u00FC\u01DC\u01D8\u01D6\u01DA\u1EE7\u016F\u0171\u01D4\u0215\u0217\u01B0\u1EEB\u1EE9\u1EEF\u1EED\u1EF1\u1EE5\u1E73\u0173\u1E77\u1E75\u0289]/g},{base:"v",letters:/[\u0076\u24E5\uFF56\u1E7D\u1E7F\u028B\uA75F\u028C]/g},{base:"vy",letters:/[\uA761]/g},{base:"w",letters:/[\u0077\u24E6\uFF57\u1E81\u1E83\u0175\u1E87\u1E85\u1E98\u1E89\u2C73]/g},{base:"x",letters:/[\u0078\u24E7\uFF58\u1E8B\u1E8D]/g},{base:"y",letters:/[\u0079\u24E8\uFF59\u1EF3\u00FD\u0177\u1EF9\u0233\u1E8F\u00FF\u1EF7\u1E99\u1EF5\u01B4\u024F\u1EFF]/g},{base:"z",letters:/[\u007A\u24E9\uFF5A\u017A\u1E91\u017C\u017E\u1E93\u1E95\u01B6\u0225\u0240\u2C6C\uA763]/g}].reduce(function(E,A){var B=A.letters,H=A.base;return E.replace(B,H)},v)},Us=function(v,E,A){var B,H=a(v);try{for(H.s();!(B=H.n()).done;){var X=B.value;if(X[E]===A||X[E]==="".concat(+X[E])&&+X[E]===A)return X;if(X.type==="optgroup"){var q,Q=a(X.children);try{for(Q.s();!(q=Q.n()).done;){var se=q.value;if(se[E]===A||se[E]==="".concat(+se[E])&&+se[E]===A)return se}}catch(Se){Q.e(Se)}finally{Q.f()}}}}catch(Se){H.e(Se)}finally{H.f()}},Pc=function(v){return Object.keys(v).forEach(function(E){return v[E]===void 0?delete v[E]:""}),v},Q_=function(){function v(E,A){e(this,v),this.$el=E,this.options=$.extend({},on.DEFAULTS,A)}return r(v,[{key:"init",value:function(){this.initLocale(),this.initContainer(),this.initData(),this.initSelected(!0),this.initFilter(),this.initDrop(),this.initView(),this.options.onAfterCreate()}},{key:"initLocale",value:function(){if(this.options.locale){var E=$.fn.multipleSelect.locales,A=this.options.locale.split(/-|_/);A[0]=A[0].toLowerCase(),A[1]&&(A[1]=A[1].toUpperCase()),E[this.options.locale]?$.extend(this.options,E[this.options.locale]):E[A.join("-")]?$.extend(this.options,E[A.join("-")]):E[A[0]]&&$.extend(this.options,E[A[0]])}}},{key:"initContainer",value:function(){var E=this,A=this.$el[0],B=A.getAttribute("name")||this.options.name||"";this.options.classes&&this.$el.addClass(this.options.classes),this.options.classPrefix&&(this.$el.addClass(this.options.classPrefix),this.options.size&&this.$el.addClass("".concat(this.options.classPrefix,"-").concat(this.options.size))),this.$el.hide(),this.$label=this.$el.closest("label"),!this.$label.length&&this.$el.attr("id")&&(this.$label=$('label[for="'.concat(this.$el.attr("id"),'"]'))),this.$label.find(">input").length&&(this.$label=null),this.options.single===void 0&&(this.options.single=A.getAttribute("multiple")===null),this.$parent=$(`
      <div class="ms-parent `.concat(A.getAttribute("class")||""," ").concat(this.options.classes,`"
      title="`).concat(A.getAttribute("title")||"",`" />
    `)),this.options.placeholder=this.options.placeholder||A.getAttribute("placeholder")||"",this.tabIndex=A.getAttribute("tabindex");var H="";if(this.tabIndex!==null&&(H=this.tabIndex&&'tabindex="'.concat(this.tabIndex,'"')),this.$el.attr("tabindex",-1),this.$choice=$(`
      <button type="button" class="ms-choice"`.concat(H,`>
      <span class="placeholder">`).concat(this.options.placeholder,`</span>
      `).concat(this.options.showClear?'<div class="icon-close"></div>':"",`
      <div class="icon-caret"></div>
      </button>
    `)),this.$drop=$('<div class="ms-drop '.concat(this.options.position,'" />')),this.$close=this.$choice.find(".icon-close"),this.options.dropWidth&&this.$drop.css("width",this.options.dropWidth),this.$el.after(this.$parent),this.$parent.append(this.$choice),this.$parent.append(this.$drop),A.disabled&&this.$choice.addClass("disabled"),this.selectAllName='data-name="selectAll'.concat(B,'"'),this.selectGroupName='data-name="selectGroup'.concat(B,'"'),this.selectItemName='data-name="selectItem'.concat(B,'"'),!this.options.keepOpen){var X=function(){var q=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return q=q||"".concat(+new Date).concat(~~(1e6*Math.random())),"click.multiple-select-".concat(q)}(this.$el.attr("id"));$(document).off(X).on(X,function(q){$(q.target)[0]!==E.$choice[0]&&$(q.target).parents(".ms-choice")[0]!==E.$choice[0]&&($(q.target)[0]===E.$drop[0]||$(q.target).parents(".ms-drop")[0]!==E.$drop[0]&&q.target!==A)&&E.options.isOpen&&E.close()})}}},{key:"initData",value:function(){var E=this,A=[];if(this.options.data){if(Array.isArray(this.options.data))this.data=this.options.data.map(function(se){return typeof se=="string"||typeof se=="number"?{text:se,value:se}:se});else if(n(this.options.data)==="object"){for(var B=0,H=Object.entries(this.options.data);B<H.length;B++){var X=i(H[B],2),q=X[0],Q=X[1];A.push({value:q,text:Q})}this.data=A}}else $.each(this.$el.children(),function(se,Se){E.initRow(se,Se)&&A.push(E.initRow(se,Se))}),this.options.data=A,this.data=A,this.fromHtml=!0;this.dataTotal=function(se){var Se=0;return se.forEach(function(Fe,Ne){Fe.type==="optgroup"?(Fe._key="group_".concat(Ne),Fe.visible=Fe.visible===void 0||Fe.visible,Fe.children.forEach(function(Pe,Me){Pe.visible=Pe.visible===void 0||Pe.visible,Pe.divider||(Pe._key="option_".concat(Ne,"_").concat(Me),Se+=1)})):(Fe.visible=Fe.visible===void 0||Fe.visible,Fe.divider||(Fe._key="option_".concat(Ne),Se+=1))}),Se}(this.data)}},{key:"initRow",value:function(E,A,B){var H=this,X={},q=$(A);return q.is("option")?(X.type="option",X.text=this.options.textTemplate(q),X.value=A.value,X.visible=!0,X.selected=!!A.selected,X.disabled=B||A.disabled,X.classes=A.getAttribute("class")||"",X.title=A.getAttribute("title")||"",q.data("value")&&(X._value=q.data("value")),Object.keys(q.data()).length&&(X._data=q.data(),X._data.divider&&(X.divider=X._data.divider)),X):q.is("optgroup")?(X.type="optgroup",X.label=this.options.labelTemplate(q),X.visible=!0,X.selected=!!A.selected,X.disabled=A.disabled,X.children=[],Object.keys(q.data()).length&&(X._data=q.data()),$.each(q.children(),function(Q,se){X.children.push(H.initRow(Q,se,X.disabled))}),X):null}},{key:"initSelected",value:function(E){var A,B=0,H=a(this.data);try{for(H.s();!(A=H.n()).done;){var X=A.value;if(X.type==="optgroup"){var q=X.children.filter(function(Q){return Q.selected&&!Q.disabled&&Q.visible}).length;X.children.length&&(X.selected=!this.options.single&&q&&q===X.children.filter(function(Q){return!Q.disabled&&Q.visible&&!Q.divider}).length),B+=q}else B+=X.selected&&!X.disabled&&X.visible?1:0}}catch(Q){H.e(Q)}finally{H.f()}this.allSelected=this.data.filter(function(Q){return Q.selected&&!Q.disabled&&Q.visible}).length===this.data.filter(function(Q){return!Q.disabled&&Q.visible&&!Q.divider}).length,E||(this.allSelected?this.options.onCheckAll():B===0&&this.options.onUncheckAll())}},{key:"initFilter",value:function(){if(this.filterText="",!this.options.filter&&this.options.filterByDataLength){var E,A=0,B=a(this.data);try{for(B.s();!(E=B.n()).done;){var H=E.value;H.type==="optgroup"?A+=H.children.length:A+=1}}catch(X){B.e(X)}finally{B.f()}this.options.filter=A>this.options.filterByDataLength}}},{key:"initDrop",value:function(){var E=this;this.initList(),this.update(!0),this.options.isOpen&&setTimeout(function(){E.open()},50),this.options.openOnHover&&this.$parent.hover(function(){E.open()},function(){E.close()})}},{key:"initList",value:function(){var E=[];this.options.filter&&E.push(`
        <div class="ms-search">
          <input type="text" autocomplete="off" autocorrect="off"
            autocapitalize="off" spellcheck="false"
            placeholder="`.concat(this.options.filterPlaceholder,`">
        </div>
      `)),E.push("<ul></ul>"),this.$drop.html(E.join("")),this.$ul=this.$drop.find(">ul"),this.initListItems()}},{key:"initListItems",value:function(){var E=this,A=this.getListRows(),B=0;if(this.options.selectAll&&!this.options.single&&(B=-1),A.length>on.BLOCK_ROWS*on.CLUSTER_BLOCKS){this.virtualScroll&&this.virtualScroll.destroy();var H=this.$drop.is(":visible");H||this.$drop.css("left",-1e4).show();var X=function(){E.updateDataStart=E.virtualScroll.dataStart+B,E.updateDataEnd=E.virtualScroll.dataEnd+B,E.updateDataStart<0&&(E.updateDataStart=0),E.updateDataEnd>E.data.length&&(E.updateDataEnd=E.data.length)};this.virtualScroll=new iF({rows:A,scrollEl:this.$ul[0],contentEl:this.$ul[0],callback:function(){X(),E.events()}}),X(),H||this.$drop.css("left",0).hide()}else this.$ul.html(A.join("")),this.updateDataStart=0,this.updateDataEnd=this.updateData.length,this.virtualScroll=null;this.events()}},{key:"getListRows",value:function(){var E=this,A=[];return this.options.selectAll&&!this.options.single&&A.push(`
        <li class="ms-select-all" tabindex="0">
        <label>
        <input type="checkbox" `.concat(this.selectAllName).concat(this.allSelected?' checked="checked"':"",` tabindex="-1" />
        <span>`).concat(this.options.formatSelectAll(),`</span>
        </label>
        </li>
      `)),this.updateData=[],this.data.forEach(function(B){A.push.apply(A,o(E.initListItem(B)))}),A.push('<li class="ms-no-results">'.concat(this.options.formatNoMatchesFound(),"</li>")),A}},{key:"initListItem",value:function(E){var A=this,B=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,H=E.title?'title="'.concat(E.title,'"'):"",X=this.options.multiple?"multiple":"",q=this.options.single?"radio":"checkbox",Q="";if(!E.visible)return[];if(this.updateData.push(E),this.options.single&&!this.options.singleRadio&&(Q="hide-radio "),E.selected&&(Q+="selected "),E.type==="optgroup"){var se=this.options.styler(E),Se=se?'style="'.concat(se,'"'):"",Fe=[],Ne=this.options.hideOptgroupCheckboxes||this.options.single?"<span ".concat(this.selectGroupName,' data-key="').concat(E._key,'"></span>'):`<input type="checkbox"
          `.concat(this.selectGroupName,`
          data-key="`).concat(E._key,`"
          `).concat(E.selected?' checked="checked"':"",`
          `).concat(E.disabled?' disabled="disabled"':"",`
          tabindex="-1"
        >`);return Q.includes("hide-radio")||!this.options.hideOptgroupCheckboxes&&!this.options.single||(Q+="hide-radio "),Fe.push(`
        <li class="group `.concat(Q,'" ').concat(Se,' tabindex="').concat(Q.includes("hide-radio")||E.disabled?-1:0,`">
        <label class="optgroup`).concat(this.options.single||E.disabled?" disabled":"",`">
        `).concat(Ne).concat(E.label,`
        </label>
        </li>
      `)),E.children.forEach(function(Qe){Fe.push.apply(Fe,o(A.initListItem(Qe,1)))}),Fe}var Pe=this.options.styler(E),Me=Pe?'style="'.concat(Pe,'"'):"";return Q+=E.classes||"",B&&this.options.single&&(Q+="option-level-".concat(B," ")),E.divider?'<li class="option-divider"/>':[`
      <li class="`.concat(X," ").concat(Q,'" ').concat(H," ").concat(Me,' tabindex="').concat(E.disabled?-1:0,`">
      <label class="`).concat(E.disabled?"disabled":"",`">
      <input type="`).concat(q,`"
        value="`).concat(E.value,`"
        data-key="`).concat(E._key,`"
        `).concat(this.selectItemName,`
        `).concat(E.selected?' checked="checked"':"",`
        `).concat(E.disabled?' disabled="disabled"':"",`
        tabindex="-1"
      >
      <span>`).concat(E.text,`</span>
      </label>
      </li>
    `)]}},{key:"events",value:function(){var E=this;this.$searchInput=this.$drop.find(".ms-search input"),this.$selectAll=this.$drop.find("input[".concat(this.selectAllName,"]")),this.$selectGroups=this.$drop.find("input[".concat(this.selectGroupName,"],span[").concat(this.selectGroupName,"]")),this.$selectItems=this.$drop.find("input[".concat(this.selectItemName,"]:enabled")),this.$disableItems=this.$drop.find("input[".concat(this.selectItemName,"]:disabled")),this.$noResults=this.$drop.find(".ms-no-results");var A=function(B){B.preventDefault(),$(B.target).hasClass("icon-close")||E[E.options.isOpen?"close":"open"]()};this.$label&&this.$label.length&&this.$label.off("click").on("click",function(B){B.target.nodeName.toLowerCase()==="label"&&(A(B),E.options.filter&&E.options.isOpen||E.focus(),B.stopPropagation())}),this.$choice.off("click").on("click",A).off("focus").on("focus",this.options.onFocus).off("blur").on("blur",this.options.onBlur),this.$parent.off("keydown").on("keydown",function(B){B.which!==27||E.options.keepOpen||(E.close(),E.$choice.focus())}),this.$close.off("click").on("click",function(B){B.preventDefault(),E._checkAll(!1,!0),E.initSelected(!1),E.updateSelected(),E.update(),E.options.onClear()}),this.$searchInput.off("keydown").on("keydown",function(B){B.keyCode===9&&B.shiftKey&&E.close()}).off("keyup").on("keyup",function(B){if(E.options.filterAcceptOnEnter&&[13,32].includes(B.which)&&E.$searchInput.val()){if(E.options.single){var H=E.$selectItems.closest("li").filter(":visible");H.length&&E.setSelects([H.first().find("input[".concat(E.selectItemName,"]")).val()])}else E.$selectAll.click();return E.close(),void E.focus()}E.filter()}),this.$selectAll.off("click").on("click",function(B){E._checkAll($(B.currentTarget).prop("checked"))}),this.$selectGroups.off("click").on("click",function(B){var H=$(B.currentTarget),X=H.prop("checked"),q=Us(E.data,"_key",H.data("key"));E._checkGroup(q,X),E.options.onOptgroupClick(Pc({label:q.label,selected:q.selected,data:q._data,children:q.children.map(function(Q){return Pc({text:Q.text,value:Q.value,selected:Q.selected,disabled:Q.disabled,data:Q._data})})}))}),this.$selectItems.off("click").on("click",function(B){var H=$(B.currentTarget),X=H.prop("checked"),q=Us(E.data,"_key",H.data("key")),Q=function(){E.options.single&&E.options.isOpen&&!E.options.keepOpen&&E.close()};E.options.onBeforeClick(q)!==!1&&(E._check(q,X),E.options.onClick(Pc({text:q.text,value:q.value,selected:q.selected,data:q._data}))),Q()}),this.$ul.find("li").off("keydown").on("keydown",function(B){var H,X=$(B.currentTarget);switch(B.key){case"ArrowUp":B.preventDefault(),((H=X.prev("li.option-divider")).length?H:X).prev().trigger("focus");break;case"ArrowDown":B.preventDefault(),((H=X.next("li.option-divider")).length?H:X).next().trigger("focus");break;case"Enter":B.preventDefault(),X.find("input").trigger("click"),E.options.single&&E.$choice.trigger("focus")}})}},{key:"initView",value:function(){var E;window.getComputedStyle?(E=window.getComputedStyle(this.$el[0]).width)==="auto"&&(E=this.$drop.outerWidth()+20):E=this.$el.outerWidth()+20,this.$parent.css("width",this.options.width||E),this.$el.show().addClass("ms-offscreen")}},{key:"open",value:function(){if(!this.$choice.hasClass("disabled")){if(this.options.isOpen=!0,this.$parent.addClass("ms-parent-open"),this.$choice.find(">div").addClass("open"),this.$drop[this.animateMethod("show")](),this.$selectAll.parent().show(),this.$noResults.hide(),this.data.length||(this.$selectAll.parent().hide(),this.$noResults.show()),this.options.container){var E=this.$drop.offset();this.$drop.appendTo($(this.options.container)),this.$drop.offset({top:E.top,left:E.left}).css("min-width","auto").outerWidth(this.$parent.outerWidth())}var A=this.options.maxHeight;this.options.maxHeightUnit==="row"&&(A=this.$drop.find(">ul>li").first().outerHeight()*this.options.maxHeight),this.$drop.find(">ul").css("max-height","".concat(A,"px")),this.$drop.find(".multiple").css("width","".concat(this.options.multipleWidth,"px")),this.data.length&&this.options.filter&&(this.$searchInput.val(""),this.$searchInput.focus(),this.filter(!0)),this.options.onOpen()}}},{key:"close",value:function(){this.options.isOpen=!1,this.$parent.removeClass("ms-parent-open"),this.$choice.find(">div").removeClass("open"),this.$drop[this.animateMethod("hide")](),this.options.container&&(this.$parent.append(this.$drop),this.$drop.css({top:"auto",left:"auto"})),this.options.onClose()}},{key:"animateMethod",value:function(E){return{show:{fade:"fadeIn",slide:"slideDown"},hide:{fade:"fadeOut",slide:"slideUp"}}[E][this.options.animate]||E}},{key:"update",value:function(E){var A=this.getSelects(),B=this.getSelects("text");this.options.displayValues&&(B=A);var H=this.$choice.find(">span"),X=A.length,q="";X===0?H.addClass("placeholder").html(this.options.placeholder):q=X<this.options.minimumCountSelected?B.join(this.options.displayDelimiter):this.options.formatAllSelected()&&X===this.dataTotal?this.options.formatAllSelected():this.options.ellipsis&&X>this.options.minimumCountSelected?"".concat(B.slice(0,this.options.minimumCountSelected).join(this.options.displayDelimiter),"..."):this.options.formatCountSelected()&&X>this.options.minimumCountSelected?this.options.formatCountSelected(X,this.dataTotal):B.join(this.options.displayDelimiter),q&&H.removeClass("placeholder").html(q),this.options.displayTitle&&H.prop("title",this.getSelects("text")),this.$el.val(this.getSelects()),E||this.$el.trigger("change")}},{key:"updateSelected",value:function(){for(var E=this.updateDataStart;E<this.updateDataEnd;E++){var A=this.updateData[E];this.$drop.find("input[data-key=".concat(A._key,"]")).prop("checked",A.selected).closest("li").toggleClass("selected",A.selected)}var B=this.data.filter(function(H){return H.visible}).length===0;this.$selectAll.length&&this.$selectAll.prop("checked",this.allSelected).closest("li").toggle(!B),this.$noResults.toggle(B),this.virtualScroll&&(this.virtualScroll.rows=this.getListRows())}},{key:"getData",value:function(){return this.options.data}},{key:"getOptions",value:function(){var E=$.extend({},this.options);return delete E.data,$.extend(!0,{},E)}},{key:"refreshOptions",value:function(E){(function(A,B,H){var X=Object.keys(A),q=Object.keys(B);if(X.length!==q.length)return!1;for(var Q=0,se=X;Q<se.length;Q++){var Se=se[Q];if(q.includes(Se)&&A[Se]!==B[Se])return!1}return!0})(this.options,E)||(this.options=$.extend(this.options,E),this.destroy(),this.init())}},{key:"getSelects",value:function(){var E,A=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"value",B=[],H=a(this.data);try{for(H.s();!(E=H.n()).done;){var X=E.value;if(X.type==="optgroup"){var q=X.children.filter(function(se){return se.selected});if(!q.length)continue;if(A==="value"||this.options.single)B.push.apply(B,o(q.map(function(se){return A==="value"&&se._value||se[A]})));else{var Q=[];Q.push("["),Q.push(X.label),Q.push(": ".concat(q.map(function(se){return se[A]}).join(", "))),Q.push("]"),B.push(Q.join(""))}}else X.selected&&B.push(A==="value"&&X._value||X[A])}}catch(se){H.e(se)}finally{H.f()}return B}},{key:"setSelects",value:function(E){var A,B=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value",H=arguments.length>2&&arguments[2]!==void 0&&arguments[2],X=!1,q=function(Se){var Fe,Ne=a(Se);try{for(Ne.s();!(Fe=Ne.n()).done;){var Pe=Fe.value,Me=!1;B==="text"?Me=E.includes($("<div>").html(Pe.text).text().trim()):(Me=E.includes(Pe._value||Pe.value))||Pe.value!=="".concat(+Pe.value)||(Me=E.includes(+Pe.value)),Pe.selected!==Me&&(X=!0),Pe.selected=Me}}catch(Qe){Ne.e(Qe)}finally{Ne.f()}},Q=a(this.data);try{for(Q.s();!(A=Q.n()).done;){var se=A.value;se.type==="optgroup"?q(se.children):q([se])}}catch(Se){Q.e(Se)}finally{Q.f()}X&&(this.initSelected(H),this.updateSelected(),this.update(H))}},{key:"enable",value:function(){this.$choice.removeClass("disabled")}},{key:"disable",value:function(){this.$choice.addClass("disabled")}},{key:"check",value:function(E){var A=Us(this.data,"value",E);A&&this._check(A,!0)}},{key:"uncheck",value:function(E){var A=Us(this.data,"value",E);A&&this._check(A,!1)}},{key:"_check",value:function(E,A){this.options.single&&this._checkAll(!1,!0),E.selected=A,this.initSelected(),this.updateSelected(),this.update()}},{key:"checkAll",value:function(){this._checkAll(!0)}},{key:"uncheckAll",value:function(){this._checkAll(!1)}},{key:"_checkAll",value:function(E,A){var B,H=a(this.data);try{for(H.s();!(B=H.n()).done;){var X=B.value;X.type==="optgroup"?this._checkGroup(X,E,!0):X.disabled||X.divider||!A&&!X.visible||(X.selected=E)}}catch(q){H.e(q)}finally{H.f()}A||(this.initSelected(),this.updateSelected(),this.update())}},{key:"_checkGroup",value:function(E,A,B){E.selected=A,E.children.forEach(function(H){H.disabled||H.divider||!B&&!H.visible||(H.selected=A)}),B||(this.initSelected(),this.updateSelected(),this.update())}},{key:"checkInvert",value:function(){if(!this.options.single){var E,A=a(this.data);try{for(A.s();!(E=A.n()).done;){var B=E.value;if(B.type==="optgroup"){var H,X=a(B.children);try{for(X.s();!(H=X.n()).done;){var q=H.value;q.divider||(q.selected=!q.selected)}}catch(Q){X.e(Q)}finally{X.f()}}else B.divider||(B.selected=!B.selected)}}catch(Q){A.e(Q)}finally{A.f()}this.initSelected(),this.updateSelected(),this.update()}}},{key:"focus",value:function(){this.$choice.focus(),this.options.onFocus()}},{key:"blur",value:function(){this.$choice.blur(),this.options.onBlur()}},{key:"refresh",value:function(){this.destroy(),this.init()}},{key:"filter",value:function(E){var A=this.$searchInput.val().trim(),B=A.toLowerCase();if(this.filterText!==B){this.filterText=B;var H,X=a(this.data);try{for(X.s();!(H=X.n()).done;){var q=H.value;if(q.type==="optgroup")if(this.options.filterGroup){var Q=this.options.customFilter({label:Ni(q.label.toString().toLowerCase()),search:Ni(B),originalLabel:q.label,originalSearch:A,row:q});q.visible=Q;var se,Se=a(q.children);try{for(Se.s();!(se=Se.n()).done;)se.value.visible=Q}catch(Me){Se.e(Me)}finally{Se.f()}}else{var Fe,Ne=a(q.children);try{for(Ne.s();!(Fe=Ne.n()).done;){var Pe=Fe.value;Pe.visible=this.options.customFilter({text:Ni(Pe.text.toString().toLowerCase()),search:Ni(B),originalText:Pe.text,originalSearch:A,row:Pe,parent:q})}}catch(Me){Ne.e(Me)}finally{Ne.f()}q.visible=q.children.filter(function(Me){return Me.visible}).length>0}else q.visible=this.options.customFilter({text:Ni(q.text.toString().toLowerCase()),search:Ni(B),originalText:q.text,originalSearch:A,row:q})}}catch(Me){X.e(Me)}finally{X.f()}this.initListItems(),this.initSelected(E),this.updateSelected(),E||this.options.onFilter(A)}}},{key:"destroy",value:function(){this.$parent&&(this.$el.before(this.$parent).removeClass("ms-offscreen"),this.tabIndex!==null&&this.$el.attr("tabindex",this.tabIndex),this.$parent.remove(),this.fromHtml&&(delete this.options.data,this.fromHtml=!1))}}]),v}();return $.fn.multipleSelect=function(v){for(var E=arguments.length,A=new Array(E>1?E-1:0),B=1;B<E;B++)A[B-1]=arguments[B];var H;return this.each(function(X,q){var Q=$(q),se=Q.data("multipleSelect"),Se=$.extend({},Q.data(),n(v)==="object"&&v);if(se||(se=new Q_(Q,Se),Q.data("multipleSelect",se)),typeof v=="string"){var Fe;if($.inArray(v,on.METHODS)<0)throw new Error("Unknown method: ".concat(v));H=(Fe=se)[v].apply(Fe,A),v==="destroy"&&Q.removeData("multipleSelect")}else se.init()}),H!==void 0?H:this},$.fn.multipleSelect.Constructor=Q_,$.fn.multipleSelect.defaults=on.DEFAULTS,$.fn.multipleSelect.locales=on.LOCALES,$.fn.multipleSelect.methods=on.METHODS,Ep}Nb();let xb=class{constructor(e,t){const r=this,i=[{bit:0,name:"GYRO_CALIBRATED",visible:!0},{bit:1,name:"RX_LOST",visible:!0},{bit:2,name:"RX_LOST_LANDING",visible:!0},{bit:3,name:"DISARMING",visible:!0},{bit:4,name:"ARMING",visible:!0},{bit:5,name:"ARMING_GPS_FIX",visible:!0},{bit:6,name:"BAT_CRIT_LOW",visible:!0},{bit:7,name:"BAT_LOW",visible:!0},{bit:8,name:"GPS_STATUS",visible:!0},{bit:9,name:"RX_SET",visible:!0},{bit:10,name:"ACC_CALIBRATION",visible:!0},{bit:11,name:"ACC_CALIBRATION_FAIL",visible:!0},{bit:12,name:"READY_BEEP",visible:!0},{bit:13,name:"MULTI_BEEPS",visible:!1},{bit:14,name:"DISARM_REPEAT",visible:!0},{bit:15,name:"ARMED",visible:!0},{bit:16,name:"SYSTEM_INIT",visible:!0},{bit:17,name:"USB",visible:!0},{bit:18,name:"BLACKBOX_ERASE",visible:!0},{bit:21,name:"ARMING_GPS_NO_FIX",visible:!0}];t?(r._beepers=[],i.forEach(function(o){t.some(function(s){return s===o.name})&&r._beepers.push(o)})):r._beepers=i.slice(),r._beeperDisabledMask=0}getDisabledMask(){return this._beeperDisabledMask}setDisabledMask(e){const t=this;t._beeperDisabledMask=e}isEnabled(e){const t=this;for(let r=0;r<t._beepers.length;r++)if(t._beepers[r].name===e&&bit_check(t._beeperOfMask,t._beepers[r].bit))return!0;return!1}generateElements(e,t){const r=this;for(let i=0;i<r._beepers.length;i++)if(r._beepers[i].visible){const o=r._beepers[i].name,s=e.clone();t.append(s);const l=$(s).find("input"),a=$(s).find("div"),c=$(s).find("span");l.attr("id",`beeper-${i}`),l.attr("name",o),l.attr("title",o),l.prop("checked",!bit_check(r._beeperDisabledMask,r._beepers[i].bit)),l.data("bit",r._beepers[i].bit),a.text(o),c.html(i18n.getMessage(`beeper_${o}`)),s.show()}}updateData(e){const t=this;if(e.attr("type")==="checkbox"){const r=e.data("bit");e.is(":checked")?t._beeperDisabledMask=bit_clear(t._beeperDisabledMask,r):t._beeperDisabledMask=bit_set(t._beeperDisabledMask,r)}}};var Hs={exports:{}},Gc,Rp;function Qa(){if(Rp)return Gc;Rp=1;const n="2.0.0",e=256,t=Number.MAX_SAFE_INTEGER||9007199254740991,r=16,i=e-6;return Gc={MAX_LENGTH:e,MAX_SAFE_COMPONENT_LENGTH:r,MAX_SAFE_BUILD_LENGTH:i,MAX_SAFE_INTEGER:t,RELEASE_TYPES:["major","premajor","minor","preminor","patch","prepatch","prerelease"],SEMVER_SPEC_VERSION:n,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2},Gc}var Lc,Fp;function Za(){if(Fp)return Lc;Fp=1;var n={};return Lc=typeof process=="object"&&n&&n.NODE_DEBUG&&/\bsemver\b/i.test(n.NODE_DEBUG)?(...t)=>console.error("SEMVER",...t):()=>{},Lc}var Ip;function ss(){return Ip||(Ip=1,function(n,e){const{MAX_SAFE_COMPONENT_LENGTH:t,MAX_SAFE_BUILD_LENGTH:r,MAX_LENGTH:i}=Qa(),o=Za();e=n.exports={};const s=e.re=[],l=e.safeRe=[],a=e.src=[],c=e.safeSrc=[],u=e.t={};let p=0;const h="[a-zA-Z0-9-]",g=[["\\s",1],["\\d",i],[h,r]],f=_=>{for(const[m,C]of g)_=_.split(`${m}*`).join(`${m}{0,${C}}`).split(`${m}+`).join(`${m}{1,${C}}`);return _},d=(_,m,C)=>{const R=f(m),S=p++;o(_,S,m),u[_]=S,a[S]=m,c[S]=R,s[S]=new RegExp(m,C?"g":void 0),l[S]=new RegExp(R,C?"g":void 0)};d("NUMERICIDENTIFIER","0|[1-9]\\d*"),d("NUMERICIDENTIFIERLOOSE","\\d+"),d("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${h}*`),d("MAINVERSION",`(${a[u.NUMERICIDENTIFIER]})\\.(${a[u.NUMERICIDENTIFIER]})\\.(${a[u.NUMERICIDENTIFIER]})`),d("MAINVERSIONLOOSE",`(${a[u.NUMERICIDENTIFIERLOOSE]})\\.(${a[u.NUMERICIDENTIFIERLOOSE]})\\.(${a[u.NUMERICIDENTIFIERLOOSE]})`),d("PRERELEASEIDENTIFIER",`(?:${a[u.NONNUMERICIDENTIFIER]}|${a[u.NUMERICIDENTIFIER]})`),d("PRERELEASEIDENTIFIERLOOSE",`(?:${a[u.NONNUMERICIDENTIFIER]}|${a[u.NUMERICIDENTIFIERLOOSE]})`),d("PRERELEASE",`(?:-(${a[u.PRERELEASEIDENTIFIER]}(?:\\.${a[u.PRERELEASEIDENTIFIER]})*))`),d("PRERELEASELOOSE",`(?:-?(${a[u.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${a[u.PRERELEASEIDENTIFIERLOOSE]})*))`),d("BUILDIDENTIFIER",`${h}+`),d("BUILD",`(?:\\+(${a[u.BUILDIDENTIFIER]}(?:\\.${a[u.BUILDIDENTIFIER]})*))`),d("FULLPLAIN",`v?${a[u.MAINVERSION]}${a[u.PRERELEASE]}?${a[u.BUILD]}?`),d("FULL",`^${a[u.FULLPLAIN]}$`),d("LOOSEPLAIN",`[v=\\s]*${a[u.MAINVERSIONLOOSE]}${a[u.PRERELEASELOOSE]}?${a[u.BUILD]}?`),d("LOOSE",`^${a[u.LOOSEPLAIN]}$`),d("GTLT","((?:<|>)?=?)"),d("XRANGEIDENTIFIERLOOSE",`${a[u.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),d("XRANGEIDENTIFIER",`${a[u.NUMERICIDENTIFIER]}|x|X|\\*`),d("XRANGEPLAIN",`[v=\\s]*(${a[u.XRANGEIDENTIFIER]})(?:\\.(${a[u.XRANGEIDENTIFIER]})(?:\\.(${a[u.XRANGEIDENTIFIER]})(?:${a[u.PRERELEASE]})?${a[u.BUILD]}?)?)?`),d("XRANGEPLAINLOOSE",`[v=\\s]*(${a[u.XRANGEIDENTIFIERLOOSE]})(?:\\.(${a[u.XRANGEIDENTIFIERLOOSE]})(?:\\.(${a[u.XRANGEIDENTIFIERLOOSE]})(?:${a[u.PRERELEASELOOSE]})?${a[u.BUILD]}?)?)?`),d("XRANGE",`^${a[u.GTLT]}\\s*${a[u.XRANGEPLAIN]}$`),d("XRANGELOOSE",`^${a[u.GTLT]}\\s*${a[u.XRANGEPLAINLOOSE]}$`),d("COERCEPLAIN",`(^|[^\\d])(\\d{1,${t}})(?:\\.(\\d{1,${t}}))?(?:\\.(\\d{1,${t}}))?`),d("COERCE",`${a[u.COERCEPLAIN]}(?:$|[^\\d])`),d("COERCEFULL",a[u.COERCEPLAIN]+`(?:${a[u.PRERELEASE]})?(?:${a[u.BUILD]})?(?:$|[^\\d])`),d("COERCERTL",a[u.COERCE],!0),d("COERCERTLFULL",a[u.COERCEFULL],!0),d("LONETILDE","(?:~>?)"),d("TILDETRIM",`(\\s*)${a[u.LONETILDE]}\\s+`,!0),e.tildeTrimReplace="$1~",d("TILDE",`^${a[u.LONETILDE]}${a[u.XRANGEPLAIN]}$`),d("TILDELOOSE",`^${a[u.LONETILDE]}${a[u.XRANGEPLAINLOOSE]}$`),d("LONECARET","(?:\\^)"),d("CARETTRIM",`(\\s*)${a[u.LONECARET]}\\s+`,!0),e.caretTrimReplace="$1^",d("CARET",`^${a[u.LONECARET]}${a[u.XRANGEPLAIN]}$`),d("CARETLOOSE",`^${a[u.LONECARET]}${a[u.XRANGEPLAINLOOSE]}$`),d("COMPARATORLOOSE",`^${a[u.GTLT]}\\s*(${a[u.LOOSEPLAIN]})$|^$`),d("COMPARATOR",`^${a[u.GTLT]}\\s*(${a[u.FULLPLAIN]})$|^$`),d("COMPARATORTRIM",`(\\s*)${a[u.GTLT]}\\s*(${a[u.LOOSEPLAIN]}|${a[u.XRANGEPLAIN]})`,!0),e.comparatorTrimReplace="$1$2$3",d("HYPHENRANGE",`^\\s*(${a[u.XRANGEPLAIN]})\\s+-\\s+(${a[u.XRANGEPLAIN]})\\s*$`),d("HYPHENRANGELOOSE",`^\\s*(${a[u.XRANGEPLAINLOOSE]})\\s+-\\s+(${a[u.XRANGEPLAINLOOSE]})\\s*$`),d("STAR","(<|>)?=?\\s*\\*"),d("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),d("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")}(Hs,Hs.exports)),Hs.exports}var $c,bp;function Nd(){if(bp)return $c;bp=1;const n=Object.freeze({loose:!0}),e=Object.freeze({});return $c=r=>r?typeof r!="object"?n:r:e,$c}var Dc,Tp;function Bg(){if(Tp)return Dc;Tp=1;const n=/^[0-9]+$/,e=(r,i)=>{const o=n.test(r),s=n.test(i);return o&&s&&(r=+r,i=+i),r===i?0:o&&!s?-1:s&&!o?1:r<i?-1:1};return Dc={compareIdentifiers:e,rcompareIdentifiers:(r,i)=>e(i,r)},Dc}var kc,Op;function Wt(){if(Op)return kc;Op=1;const n=Za(),{MAX_LENGTH:e,MAX_SAFE_INTEGER:t}=Qa(),{safeRe:r,t:i}=ss(),o=Nd(),{compareIdentifiers:s}=Bg();class l{constructor(c,u){if(u=o(u),c instanceof l){if(c.loose===!!u.loose&&c.includePrerelease===!!u.includePrerelease)return c;c=c.version}else if(typeof c!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof c}".`);if(c.length>e)throw new TypeError(`version is longer than ${e} characters`);n("SemVer",c,u),this.options=u,this.loose=!!u.loose,this.includePrerelease=!!u.includePrerelease;const p=c.trim().match(u.loose?r[i.LOOSE]:r[i.FULL]);if(!p)throw new TypeError(`Invalid Version: ${c}`);if(this.raw=c,this.major=+p[1],this.minor=+p[2],this.patch=+p[3],this.major>t||this.major<0)throw new TypeError("Invalid major version");if(this.minor>t||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>t||this.patch<0)throw new TypeError("Invalid patch version");p[4]?this.prerelease=p[4].split(".").map(h=>{if(/^[0-9]+$/.test(h)){const g=+h;if(g>=0&&g<t)return g}return h}):this.prerelease=[],this.build=p[5]?p[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(c){if(n("SemVer.compare",this.version,this.options,c),!(c instanceof l)){if(typeof c=="string"&&c===this.version)return 0;c=new l(c,this.options)}return c.version===this.version?0:this.compareMain(c)||this.comparePre(c)}compareMain(c){return c instanceof l||(c=new l(c,this.options)),s(this.major,c.major)||s(this.minor,c.minor)||s(this.patch,c.patch)}comparePre(c){if(c instanceof l||(c=new l(c,this.options)),this.prerelease.length&&!c.prerelease.length)return-1;if(!this.prerelease.length&&c.prerelease.length)return 1;if(!this.prerelease.length&&!c.prerelease.length)return 0;let u=0;do{const p=this.prerelease[u],h=c.prerelease[u];if(n("prerelease compare",u,p,h),p===void 0&&h===void 0)return 0;if(h===void 0)return 1;if(p===void 0)return-1;if(p===h)continue;return s(p,h)}while(++u)}compareBuild(c){c instanceof l||(c=new l(c,this.options));let u=0;do{const p=this.build[u],h=c.build[u];if(n("build compare",u,p,h),p===void 0&&h===void 0)return 0;if(h===void 0)return 1;if(p===void 0)return-1;if(p===h)continue;return s(p,h)}while(++u)}inc(c,u,p){if(c.startsWith("pre")){if(!u&&p===!1)throw new Error("invalid increment argument: identifier is empty");if(u){const h=`-${u}`.match(this.options.loose?r[i.PRERELEASELOOSE]:r[i.PRERELEASE]);if(!h||h[1]!==u)throw new Error(`invalid identifier: ${u}`)}}switch(c){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",u,p);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",u,p);break;case"prepatch":this.prerelease.length=0,this.inc("patch",u,p),this.inc("pre",u,p);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",u,p),this.inc("pre",u,p);break;case"release":if(this.prerelease.length===0)throw new Error(`version ${this.raw} is not a prerelease`);this.prerelease.length=0;break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{const h=Number(p)?1:0;if(this.prerelease.length===0)this.prerelease=[h];else{let g=this.prerelease.length;for(;--g>=0;)typeof this.prerelease[g]=="number"&&(this.prerelease[g]++,g=-2);if(g===-1){if(u===this.prerelease.join(".")&&p===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(h)}}if(u){let g=[u,h];p===!1&&(g=[u]),s(this.prerelease[0],u)===0?isNaN(this.prerelease[1])&&(this.prerelease=g):this.prerelease=g}break}default:throw new Error(`invalid increment argument: ${c}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}}return kc=l,kc}var Uc,Pp;function ao(){if(Pp)return Uc;Pp=1;const n=Wt();return Uc=(t,r,i=!1)=>{if(t instanceof n)return t;try{return new n(t,r)}catch(o){if(!i)return null;throw o}},Uc}var Bc,Ap;function yb(){if(Ap)return Bc;Ap=1;const n=ao();return Bc=(t,r)=>{const i=n(t,r);return i?i.version:null},Bc}var Vc,Mp;function wb(){if(Mp)return Vc;Mp=1;const n=ao();return Vc=(t,r)=>{const i=n(t.trim().replace(/^[=v]+/,""),r);return i?i.version:null},Vc}var Hc,Np;function Gb(){if(Np)return Hc;Np=1;const n=Wt();return Hc=(t,r,i,o,s)=>{typeof i=="string"&&(s=o,o=i,i=void 0);try{return new n(t instanceof n?t.version:t,i).inc(r,o,s).version}catch{return null}},Hc}var Xc,xp;function Lb(){if(xp)return Xc;xp=1;const n=ao();return Xc=(t,r)=>{const i=n(t,null,!0),o=n(r,null,!0),s=i.compare(o);if(s===0)return null;const l=s>0,a=l?i:o,c=l?o:i,u=!!a.prerelease.length;if(!!c.prerelease.length&&!u){if(!c.patch&&!c.minor)return"major";if(c.compareMain(a)===0)return c.minor&&!c.patch?"minor":"patch"}const h=u?"pre":"";return i.major!==o.major?h+"major":i.minor!==o.minor?h+"minor":i.patch!==o.patch?h+"patch":"prerelease"},Xc}var Yc,yp;function $b(){if(yp)return Yc;yp=1;const n=Wt();return Yc=(t,r)=>new n(t,r).major,Yc}var zc,wp;function Db(){if(wp)return zc;wp=1;const n=Wt();return zc=(t,r)=>new n(t,r).minor,zc}var Wc,Gp;function kb(){if(Gp)return Wc;Gp=1;const n=Wt();return Wc=(t,r)=>new n(t,r).patch,Wc}var jc,Lp;function Ub(){if(Lp)return jc;Lp=1;const n=ao();return jc=(t,r)=>{const i=n(t,r);return i&&i.prerelease.length?i.prerelease:null},jc}var qc,$p;function Bn(){if($p)return qc;$p=1;const n=Wt();return qc=(t,r,i)=>new n(t,i).compare(new n(r,i)),qc}var Kc,Dp;function Bb(){if(Dp)return Kc;Dp=1;const n=Bn();return Kc=(t,r,i)=>n(r,t,i),Kc}var Qc,kp;function Vb(){if(kp)return Qc;kp=1;const n=Bn();return Qc=(t,r)=>n(t,r,!0),Qc}var Zc,Up;function xd(){if(Up)return Zc;Up=1;const n=Wt();return Zc=(t,r,i)=>{const o=new n(t,i),s=new n(r,i);return o.compare(s)||o.compareBuild(s)},Zc}var Jc,Bp;function Hb(){if(Bp)return Jc;Bp=1;const n=xd();return Jc=(t,r)=>t.sort((i,o)=>n(i,o,r)),Jc}var eu,Vp;function Xb(){if(Vp)return eu;Vp=1;const n=xd();return eu=(t,r)=>t.sort((i,o)=>n(o,i,r)),eu}var tu,Hp;function Ja(){if(Hp)return tu;Hp=1;const n=Bn();return tu=(t,r,i)=>n(t,r,i)>0,tu}var nu,Xp;function yd(){if(Xp)return nu;Xp=1;const n=Bn();return nu=(t,r,i)=>n(t,r,i)<0,nu}var ru,Yp;function Vg(){if(Yp)return ru;Yp=1;const n=Bn();return ru=(t,r,i)=>n(t,r,i)===0,ru}var iu,zp;function Hg(){if(zp)return iu;zp=1;const n=Bn();return iu=(t,r,i)=>n(t,r,i)!==0,iu}var ou,Wp;function wd(){if(Wp)return ou;Wp=1;const n=Bn();return ou=(t,r,i)=>n(t,r,i)>=0,ou}var su,jp;function Gd(){if(jp)return su;jp=1;const n=Bn();return su=(t,r,i)=>n(t,r,i)<=0,su}var au,qp;function Xg(){if(qp)return au;qp=1;const n=Vg(),e=Hg(),t=Ja(),r=wd(),i=yd(),o=Gd();return au=(l,a,c,u)=>{switch(a){case"===":return typeof l=="object"&&(l=l.version),typeof c=="object"&&(c=c.version),l===c;case"!==":return typeof l=="object"&&(l=l.version),typeof c=="object"&&(c=c.version),l!==c;case"":case"=":case"==":return n(l,c,u);case"!=":return e(l,c,u);case">":return t(l,c,u);case">=":return r(l,c,u);case"<":return i(l,c,u);case"<=":return o(l,c,u);default:throw new TypeError(`Invalid operator: ${a}`)}},au}var lu,Kp;function Yb(){if(Kp)return lu;Kp=1;const n=Wt(),e=ao(),{safeRe:t,t:r}=ss();return lu=(o,s)=>{if(o instanceof n)return o;if(typeof o=="number"&&(o=String(o)),typeof o!="string")return null;s=s||{};let l=null;if(!s.rtl)l=o.match(s.includePrerelease?t[r.COERCEFULL]:t[r.COERCE]);else{const g=s.includePrerelease?t[r.COERCERTLFULL]:t[r.COERCERTL];let f;for(;(f=g.exec(o))&&(!l||l.index+l[0].length!==o.length);)(!l||f.index+f[0].length!==l.index+l[0].length)&&(l=f),g.lastIndex=f.index+f[1].length+f[2].length;g.lastIndex=-1}if(l===null)return null;const a=l[2],c=l[3]||"0",u=l[4]||"0",p=s.includePrerelease&&l[5]?`-${l[5]}`:"",h=s.includePrerelease&&l[6]?`+${l[6]}`:"";return e(`${a}.${c}.${u}${p}${h}`,s)},lu}var cu,Qp;function zb(){if(Qp)return cu;Qp=1;class n{constructor(){this.max=1e3,this.map=new Map}get(t){const r=this.map.get(t);if(r!==void 0)return this.map.delete(t),this.map.set(t,r),r}delete(t){return this.map.delete(t)}set(t,r){if(!this.delete(t)&&r!==void 0){if(this.map.size>=this.max){const o=this.map.keys().next().value;this.delete(o)}this.map.set(t,r)}return this}}return cu=n,cu}var uu,Zp;function Vn(){if(Zp)return uu;Zp=1;const n=/\s+/g;class e{constructor(w,x){if(x=i(x),w instanceof e)return w.loose===!!x.loose&&w.includePrerelease===!!x.includePrerelease?w:new e(w.raw,x);if(w instanceof o)return this.raw=w.value,this.set=[[w]],this.formatted=void 0,this;if(this.options=x,this.loose=!!x.loose,this.includePrerelease=!!x.includePrerelease,this.raw=w.trim().replace(n," "),this.set=this.raw.split("||").map(k=>this.parseRange(k.trim())).filter(k=>k.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){const k=this.set[0];if(this.set=this.set.filter(O=>!d(O[0])),this.set.length===0)this.set=[k];else if(this.set.length>1){for(const O of this.set)if(O.length===1&&_(O[0])){this.set=[O];break}}}this.formatted=void 0}get range(){if(this.formatted===void 0){this.formatted="";for(let w=0;w<this.set.length;w++){w>0&&(this.formatted+="||");const x=this.set[w];for(let k=0;k<x.length;k++)k>0&&(this.formatted+=" "),this.formatted+=x[k].toString().trim()}}return this.formatted}format(){return this.range}toString(){return this.range}parseRange(w){const k=((this.options.includePrerelease&&g)|(this.options.loose&&f))+":"+w,O=r.get(k);if(O)return O;const D=this.options.loose,Y=D?a[c.HYPHENRANGELOOSE]:a[c.HYPHENRANGE];w=w.replace(Y,U(this.options.includePrerelease)),s("hyphen replace",w),w=w.replace(a[c.COMPARATORTRIM],u),s("comparator trim",w),w=w.replace(a[c.TILDETRIM],p),s("tilde trim",w),w=w.replace(a[c.CARETTRIM],h),s("caret trim",w);let z=w.split(" ").map(J=>C(J,this.options)).join(" ").split(/\s+/).map(J=>G(J,this.options));D&&(z=z.filter(J=>(s("loose invalid filter",J,this.options),!!J.match(a[c.COMPARATORLOOSE])))),s("range list",z);const ee=new Map,re=z.map(J=>new o(J,this.options));for(const J of re){if(d(J))return[J];ee.set(J.value,J)}ee.size>1&&ee.has("")&&ee.delete("");const le=[...ee.values()];return r.set(k,le),le}intersects(w,x){if(!(w instanceof e))throw new TypeError("a Range is required");return this.set.some(k=>m(k,x)&&w.set.some(O=>m(O,x)&&k.every(D=>O.every(Y=>D.intersects(Y,x)))))}test(w){if(!w)return!1;if(typeof w=="string")try{w=new l(w,this.options)}catch{return!1}for(let x=0;x<this.set.length;x++)if(M(this.set[x],w,this.options))return!0;return!1}}uu=e;const t=zb(),r=new t,i=Nd(),o=el(),s=Za(),l=Wt(),{safeRe:a,t:c,comparatorTrimReplace:u,tildeTrimReplace:p,caretTrimReplace:h}=ss(),{FLAG_INCLUDE_PRERELEASE:g,FLAG_LOOSE:f}=Qa(),d=N=>N.value==="<0.0.0-0",_=N=>N.value==="",m=(N,w)=>{let x=!0;const k=N.slice();let O=k.pop();for(;x&&k.length;)x=k.every(D=>O.intersects(D,w)),O=k.pop();return x},C=(N,w)=>(s("comp",N,w),N=I(N,w),s("caret",N),N=S(N,w),s("tildes",N),N=P(N,w),s("xrange",N),N=L(N,w),s("stars",N),N),R=N=>!N||N.toLowerCase()==="x"||N==="*",S=(N,w)=>N.trim().split(/\s+/).map(x=>F(x,w)).join(" "),F=(N,w)=>{const x=w.loose?a[c.TILDELOOSE]:a[c.TILDE];return N.replace(x,(k,O,D,Y,z)=>{s("tilde",N,k,O,D,Y,z);let ee;return R(O)?ee="":R(D)?ee=`>=${O}.0.0 <${+O+1}.0.0-0`:R(Y)?ee=`>=${O}.${D}.0 <${O}.${+D+1}.0-0`:z?(s("replaceTilde pr",z),ee=`>=${O}.${D}.${Y}-${z} <${O}.${+D+1}.0-0`):ee=`>=${O}.${D}.${Y} <${O}.${+D+1}.0-0`,s("tilde return",ee),ee})},I=(N,w)=>N.trim().split(/\s+/).map(x=>T(x,w)).join(" "),T=(N,w)=>{s("caret",N,w);const x=w.loose?a[c.CARETLOOSE]:a[c.CARET],k=w.includePrerelease?"-0":"";return N.replace(x,(O,D,Y,z,ee)=>{s("caret",N,O,D,Y,z,ee);let re;return R(D)?re="":R(Y)?re=`>=${D}.0.0${k} <${+D+1}.0.0-0`:R(z)?D==="0"?re=`>=${D}.${Y}.0${k} <${D}.${+Y+1}.0-0`:re=`>=${D}.${Y}.0${k} <${+D+1}.0.0-0`:ee?(s("replaceCaret pr",ee),D==="0"?Y==="0"?re=`>=${D}.${Y}.${z}-${ee} <${D}.${Y}.${+z+1}-0`:re=`>=${D}.${Y}.${z}-${ee} <${D}.${+Y+1}.0-0`:re=`>=${D}.${Y}.${z}-${ee} <${+D+1}.0.0-0`):(s("no pr"),D==="0"?Y==="0"?re=`>=${D}.${Y}.${z}${k} <${D}.${Y}.${+z+1}-0`:re=`>=${D}.${Y}.${z}${k} <${D}.${+Y+1}.0-0`:re=`>=${D}.${Y}.${z} <${+D+1}.0.0-0`),s("caret return",re),re})},P=(N,w)=>(s("replaceXRanges",N,w),N.split(/\s+/).map(x=>y(x,w)).join(" ")),y=(N,w)=>{N=N.trim();const x=w.loose?a[c.XRANGELOOSE]:a[c.XRANGE];return N.replace(x,(k,O,D,Y,z,ee)=>{s("xRange",N,k,O,D,Y,z,ee);const re=R(D),le=re||R(Y),J=le||R(z),oe=J;return O==="="&&oe&&(O=""),ee=w.includePrerelease?"-0":"",re?O===">"||O==="<"?k="<0.0.0-0":k="*":O&&oe?(le&&(Y=0),z=0,O===">"?(O=">=",le?(D=+D+1,Y=0,z=0):(Y=+Y+1,z=0)):O==="<="&&(O="<",le?D=+D+1:Y=+Y+1),O==="<"&&(ee="-0"),k=`${O+D}.${Y}.${z}${ee}`):le?k=`>=${D}.0.0${ee} <${+D+1}.0.0-0`:J&&(k=`>=${D}.${Y}.0${ee} <${D}.${+Y+1}.0-0`),s("xRange return",k),k})},L=(N,w)=>(s("replaceStars",N,w),N.trim().replace(a[c.STAR],"")),G=(N,w)=>(s("replaceGTE0",N,w),N.trim().replace(a[w.includePrerelease?c.GTE0PRE:c.GTE0],"")),U=N=>(w,x,k,O,D,Y,z,ee,re,le,J,oe)=>(R(k)?x="":R(O)?x=`>=${k}.0.0${N?"-0":""}`:R(D)?x=`>=${k}.${O}.0${N?"-0":""}`:Y?x=`>=${x}`:x=`>=${x}${N?"-0":""}`,R(re)?ee="":R(le)?ee=`<${+re+1}.0.0-0`:R(J)?ee=`<${re}.${+le+1}.0-0`:oe?ee=`<=${re}.${le}.${J}-${oe}`:N?ee=`<${re}.${le}.${+J+1}-0`:ee=`<=${ee}`,`${x} ${ee}`.trim()),M=(N,w,x)=>{for(let k=0;k<N.length;k++)if(!N[k].test(w))return!1;if(w.prerelease.length&&!x.includePrerelease){for(let k=0;k<N.length;k++)if(s(N[k].semver),N[k].semver!==o.ANY&&N[k].semver.prerelease.length>0){const O=N[k].semver;if(O.major===w.major&&O.minor===w.minor&&O.patch===w.patch)return!0}return!1}return!0};return uu}var du,Jp;function el(){if(Jp)return du;Jp=1;const n=Symbol("SemVer ANY");class e{static get ANY(){return n}constructor(u,p){if(p=t(p),u instanceof e){if(u.loose===!!p.loose)return u;u=u.value}u=u.trim().split(/\s+/).join(" "),s("comparator",u,p),this.options=p,this.loose=!!p.loose,this.parse(u),this.semver===n?this.value="":this.value=this.operator+this.semver.version,s("comp",this)}parse(u){const p=this.options.loose?r[i.COMPARATORLOOSE]:r[i.COMPARATOR],h=u.match(p);if(!h)throw new TypeError(`Invalid comparator: ${u}`);this.operator=h[1]!==void 0?h[1]:"",this.operator==="="&&(this.operator=""),h[2]?this.semver=new l(h[2],this.options.loose):this.semver=n}toString(){return this.value}test(u){if(s("Comparator.test",u,this.options.loose),this.semver===n||u===n)return!0;if(typeof u=="string")try{u=new l(u,this.options)}catch{return!1}return o(u,this.operator,this.semver,this.options)}intersects(u,p){if(!(u instanceof e))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?!0:new a(u.value,p).test(this.value):u.operator===""?u.value===""?!0:new a(this.value,p).test(u.semver):(p=t(p),p.includePrerelease&&(this.value==="<0.0.0-0"||u.value==="<0.0.0-0")||!p.includePrerelease&&(this.value.startsWith("<0.0.0")||u.value.startsWith("<0.0.0"))?!1:!!(this.operator.startsWith(">")&&u.operator.startsWith(">")||this.operator.startsWith("<")&&u.operator.startsWith("<")||this.semver.version===u.semver.version&&this.operator.includes("=")&&u.operator.includes("=")||o(this.semver,"<",u.semver,p)&&this.operator.startsWith(">")&&u.operator.startsWith("<")||o(this.semver,">",u.semver,p)&&this.operator.startsWith("<")&&u.operator.startsWith(">")))}}du=e;const t=Nd(),{safeRe:r,t:i}=ss(),o=Xg(),s=Za(),l=Wt(),a=Vn();return du}var fu,eh;function tl(){if(eh)return fu;eh=1;const n=Vn();return fu=(t,r,i)=>{try{r=new n(r,i)}catch{return!1}return r.test(t)},fu}var _u,th;function Wb(){if(th)return _u;th=1;const n=Vn();return _u=(t,r)=>new n(t,r).set.map(i=>i.map(o=>o.value).join(" ").trim().split(" ")),_u}var pu,nh;function jb(){if(nh)return pu;nh=1;const n=Wt(),e=Vn();return pu=(r,i,o)=>{let s=null,l=null,a=null;try{a=new e(i,o)}catch{return null}return r.forEach(c=>{a.test(c)&&(!s||l.compare(c)===-1)&&(s=c,l=new n(s,o))}),s},pu}var hu,rh;function qb(){if(rh)return hu;rh=1;const n=Wt(),e=Vn();return hu=(r,i,o)=>{let s=null,l=null,a=null;try{a=new e(i,o)}catch{return null}return r.forEach(c=>{a.test(c)&&(!s||l.compare(c)===1)&&(s=c,l=new n(s,o))}),s},hu}var gu,ih;function Kb(){if(ih)return gu;ih=1;const n=Wt(),e=Vn(),t=Ja();return gu=(i,o)=>{i=new e(i,o);let s=new n("0.0.0");if(i.test(s)||(s=new n("0.0.0-0"),i.test(s)))return s;s=null;for(let l=0;l<i.set.length;++l){const a=i.set[l];let c=null;a.forEach(u=>{const p=new n(u.semver.version);switch(u.operator){case">":p.prerelease.length===0?p.patch++:p.prerelease.push(0),p.raw=p.format();case"":case">=":(!c||t(p,c))&&(c=p);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${u.operator}`)}}),c&&(!s||t(s,c))&&(s=c)}return s&&i.test(s)?s:null},gu}var mu,oh;function Qb(){if(oh)return mu;oh=1;const n=Vn();return mu=(t,r)=>{try{return new n(t,r).range||"*"}catch{return null}},mu}var Cu,sh;function Ld(){if(sh)return Cu;sh=1;const n=Wt(),e=el(),{ANY:t}=e,r=Vn(),i=tl(),o=Ja(),s=yd(),l=Gd(),a=wd();return Cu=(u,p,h,g)=>{u=new n(u,g),p=new r(p,g);let f,d,_,m,C;switch(h){case">":f=o,d=l,_=s,m=">",C=">=";break;case"<":f=s,d=a,_=o,m="<",C="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(i(u,p,g))return!1;for(let R=0;R<p.set.length;++R){const S=p.set[R];let F=null,I=null;if(S.forEach(T=>{T.semver===t&&(T=new e(">=0.0.0")),F=F||T,I=I||T,f(T.semver,F.semver,g)?F=T:_(T.semver,I.semver,g)&&(I=T)}),F.operator===m||F.operator===C||(!I.operator||I.operator===m)&&d(u,I.semver))return!1;if(I.operator===C&&_(u,I.semver))return!1}return!0},Cu}var vu,ah;function Zb(){if(ah)return vu;ah=1;const n=Ld();return vu=(t,r,i)=>n(t,r,">",i),vu}var Eu,lh;function Jb(){if(lh)return Eu;lh=1;const n=Ld();return Eu=(t,r,i)=>n(t,r,"<",i),Eu}var Su,ch;function eT(){if(ch)return Su;ch=1;const n=Vn();return Su=(t,r,i)=>(t=new n(t,i),r=new n(r,i),t.intersects(r,i)),Su}var Ru,uh;function tT(){if(uh)return Ru;uh=1;const n=tl(),e=Bn();return Ru=(t,r,i)=>{const o=[];let s=null,l=null;const a=t.sort((h,g)=>e(h,g,i));for(const h of a)n(h,r,i)?(l=h,s||(s=h)):(l&&o.push([s,l]),l=null,s=null);s&&o.push([s,null]);const c=[];for(const[h,g]of o)h===g?c.push(h):!g&&h===a[0]?c.push("*"):g?h===a[0]?c.push(`<=${g}`):c.push(`${h} - ${g}`):c.push(`>=${h}`);const u=c.join(" || "),p=typeof r.raw=="string"?r.raw:String(r);return u.length<p.length?u:r},Ru}var Fu,dh;function nT(){if(dh)return Fu;dh=1;const n=Vn(),e=el(),{ANY:t}=e,r=tl(),i=Bn(),o=(p,h,g={})=>{if(p===h)return!0;p=new n(p,g),h=new n(h,g);let f=!1;e:for(const d of p.set){for(const _ of h.set){const m=a(d,_,g);if(f=f||m!==null,m)continue e}if(f)return!1}return!0},s=[new e(">=0.0.0-0")],l=[new e(">=0.0.0")],a=(p,h,g)=>{if(p===h)return!0;if(p.length===1&&p[0].semver===t){if(h.length===1&&h[0].semver===t)return!0;g.includePrerelease?p=s:p=l}if(h.length===1&&h[0].semver===t){if(g.includePrerelease)return!0;h=l}const f=new Set;let d,_;for(const P of p)P.operator===">"||P.operator===">="?d=c(d,P,g):P.operator==="<"||P.operator==="<="?_=u(_,P,g):f.add(P.semver);if(f.size>1)return null;let m;if(d&&_){if(m=i(d.semver,_.semver,g),m>0)return null;if(m===0&&(d.operator!==">="||_.operator!=="<="))return null}for(const P of f){if(d&&!r(P,String(d),g)||_&&!r(P,String(_),g))return null;for(const y of h)if(!r(P,String(y),g))return!1;return!0}let C,R,S,F,I=_&&!g.includePrerelease&&_.semver.prerelease.length?_.semver:!1,T=d&&!g.includePrerelease&&d.semver.prerelease.length?d.semver:!1;I&&I.prerelease.length===1&&_.operator==="<"&&I.prerelease[0]===0&&(I=!1);for(const P of h){if(F=F||P.operator===">"||P.operator===">=",S=S||P.operator==="<"||P.operator==="<=",d){if(T&&P.semver.prerelease&&P.semver.prerelease.length&&P.semver.major===T.major&&P.semver.minor===T.minor&&P.semver.patch===T.patch&&(T=!1),P.operator===">"||P.operator===">="){if(C=c(d,P,g),C===P&&C!==d)return!1}else if(d.operator===">="&&!r(d.semver,String(P),g))return!1}if(_){if(I&&P.semver.prerelease&&P.semver.prerelease.length&&P.semver.major===I.major&&P.semver.minor===I.minor&&P.semver.patch===I.patch&&(I=!1),P.operator==="<"||P.operator==="<="){if(R=u(_,P,g),R===P&&R!==_)return!1}else if(_.operator==="<="&&!r(_.semver,String(P),g))return!1}if(!P.operator&&(_||d)&&m!==0)return!1}return!(d&&S&&!_&&m!==0||_&&F&&!d&&m!==0||T||I)},c=(p,h,g)=>{if(!p)return h;const f=i(p.semver,h.semver,g);return f>0?p:f<0||h.operator===">"&&p.operator===">="?h:p},u=(p,h,g)=>{if(!p)return h;const f=i(p.semver,h.semver,g);return f<0?p:f>0||h.operator==="<"&&p.operator==="<="?h:p};return Fu=o,Fu}var Iu,fh;function rT(){if(fh)return Iu;fh=1;const n=ss(),e=Qa(),t=Wt(),r=Bg(),i=ao(),o=yb(),s=wb(),l=Gb(),a=Lb(),c=$b(),u=Db(),p=kb(),h=Ub(),g=Bn(),f=Bb(),d=Vb(),_=xd(),m=Hb(),C=Xb(),R=Ja(),S=yd(),F=Vg(),I=Hg(),T=wd(),P=Gd(),y=Xg(),L=Yb(),G=el(),U=Vn(),M=tl(),N=Wb(),w=jb(),x=qb(),k=Kb(),O=Qb(),D=Ld(),Y=Zb(),z=Jb(),ee=eT(),re=tT(),le=nT();return Iu={parse:i,valid:o,clean:s,inc:l,diff:a,major:c,minor:u,patch:p,prerelease:h,compare:g,rcompare:f,compareLoose:d,compareBuild:_,sort:m,rsort:C,gt:R,lt:S,eq:F,neq:I,gte:T,lte:P,cmp:y,coerce:L,Comparator:G,Range:U,satisfies:M,toComparators:N,maxSatisfying:w,minSatisfying:x,minVersion:k,validRange:O,outside:D,gtr:Y,ltr:z,intersects:ee,simplifyRange:re,subset:le,SemVer:t,re:n.re,src:n.src,tokens:n.t,SEMVER_SPEC_VERSION:e.SEMVER_SPEC_VERSION,RELEASE_TYPES:e.RELEASE_TYPES,compareIdentifiers:r.compareIdentifiers,rcompareIdentifiers:r.rcompareIdentifiers},Iu}var iT=rT();const _e=ng(iT),wt={configEnabled:!1,builder:{state:"reset",numFails:0}};wt.isEnabled=function(){return this.isBuilding()||this.configEnabled&&FC.CONFIG.flightControllerIdentifier==="RTFL"&&this.builder.state!=="fail"};wt.isBuilding=function(){return this.builder.state!=="reset"&&this.builder.state!=="done"&&this.builder.state!=="fail"};wt.isOpen=function(){return $(".cli-textcomplete-dropdown").is(":visible")};wt.openLater=function(n){const e=this;setTimeout(function(){e.forceOpen=!!n,e.$textarea.textcomplete("trigger"),e.forceOpen=!1},0)};wt.setEnabled=function(n){n=!1,this.configEnabled!==n&&(this.configEnabled=n,CONFIGURATOR.cliEngineActive&&CONFIGURATOR.cliEngineValid&&(this.isEnabled()?this.builderStart():!this.isEnabled()&&!this.isBuilding()&&this.cleanup()))};wt.initialize=function(n,e,t){this.$textarea=n,this.forceOpen=!1,this.sendLine=e,this.writeToOutput=t,this.cleanup()};wt.cleanup=function(){this.$textarea.textcomplete("destroy"),this.builder.state="reset",this.builder.numFails=0};wt._builderWatchdogTouch=function(){const n=this;this._builderWatchdogStop(),GUI.timeout_add("autocomplete_builder_watchdog",function(){n.builder.numFails?(n.builder.numFails++,n.builder.state="fail",n.writeToOutput("Failed!<br># "),$(n).trigger("build:stop")):(n.builder.state="reset",n.builderStart())},3e3)};wt._builderWatchdogStop=function(){GUI.timeout_remove("autocomplete_builder_watchdog")};wt.builderStart=function(){this.builder.state==="reset"&&(this.cache={commands:[],resources:[],resourcesCount:{},settings:[],settingsAcceptedValues:{},feature:[],beeper:["ALL"],mixers:[]},this.builder.commandSequence=["help","dump","get","mixer list"],this.builder.currentSetting=null,this.builder.sentinel="# "+Math.random(),this.builder.state="init",this.writeToOutput("<br># Building AutoComplete Cache ... "),this.sendLine(this.builder.sentinel),$(this).trigger("build:start"))};wt.builderParseLine=function(n){const e=this.cache,t=this.builder;if(this._builderWatchdogTouch(),n.indexOf(t.sentinel)!==-1){const r=t.commandSequence.shift();r&&this.configEnabled?(t.state="parse-"+r,this.sendLine(r),this.sendLine(t.sentinel)):(this._builderWatchdogStop(),this.configEnabled?(e.settings.sort(),e.commands.sort(),e.feature.sort(),e.beeper.sort(),e.resources=Object.keys(e.resourcesCount).sort(),this._initTextcomplete(),this.writeToOutput("Done!<br># "),t.state="done"):(this.writeToOutput("Cancelled!<br># "),this.cleanup()),$(this).trigger("build:stop"))}else switch(t.state){case"parse-help":{const r=n.match(/^(\w+)/);r&&e.commands.push(r[1]);break}case"parse-dump":{const r=n.match(/^resource\s+(\w+)/i);if(r){const i=r[1].toUpperCase();e.resourcesCount[i]=(e.resourcesCount[i]||0)+1}else{const i=n.match(/^(feature|beeper)\s+-?(\w+)/i);i&&e[i[1].toLowerCase()].push(i[2])}break}case"parse-get":{const r=n.match(/^(\w+)\s*=/);if(r)e.settings.push(r[1]),t.currentSetting=r[1].toLowerCase();else{const i=n.match(/^(.*): (.*)/);i!==null&&t.currentSetting&&(i[1].match(/values/i)?e.settingsAcceptedValues[t.currentSetting]=i[2].split(/\s*,\s*/).sort():i[1].match(/range|length/i)&&(e.settingsAcceptedValues[t.currentSetting]=i[0]))}break}case"parse-mixer list":{const r=n.match(/:(.+)/);r&&(e.mixers=["list"].concat(r[1].trim().split(/\s+/)));break}}};wt._initTextcomplete=function(){let n=!1;const e=this,t=this.$textarea,r=e.cache;let i=null;const o=function(f){return function(d,_){const m=f?"":"^",C=d.replace(new RegExp(`${m}(${_})`,"gi"),"<b>$1</b>");return _?C:d}},s=o(!0),l=o(!1),a=function(f,d,_,m,C){const R=[];if(m!==!1&&f.length>=m||e.forceOpen||e.isOpen()){f=f.toLowerCase();for(let S=0;S<_.length;S++){const F=_[S].toLowerCase();(C&&F.startsWith(f)||!C&&F.indexOf(f)!==-1)&&R.push(_[S])}}d(R),e.forceOpen&&R.length===1&&t.trigger($.Event("keydown",{keyCode:9}))},c=function(f){const d=t.val();return!!(d.length===f.length||d[f.length].match(/\s/))},u=function(f){return`$1${f} `};t.textcomplete([],{maxCount:1e4,debounce:0,className:"cli-textcomplete-dropdown",placement:"top",onKeydown:function(f){f.which===13&&setTimeout(function(){n&&t.trigger($.Event("keypress",{which:13}))},0)}}).on("textComplete:show",function(){i||(i=$._data($(".textcomplete-dropdown")[0],"events").mouseover[0].handler),$(".textcomplete-dropdown").off("mouseover").off("mousemove").on("mousemove",".textcomplete-item",function(f){$(this).parent().off("mousemove").on("mouseover",".textcomplete-item",i),i(f)})});const p=function(f){return $.extend({template:s,replace:u,context:c,index:2},f)};t.textcomplete("register",[p({match:/^(\s*)(\w*)$/,search:function(f,d){n=!1,a(f,d,r.commands,!1,!0)},template:l}),p({match:/^(\s*get\s+)(\w*)$/i,search:function(f,d){n=!0,a(f,function(_){f.length>0&&_.length>1&&(_=[f].concat(_)),d(_)},r.settings,3)}}),p({match:/^(\s*set\s+)(\w*)$/i,search:function(f,d){n=!1,a(f,d,r.settings,3)}}),p({match:/^(\s*set\s+\w*\s*)$/i,search:function(f,d){n=!1,a("",d,["="],!1)},replace:function(f){return e.openLater(),u(f)}}),p({match:/^(\s*set\s+(\w+))\s*=\s*(.*)$/i,search:function(f,d,_){const m=[],C=_[2].toLowerCase();if(this.isSettingValueArray=!1,this.value=_[3],n=!!f,C in r.settingsAcceptedValues){const R=r.settingsAcceptedValues[C];if(Array.isArray(R)){this.isSettingValueArray=!0,n=!0,a(f,d,R,0);return}m.push(R)}d(m)},replace:function(f){return this.isSettingValueArray||(f=this.value),"$1 = "+f},index:3,isSettingValueArray:!1}),p({match:/^(\s*resource\s+)(\w*)$/i,search:function(f,d){n=!1;let _=r.resources;_e.gte(FC.CONFIG.flightControllerVersion,"4.0.0")?_=["show"].concat(_):_=["list"].concat(_),a(f,d,_,1)},replace:function(f){return f in r.resourcesCount?e.openLater():(f==="list"||f==="show")&&(n=!0),u(f)}}),p({match:/^(\s*resource\s+(\w+)\s+)(\d*)$/i,search:function(f,d,_){n=!1,this.savedTerm=f,d([`&lt;1-${r.resourcesCount[_[2].toUpperCase()]}&gt;`])},replace:function(){if(this.savedTerm)return e.openLater(),"$1$3 "},context:function(f){const d=f.match(/^\s*resource\s+(\w+)\s/i);return d&&(r.resourcesCount[d[1].toUpperCase()]||0)>1?c(f):!1},index:3,savedTerm:null}),p({match:/^(\s*resource\s+\w+\s+(\d*\s+)?)(\w*)$/i,search:function(f,d){n=!!f,f?"none".startsWith(f)?d(["none"]):d(["&lt;pin&gt;"]):d(["&lt;pin&gt","none"])},template:function(f,d){return f==="none"?l(f,d):f},replace:function(f){if(f==="none")return n=!0,"$1none "},context:function(f){const d=f.match(/^\s*resource\s+(\w+)\s+(\d+\s)?/i);if(d){const _=r.resourcesCount[d[1].toUpperCase()]||0;if(_&&(d[2]||_===1))return c(f)}return!1},index:3}),p({match:/^(\s*(feature|beeper)\s+(-?))(\w*)$/i,search:function(f,d,_){n=!!f;let m=r[_[2].toLowerCase()];_[3]||(m=["-","list"].concat(m)),a(f,d,m,1)},replace:function(f){return f==="-"?(e.openLater(!0),"$1-"):u(f)},index:4}),p({match:/^(\s*mixer\s+)(\w*)$/i,search:function(f,d){n=!0,a(f,d,r.mixers,1)}})]),_e.gte(FC.CONFIG.flightControllerVersion,"4.0.0")&&t.textcomplete("register",[p({match:/^(\s*resource\s+show\s+)(\w*)$/i,search:function(f,d){n=!0,a(f,d,["all"],1,!0)},template:l})]);const h=["master","profile","rates","all"],g=[];_e.lt(FC.CONFIG.flightControllerVersion,"3.4.0")?g.push("showdefaults"):(g.push("defaults"),_e.gte(FC.CONFIG.flightControllerVersion,"4.0.0")&&(h.push("hardware"),g.push("bare"))),h.sort(),g.sort(),t.textcomplete("register",[p({match:/^(\s*diff\s+)(\w*)$/i,search:function(f,d){n=!0,a(f,d,h,1,!0)},template:l}),p({match:/^(\s*diff\s+\w+\s+)(\w*)$/i,search:function(f,d){n=!0,a(f,d,g,1,!0)},template:l})])};const Yg=function(){},oT=134227968,_h=16384;function zg(n,e){let t=0;for(;t<n.data.length&&e>=n.data[t].address+n.data[t].bytes;t++);const r={lineIndex:t};return n.data[t]&&e>=n.data[t].address&&(r.byteIndex=e-n.data[t].address),r}function ph(n,e){let t=0;for(let r=0;r<4;r++)t+=n.data[e.lineIndex].data[e.byteIndex++]<<8*r,e.byteIndex>=n.data[e.lineIndex].bytes&&(e.lineIndex++,e.byteIndex=0);return t}function sT(n){const e={},t=zg(n,oT);if(t.byteIndex!==void 0)return e.startAddress=ph(n,t),e.endAddress=ph(n,t),e}function aT(n,e,t){let r=t;const i=zg(n,r);if(i.byteIndex!==void 0)throw new Error("Configuration area in firmware not free.");e=e+"\0";let o=0;for(;o<e.length;){const s=e.length-o,l={address:r,bytes:_h>s?s:_h,data:[]};if(n.data[i.lineIndex]&&l.address+l.bytes>n.data[i.lineIndex].address)throw new Error("Aborting data generation, free area too small.");for(let a=0;a<l.bytes;a++)l.data.push(e.charCodeAt(o++));r=r+l.bytes,n.data.splice(i.lineIndex++,0,l)}n.bytes_total+=e.length}const hh="Custom defaults inserted in";Yg.prototype.insertConfig=function(n,e){console.time(hh);const t=sT(n);if(!t||t.endAddress-t.startAddress===0)return!1;if(e.length>=t.endAddress-t.startAddress)throw new Error(`Custom defaults area too small (${t.endAddress-t.startAddress} bytes), ${e.length+1} bytes needed.`);return aT(n,e,t.startAddress),console.timeEnd(hh),!0};let $d=class Li{static FLAGS={RX_PPM:0,RX_SERIAL:3,SOFTSERIAL:6,GPS:7,SONAR:9,TELEMETRY:10,RX_PARALLEL_PWM:13,RX_MSP:14,RSSI_ADC:15,LED_STRIP:16,DISPLAY:17,OSD:18,CMS:19,RX_SPI:25,GOVERNOR:26,ESC_SENSOR:27,FREQ_SENSOR:28,DYN_NOTCH:29,RPM_FILTER:30};static GROUPS={RX_PROTO:["RX_PPM","RX_SERIAL","RX_PARALLEL_PWM","RX_MSP","RX_SPI"],OTHER:["GPS","LED_STRIP","CMS"],RSSI:["RSSI_ADC"]};#e=pe(0);get bitfield(){return b(this.#e)}set bitfield(e){ce(this.#e,e,!0)}constructor(){for(const e of Object.keys(Li.FLAGS))Object.defineProperty(this,e,{get(){return this.isEnabled(e)},set(t){this.setFeature(e,t)}})}isEnabled(e){return bit_check(this.bitfield,Li.FLAGS[e])}setFeature(e,t){this.bitfield=t?bit_set(this.bitfield,Li.FLAGS[e]):bit_clear(this.bitfield,Li.FLAGS[e])}setGroup(e,t){for(const r of Li.GROUPS[e])this.setFeature(r,t)}};const lT=function(){let n,e,t=function(){let f="firmware-cache-journal";function d(m){let C={};C[f]=m,chrome.storage.local.set(C)}function _(m){chrome.storage.local.get(f,C=>{let R=typeof C=="object"&&C.hasOwnProperty(f)?C[f]:[];m(R)})}return{persist:d,load:_}}(),r=new LRUMap(100),i=!1;r.shift=function(){let f=LRUMap.prototype.shift.call(this);if(f===void 0)return;let d=f[0],_=s(d);return chrome.storage.local.get(_,m=>{let C=typeof m=="object"&&m.hasOwnProperty(_)?m[_]:null;C!==null&&chrome.storage.local.remove(_,()=>{h(C.release)})}),f};function o(f){return f.file}function s(f){return"cache:"+f}function l(f){return f?i?r.has(o(f)):(console.warn("Cache not yet loaded"),!1):!1}function a(f,d){if(!i){console.warn("Cache journal not yet loaded");return}let _=o(f);if(l(f)){console.debug("Firmware is already cached: "+_);return}r.set(_,!0),t.persist(r.toJSON());let m={};m[s(_)]={release:f,hexdata:d},chrome.storage.local.set(m,()=>{p(f)})}function c(f,d){if(!i){console.warn("Cache journal not yet loaded");return}let _=o(f);if(!l(f)){console.debug("Firmware is not cached: "+_);return}let m=s(_);chrome.storage.local.get(m,C=>{let R=typeof C=="object"&&C.hasOwnProperty(m)?C[m]:null;d(R)})}function u(){if(!i){console.warn("Cache journal not yet loaded");return}let f=[];for(let d of r.keys())f.push(s(d));chrome.storage.local.get(f,d=>{if(typeof d=="object"){for(let _ of f)if(d.hasOwnProperty(_)){let m=d[_];h(m.release)}chrome.storage.local.remove(f)}}),r.clear(),t.persist(r.toJSON())}function p(f){typeof n=="function"&&n(f),console.info("Release put to cache: "+o(f))}function h(f){typeof e=="function"&&e(f),console.debug("Cache data removed: "+o(f))}function g(f){let d=[];for(let _ of f)d.push([_.key,_.value]);r.assign(d),i=!0,console.info("Firmware cache journal loaded; number of entries: "+f.length)}return{has:l,put:a,get:c,onPutToCache:f=>n=f,onRemoveFromCache:f=>e=f,load:()=>{t.load(g)},unload:()=>{t.persist(r.toJSON()),r.clear()},invalidate:u}}(),$i={inputNames:["mixerInputNone","mixerInputStabilizedRoll","mixerInputStabilizedPitch","mixerInputStabilizedYaw","mixerInputStabilizedCollective","mixerInputStabilizedThrottle","mixerInputRCCommandRoll","mixerInputRCCommandPitch","mixerInputRCCommandYaw","mixerInputRCCommandCollective","mixerInputRCCommandThrottle","mixerInputRCChannelRoll","mixerInputRCChannelPitch","mixerInputRCChannelYaw","mixerInputRCChannelCollective","mixerInputRCChannelThrottle","mixerInputRCChannelAux1","mixerInputRCChannelAux2","mixerInputRCChannelAux3","mixerInputRCChannel9","mixerInputRCChannel10","mixerInputRCChannel11","mixerInputRCChannel12","mixerInputRCChannel13","mixerInputRCChannel14","mixerInputRCChannel15","mixerInputRCChannel16","mixerInputRCChannel17","mixerInputRCChannel18"],outputNames:["mixerOutputNone","mixerOutputMotor1","mixerOutputMotor2","mixerOutputMotor3","mixerOutputMotor4","mixerOutputServo1","mixerOutputServo2","mixerOutputServo3","mixerOutputServo4","mixerOutputServo5","mixerOutputServo6","mixerOutputServo7","mixerOutputServo8"],operNames:["mixerRuleNOP","mixerRuleSet","mixerRuleAdd","mixerRuleMul"],swashTypes:["mixerSwashType0","mixerSwashType1","mixerSwashType2","mixerSwashType3","mixerSwashType4","mixerSwashType5","mixerSwashType6"],UNINIT:-1,TAIL_MODE_VARIABLE:0,TAIL_MODE_MOTORIZED:1,TAIL_MODE_BIDIRECTIONAL:2,SWASH_TYPE_NONE:0,SWASH_TYPE_THRU:1,SWASH_TYPE_120:2,SWASH_TYPE_135:3,SWASH_TYPE_140:4,SWASH_TYPE_90L:5,SWASH_TYPE_90V:6,RULE_COUNT:32,OVERRIDE_MIN:-2500,OVERRIDE_MAX:2500,OVERRIDE_OFF:2501,OVERRIDE_PASSTHROUGH:2502,nullRule:function(){return{oper:0,src:0,dst:0,weight:0,offset:0}},cloneRule:function(n){return Object.assign({},n)},compareRule:function(n,e){return n.oper===e.oper&&n.src===e.src&&n.dst===e.dst&&n.weight===e.weight&&n.offset===e.offset},cloneRules:function(n){const e=this,t=[];return n&&n.forEach(function(r){t.push(e.cloneRule(r))}),t},isNullRule:function(n){return n.oper==0&&n.src==0&&n.dst==0&&n.weight==0&&n.offset==0},isNullMixer:function(n){const e=this;for(let t=0;t<n.length;t++)if(!e.isNullRule(n[t]))return!1;return!0},compareMixer:function(n,e,t){const r=this;for(let i=0;i<t;i++)if(!r.compareRule(n[i],e[i]))return!1;return!0},cloneInput:function(n){return Object.assign({},n)},cloneInputs:function(n){const e=[];return n.forEach(function(t){e.push($i.cloneInput(t))}),e},cloneConfig:function(n){const e=Object.assign({},n);return e.swash_trim=Array.from(n.swash_trim),e},overrideEnabled:function(n){return n>=$i.OVERRIDE_MIN&&n<=$i.OVERRIDE_MAX||n==$i.OVERRIDE_PASSTHROUGH},passthroughEnabled:function(n){return n==$i.OVERRIDE_PASSTHROUGH}},Wg=1e3,Xi=1500,nl=2e3,as=function(n){this.useLegacyCurve=n,this.maxAngularVel=null,this.constrain=function(e,t,r){return Math.max(t,Math.min(e,r))},this.rcCommand=function(e,t,r){let o=Math.min(Math.max(Math.abs(e-Xi)-r,0),500)*t;return e<Xi&&(o=-o),o},this.drawRateCurve=function(e,t,r,i,o,s,l,a,c,u){const p=u/(2*l),h=a.lineWidth;a.save(),a.translate(c/2,u/2),a.beginPath();let g=Wg;for(a.moveTo(-500,-p*this.rcCommandRawToDegreesPerSecond(g,e,t,r,i,o,s)),g=g+h;g<=nl;)a.lineTo(g-Xi,-p*this.rcCommandRawToDegreesPerSecond(g,e,t,r,i,o,s)),g=g+h;a.stroke(),a.restore()},this.drawLegacyRateCurve=function(e,t,r,i,o,s){let l=s*t;l=l+1/(1-l/s*e),i.beginPath(),i.moveTo(0,s),i.quadraticCurveTo(o*11/20,s-l/2*(1-r),o,s-l),i.stroke()},this.drawStickPosition=function(e,t,r,i,o,s,l,a,c,u){const h=c.canvas.height/2/a,g=this.rcCommandRawToDegreesPerSecond(e,t,r,i,o,s,l);return e!=null&&(c.save(),c.fillStyle=u||"#000000",c.translate(c.canvas.width/2,c.canvas.height/2),c.beginPath(),c.arc(e-1500,-h*g,c.canvas.height/60,0,2*Math.PI),c.fill(),c.restore()),g},this.getBetaflightRates=function(e,t,r,i,o,s,l){let a;i>2&&(i=i+(i-2)*14.54);let c=3,u=200;if(o>0&&(e=e*Math.pow(t,c)*o+e*(1-o)),s){const p=1/this.constrain(1-t*r,.01,1);a=u*i*e,a=a*p}else a=(r*100+27)*e/16/4.1;return a=this.constrain(a,-1*l,l),a},this.getRaceflightRates=function(e,t,r,i){let o=(1+.01*i*(e*e-1))*e;return o=o*(r+Math.abs(o)*r*t*.01),o},this.getKISSRates=function(e,t,r,i,o){const s=1-t*r,l=e*e;return e=(e*l*o+e*(1-o))*(i/10),2e3*(1/s)*e},this.getActualRates=function(e,t,r,i,o){let s;const l=t*(Math.pow(e,5)*o+e*(1-o));return s=Math.max(0,r-i),s=e*i+s*l,s},this.getQuickRates=function(e,t,r,i,o){i=i*200,r=Math.max(r,i);let s;const l=(r/i-1)/(r/i);return s=1/(1-(Math.pow(t,3)*o+t*(1-o))*l),s=e*i*s,s}};as.prototype.rcCommandRawToDegreesPerSecond=function(n,e,t,r,i,o,s){let l;if(e!==void 0&&t!==void 0&&r!==void 0){let a=this.rcCommand(n,1,o);a=a/(500-o);const c=Math.abs(a);switch(TABS.rates.currentRatesType){case TABS.rates.RATES_TYPE.BETAFLIGHT:l=this.getBetaflightRates(a,c,e,t,r,i,s);break;case TABS.rates.RATES_TYPE.RACEFLIGHT:l=this.getRaceflightRates(a,e,t,r);break;case TABS.rates.RATES_TYPE.KISS:l=this.getKISSRates(a,c,e,t,r);break;case TABS.rates.RATES_TYPE.ACTUAL:l=this.getActualRates(a,c,e,t,r);break;case TABS.rates.RATES_TYPE.QUICKRATES:l=this.getQuickRates(a,c,e,t,r);break;default:l=a*500;break}}return l};as.prototype.getMaxAngularVel=function(n,e,t,r,i,o){let s;return this.useLegacyCurve||(s=this.rcCommandRawToDegreesPerSecond(nl,n,e,t,r,i,o)),s};as.prototype.setMaxAngularVel=function(n){return this.maxAngularVel=Math.ceil(n/200)*200,this.maxAngularVel};as.prototype.draw=function(n,e,t,r,i,o,s,l){if(n!==void 0&&e!==void 0&&t!==void 0){const a=l.canvas.height,c=l.canvas.width;this.useLegacyCurve?this.drawLegacyRateCurve(n,e,t,l,c,a):this.drawRateCurve(n,e,t,r,i,o,s,l,c,a)}};const ls=function(){this.maxAngularVel=null,this.constrain=function(n,e,t){return Math.max(e,Math.min(n,t))},this.rcCommand=function(n,e,t){let i=Math.min(Math.max(Math.abs(n-Xi)-t,0),500)*e;return n<Xi&&(i=-i),i},this.drawRateCurve=function(n,e,t,r,i,o,s,l,a,c,u){const p=u/(2*l),h=a.lineWidth;a.save(),a.translate(c/2,u/2),a.beginPath();let g=Wg;for(a.moveTo(-500,-p*this.rcCommandRawToDegreesPerSecond(g,n,e,t,r,i,o,s)),g=g+h;g<=nl;)a.lineTo(g-Xi,-p*this.rcCommandRawToDegreesPerSecond(g,n,e,t,r,i,o,s)),g=g+h;a.stroke(),a.restore()},this.drawStickPosition=function(n,e,t,r,i,o,s,l,a,c,u){const h=c.canvas.height/2/a,g=this.rcCommandRawToDegreesPerSecond(n,e,t,r,i,o,s,l);return n!=null&&(c.save(),c.fillStyle=u||"#000000",c.translate(c.canvas.width/2,c.canvas.height/2),c.beginPath(),c.arc(n-1500,-h*g,c.canvas.height/60,0,2*Math.PI),c.fill(),c.restore()),g},this.getBetaflightRates=function(n,e,t,r,i,o,s){let l;r>2&&(r=r+(r-2)*14.54);let a=3,c=200;if(i>0&&(n=n*Math.pow(e,a)*i+n*(1-i)),o){const u=1/this.constrain(1-e*t,.01,1);l=c*r*n,l=l*u}else l=(t*100+27)*n/16/4.1;return l=this.constrain(l,-1*s,s),l},this.getRaceflightRates=function(n,e,t,r){let i=(1+.01*r*(n*n-1))*n;return i=i*(t+Math.abs(i)*t*e*.01),i},this.getKISSRates=function(n,e,t,r,i){const o=1-e*t,s=n*n;return n=(n*s*i+n*(1-i))*(r/10),2e3*(1/o)*n},this.getActualRates=function(n,e,t,r,i){let o;const s=e*(Math.pow(n,5)*i+n*(1-i));return o=Math.max(0,t-r),o=n*r+o*s,o},this.getQuickRates=function(n,e,t,r,i){r=r*200,t=Math.max(t,r);let o;const s=(t/r-1)/(t/r);return o=1/(1-(Math.pow(e,3)*i+e*(1-i))*s),o=n*r*o,o}};ls.prototype.rcCommandRawToDegreesPerSecond=function(n,e,t,r,i,o,s,l){let a;if(t!==void 0&&r!==void 0&&i!==void 0){let c=this.rcCommand(n,1,s);c=c/(500-s);const u=Math.abs(c);switch(e){case TABS.rates.RATES_TYPE.BETAFLIGHT:a=this.getBetaflightRates(c,u,t,r,i,o,l);break;case TABS.rates.RATES_TYPE.RACEFLIGHT:a=this.getRaceflightRates(c,t,r,i);break;case TABS.rates.RATES_TYPE.KISS:a=this.getKISSRates(c,u,t,r,i);break;case TABS.rates.RATES_TYPE.ACTUAL:a=this.getActualRates(c,u,t,r,i);break;case TABS.rates.RATES_TYPE.QUICKRATES:a=this.getQuickRates(c,u,t,r,i);break;default:a=c*500;break}}return a};ls.prototype.getMaxAngularVel=function(n,e,t,r,i,o,s){return this.rcCommandRawToDegreesPerSecond(nl,n,e,t,r,i,o,s)};ls.prototype.setMaxAngularVel=function(n){return this.maxAngularVel=Math.ceil(n/200)*200,this.maxAngularVel};ls.prototype.draw=function(n,e,t,r,i,o,s,l,a){if(e!==void 0&&t!==void 0&&r!==void 0){const c=a.canvas.height,u=a.canvas.width;this.drawRateCurve(n,e,t,r,i,o,s,l,a,u,c)}};function cT(n){let e=null,t=CONFIGURATOR.version;t.indexOf(".")===-1&&(t=t+".0.0");const r={generatedBy:t,apiVersion:FC.CONFIG.apiVersion,profiles:[]},i=[MSPCodes.MSP_PID_CONTROLLER,MSPCodes.MSP_PID,MSPCodes.MSP_RC_TUNING,MSPCodes.MSP_ACC_TRIM,MSPCodes.MSP_SERVO_CONFIGURATIONS,MSPCodes.MSP_MODE_RANGES,MSPCodes.MSP_ADJUSTMENT_RANGES];function o(){_e.gt(FC.CONFIG.apiVersion,"1.12.0")&&i.push(MSPCodes.MSP_SERVO_MIX_RULES),_e.gte(FC.CONFIG.apiVersion,"1.15.0")&&i.push(MSPCodes.MSP_RC_DEADBAND)}o(),MSP.send_message(MSPCodes.MSP_STATUS,!1,!1,function(){e=FC.CONFIG.profile,s()});function s(){e>0?MSP.send_message(MSPCodes.MSP_SELECT_SETTING,[0],!1,l):l()}function l(){let h=0,g=0;function f(){h<FC.CONFIG.numProfiles?MSP.send_message(i[g],!1,!1,function(){g++,g<i.length?f():(r.profiles.push({PID:jQuery.extend(!0,{},FC.PID),PIDs:jQuery.extend(!0,[],FC.PIDS),RC:jQuery.extend(!0,{},FC.RC_TUNING),AccTrim:jQuery.extend(!0,[],FC.CONFIG.accelerometerTrims),ServoConfig:jQuery.extend(!0,[],FC.SERVO_CONFIG),ServoRules:jQuery.extend(!0,[],FC.SERVO_RULES),ModeRanges:jQuery.extend(!0,[],FC.MODE_RANGES),AdjustmentRanges:jQuery.extend(!0,[],FC.ADJUSTMENT_RANGES)}),_e.gte(FC.CONFIG.apiVersion,"1.15.0")&&(r.profiles[h].RCdeadband=jQuery.extend(!0,{},FC.RC_DEADBAND_CONFIG)),g=0,h++,MSP.send_message(MSPCodes.MSP_SELECT_SETTING,[h],!1,f))}):MSP.send_message(MSPCodes.MSP_SELECT_SETTING,[e],!1,u)}f()}const a=[MSPCodes.MSP_RX_MAP,MSPCodes.MSP_CF_SERIAL_CONFIG,MSPCodes.MSP_LED_STRIP_CONFIG,MSPCodes.MSP_LED_COLORS];function c(){_e.gte(FC.CONFIG.apiVersion,"1.8.0")&&(a.push(MSPCodes.MSP_LOOP_TIME),a.push(MSPCodes.MSP_ARMING_CONFIG)),_e.gte(FC.CONFIG.apiVersion,"1.15.0")&&(a.push(MSPCodes.MSP_SENSOR_ALIGNMENT),a.push(MSPCodes.MSP_RX_CONFIG),a.push(MSPCodes.MSP_FAILSAFE_CONFIG),a.push(MSPCodes.MSP_RXFAIL_CONFIG)),_e.gte(FC.CONFIG.apiVersion,"1.19.0")&&a.push(MSPCodes.MSP_LED_STRIP_MODECOLOR),_e.gte(FC.CONFIG.apiVersion,API_VERSION_1_33)&&(a.push(MSPCodes.MSP_MOTOR_CONFIG),a.push(MSPCodes.MSP_RSSI_CONFIG),a.push(MSPCodes.MSP_GPS_CONFIG),a.push(MSPCodes.MSP_FEATURE_CONFIG)),_e.gte(FC.CONFIG.apiVersion,API_VERSION_1_41)&&a.push(MSPCodes.MSP_MODE_RANGES_EXTRA)}c();function u(){let h=0;function g(){h<a.length?MSP.send_message(a[h],!1,!1,function(){h++,g()}):(r.RCMAP=jQuery.extend(!0,[],FC.RC_MAP),r.SERIAL_CONFIG=jQuery.extend(!0,{},FC.SERIAL_CONFIG),r.LED_STRIP=jQuery.extend(!0,[],FC.LED_STRIP),r.LED_COLORS=jQuery.extend(!0,[],FC.LED_COLORS),r.BOARD_ALIGNMENT_CONFIG=jQuery.extend(!0,{},FC.BOARD_ALIGNMENT_CONFIG),r.CRAFT_NAME=FC.CONFIG.name,r.DISPLAY_NAME=FC.CONFIG.displayName,r.MIXER_CONFIG=jQuery.extend(!0,{},FC.MIXER_CONFIG),r.SENSOR_CONFIG=jQuery.extend(!0,{},FC.SENSOR_CONFIG),r.ADVANCED_CONFIG=jQuery.extend(!0,{},FC.ADVANCED_CONFIG),_e.gte(FC.CONFIG.apiVersion,"1.19.0")&&(r.LED_MODE_COLORS=jQuery.extend(!0,[],FC.LED_MODE_COLORS)),_e.gte(FC.CONFIG.apiVersion,"1.8.0")&&(r.FC_CONFIG=jQuery.extend(!0,{},FC.FC_CONFIG),r.ARMING_CONFIG=jQuery.extend(!0,{},FC.ARMING_CONFIG)),_e.gte(FC.CONFIG.apiVersion,"1.15.0")&&(r.SENSOR_ALIGNMENT=jQuery.extend(!0,{},FC.SENSOR_ALIGNMENT),r.RX_CONFIG=jQuery.extend(!0,{},FC.RX_CONFIG),r.FAILSAFE_CONFIG=jQuery.extend(!0,{},FC.FAILSAFE_CONFIG),r.RXFAIL_CONFIG=jQuery.extend(!0,[],FC.RXFAIL_CONFIG)),_e.gte(FC.CONFIG.apiVersion,API_VERSION_1_33)&&(r.RSSI_CONFIG=jQuery.extend(!0,{},FC.RSSI_CONFIG),r.FEATURE_CONFIG=jQuery.extend(!0,{},FC.FEATURE_CONFIG),r.MOTOR_CONFIG=jQuery.extend(!0,{},FC.MOTOR_CONFIG),r.GPS_CONFIG=jQuery.extend(!0,{},FC.GPS_CONFIG)),_e.gte(FC.CONFIG.apiVersion,API_VERSION_1_36)&&(r.BEEPER_CONFIG=jQuery.extend(!0,{},FC.BEEPER_CONFIG)),_e.gte(FC.CONFIG.apiVersion,API_VERSION_1_41)&&(r.MODE_RANGES_EXTRA=jQuery.extend(!0,[],FC.MODE_RANGES_EXTRA)),p())}if(GUI.configuration_loaded===!0)return g();MSP.promise(MSPCodes.MSP_ADVANCED_CONFIG).then(function(){return MSP.promise(MSPCodes.MSP_SENSOR_CONFIG)}).then(function(){return MSP.promise(MSPCodes.MSP_NAME)}).then(function(){return MSP.promise(MSPCodes.MSP_BOARD_ALIGNMENT_CONFIG)}).then(function(){return MSP.promise(MSPCodes.MSP_MIXER_CONFIG)}).then(function(){return MSP.promise(MSPCodes.MSP_BEEPER_CONFIG)}).then(function(){return g()})}function p(){let h=null;const g="backup",f="json",d=generateFilename(g,f),_=[{description:f.toUpperCase()+" files",extensions:[f]}];chrome.fileSystem.chooseEntry({type:"saveFile",suggestedName:d,accepts:_},function(m){if(!checkChromeRuntimeError()){if(!m){console.log("No file selected, backup aborted.");return}h=m,chrome.fileSystem.getDisplayPath(h,function(C){console.log("Backup file path: "+C)}),chrome.fileSystem.getWritableEntry(h,function(C){chrome.fileSystem.isWritableEntry(C,function(R){if(R){h=C;const S=JSON.stringify(r,null,"	"),F=new Blob([S],{type:"text/plain"});h.createWriter(function(I){I.onerror=function(P){console.error(P)};let T=!1;I.onwriteend=function(){if(!T){T=!0,I.truncate(F.size);return}console.log("Write SUCCESSFUL"),n?.()},I.write(F)},function(I){console.error(I)})}else console.log("File appears to be read only, sorry.")})})}})}}function uT(n){let e=null;const t=[{description:"JSON files",extensions:["json"]}];chrome.fileSystem.chooseEntry({type:"openFile",accepts:t},function(s){if(!checkChromeRuntimeError()){if(!s){console.log("No file selected, restore aborted.");return}e=s,chrome.fileSystem.getDisplayPath(e,function(l){console.log("Restore file path: "+l)}),e.file(function(l){const a=new FileReader;a.onprogress=function(c){c.total>1048576&&(console.log("File limit (1 MB) exceeded, aborting"),a.abort())},a.onloadend=function(c){if(c.total!=0&&c.total==c.loaded||GUI.isCordova()){console.log("Read SUCCESSFUL");let u;try{u=JSON.parse(c.target.result)}catch(p){console.log(`Data provided != valid JSON string, restore aborted: ${p}`);return}if(typeof u.generatedBy<"u"&&r(u.generatedBy,CONFIGURATOR.BACKUP_FILE_VERSION_MIN_SUPPORTED)){if(!r(u.generatedBy,"1.14.0")&&!i(u)){GUI.log(i18n.getMessage("backupFileUnmigratable"));return}if(u.FEATURE_CONFIG.features._featureMask){const p=new Features(FC.CONFIG);p.setMask(u.FEATURE_CONFIG.features._featureMask),u.FEATURE_CONFIG.features=p}o(u,n)}else GUI.log(i18n.getMessage("backupFileIncompatible"))}},a.readAsText(l)})}});function r(s,l){return s==null?!1:_e.gte(s,l)}function i(s){let l=0,a=s.generatedBy;if(GUI.log(i18n.getMessage("configMigrationFrom",[a])),r(a,"0.59.1")||(s.RSSI_CONFIG.channel=s.MISC.rssi_aux_channel,s.MISC.rssi_aux_channel=void 0,a="0.59.1",GUI.log(i18n.getMessage("configMigratedTo",[a])),l++),r(a,"0.60.1")||(s.LED_STRIP||(s.LED_STRIP=[]),a="0.60.1",GUI.log(i18n.getMessage("configMigratedTo",[a])),l++),r(a,"0.61.0")||(!s.PIDs&&s.PID&&(s.PIDs=s.PID,s.PID={controller:0}),a="0.61.0",GUI.log(i18n.getMessage("configMigratedTo",[a])),l++),!r(a,"0.63.0")){if(typeof s.LED_STRIP=="object"){const c=[];let u=0;for(;s.LED_STRIP[u];)c.push(s.LED_STRIP[u++]);s.LED_STRIP=c}for(let c=0;c<3;c++){const u=s.profiles[c].RC;u.roll_rate=u.roll_pitch_rate,u.pitch_rate=u.roll_pitch_rate}a="0.63.0",GUI.log(i18n.getMessage("configMigratedTo",[a])),l++}if(s.apiVersion==null&&(s.apiVersion="1.0.0"),!_e.parse(s.apiVersion)&&(s.apiVersion+=".0",!_e.parse(s.apiVersion)))return!1;if(r(a,"0.63.0")&&!r(s.apiVersion,"1.7.0")){const c=[];for(const u of s.SERIAL_CONFIG.ports){const p=u,h={identifier:p.identifier,functions:[],msp_baudrate:String(s.SERIAL_CONFIG.mspBaudRate),gps_baudrate:String(s.SERIAL_CONFIG.gpsBaudRate),telemetry_baudrate:"AUTO",blackbox_baudrate:"115200"};switch(p.scenario){case 1:case 5:case 8:h.functions.push("MSP");break;case 2:h.functions.push("GPS");break;case 3:h.functions.push("RX_SERIAL");break;case 10:h.functions.push("BLACKBOX");break;case 11:h.functions.push("MSP"),h.functions.push("BLACKBOX");break}c.push(h)}s.SERIAL_CONFIG={ports:c},GUI.log(i18n.getMessage("configMigratedTo",[a])),l++}if(r(a,"0.63.0")&&!r(s.apiVersion,"1.8.0")&&(s.FC_CONFIG==null&&(s.FC_CONFIG={loopTime:3500}),s.ARMING_CONFIG==null&&(s.ARMING_CONFIG={auto_disarm_delay:5,disarm_kill_switch:1}),GUI.log(i18n.getMessage("configMigratedTo",[a])),l++),r(a,"0.63.0")&&s.FC_CONFIG.loopTime==0&&(s.FC_CONFIG.loopTime=3500),_e.lt(a,"0.66.0")){for(let c=0;c<s.profiles.length;c++){if(_e.eq(s.apiVersion,"1.10.0"))for(;s.profiles[c].ServoConfig.length>8;)s.profiles[c].ServoConfig.pop();for(let u=0;u<s.profiles[c].ServoConfig.length;u++){const p=profiles[c].ServoConfig;p[u].angleAtMin=45,p[u].angleAtMax=45,p[u].reversedInputSources=0,(p[u].rate<-100||p[u].rate>100)&&(p[u].rate=0)}s.profiles[c].ServoRules=[]}a="0.66.0",GUI.log(i18n.getMessage("configMigratedTo",[a])),l++}if(_e.lt(s.apiVersion,"1.14.0")&&_e.gte(FC.CONFIG.apiVersion,"1.14.0")){for(let c=0;c<s.profiles.length;c++){let u=s.profiles[c].PID.controller;switch(u){case 3:case 4:case 5:u=0;break}s.profiles[c].PID.controller=u}GUI.log(i18n.getMessage("configMigratedTo",[a])),l++}if(r(a,"0.66.0")&&!r(s.apiVersion,"1.15.0")){for(let c=0;c<s.profiles.length;c++)s.profiles[c].RCdeadband==null&&(s.profiles[c].RCdeadband={deadband:0,yaw_deadband:0,alt_hold_deadband:40});if(s.SENSOR_ALIGNMENT==null&&(s.SENSOR_ALIGNMENT={align_gyro:0,align_acc:0,align_mag:0}),s.RX_CONFIG==null&&(s.RX_CONFIG={serialrx_provider:0,spektrum_sat_bind:0,stick_center:1500,stick_min:1100,stick_max:1900,rx_pulse_min:885,rx_pulse_max:2115}),s.FAILSAFE_CONFIG==null&&(s.FAILSAFE_CONFIG={failsafe_delay:10,failsafe_off_delay:200,failsafe_throttle:1e3,failsafe_switch_mode:0,failsafe_throttle_low_delay:100,failsafe_procedure:0}),s.RXFAIL_CONFIG==null){s.RXFAIL_CONFIG=[{mode:0,value:1500},{mode:0,value:1500},{mode:0,value:1500},{mode:0,value:875}];for(let c=0;c<14;c++){const u={mode:1,value:1500};s.RXFAIL_CONFIG.push(u)}}GUI.log(i18n.getMessage("configMigratedTo",[a])),l++}return r(a,"1.2.0")&&(FC.GPS_CONFIG.ublox_sbas<0&&(FC.GPS_CONFIG.ublox_sbas=0),a="1.2.0",GUI.log(i18n.getMessage("configMigratedTo",[a])),l++),r(a,"1.3.1")&&(s.LED_COLORS||(s.LED_COLORS=[]),s.LED_MODE_COLORS||(s.LED_MODE_COLORS=[]),a="1.3.1",GUI.log(i18n.getMessage("configMigratedTo",[a])),l++),l>0&&GUI.log(i18n.getMessage("configMigrationSuccessful",[l])),!0}function o(s,l){function a(){let c=null,u=FC.CONFIG.numProfiles;s.profiles.length<u&&(u=s.profiles.length);const p=[MSPCodes.MSP_SET_PID_CONTROLLER,MSPCodes.MSP_SET_PID,MSPCodes.MSP_SET_RC_TUNING,MSPCodes.MSP_SET_ACC_TRIM];_e.gte(FC.CONFIG.apiVersion,"1.15.0")&&p.push(MSPCodes.MSP_SET_RC_DEADBAND),MSP.send_message(MSPCodes.MSP_STATUS,!1,!1,function(){c=FC.CONFIG.profile,h()});function h(){c>0?MSP.send_message(MSPCodes.MSP_SELECT_SETTING,[0],!1,g):g()}function g(){let F=0,I=0;function T(U){FC.PID=s.profiles[U].PID,FC.PIDS=s.profiles[U].PIDs,FC.RC_TUNING=s.profiles[U].RC,FC.CONFIG.accelerometerTrims=s.profiles[U].AccTrim,FC.SERVO_CONFIG=s.profiles[U].ServoConfig,FC.SERVO_RULES=s.profiles[U].ServoRules,FC.MODE_RANGES=s.profiles[U].ModeRanges,FC.ADJUSTMENT_RANGES=s.profiles[U].AdjustmentRanges,FC.RC_DEADBAND_CONFIG=s.profiles[U].RCdeadband}function P(){MSP.send_message(p[I],mspHelper.crunch(p[I]),!1,function(){I++,I<p.length?P():(I=0,F++,F<u?(T(F),MSP.send_message(MSPCodes.MSP_EEPROM_WRITE,!1,!1,function(){MSP.send_message(MSPCodes.MSP_SELECT_SETTING,[F],!1,P)})):MSP.send_message(MSPCodes.MSP_EEPROM_WRITE,!1,!1,function(){MSP.send_message(MSPCodes.MSP_SELECT_SETTING,[c],!1,f)}))})}function y(){mspHelper.sendServoConfigurations(L)}function L(){if(_e.gte(FC.CONFIG.apiVersion,API_VERSION_1_41))if(s.MODE_RANGES_EXTRA==null){FC.MODE_RANGES_EXTRA=[];for(let U=0;U<FC.MODE_RANGES.length;U++){const M={modeId:FC.MODE_RANGES[U].modeId,modeLogic:0,linkedTo:0};FC.MODE_RANGES_EXTRA.push(M)}}else FC.MODE_RANGES_EXTRA=s.MODE_RANGES_EXTRA;mspHelper.sendModeRanges(G)}function G(){mspHelper.sendAdjustmentRanges(P)}T(0),y()}function f(){let F=0;const I=[MSPCodes.MSP_SET_RX_MAP,MSPCodes.MSP_SET_CF_SERIAL_CONFIG];function T(){I.push(MSPCodes.MSP_SET_NAME),I.push(MSPCodes.MSP_SET_SENSOR_CONFIG),I.push(MSPCodes.MSP_SET_MIXER_CONFIG),I.push(MSPCodes.MSP_SET_BEEPER_CONFIG),I.push(MSPCodes.MSP_SET_BOARD_ALIGNMENT_CONFIG),I.push(MSPCodes.MSP_SET_ADVANCED_CONFIG),_e.gte(FC.CONFIG.apiVersion,"1.8.0")&&(I.push(MSPCodes.MSP_SET_LOOP_TIME),I.push(MSPCodes.MSP_SET_ARMING_CONFIG)),_e.gte(FC.CONFIG.apiVersion,"1.15.0")&&(I.push(MSPCodes.MSP_SET_SENSOR_ALIGNMENT),I.push(MSPCodes.MSP_SET_RX_CONFIG),I.push(MSPCodes.MSP_SET_FAILSAFE_CONFIG)),_e.gte(FC.CONFIG.apiVersion,API_VERSION_1_33)&&(I.push(MSPCodes.MSP_SET_FEATURE_CONFIG),I.push(MSPCodes.MSP_SET_MOTOR_CONFIG),I.push(MSPCodes.MSP_SET_GPS_CONFIG),I.push(MSPCodes.MSP_SET_RSSI_CONFIG))}function P(){FC.MISC=s.MISC,FC.RC_MAP=s.RCMAP,FC.SERIAL_CONFIG=s.SERIAL_CONFIG,FC.LED_STRIP=s.LED_STRIP,FC.LED_COLORS=s.LED_COLORS,FC.LED_MODE_COLORS=s.LED_MODE_COLORS,FC.ARMING_CONFIG=s.ARMING_CONFIG,FC.FC_CONFIG=s.FC_CONFIG,FC.SENSOR_ALIGNMENT=s.SENSOR_ALIGNMENT,FC.RX_CONFIG=s.RX_CONFIG,FC.FAILSAFE_CONFIG=s.FAILSAFE_CONFIG,FC.RXFAIL_CONFIG=s.RXFAIL_CONFIG,FC.FEATURE_CONFIG=s.FEATURE_CONFIG,FC.MOTOR_CONFIG=s.MOTOR_CONFIG,FC.GPS_CONFIG=s.GPS_CONFIG,FC.RSSI_CONFIG=s.RSSI_CONFIG,FC.BOARD_ALIGNMENT_CONFIG=s.BOARD_ALIGNMENT_CONFIG,FC.CONFIG.name=s.CRAFT_NAME,FC.CONFIG.displayName=s.DISPLAY_NAME,FC.MIXER_CONFIG=s.MIXER_CONFIG,FC.SENSOR_CONFIG=s.SENSOR_CONFIG,FC.ADVANCED_CONFIG=s.ADVANCED_CONFIG,FC.BEEPER_CONFIG.beepers=new Beepers(FC.CONFIG),FC.BEEPER_CONFIG.beepers.setDisabledMask(s.BEEPER_CONFIG.beepers._beeperDisabledMask),FC.BEEPER_CONFIG.dshotBeaconTone=s.BEEPER_CONFIG.dshotBeaconTone,FC.BEEPER_CONFIG.dshotBeaconConditions=new Beepers(FC.CONFIG,["RX_LOST","RX_SET"]),FC.BEEPER_CONFIG.dshotBeaconConditions.setDisabledMask(s.BEEPER_CONFIG.dshotBeaconConditions._beeperDisabledMask)}function y(){F<I.length?MSP.send_message(I[F],mspHelper.crunch(I[F]),!1,function(){F++,y()}):d()}P(),T(),y()}function d(){mspHelper.sendLedStripConfig(_)}function _(){mspHelper.sendLedStripColors(m)}function m(){_e.gte(FC.CONFIG.apiVersion,"1.19.0")?mspHelper.sendLedStripModeColors(C):C()}function C(){_e.gte(FC.CONFIG.apiVersion,"1.15.0")?mspHelper.sendRxFailConfig(R):R()}function R(){MSP.send_message(MSPCodes.MSP_EEPROM_WRITE,!1,!1,S)}function S(){GUI.log(i18n.getMessage("eeprom_saved_ok")),GUI.tab_switch_cleanup(function(){MSP.send_message(MSPCodes.MSP_SET_REBOOT,!1,!1,reinitialiseConnection(l))})}}CONFIGURATOR.virtualMode&&(FC.resetState(),FC.CONFIG.apiVersion=CONFIGURATOR.virtualApiVersion,sensor_status(FC.CONFIG.activeSensors),update_dataflash_global()),a()}}const dT=Object.freeze(Object.defineProperty({__proto__:null,configuration_backup:cT,configuration_restore:uT},Symbol.toStringTag,{value:"Module"})),jg="12.6.0",cn="12.7.0",Dn="12.8.0",lo="12.9.0",qg=jg,Kg=lo,Qg="4.3.0-0",Zg="4.6.99",qe=Rn({API_VERSION_MIN_SUPPORTED:qg,API_VERSION_MAX_SUPPORTED:Kg,FW_VERSION_MIN_SUPPORTED:Qg,FW_VERSION_MAX_SUPPORTED:Zg,connectionValid:!1,virtualMode:!1,virtualApiVersion:"0.0.1",cliEngineActive:!1,cliEngineValid:!1,cliTab:"",gitChangesetId:"d6d64f66",version:"0.0.0",latestVersion:"0.0.1",latestVersionReleaseUrl:"https://github.com/rotorflight/rotorflight-configurator/releases",allReleasesUrl:"https://github.com/rotorflight/rotorflight-configurator/releases",expertMode:!1}),fT=Object.freeze(Object.defineProperty({__proto__:null,API_VERSION_12_6:jg,API_VERSION_12_7:cn,API_VERSION_12_8:Dn,API_VERSION_12_9:lo,API_VERSION_RTFL_MAX:Kg,API_VERSION_RTFL_MIN:qg,CONFIGURATOR:qe,FW_VERSION_RTFL_MAX:Zg,FW_VERSION_RTFL_MIN:Qg},Symbol.toStringTag,{value:"Module"})),Jg=-1;function _T(n,e,t,r){let i=0,o=0,s=128,l=!1;const a=[];for(;!l&&n.byteLength!=0&&a.length!=e;){if(n.byteLength==0)throw new Error("unexpected");if(i<<=1,++o,n[0]&s&&(i|=1),s>>=1,s==0&&(s=128,n=n.subarray(1)),r[o]!=-1){for(let c=r[o];c<t.length&&t[c].codeLen===o;++c)if(t[c].code===i){const u=t[c].value;u==Jg?l=!0:a.push(u),i=0,o=0;break}}}return new Uint8Array(a)}const No=[{value:0,codeLen:2,code:3},{value:1,codeLen:3,code:5},{value:2,codeLen:4,code:9},{value:3,codeLen:5,code:17},{value:4,codeLen:5,code:16},{value:80,codeLen:5,code:15},{value:5,codeLen:6,code:29},{value:6,codeLen:6,code:28},{value:7,codeLen:6,code:27},{value:8,codeLen:6,code:26},{value:16,codeLen:6,code:25},{value:9,codeLen:7,code:49},{value:10,codeLen:7,code:48},{value:11,codeLen:7,code:47},{value:12,codeLen:7,code:46},{value:13,codeLen:7,code:45},{value:14,codeLen:7,code:44},{value:15,codeLen:7,code:43},{value:17,codeLen:7,code:42},{value:18,codeLen:7,code:41},{value:19,codeLen:8,code:81},{value:20,codeLen:8,code:80},{value:21,codeLen:8,code:79},{value:22,codeLen:8,code:78},{value:23,codeLen:8,code:77},{value:24,codeLen:8,code:76},{value:25,codeLen:8,code:75},{value:26,codeLen:8,code:74},{value:27,codeLen:8,code:73},{value:28,codeLen:8,code:72},{value:29,codeLen:8,code:71},{value:30,codeLen:8,code:70},{value:31,codeLen:8,code:69},{value:32,codeLen:8,code:68},{value:33,codeLen:8,code:67},{value:34,codeLen:8,code:66},{value:35,codeLen:8,code:65},{value:36,codeLen:8,code:64},{value:48,codeLen:8,code:63},{value:64,codeLen:8,code:62},{value:240,codeLen:8,code:61},{value:37,codeLen:9,code:121},{value:38,codeLen:9,code:120},{value:39,codeLen:9,code:119},{value:40,codeLen:9,code:118},{value:41,codeLen:9,code:117},{value:42,codeLen:9,code:116},{value:43,codeLen:9,code:115},{value:44,codeLen:9,code:114},{value:45,codeLen:9,code:113},{value:46,codeLen:9,code:112},{value:47,codeLen:9,code:111},{value:49,codeLen:9,code:110},{value:50,codeLen:9,code:109},{value:51,codeLen:9,code:108},{value:52,codeLen:9,code:107},{value:53,codeLen:9,code:106},{value:54,codeLen:9,code:105},{value:55,codeLen:9,code:104},{value:56,codeLen:9,code:103},{value:57,codeLen:9,code:102},{value:58,codeLen:9,code:101},{value:59,codeLen:9,code:100},{value:60,codeLen:9,code:99},{value:61,codeLen:9,code:98},{value:62,codeLen:9,code:97},{value:63,codeLen:9,code:96},{value:65,codeLen:9,code:95},{value:66,codeLen:9,code:94},{value:67,codeLen:9,code:93},{value:68,codeLen:9,code:92},{value:69,codeLen:9,code:91},{value:70,codeLen:9,code:90},{value:71,codeLen:9,code:89},{value:72,codeLen:9,code:88},{value:73,codeLen:9,code:87},{value:76,codeLen:9,code:86},{value:79,codeLen:9,code:85},{value:81,codeLen:9,code:84},{value:128,codeLen:9,code:83},{value:224,codeLen:9,code:82},{value:241,codeLen:9,code:81},{value:255,codeLen:9,code:80},{value:74,codeLen:10,code:159},{value:75,codeLen:10,code:158},{value:77,codeLen:10,code:157},{value:78,codeLen:10,code:156},{value:82,codeLen:10,code:155},{value:83,codeLen:10,code:154},{value:84,codeLen:10,code:153},{value:85,codeLen:10,code:152},{value:86,codeLen:10,code:151},{value:87,codeLen:10,code:150},{value:88,codeLen:10,code:149},{value:89,codeLen:10,code:148},{value:90,codeLen:10,code:147},{value:91,codeLen:10,code:146},{value:92,codeLen:10,code:145},{value:93,codeLen:10,code:144},{value:94,codeLen:10,code:143},{value:95,codeLen:10,code:142},{value:96,codeLen:10,code:141},{value:97,codeLen:10,code:140},{value:98,codeLen:10,code:139},{value:99,codeLen:10,code:138},{value:100,codeLen:10,code:137},{value:101,codeLen:10,code:136},{value:102,codeLen:10,code:135},{value:103,codeLen:10,code:134},{value:104,codeLen:10,code:133},{value:105,codeLen:10,code:132},{value:106,codeLen:10,code:131},{value:107,codeLen:10,code:130},{value:108,codeLen:10,code:129},{value:109,codeLen:10,code:128},{value:110,codeLen:10,code:127},{value:111,codeLen:10,code:126},{value:112,codeLen:10,code:125},{value:113,codeLen:10,code:124},{value:114,codeLen:10,code:123},{value:115,codeLen:10,code:122},{value:116,codeLen:10,code:121},{value:117,codeLen:10,code:120},{value:118,codeLen:10,code:119},{value:119,codeLen:10,code:118},{value:120,codeLen:10,code:117},{value:121,codeLen:10,code:116},{value:122,codeLen:10,code:115},{value:123,codeLen:10,code:114},{value:124,codeLen:10,code:113},{value:125,codeLen:10,code:112},{value:126,codeLen:10,code:111},{value:127,codeLen:10,code:110},{value:129,codeLen:10,code:109},{value:130,codeLen:10,code:108},{value:131,codeLen:10,code:107},{value:132,codeLen:10,code:106},{value:133,codeLen:10,code:105},{value:134,codeLen:10,code:104},{value:135,codeLen:10,code:103},{value:136,codeLen:10,code:102},{value:137,codeLen:10,code:101},{value:138,codeLen:10,code:100},{value:139,codeLen:10,code:99},{value:140,codeLen:10,code:98},{value:141,codeLen:10,code:97},{value:142,codeLen:10,code:96},{value:143,codeLen:10,code:95},{value:144,codeLen:10,code:94},{value:145,codeLen:10,code:93},{value:146,codeLen:10,code:92},{value:147,codeLen:10,code:91},{value:148,codeLen:10,code:90},{value:149,codeLen:10,code:89},{value:150,codeLen:10,code:88},{value:151,codeLen:10,code:87},{value:152,codeLen:10,code:86},{value:153,codeLen:10,code:85},{value:154,codeLen:10,code:84},{value:155,codeLen:10,code:83},{value:156,codeLen:10,code:82},{value:157,codeLen:10,code:81},{value:158,codeLen:10,code:80},{value:159,codeLen:10,code:79},{value:160,codeLen:10,code:78},{value:161,codeLen:10,code:77},{value:162,codeLen:10,code:76},{value:163,codeLen:10,code:75},{value:164,codeLen:10,code:74},{value:165,codeLen:10,code:73},{value:166,codeLen:10,code:72},{value:167,codeLen:10,code:71},{value:168,codeLen:10,code:70},{value:169,codeLen:10,code:69},{value:170,codeLen:10,code:68},{value:171,codeLen:10,code:67},{value:172,codeLen:10,code:66},{value:173,codeLen:10,code:65},{value:174,codeLen:10,code:64},{value:175,codeLen:10,code:63},{value:176,codeLen:10,code:62},{value:177,codeLen:10,code:61},{value:178,codeLen:10,code:60},{value:179,codeLen:10,code:59},{value:180,codeLen:10,code:58},{value:181,codeLen:10,code:57},{value:182,codeLen:10,code:56},{value:183,codeLen:10,code:55},{value:184,codeLen:10,code:54},{value:185,codeLen:10,code:53},{value:186,codeLen:10,code:52},{value:187,codeLen:10,code:51},{value:188,codeLen:10,code:50},{value:189,codeLen:10,code:49},{value:190,codeLen:10,code:48},{value:191,codeLen:10,code:47},{value:192,codeLen:10,code:46},{value:193,codeLen:10,code:45},{value:194,codeLen:10,code:44},{value:195,codeLen:10,code:43},{value:196,codeLen:10,code:42},{value:197,codeLen:10,code:41},{value:198,codeLen:10,code:40},{value:199,codeLen:10,code:39},{value:200,codeLen:10,code:38},{value:201,codeLen:10,code:37},{value:202,codeLen:10,code:36},{value:203,codeLen:10,code:35},{value:204,codeLen:10,code:34},{value:205,codeLen:10,code:33},{value:206,codeLen:10,code:32},{value:207,codeLen:10,code:31},{value:208,codeLen:10,code:30},{value:209,codeLen:10,code:29},{value:210,codeLen:10,code:28},{value:211,codeLen:10,code:27},{value:212,codeLen:10,code:26},{value:214,codeLen:10,code:25},{value:215,codeLen:10,code:24},{value:216,codeLen:10,code:23},{value:217,codeLen:10,code:22},{value:218,codeLen:10,code:21},{value:219,codeLen:10,code:20},{value:220,codeLen:10,code:19},{value:222,codeLen:10,code:18},{value:223,codeLen:10,code:17},{value:225,codeLen:10,code:16},{value:226,codeLen:10,code:15},{value:228,codeLen:10,code:14},{value:239,codeLen:10,code:13},{value:213,codeLen:11,code:25},{value:221,codeLen:11,code:24},{value:227,codeLen:11,code:23},{value:229,codeLen:11,code:22},{value:230,codeLen:11,code:21},{value:231,codeLen:11,code:20},{value:232,codeLen:11,code:19},{value:233,codeLen:11,code:18},{value:234,codeLen:11,code:17},{value:235,codeLen:11,code:16},{value:236,codeLen:11,code:15},{value:237,codeLen:11,code:14},{value:238,codeLen:11,code:13},{value:242,codeLen:11,code:12},{value:243,codeLen:11,code:11},{value:244,codeLen:11,code:10},{value:245,codeLen:11,code:9},{value:246,codeLen:11,code:8},{value:247,codeLen:11,code:7},{value:248,codeLen:11,code:6},{value:250,codeLen:11,code:5},{value:251,codeLen:11,code:4},{value:252,codeLen:11,code:3},{value:253,codeLen:11,code:2},{value:254,codeLen:11,code:1},{value:249,codeLen:12,code:1},{value:Jg,codeLen:12,code:0}],pT=function(){const n=Array(No.length).fill(-1);for(let e=0;e<No.length;++e)n[No[e].codeLen]===-1&&(n[No[e].codeLen]=e);return n}(),hT=Object.freeze(Object.defineProperty({__proto__:null,defaultHuffmanLenIndex:pT,defaultHuffmanTree:No},Symbol.toStringTag,{value:"Module"}));class gT{#e=pe();get ADJUSTMENT_RANGES(){return b(this.#e)}set ADJUSTMENT_RANGES(e){ce(this.#e,e,!0)}#i=pe();get ADVANCED_CONFIG(){return b(this.#i)}set ADVANCED_CONFIG(e){ce(this.#i,e,!0)}#s=pe();get ANALOG(){return b(this.#s)}set ANALOG(e){ce(this.#s,e,!0)}#r=pe();get ARMING_CONFIG(){return b(this.#r)}set ARMING_CONFIG(e){ce(this.#r,e,!0)}#o=pe();get AUX_CONFIG(){return b(this.#o)}set AUX_CONFIG(e){ce(this.#o,e,!0)}#n=pe();get AUX_CONFIG_IDS(){return b(this.#n)}set AUX_CONFIG_IDS(e){ce(this.#n,e,!0)}#t=pe();get BATTERY_CONFIG(){return b(this.#t)}set BATTERY_CONFIG(e){ce(this.#t,e,!0)}#u=pe();get BATTERY_STATE(){return b(this.#u)}set BATTERY_STATE(e){ce(this.#u,e,!0)}#c=pe();get BEEPER_CONFIG(){return b(this.#c)}set BEEPER_CONFIG(e){ce(this.#c,e,!0)}#l=pe();get BLACKBOX(){return b(this.#l)}set BLACKBOX(e){ce(this.#l,e,!0)}#_=pe();get BOARD_ALIGNMENT_CONFIG(){return b(this.#_)}set BOARD_ALIGNMENT_CONFIG(e){ce(this.#_,e,!0)}#f=pe();get CONFIG(){return b(this.#f)}set CONFIG(e){ce(this.#f,e,!0)}#a=pe();get COPY_PROFILE(){return b(this.#a)}set COPY_PROFILE(e){ce(this.#a,e,!0)}#g=pe();get CURRENT_METERS(){return b(this.#g)}set CURRENT_METERS(e){ce(this.#g,e,!0)}#d=pe();get CURRENT_METER_CONFIGS(){return b(this.#d)}set CURRENT_METER_CONFIGS(e){ce(this.#d,e,!0)}#p=pe();get DATAFLASH(){return b(this.#p)}set DATAFLASH(e){ce(this.#p,e,!0)}#m=pe();get DEBUG_CONFIG(){return b(this.#m)}set DEBUG_CONFIG(e){ce(this.#m,e,!0)}#h=pe();get DEFAULT(){return b(this.#h)}set DEFAULT(e){ce(this.#h,e,!0)}#C=pe();get ESC_SENSOR_CONFIG(){return b(this.#C)}set ESC_SENSOR_CONFIG(e){ce(this.#C,e,!0)}#v=pe();get FAILSAFE_CONFIG(){return b(this.#v)}set FAILSAFE_CONFIG(e){ce(this.#v,e,!0)}#E=pe();get FEATURE_CONFIG(){return b(this.#E)}set FEATURE_CONFIG(e){ce(this.#E,e,!0)}#S=pe();get FILTER_CONFIG(){return b(this.#S)}set FILTER_CONFIG(e){ce(this.#S,e,!0)}#F=pe();get GOVERNOR(){return b(this.#F)}set GOVERNOR(e){ce(this.#F,e,!0)}#R=pe();get GPS_CONFIG(){return b(this.#R)}set GPS_CONFIG(e){ce(this.#R,e,!0)}#I=pe();get GPS_DATA(){return b(this.#I)}set GPS_DATA(e){ce(this.#I,e,!0)}#b=pe();get GPS_RESCUE(){return b(this.#b)}set GPS_RESCUE(e){ce(this.#b,e,!0)}#T=pe();get LED_COLORS(){return b(this.#T)}set LED_COLORS(e){ce(this.#T,e,!0)}#O=pe();get LED_MODE_COLORS(){return b(this.#O)}set LED_MODE_COLORS(e){ce(this.#O,e,!0)}#P=pe();get LED_STRIP(){return b(this.#P)}set LED_STRIP(e){ce(this.#P,e,!0)}#A=pe();get LED_STRIP_CONFIG(){return b(this.#A)}set LED_STRIP_CONFIG(e){ce(this.#A,e,!0)}#M=pe();get MIXER_CONFIG(){return b(this.#M)}set MIXER_CONFIG(e){ce(this.#M,e,!0)}#N=pe();get MIXER_INPUTS(){return b(this.#N)}set MIXER_INPUTS(e){ce(this.#N,e,!0)}#x=pe();get MIXER_OVERRIDE(){return b(this.#x)}set MIXER_OVERRIDE(e){ce(this.#x,e,!0)}#y=pe();get MIXER_RULES(){return b(this.#y)}set MIXER_RULES(e){ce(this.#y,e,!0)}#w=pe();get MODE_RANGES(){return b(this.#w)}set MODE_RANGES(e){ce(this.#w,e,!0)}#G=pe();get MODE_RANGES_EXTRA(){return b(this.#G)}set MODE_RANGES_EXTRA(e){ce(this.#G,e,!0)}#L=pe();get MOTOR_CONFIG(){return b(this.#L)}set MOTOR_CONFIG(e){ce(this.#L,e,!0)}#$=pe();get MOTOR_DATA(){return b(this.#$)}set MOTOR_DATA(e){ce(this.#$,e,!0)}#D=pe();get MOTOR_OUTPUT_ORDER(){return b(this.#D)}set MOTOR_OUTPUT_ORDER(e){ce(this.#D,e,!0)}#k=pe();get MOTOR_OVERRIDE(){return b(this.#k)}set MOTOR_OVERRIDE(e){ce(this.#k,e,!0)}#U=pe();get MOTOR_TELEMETRY_DATA(){return b(this.#U)}set MOTOR_TELEMETRY_DATA(e){ce(this.#U,e,!0)}#B=pe();get MULTIPLE_MSP(){return b(this.#B)}set MULTIPLE_MSP(e){ce(this.#B,e,!0)}#V=pe();get PID(){return b(this.#V)}set PID(e){ce(this.#V,e,!0)}#H=pe();get PIDS(){return b(this.#H)}set PIDS(e){ce(this.#H,e,!0)}#X=pe();get PIDS_ACTIVE(){return b(this.#X)}set PIDS_ACTIVE(e){ce(this.#X,e,!0)}#Y=pe();get PID_NAMES(){return b(this.#Y)}set PID_NAMES(e){ce(this.#Y,e,!0)}#z=pe();get PID_PROFILE(){return b(this.#z)}set PID_PROFILE(e){ce(this.#z,e,!0)}#W=pe();get RC(){return b(this.#W)}set RC(e){ce(this.#W,e,!0)}#j=pe();get RC_COMMAND(){return b(this.#j)}set RC_COMMAND(e){ce(this.#j,e,!0)}#q=pe();get RC_CONFIG(){return b(this.#q)}set RC_CONFIG(e){ce(this.#q,e,!0)}#K=pe();get RC_MAP(){return b(this.#K)}set RC_MAP(e){ce(this.#K,e,!0)}#Q=pe();get RC_TUNING(){return b(this.#Q)}set RC_TUNING(e){ce(this.#Q,e,!0)}#Z=pe();get RPM_FILTER_CONFIG(){return b(this.#Z)}set RPM_FILTER_CONFIG(e){ce(this.#Z,e,!0)}#J=pe();get RPM_FILTER_CONFIG_V2(){return b(this.#J)}set RPM_FILTER_CONFIG_V2(e){ce(this.#J,e,!0)}#ee=pe();get RSSI_CONFIG(){return b(this.#ee)}set RSSI_CONFIG(e){ce(this.#ee,e,!0)}#te=pe();get RXFAIL_CONFIG(){return b(this.#te)}set RXFAIL_CONFIG(e){ce(this.#te,e,!0)}#ne=pe();get RX_CHANNELS(){return b(this.#ne)}set RX_CHANNELS(e){ce(this.#ne,e,!0)}#re=pe();get RX_CONFIG(){return b(this.#re)}set RX_CONFIG(e){ce(this.#re,e,!0)}#ie=pe();get SDCARD(){return b(this.#ie)}set SDCARD(e){ce(this.#ie,e,!0)}#oe=pe();get SENSOR_ALIGNMENT(){return b(this.#oe)}set SENSOR_ALIGNMENT(e){ce(this.#oe,e,!0)}#se=pe();get SENSOR_CONFIG(){return b(this.#se)}set SENSOR_CONFIG(e){ce(this.#se,e,!0)}#ae=pe();get SENSOR_DATA(){return b(this.#ae)}set SENSOR_DATA(e){ce(this.#ae,e,!0)}#le=pe();get SERIAL_CONFIG(){return b(this.#le)}set SERIAL_CONFIG(e){ce(this.#le,e,!0)}#ce=pe();get SERVO_CONFIG(){return b(this.#ce)}set SERVO_CONFIG(e){ce(this.#ce,e,!0)}#ue=pe();get SERVO_DATA(){return b(this.#ue)}set SERVO_DATA(e){ce(this.#ue,e,!0)}#de=pe();get SERVO_OVERRIDE(){return b(this.#de)}set SERVO_OVERRIDE(e){ce(this.#de,e,!0)}#fe=pe();get SERVO_RULES(){return b(this.#fe)}set SERVO_RULES(e){ce(this.#fe,e,!0)}#_e=pe();get TELEMETRY_CONFIG(){return b(this.#_e)}set TELEMETRY_CONFIG(e){ce(this.#_e,e,!0)}#pe=pe();get TRANSPONDER(){return b(this.#pe)}set TRANSPONDER(e){ce(this.#pe,e,!0)}#he=pe();get TUNING_SLIDERS(){return b(this.#he)}set TUNING_SLIDERS(e){ce(this.#he,e,!0)}#ge=pe();get VOLTAGE_METERS(){return b(this.#ge)}set VOLTAGE_METERS(e){ce(this.#ge,e,!0)}#me=pe();get VOLTAGE_METER_CONFIGS(){return b(this.#me)}set VOLTAGE_METER_CONFIGS(e){ce(this.#me,e,!0)}constructor(){this.resetState()}resetState(){this.CONFIG={apiVersion:"0.0.0",flightControllerIdentifier:"",flightControllerVersion:"",version:0,buildInfo:"",multiType:0,msp_version:0,capability:0,pidCycleTime:0,gyroCycleTime:0,cpuLoad:0,rtLoad:0,activeSensors:0,mode:0,motorCount:0,servoCount:0,numProfiles:6,profile:0,numRateProfile:6,rateProfile:0,uid:[0,0,0],accelerometerTrims:[0,0],name:"",displayName:"JOE PILOT",boardType:0,extraFlags:0,armingDisableCount:0,armingDisableFlags:0,armingDisabled:!1,enableArmingFlag:!1,motorOverrideEnabled:!1,servoOverrideEnabled:!1,mixerOverrideEnabled:!1,boardIdentifier:"",boardVersion:0,targetCapabilities:0,targetName:"",boardName:"",manufacturerId:"",signature:[],mcuTypeId:255,configurationState:0,sampleRateHz:0,configurationProblems:0},this.BATTERY_CONFIG={capacity:0,cellCount:0,voltageMeterSource:0,currentMeterSource:0,vbatmincellvoltage:0,vbatmaxcellvoltage:0,vbatfullcellvoltage:0,vbatwarningcellvoltage:0,lvcPercentage:0,mahWarningPercentage:0},this.BATTERY_STATE={batteryState:0,cellCount:0,capacity:0,mAhDrawn:0,voltage:0,amperage:0,chargeLevel:0},this.ANALOG={voltage:0,mAhdrawn:0,rssi:0,amperage:0},this.COPY_PROFILE={type:0,dstProfile:0,srcProfile:0},this.FEATURE_CONFIG={features:new $d},this.BEEPER_CONFIG={beepers:0,dshotBeaconTone:0,dshotBeaconConditions:0},this.MIXER_CONFIG={main_rotor_dir:0,tail_rotor_mode:0,tail_motor_idle:0,tail_center_trim:0,swash_type:0,swash_ring:0,swash_phase:0,swash_trim:[0,0,0],blade_pitch_limit:0,coll_rpm_correction:0,coll_geo_correction:0,coll_tilt_correction_pos:0,coll_tilt_correction_neg:0},this.MIXER_INPUTS=[],this.MIXER_RULES=[],this.MIXER_OVERRIDE=Array.from({length:29}),this.BOARD_ALIGNMENT_CONFIG={roll:0,pitch:0,yaw:0},this.LED_STRIP=[],this.LED_COLORS=[],this.LED_MODE_COLORS=[],this.LED_STRIP_CONFIG={ledstrip_beacon_armed_only:0,ledstrip_beacon_color:0,ledstrip_beacon_percent:0,ledstrip_beacon_period_ms:0,ledstrip_blink_period_ms:0,ledstrip_brightness:0,ledstrip_fade_rate:0,ledstrip_flicker_rate:0,ledstrip_grb_rgb:0,ledstrip_profile:0,ledstrip_race_color:0,ledstrip_visual_beeper:0,ledstrip_visual_beeper_color:0},this.PID={controller:0},this.PID_NAMES=[],this.PIDS_ACTIVE=Array.from({length:3}),this.PIDS=Array.from({length:3});for(let e=0;e<3;e++)this.PIDS_ACTIVE[e]=Array.from({length:8}),this.PIDS[e]=Array.from({length:8});this.RC_MAP=[],this.RC={active_channels:0,channels:Array.from({length:32})},this.RX_CHANNELS=Array.from({length:32}),this.RC_COMMAND=Array.from({length:32}),this.RC_TUNING={RC_RATE:0,RC_EXPO:0,roll_pitch_rate:0,roll_rate:0,pitch_rate:0,yaw_rate:0,collective_rate:0,dynamic_THR_PID:0,throttle_MID:0,throttle_EXPO:0,dynamic_THR_breakpoint:0,RC_YAW_EXPO:0,rcYawRate:0,rcPitchRate:0,RC_PITCH_EXPO:0,rcCollectiveRate:0,RC_COLLECTIVE_EXPO:0,roll_rate_limit:2e3,pitch_rate_limit:2e3,yaw_rate_limit:2e3,collective_rate_limit:2e3,roll_response_time:0,pitch_response_time:0,yaw_response_time:0,collective_response_time:0,roll_accel_limit:0,pitch_accel_limit:0,yaw_accel_limit:0,collective_accel_limit:0,roll_setpoint_boost_gain:0,roll_setpoint_boost_cutoff:0,pitch_setpoint_boost_gain:0,pitch_setpoint_boost_cutoff:0,yaw_setpoint_boost_gain:0,yaw_setpoint_boost_cutoff:0,collective_setpoint_boost_gain:0,collective_setpoint_boost_cutoff:0,yaw_dynamic_ceiling_gain:0,yaw_dynamic_deadband_gain:0,yaw_dynamic_deadband_filter:0},this.AUX_CONFIG=[],this.AUX_CONFIG_IDS=[],this.MODE_RANGES=[],this.MODE_RANGES_EXTRA=[],this.ADJUSTMENT_RANGES=[],this.SERVO_CONFIG=[],this.SERVO_RULES=[],this.SERIAL_CONFIG={ports:[]},this.ESC_SENSOR_CONFIG={protocol:0,half_duplex:!1,update_hz:0,current_offset:0,hw4_current_offset:0,hw4_current_gain:0,hw4_voltage_gain:0,pinswap:!1,voltage_correction:0,current_correction:0,consumption_correction:0},this.SENSOR_DATA={gyroscope:[0,0,0],accelerometer:[0,0,0],magnetometer:[0,0,0],altitude:0,sonar:0,kinematics:[0,0,0],debug:[0,0,0,0]},this.MOTOR_DATA=[0,0,0,0],this.MOTOR_OVERRIDE=[0,0,0,0],this.SERVO_DATA=[0,0,0,0,0,0,0,0],this.SERVO_OVERRIDE=[0,0,0,0,0,0,0,0],this.MOTOR_TELEMETRY_DATA={rpm:[0,0,0,0,0,0,0,0],invalidPercent:[0,0,0,0,0,0,0,0],voltage:[0,0,0,0,0,0,0,0],current:[0,0,0,0,0,0,0,0],consumption:[0,0,0,0,0,0,0,0],temperature:[0,0,0,0,0,0,0,0],temperature2:[0,0,0,0,0,0,0,0]},this.GPS_DATA={fix:0,numSat:0,lat:0,lon:0,alt:0,speed:0,ground_course:0,distanceToHome:0,ditectionToHome:0,update:0,chn:[],svid:[],quality:[],cno:[]},this.VOLTAGE_METERS=[],this.VOLTAGE_METER_CONFIGS=[],this.CURRENT_METERS=[],this.CURRENT_METER_CONFIGS=[],this.DEBUG_CONFIG={debugMode:0,debugAxis:0,debugModeCount:0,debugValueCount:0},this.ARMING_CONFIG={auto_disarm_delay:0,disarm_kill_switch:0},this.MOTOR_CONFIG={mincommand:0,minthrottle:0,maxthrottle:0,motor_pwm_protocol:0,motor_pwm_rate:0,motor_poles:[0,0,0,0],motor_rpm_lpf:[0,0,0,0],use_dshot_telemetry:!1,use_unsynced_pwm:!1,main_rotor_gear_ratio:[1,1],tail_rotor_gear_ratio:[1,1]},this.GPS_CONFIG={provider:0,ublox_sbas:0,auto_config:0,auto_baud:0,home_point_once:0,ublox_use_galileo:0},this.RSSI_CONFIG={channel:0,scale:0,invert:0,offset:0},this.DATAFLASH={ready:!1,supported:!1,sectors:0,totalSize:0,usedSize:0},this.SDCARD={supported:!1,state:0,filesystemLastError:0,freeSizeKB:0,totalSizeKB:0},this.BLACKBOX={supported:!1,blackboxDevice:0,blackboxMode:0,blackboxDenom:0,blackboxFields:0,blackboxInitialEraseKiB:0,blackboxRollingErase:0,blackboxGracePeriod:0},this.TRANSPONDER={supported:!1,data:[],provider:0,providers:[]},this.SENSOR_ALIGNMENT={gyro_1_align:0,gyro_2_align:0,align_mag:0},this.ADVANCED_CONFIG={gyro_sync_denom:1,pid_process_denom:1},this.FILTER_CONFIG={gyro_hardware_lpf:0,gyro_lowpass_type:0,gyro_lowpass_hz:0,gyro_lowpass2_type:0,gyro_lowpass2_hz:0,gyro_notch_hz:0,gyro_notch_cutoff:0,gyro_notch2_hz:0,gyro_notch2_cutoff:0,dterm_lowpass_type:0,dterm_lowpass_hz:0,dterm_lowpass2_type:0,dterm_lowpass2_hz:0,dterm_notch_hz:0,dterm_notch_cutoff:0,gyro_lowpass_dyn_min_hz:0,gyro_lowpass_dyn_max_hz:0,dterm_lowpass_dyn_min_hz:0,dterm_lowpass_dyn_max_hz:0,dyn_notch_count:0,dyn_notch_q:0,dyn_notch_min_hz:0,dyn_notch_max_hz:0,rpm_preset:0,rpm_min_hz:0},this.RPM_FILTER_CONFIG=[],this.RPM_FILTER_CONFIG_V2=[],this.PID_PROFILE={rollPitchItermIgnoreRate:0,yawItermIgnoreRate:0,yaw_p_limit:0,deltaMethod:0,vbatPidCompensation:0,dtermSetpointTransition:0,dtermSetpointWeight:0,toleranceBand:0,toleranceBandReduction:0,itermThrottleGain:0,pidMaxVelocity:0,pidMaxVelocityYaw:0,levelAngleLimit:0,levelSensitivity:0,itermThrottleThreshold:0,itermAcceleratorGain:0,error_rotation:0,error_decay_time_ground:0,error_decay_time_cyclic:0,error_decay_time_yaw:0,error_decay_limit_cyclic:0,error_decay_limit_yaw:0,errorLimitRoll:0,errorLimitPitch:0,errorLimitYaw:0,offsetLimitRoll:0,offsetLimitPitch:0,gyroCutoffRoll:0,gyroCutoffPitch:0,gyroCutoffYaw:0,dtermCutoffRoll:0,dtermCutoffPitch:0,dtermCutoffYaw:0,btermCutoffRoll:0,btermCutoffPitch:0,btermCutoffYaw:0,smartFeedforward:0,itermRelax:0,itermRelaxType:0,itermRelaxCutoff:0,itermRelaxCutoffRoll:0,itermRelaxCutoffPitch:0,itermRelaxCutoffYaw:0,itermRelaxLevelRoll:0,itermRelaxLevelPitch:0,itermRelaxLevelYaw:0,absoluteControlGain:0,throttleBoost:0,levelAngleStrength:0,horizonLevelStrength:0,acroTrainerAngleLimit:0,acroTrainerLimit:0,acroTrainerGain:0,feedforwardRoll:0,feedforwardPitch:0,feedforwardYaw:0,feedforwardTransition:0,antiGravityMode:0,dMinRoll:0,dMinPitch:0,dMinYaw:0,dMinGain:0,dMinAdvance:0,useIntegratedYaw:0,integratedYawRelax:0,motorOutputLimit:0,autoProfileCellCount:0,idleMinRpm:0,ff_interpolate_sp:0,ff_smooth_factor:0,ff_boost:0,vbat_sag_compensation:0,thrustLinearization:0,yawCenterOffset:0,yawStopGainCW:0,yawStopGainCCW:0,yawPrecompCutoff:0,yawFFCyclicGain:0,yawFFCollectiveGain:0,yawFFImpulseGain:0,yawFFImpulseDecay:0,pitchFFCollectiveGain:0,cyclicCrossCouplingGain:0,cyclicCrossCouplingRatio:0,cyclicCrossCouplingCutoff:0,pid_mode:0,rescueMode:0,rescueFlipMode:0,rescueFlipGain:0,rescuePullupTime:0,rescueClimbTime:0,rescueFlipTime:0,rescueExitTime:0,rescuePullupCollective:0,rescueClimbCollective:0,rescueHoverCollective:0,rescueHoverAltitude:0,rescueAltitudePGain:0,rescueAltitudeIGain:0,rescueAltitudeDGain:0,rescueMaxCollective:0,rescueMaxRate:0,rescueMaxAccel:0,yaw_inertia_precomp_gain:0,yaw_inertia_precomp_cutoff:0},this.GOVERNOR={gov_mode:0,gov_startup_time:0,gov_spoolup_time:0,gov_spoolup_min_throttle:0,gov_tracking_time:0,gov_recovery_time:0,gov_zero_throttle_timeout:0,gov_lost_headspeed_timeout:0,gov_autorotation_timeout:0,gov_autorotation_bailout_time:0,gov_autorotation_min_entry_time:0,gov_handover_throttle:0,gov_headspeed:0,gov_gain:0,gov_p_gain:0,gov_i_gain:0,gov_d_gain:0,gov_f_gain:0,gov_tta_gain:0,gov_tta_limit:0,gov_yaw_ff_weight:0,gov_cyclic_ff_weight:0,gov_collective_ff_weight:0,gov_max_throttle:0,gov_min_throttle:0,gov_pwr_filter:0,gov_rpm_filter:0,gov_tta_filter:0,gov_ff_filter:0},this.SENSOR_CONFIG={acc_hardware:0,baro_hardware:0,mag_hardware:0,gyro_to_use:0,gyroHighFsr:0,gyroMovementCalibThreshold:0,gyroCalibDuration:0,gyroOffsetYaw:0,gyroCheckOverflow:0},this.RX_CONFIG={serialrx_provider:0,serialrx_inverted:0,serialrx_halfduplex:0,rx_pulse_min:0,rx_pulse_max:0,rxSpiProtocol:0,rxSpiId:0,rxSpiRfChannelCount:0,serialrx_pinswap:0},this.RC_CONFIG={rc_center:0,rc_deflection:0,rc_arm_throttle:0,rc_min_throttle:0,rc_max_throttle:0,rc_deadband:0,rc_yaw_deadband:0},this.FAILSAFE_CONFIG={failsafe_delay:0,failsafe_off_delay:0,failsafe_throttle:0,failsafe_switch_mode:0,failsafe_throttle_low_delay:0,failsafe_procedure:0},this.TELEMETRY_CONFIG={telemetry_inverted:0,telemetry_halfduplex:0,telemetry_sensors:0,telemetry_pinswap:0,crsf_telemetry_mode:0,crsf_telemetry_rate:0,crsf_telemetry_ratio:0,telemetry_sensors_list:[]},this.GPS_RESCUE={angle:0,initialAltitudeM:0,descentDistanceM:0,rescueGroundspeed:0,throttleMin:0,throttleMax:0,throttleHover:0,sanityChecks:0,minSats:0,ascendRate:0,descendRate:0,allowArmingWithoutFix:0,altitudeMode:0},this.RXFAIL_CONFIG=[],this.MOTOR_OUTPUT_ORDER=[],this.MULTIPLE_MSP={msp_commands:[]},this.DEFAULT={gyro_lowpass_hz:100,gyro_lowpass_dyn_min_hz:150,gyro_lowpass_dyn_max_hz:450,gyro_lowpass_type:this.FILTER_TYPE_FLAGS.PT1,gyro_lowpass2_hz:300,gyro_lowpass2_type:this.FILTER_TYPE_FLAGS.PT1,gyro_notch_cutoff:300,gyro_notch_hz:400,gyro_notch2_cutoff:100,gyro_notch2_hz:200,gyro_rpm_notch_harmonics:3,gyro_rpm_notch_min_hz:100,dterm_lowpass_hz:100,dterm_lowpass_dyn_min_hz:150,dterm_lowpass_dyn_max_hz:250,dyn_lpf_curve_expo:5,dterm_lowpass_type:this.FILTER_TYPE_FLAGS.PT1,dterm_lowpass2_hz:150,dterm_lowpass2_type:this.FILTER_TYPE_FLAGS.BIQUAD,dterm_notch_cutoff:160,dterm_notch_hz:260,yaw_lowpass_hz:100,dyn_notch_q:20,dyn_notch_count:0,dyn_notch_q_rpm:250,dyn_notch_count_rpm:0,dyn_notch_min_hz:25,dyn_notch_max_hz:245},this.TUNING_SLIDERS={slider_pids_mode:0,slider_master_multiplier:0,slider_roll_pitch_ratio:0,slider_i_gain:0,slider_pd_ratio:0,slider_pd_gain:0,slider_dmin_ratio:0,slider_ff_gain:0,slider_dterm_filter:0,slider_dterm_filter_multiplier:0,slider_gyro_filter:0,slider_gyro_filter_multiplier:0}}getHardwareName(){let e;return this.CONFIG.targetName?e=this.CONFIG.targetName:e=this.CONFIG.boardIdentifier,this.CONFIG.boardName&&this.CONFIG.boardName!==e&&(e=`${this.CONFIG.boardName}(${e})`),this.CONFIG.manufacturerId&&(e=`${this.CONFIG.manufacturerId}/${e}`),e}CONFIGURATION_STATES={DEFAULTS_BARE:0,DEFAULTS_CUSTOM:1,CONFIGURED:2};TARGET_CAPABILITIES_FLAGS={HAS_VCP:0,HAS_SOFTSERIAL:1,IS_UNIFIED:2,HAS_FLASH_BOOTLOADER:3,SUPPORTS_CUSTOM_DEFAULTS:4,HAS_CUSTOM_DEFAULTS:5,SUPPORTS_RX_BIND:6};CONFIGURATION_PROBLEM_FLAGS={ACC_NEEDS_CALIBRATION:0,MOTOR_PROTOCOL_DISABLED:1};boardHasVcp(){return bit_check(this.CONFIG.targetCapabilities,this.TARGET_CAPABILITIES_FLAGS.HAS_VCP)}FILTER_TYPE_FLAGS={PT1:0,BIQUAD:1};getFilterDefaults(){const e=Qn(this.DEFAULT);return e.gyro_lowpass_hz=125,e.gyro_lowpass_dyn_min_hz=50,e.gyro_lowpass_dyn_max_hz=150,e.gyro_lowpass_type=this.FILTER_TYPE_FLAGS.BIQUAD,e.gyro_lowpass2_hz=500,e.gyro_lowpass2_type=this.FILTER_TYPE_FLAGS.BIQUAD,e.dterm_lowpass_hz=50,e.dterm_lowpass_dyn_min_hz=25,e.dterm_lowpass_dyn_max_hz=60,e.dterm_lowpass_type=this.FILTER_TYPE_FLAGS.PT1,e.dterm_lowpass2_hz=0,e.dterm_lowpass2_type=this.FILTER_TYPE_FLAGS.PT1,e}}const V=new gT,oi={NWJS:"NW.js",Cordova:"Cordova",Browser:"Browser",Other:"Other"},ct=function(){this.auto_connect=!1,this.show_all_ports=!1,this.connecting_to=!1,this.connected_to=!1,this.connect_lock=!1,this.zoom_level=100,this.active_tab=null,this.current_tab=null,this.tab_switch_in_progress=!1,this.reboot_in_progress=!1,this.operating_system=null,this.interval_array=[],this.timeout_array=[],this.defaultAllowedTabsWhenDisconnected=["landing","firmware_flasher","privacy_policy","options","help"],this.defaultAllowedFCTabsWhenConnected=["status","setup","failsafe","power","adjustments","auxiliary","cli","configuration","beepers","gps","led_strip","blackbox","modes","motors","mixer","profiles","rates","gyro","receiver","sensors","servos","presets"],this.allowedTabs=this.defaultAllowedTabsWhenDisconnected,this.operating_system=mT(),this.zoomBoxTimeout=null,this.Mode=oi.Browser};function mT(){return navigator.appVersion.indexOf("Win")!==-1?"Windows":navigator.appVersion.indexOf("Mac")!==-1?"MacOS":navigator.appVersion.indexOf("Android")!==-1?"Android":navigator.appVersion.indexOf("Linux")!==-1?"Linux":navigator.appVersion.indexOf("X11")!==-1?"UNIX":"Unknown"}ct.prototype.interval_add=function(n,e,t,r){const i={name:n,timer:null,code:e,interval:t,fired:0,paused:!1};return r===!0&&(e(),i.fired++),i.timer=setInterval(function(){e(),i.fired++},t),this.interval_array.push(i),i};ct.prototype.interval_add_condition=function(n,e,t,r,i){this.interval_add(n,()=>{i()?e():this.interval_remove(n)},t,r)};ct.prototype.interval_remove=function(n){for(let e=0;e<this.interval_array.length;e++)if(this.interval_array[e].name===n)return clearInterval(this.interval_array[e].timer),this.interval_array.splice(e,1),!0;return!1};ct.prototype.interval_pause=function(n){for(let e=0;e<this.interval_array.length;e++)if(this.interval_array[e].name===n)return clearInterval(this.interval_array[e].timer),this.interval_array[e].paused=!0,!0;return!1};ct.prototype.interval_resume=function(n){function e(t){t.code(),t.fired++}for(let t=0;t<this.interval_array.length;t++)if(this.interval_array[t].name===n&&this.interval_array[t].paused){const r=this.interval_array[t];return r.timer=setInterval(e,r.interval,r),r.paused=!1,!0}return!1};ct.prototype.interval_kill_all=function(n){const e=this;let t=0;for(let r=this.interval_array.length-1;r>=0;r--){let i=!1;n&&n.forEach(function(o){e.interval_array[r].name===o&&(i=!0)}),i||(clearInterval(this.interval_array[r].timer),this.interval_array.splice(r,1),t++)}return t};ct.prototype.timeout_add=function(n,e,t){const r=this,i={name:n,timer:null,timeout:t};return i.timer=setTimeout(function(){e();const o=r.timeout_array.indexOf(i);o>-1&&r.timeout_array.splice(o,1)},t),this.timeout_array.push(i),i};ct.prototype.timeout_remove=function(n){for(let e=0;e<this.timeout_array.length;e++)if(this.timeout_array[e].name===n)return clearTimeout(this.timeout_array[e].timer),this.timeout_array.splice(e,1),!0;return!1};ct.prototype.timeout_kill_all=function(){let n=0;for(let e=0;e<this.timeout_array.length;e++)clearTimeout(this.timeout_array[e].timer),n++;return this.timeout_array=[],n};ct.prototype.log=function(n){const e=$("div#log"),t=new Date,r=t.getFullYear(),i=t.getMonth()<9?`0${t.getMonth()+1}`:t.getMonth()+1,o=t.getDate()<10?`0${t.getDate()}`:t.getDate(),s=t.getHours()<10?`0${t.getHours()}`:t.getHours(),l=t.getMinutes()<10?`0${t.getMinutes()}`:t.getMinutes(),a=t.getSeconds()<10?`0${t.getSeconds()}`:t.getSeconds(),c=`${s}:${l}:${a}`,u=`${r}-${i}-${o} @${c}`;$("div.wrapper",e).append(`<p>${u} -- ${n}</p>`),e.scrollTop($("div.wrapper",e).height())};ct.prototype.tab_switch_allowed=function(n){this.current_tab?this.current_tab.exit?this.current_tab.exit(n):this.current_tab.isDirty?showTabExitDialog(this.current_tab,n):n?.():n?.()};ct.prototype.tab_switch_reload=function(n){MSP.callbacks_cleanup(),this.interval_kill_all(),this.current_tab&&(this.current_tab.cleanup(),this.current_tab.initialize(n))};ct.prototype.tab_switch_cleanup=function(n){MSP.callbacks_cleanup(),this.interval_kill_all(),this.current_tab?this.current_tab.cleanup(n):n?.()};ct.prototype.switchery=function(){const n="var(--accent)",e="var(--switcherysecond)";$(".togglesmall").each(function(t,r){const i=new Switchery(r,{size:"small",color:n,secondaryColor:e});$(r).on("change",function(){i.setPosition()}),$(r).removeClass("togglesmall")}),$(".toggle").each(function(t,r){const i=new Switchery(r,{color:n,secondaryColor:e});$(r).on("change",function(){i.setPosition()}),$(r).removeClass("toggle")}),$(".togglemedium").each(function(t,r){const i=new Switchery(r,{className:"switcherymid",color:n,secondaryColor:e});$(r).on("change",function(){i.setPosition()}),$(r).removeClass("togglemedium")})};ct.prototype.set_zoom=function(n,e){n?GUI.zoom_level=n:n=GUI.zoom_level;const t=n+"%";it({zoomLevel:n}),nw.Window.get().zoomLevel=Math.log(n/100)/Math.log(1.2),$("#zoom-percent").text(t),e&&($("#zoom-box").show(),clearTimeout(this.zoomBoxTimeout),this.zoomBoxTimeout=setTimeout(function(){$("#zoom-box").fadeOut()},3e3))};ct.prototype.content_ready=function(n){if(this.switchery(),CONFIGURATOR.connectionValid){const e=$("#content .tab_title").attr("i18n");$("#content #button-documentation").text(i18n.getMessage("buttonHelp")).attr("target","_rfhelp").attr("rel","noopener noreferrer").attr("href",getTabHelpURL(e))}jQuery(function(){new jBox("Tooltip",{attach:".cf_tip",trigger:"mouseenter",closeOnMouseleave:!0,closeOnClick:"body",delayOpen:100,delayClose:100,position:{x:"right",y:"center"},outside:"x"}),new jBox("Tooltip",{theme:"Widetip",attach:".cf_tip_wide",trigger:"mouseenter",closeOnMouseleave:!0,closeOnClick:"body",delayOpen:100,delayClose:100,position:{x:"right",y:"center"},outside:"x"})}),n?.()};ct.prototype.saveDefaultTab=function(n){it({lastTab:n})};ct.prototype.selectDefaultTabWhenConnected=function(){const n=We("lastTab");We("rememberLastTab")&&n?$(`#tabs ul.mode-connected .tab_${n} a`).click():$("#tabs ul.mode-connected .tab_status a").click()};ct.prototype.isNWJS=function(){return this.Mode===oi.NWJS};ct.prototype.isCordova=function(){return this.Mode===oi.Cordova};ct.prototype.isOther=function(){return this.Mode===oi.Other};ct.prototype.isBrowser=function(){return this.Mode===oi.Browser};ct.prototype.isInstalled=function(){return[oi.NWJS,oi.Cordova].includes(this.Mode)};ct.prototype.escapeHtml=function(n){return n.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")};ct.prototype.addLinksTargetBlank=function(n){n.find("a").each(function(){$(this).attr("target","_blank")})};const CT="https://www.rotorflight.org/",gh={tabStatus:"https://www.rotorflight.org/docs/2.2.0/configurator/tabs/status",tabSetup:"https://www.rotorflight.org/docs/2.2.0/configurator/tabs/setup",tabConfiguration:"https://www.rotorflight.org/docs/2.2.0/configurator/tabs/configuration",tabPresets:"https://www.rotorflight.org/docs/2.2.0/configurator/tabs/presets",tabReceiver:"https://www.rotorflight.org/docs/2.2.0/configurator/tabs/receiver",tabFailsafe:"https://www.rotorflight.org/docs/2.2.0/configurator/tabs/failsafe",tabPower:"https://www.rotorflight.org/docs/2.2.0/configurator/tabs/power",tabMotors:"https://www.rotorflight.org/docs/2.2.0/configurator/tabs/motors",tabServos:"https://www.rotorflight.org/docs/2.2.0/configurator/tabs/servos",tabMixer:"https://www.rotorflight.org/docs/2.2.0/configurator/tabs/mixer",tabGyro:"https://www.rotorflight.org/docs/2.2.0/configurator/tabs/gyro",tabRates:"https://www.rotorflight.org/docs/2.2.0/configurator/tabs/rates",tabProfiles:"https://www.rotorflight.org/docs/2.2.0/configurator/tabs/profiles",tabAuxiliary:"https://www.rotorflight.org/docs/2.2.0/configurator/tabs/modes",tabAdjustments:"https://www.rotorflight.org/docs/2.2.0/configurator/tabs/adjustments",tabLedStrip:"https://www.rotorflight.org/docs/2.2.0/configurator/tabs/led-strip",tabBeepers:"https://www.rotorflight.org/docs/2.2.0/configurator/tabs/beepers",tabGPS:"https://www.rotorflight.org/docs/2.2.0/configurator/tabs/gps",tabSensors:"https://www.rotorflight.org/docs/2.2.0/configurator/tabs/sensors",tabBlackbox:"https://www.rotorflight.org/docs/2.2.0/configurator/tabs/blackbox",tabCli:"https://www.rotorflight.org/docs/2.2.0/configurator/tabs/cli"};function em(n){return n&&gh[n]?gh[n]:CT}const Sn={connected:!1,connectionId:!1,openCanceled:!1,bitrate:0,bytesReceived:0,bytesSent:0,failed:0,connectionType:"serial",connectionIP:"127.0.0.1",connectionPort:5761,transmitting:!1,outputBuffer:[],connect:function(n,e,t){const r=this,i=n.match(/^tcp:\/\/([A-Za-z0-9.-]+)(?::(\d+))?$/);i?r.connectTcp(i[1],i[2],e,t):n==="virtual"?r.connectVirtual(t):r.connectSerial(n,e,t)},connectSerial:function(n,e,t){const r=this;r.connectionType="serial",chrome.serial.connect(n,e,function(i){i&&!r.openCanceled&&!checkChromeRuntimeError()?(r.connected=!0,r.connectionId=i.connectionId,r.bitrate=i.bitrate,r.bytesReceived=0,r.bytesSent=0,r.failed=0,r.onReceive.addListener(function(s){r.bytesReceived+=s.data.byteLength}),r.onReceiveError.addListener(function(s){switch(s.error){case"system_error":r.failed++||chrome.serial.setPaused(r.connectionId,!1,function(){r.getInfo(function(l){l?l.paused?(console.log(`${r.connectionType}: connection did not recover from last onReceiveError, disconnecting`),GUI.log(i18n.getMessage("serialUnrecoverable")),r.errorHandler(l.error,"receive")):(console.log(`${r.connectionType}: connection recovered from last onReceiveError`),r.failed=0):checkChromeRuntimeError()})});break;case"overrun":r.error=s.error,setTimeout(function(){chrome.serial.setPaused(s.connectionId,!1,function(){r.getInfo(function(l){l&&(l.paused?(console.log(`${r.connectionType}: connection did not recover from ${r.error} condition, disconnecting`),GUI.log(i18n.getMessage("serialUnrecoverable")),r.errorHandler(l.error,"receive")):console.log(`${r.connectionType}: connection recovered from ${r.error} condition`))})})},50);break;case"timeout":break;case"frame_error":GUI.log(i18n.getMessage("serialErrorFrameError")),r.errorHandler(s.error,"receive");break;case"parity_error":GUI.log(i18n.getMessage("serialErrorParityError")),r.errorHandler(s.error,"receive");break;case"break":case"disconnected":case"device_lost":default:r.errorHandler(s.error,"receive");break}}),console.log(`${r.connectionType}: connection opened with ID: ${i.connectionId} , Baud: ${i.bitrate}`),t&&t(i)):(i&&r.openCanceled?(r.connectionId=i.connectionId,console.log(`${r.connectionType}: connection opened with ID: ${i.connectionId} , but request was canceled, disconnecting`),setTimeout(function(){r.openCanceled=!1,r.disconnect(function(){console.log(`${r.connectionType}: connect sequence was cancelled, disconnecting...`)})},150)):r.openCanceled?(console.log(`${r.connectionType}: connection didn't open and request was canceled`),r.openCanceled=!1):console.log(`${r.connectionType}: failed to open serial port`),t&&t(!1))})},connectTcp:function(n,e,t,r){const i=this;i.connectionIP=n,i.connectionPort=e||5761,i.connectionPort=parseInt(i.connectionPort),i.connectionType="tcp",chrome.sockets.tcp.create({persistent:!1,name:"Rotorflight",bufferSize:65535},function(o){(o&&!i.openCanceled||!checkChromeRuntimeError())&&(i.connectionId=o.socketId,i.bitrate=115200,i.bytesReceived=0,i.bytesSent=0,i.failed=0,chrome.sockets.tcp.connect(o.socketId,i.connectionIP,i.connectionPort,function(s){s===0||!checkChromeRuntimeError()?chrome.sockets.tcp.setNoDelay(o.socketId,!0,function(l){(l===0||!checkChromeRuntimeError())&&(i.onReceive.addListener(function(c){i.bytesReceived+=c.data.byteLength}),i.onReceiveError.addListener(function(c){c.socketId===i.connectionId&&i.connectionType==="tcp"&&c.resultCode<0&&i.errorHandler(c.resultCode,"receive")}),i.connected=!0,console.log(`${i.connectionType}: connection opened with ID ${o.socketId} , url: ${i.connectionIP}:${i.connectionPort}`),r&&r(o))}):(console.log(`${i.connectionType}: failed to connect with result ${s}`),r&&r(!1))}))})},connectVirtual:function(n){const e=this;e.connectionType="virtual",e.openCanceled||(e.connected=!0,e.connectionId="virtual",e.bitrate=115200,e.bytesReceived=0,e.bytesSent=0,e.failed=0,n?.())},disconnect:function(n){const e=this;if(e.connected=!1,e.emptyOutputBuffer(),e.connectionId){for(let t=e.onReceive.listeners.length-1;t>=0;t--)e.onReceive.removeListener(e.onReceive.listeners[t]);for(let t=e.onReceiveError.listeners.length-1;t>=0;t--)e.onReceiveError.removeListener(e.onReceiveError.listeners[t]);e.connectionType!=="virtual"?(e.connectionType==="tcp"&&chrome.sockets.tcp.disconnect(e.connectionId,function(){checkChromeRuntimeError(),console.log(`${e.connectionType}: disconnecting socket.`)}),(e.connectionType==="serial"?chrome.serial.disconnect:chrome.sockets.tcp.close)(e.connectionId,function(r){checkChromeRuntimeError(),r=r||e.connectionType==="tcp",console.log(`${e.connectionType}: ${r?"closed":"failed to close"} connection with ID: ${e.connectionId}, Sent: ${e.bytesSent} bytes, Received: ${e.bytesReceived} bytes`),e.connectionId=!1,e.bitrate=0,n&&n(r)})):(e.connectionId=!1,CONFIGURATOR.virtualMode=!1,e.connectionType=!1,n&&n(!0))}else e.openCanceled=!0},getDevices:function(n){chrome.serial.getDevices(function(e){n(e.map(({path:t,displayName:r})=>({path:t,displayName:r})))})},getInfo:function(n){(this.connectionType==="serial"?chrome.serial:chrome.sockets.tcp).getInfo(this.connectionId,n)},send:function(n,e){const t=this;t.outputBuffer.push({data:n,callback:e});function r(){const i=t.outputBuffer[0].data,o=t.outputBuffer[0].callback;if(!t.connected){console.log(`${t.connectionType}: attempting to send when disconnected`),o&&o({bytesSent:0,error:"undefined"});return}(t.connectionType==="serial"?chrome.serial.send:chrome.sockets.tcp.send)(t.connectionId,i,function(l){if(checkChromeRuntimeError(),l===void 0){console.log("undefined send error"),o&&o({bytesSent:0,error:"undefined"});return}if(t.connectionType==="tcp"&&l.resultCode<0){t.errorHandler(l.resultCode,"send");return}if(t.bytesSent+=l.bytesSent,o&&o(l),t.outputBuffer.shift(),t.outputBuffer.length){if(t.outputBuffer.length>100){let a=0;for(;t.outputBuffer.length>100;)t.outputBuffer.pop(),a++;console.log(`${t.connectionType}: send buffer overflowing, dropped: ${a} ${entries}`)}r()}else t.transmitting=!1})}t.transmitting||(t.transmitting=!0,r())},onReceive:{listeners:[],addListener:function(n){(Sn.connectionType==="serial"?chrome.serial:chrome.sockets.tcp).onReceive.addListener(n),this.listeners.push(n)},removeListener:function(n){const e=Sn.connectionType==="serial"?chrome.serial:chrome.sockets.tcp;for(let t=this.listeners.length-1;t>=0;t--)if(this.listeners[t]==n){e.onReceive.removeListener(n),this.listeners.splice(t,1);break}}},onReceiveError:{listeners:[],addListener:function(n){(Sn.connectionType==="serial"?chrome.serial:chrome.sockets.tcp).onReceiveError.addListener(n),this.listeners.push(n)},removeListener:function(n){const e=Sn.connectionType==="serial"?chrome.serial:chrome.sockets.tcp;for(let t=this.listeners.length-1;t>=0;t--)if(this.listeners[t]==n){e.onReceiveError.removeListener(n),this.listeners.splice(t,1);break}}},emptyOutputBuffer:function(){this.outputBuffer=[],this.transmitting=!1},errorHandler:function(n,e){const t=this;t.connected=!1,FC.CONFIG.armingDisabled=!1;let r="error: UNDEFINED";if(t.connectionType==="tcp")switch(n){case-15:r="error: ERR_SOCKET_NOT_CONNECTED",console.log(`${t.connectionType}: ${e} ${r}: ${n}`),t.connectionId=!1;return;case-21:r="error: NETWORK_CHANGED";break;case-100:r="error: CONNECTION_CLOSED";break;case-102:r="error: CONNECTION_REFUSED";break;case-105:r="error: NAME_NOT_RESOLVED";break;case-106:r="error: INTERNET_DISCONNECTED";break;case-109:r="error: ADDRESS_UNREACHABLE";break}console.log(`${t.connectionType}: ${e} ${r}: ${n}`),GUI.connected_to||GUI.connecting_to?$("a.connect").click():t.disconnect()}};class vT{#e=pe(0);get down(){return b(this.#e)}set down(e){ce(this.#e,e,!0)}#i=pe(0);get up(){return b(this.#i)}set up(e){ce(this.#i,e,!0)}#s=0;#r=0;constructor(){this.timer=globalThis.setInterval(()=>{this.update()},1e3)}update(){Sn.bitrate?(this.down=100*(Sn.bytesReceived-this.#s)/(Sn.bitrate/8),this.up=100*(Sn.bytesSent-this.#r)/(Sn.bitrate/8),this.#s=Sn.bytesReceived,this.#r=Sn.bytesSent):(this.down=0,this.up=0)}reset(){this.#s=0,this.#r=0,this.down=0,this.up=0}}const jo=new vT;function ET(){V.resetState(),Object.assign(V.CONFIG,{targetName:"VirtualFC",name:"VirtualFC",buildVersion:CONFIGURATOR.virtualFwVersion,flightControllerVersion:CONFIGURATOR.virtualFwVersion,flightControllerIdentifier:"RTFL",apiVersion:CONFIGURATOR.virtualApiVersion,motorCount:1,servoCount:4,sampleRateHz:4e3,activeSensors:63}),Object.assign(V.ADVANCED_CONFIG,{pid_process_denom:2}),V.SERIAL_CONFIG.ports=new Array(6),V.SERIAL_CONFIG.ports[0]={identifier:20,auxChannelIndex:0,functions:["MSP"],msp_baudrate:115200,gps_baudrate:57600,telemetry_baudrate:"AUTO",blackbox_baudrate:115200};for(let n=1;n<V.SERIAL_CONFIG.ports.length;n++)V.SERIAL_CONFIG.ports[n]={identifier:n-1,auxChannelIndex:0,functions:[],msp_baudrate:115200,gps_baudrate:57600,telemetry_baudrate:"AUTO",blackbox_baudrate:115200};V.SERIAL_CONFIG.ports[1].functionMask=64,V.SERIAL_CONFIG.ports[2].functionMask=1024,V.SERIAL_CONFIG.ports[3].functionMask=2,V.FEATURE_CONFIG.features.RX_SERIAL=!0,V.FEATURE_CONFIG.features.TELEMETRY=!0,Object.assign(V.RX_CONFIG,{serialrx_provider:9}),Object.assign(V.RC_CONFIG,{rc_center:1500,rc_deflection:510,rc_arm_throttle:1e3,rc_min_throttle:1070,rc_max_throttle:2e3,rc_deadband:2,rc_yaw_deadband:2}),Object.assign(V.ANALOG,{rssi:700}),V.RC_MAP=[0,1,3,2,5,4,6,7],Object.assign(V.TELEMETRY_CONFIG,{crsf_telemetry_mode:1,crsf_telemetry_rate:500,crsf_telemetry_ratio:8,telemetry_sensors_list:[4,5,6,7,8]}),V.RC={channels:new Array(16).fill(1500),active_channels:16},V.RX_CHANNELS=new Array(16).fill(1500),V.RC_COMMAND=new Array(16).fill(0),Object.assign(V.RX_CONFIG,{rx_pulse_min:885,rx_pulse_max:2115});for(let n=0;n<16;n++)V.RXFAIL_CONFIG[n]={mode:n<5?0:1,value:1500};V.FEATURE_CONFIG.features.DYN_NOTCH=!0,V.FEATURE_CONFIG.features.RPM_FILTER=!0,Object.assign(V.FILTER_CONFIG,{dyn_notch_count:6,dyn_notch_q:20,dyn_notch_min_hz:50,dyn_notch_max_hz:200,rpm_preset:2,rpm_min_hz:20}),V.MOTOR_DATA=new Array(8),Object.assign(V.MOTOR_CONFIG,{mincommand:1e3,minthrottle:1070,maxthrottle:2e3,motor_pwm_protocol:0,motor_pwm_rate:250,motor_poles:[8,8,8,8],motor_rpm_lpf:[0,0,0,0],use_dshot_telemetry:!1,use_unsynced_pwm:!1,main_rotor_gear_ratio:[1,9],tail_rotor_gear_ratio:[1,5]}),V.FEATURE_CONFIG.features.ESC_SENSOR=!0,V.FEATURE_CONFIG.features.FREQ_SENSOR=!0,Object.assign(V.ESC_SENSOR_CONFIG,{protocol:1}),Object.assign(V.GOVERNOR,{gov_mode:3,gov_handover_throttle:20,gov_spoolup_min_throttle:5,gov_zero_throttle_timeout:30,gov_lost_headspeed_timeout:10,gov_startup_time:200,gov_spoolup_time:100,gov_tracking_time:20,gov_recovery_time:20,gov_autorotation_timeout:0,gov_autorotation_bailout_time:0,gov_autorotation_min_entry_time:50,gov_rpm_filter:10,gov_pwr_filter:5,gov_tta_filter:0,gov_ff_filter:10}),Object.assign(V.MOTOR_TELEMETRY_DATA,{rpm:[1e4],voltage:[11e3],current:[15e3],temperature:[250],temperature2:[250],invalidPercent:[500]}),Object.assign(V.BLACKBOX,{blackboxDevice:1,blackboxMode:2,supported:!0,blackboxGracePeriod:5,blackboxDenom:2,blackboxRollingErase:1}),Object.assign(V.DATAFLASH,{ready:!0,supported:!0,sectors:1024,totalSize:128*1024*1024,usedSize:64*1024*1024}),Object.assign(V.SDCARD,{supported:!1,state:1,freeSizeKB:1024,totalSizeKB:2048}),Object.assign(V.DEBUG_CONFIG,{debugMode:0,debugAxis:0,debugModeCount:83}),V.BEEPER_CONFIG.beepers=new Beepers(V.CONFIG),V.BEEPER_CONFIG.dshotBeaconConditions=new Beepers(V.CONFIG,["RX_LOST","RX_SET"]),V.MIXER_CONFIG.mixer=3,V.SERVO_CONFIG=new Array(8);for(let n=0;n<V.SERVO_CONFIG.length;n++)V.SERVO_CONFIG[n]={mid:1500,min:-700,max:700,rneg:500,rpos:500,rate:333,speed:0,flags:0};V.ADJUSTMENT_RANGES=new Array(42);for(let n=0;n<V.ADJUSTMENT_RANGES.length;n++)V.ADJUSTMENT_RANGES[n]={adjFunction:0,enaChannel:0,enaRange:{start:1500,end:1500},adjChannel:0,adjRange1:{start:1500,end:1500},adjRange2:{start:1500,end:1500},adjMin:0,adjMax:100,adjStep:1};V.LED_STRIP=new Array(256);for(let n=0;n<V.LED_STRIP.length;n++)V.LED_STRIP[n]={x:0,y:0,functions:["c"],color:0,directions:[],parameters:0};Object.assign(V.ANALOG,{voltage:12,mAhdrawn:1200,amperage:3}),V.BATTERY_CONFIG={vbatmincellvoltage:1,vbatmaxcellvoltage:4,vbatwarningcellvoltage:3,capacity:1e4,voltageMeterSource:1,currentMeterSource:1},V.BATTERY_STATE={cellCount:10,voltage:20,mAhDrawn:1e3,amperage:3},V.SENSOR_CONFIG={acc_hardware:1,baro_hardware:1,mag_hardware:1},V.AUX_CONFIG=["ARM","ANGLE","HORIZON","TRAINER","ALTHOLD","RESCUE","GPSRESCUE","FAILSAFE","PREARM","PARALYZE","BEEPERON","BEEPERMUTE","LEDLOW","CALIB","OSD","TELEMETRY","BEEPGPSCOUNT","BLACKBOX","BLACKBOXERASE","CAMERA1","CAMERA2","CAMERA3","VTXPITMODE","VTXCONTROLDISABLE","STICKCOMMANDDISABLE","USER1","USER2","USER3","USER4"],V.AUX_CONFIG_IDS=[0,1,2,4,5,6,7,8,12,13,15,17,19,20,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,39,40,41,42,43,44,45,46,47,48,49],V.MIXER_INPUTS=[{rate:0,min:0,max:0},{rate:0,min:0,max:0},{rate:0,min:0,max:0},{rate:0,min:0,max:0},{rate:0,min:0,max:0}],V.PID_PROFILE.pid_mode=3,V.RC_TUNING.rates_type=4}async function Dd(){if(GUI.connect_lock!=!0){const n=$(this),e=n.data("clicks"),t=function(){n.data("clicks",!e)};GUI.configuration_loaded=!1;const r=parseInt($("div#port-picker #baud").val()),i=$("div#port-picker #port option:selected");let o;i.data().isManual?o=$("#port-override").val():o=String($("div#port-picker #port").val()),i.data().isDFU?$("select#baud").hide():o!=="0"&&(e?($("div#flashbutton a.flash_state").hasClass("active")&&$("div#flashbutton a.flash").hasClass("active")&&($("div#flashbutton a.flash_state").removeClass("active"),$("div#flashbutton a.flash").removeClass("active")),GUI.timeout_kill_all(),GUI.interval_kill_all(),await new Promise(s=>GUI.tab_switch_cleanup(s)),GUI.tab_switch_in_progress=!1,await new Promise(s=>globalThis.mspHelper.setArmingEnabled(!0,s)),RT()):(console.log(`${serial.connectionType}: connecting to: ${o}`),GUI.connecting_to=o,$("div#port-picker #port, div#port-picker #baud, div#port-picker #delay").prop("disabled",!0),$("div.connect_controls div.connect_state").text(i18n.getMessage("connecting")),i.data().isVirtual?(CONFIGURATOR.virtualMode=!0,CONFIGURATOR.virtualApiVersion=$("#firmware-version-dropdown :selected").val(),CONFIGURATOR.virtualFwVersion=$("#firmware-version-dropdown :selected").data("fw"),serial.connect("virtual",{},IT)):serial.connect(o,{bitrate:r},FT)),t())}}function ST(){GUI.updateManualPortVisibility=function(){const n=$("div#port-picker #port option:selected");n.data().isManual?$("#port-override-option").show():$("#port-override-option").hide(),n.data().isVirtual?$("#firmware-virtual-option").show():$("#firmware-virtual-option").hide(),n.data().isDFU?$("select#baud").hide():$("select#baud").show()},GUI.updateManualPortVisibility(),$("#port-override").on("change",function(){it({portOverride:$("#port-override").val()})}),$("#port-override").val(We("portOverride")),$("div#port-picker #port").on("change",async function(){GUI.updateManualPortVisibility();var n=$("option:selected",this);const e=n.data().requestPermission;e?(e(GUI.show_all_ports),$(this).val($(this).data("current"))):$(this).data("current",$(this).val())}),$("div.connect_controls a.connect").on("click",function(){Dd.call(this)}),$("div.open_firmware_flasher a.flash").on("click",function(){$("div#flashbutton a.flash_state").hasClass("active")&&$("div#flashbutton a.flash").hasClass("active")?($("div#flashbutton a.flash_state").removeClass("active"),$("div#flashbutton a.flash").removeClass("active"),$("#tabs ul.mode-disconnected .tab_landing a").trigger("click")):($("#tabs ul.mode-disconnected .tab_firmware_flasher a").trigger("click"),$("div#flashbutton a.flash_state").addClass("active"),$("div#flashbutton a.flash").addClass("active"))}),We("auto_connect")??!0?(GUI.auto_connect=!0,$("input.auto_connect").prop("checked",!0),$("input.auto_connect, span.auto_connect").prop("title",i18n.getMessage("autoConnectEnabled")),$("select#baud").val(115200).prop("disabled",!0)):(GUI.auto_connect=!1,$("input.auto_connect").prop("checked",!1),$("input.auto_connect, span.auto_connect").prop("title",i18n.getMessage("autoConnectDisabled"))),$("input.auto_connect").change(function(){GUI.auto_connect=$(this).is(":checked"),GUI.auto_connect?($("input.auto_connect, span.auto_connect").prop("title",i18n.getMessage("autoConnectEnabled")),$("select#baud").val(115200).prop("disabled",!0)):($("input.auto_connect, span.auto_connect").prop("title",i18n.getMessage("autoConnectDisabled")),!GUI.connected_to&&!GUI.connecting_to&&$("select#baud").prop("disabled",!1)),it({auto_connect:GUI.auto_connect})}),GUI.operating_system==="Android"?(GUI.show_all_ports=!0,$("div #show-all-ports-switch").hide()):(We("show_all_ports")?(GUI.show_all_ports=!0,$("input.show_all_ports, span.show_all_ports").prop("title",i18n.getMessage("showAllPortsEnabled")),$("input.show_all_ports").prop("checked",!0)):(GUI.show_all_ports=!1,$("input.show_all_ports, span.show_all_ports").prop("title",i18n.getMessage("showAllPortsDisabled")),$("input.show_all_ports").prop("checked",!1)),$("input.show_all_ports").on("change",function(){GUI.show_all_ports=$(this).is(":checked"),GUI.show_all_ports?$("input.show_all_ports, span.show_all_ports").prop("title",i18n.getMessage("showAllPortsEnabled")):$("input.show_all_ports, span.show_all_ports").prop("title",i18n.getMessage("showAllPortsDisabled")),it({show_all_ports:GUI.show_all_ports}),PortHandler.showAllPorts(GUI.show_all_ports)})),PortHandler.initialize(GUI.show_all_ports)}function RT(){GUI.isCordova()&&UI_PHONES.reset();const n=CONFIGURATOR.connectionValid;$("#dialogResetToCustomDefaults")[0].close(),serial.disconnect(NT),MSP.disconnect_cleanup(),jo.reset(),FC.resetState(),GUI.reboot_in_progress=!1,GUI.connected_to=!1,GUI.allowedTabs=GUI.defaultAllowedTabsWhenDisconnected.slice(),$("#dialogReportProblems-closebtn").trigger("click"),$("div#port-picker #port").prop("disabled",!1),GUI.auto_connect||$("div#port-picker #baud").prop("disabled",!1),$("div.connect_controls a.connect").removeClass("active"),$("div.connect_controls div.connect_state").text(i18n.getMessage("connect")),Jr(0),n&&$("#content").empty(),$("#tabs .tab_landing a").trigger("click")}function tm(){GUI.timeout_add("connecting",function(){CONFIGURATOR.connectionValid||(GUI.log(i18n.getMessage("noConfigurationReceived")),$("div.connect_controls a.connect").trigger("click"))},1e4)}function nm(){GUI.timeout_remove("connecting")}async function FT(n){if(n){CONFIGURATOR.virtualMode=!1,GUI.connected_to=GUI.connecting_to,GUI.connecting_to=!1,GUI.log(i18n.getMessage("serialPortOpened",serial.connectionType==="serial"?[serial.connectionId]:[n.socketId])),it({last_used_port:GUI.connected_to}),serial.onReceive.addListener(sm),tm(),FC.resetState(),globalThis.mspHelper=new MspHelper,MSP.listen(globalThis.mspHelper.process_data.bind(globalThis.mspHelper)),console.log("Requesting configuration data");try{await MSP.promise(MSPCodes.MSP_API_VERSION,!1);const{API_VERSION_MIN_SUPPORTED:e,API_VERSION_MAX_SUPPORTED:t}=CONFIGURATOR,{apiVersion:r}=FC.CONFIG;if(GUI.log(i18n.getMessage("apiVersionReceived",[r])),_e.valid(r)){if(!_e.gte(r,e)||!_e.lte(r,t))throw bu("firmwareVersionNotSupported")}else throw mh("apiVersionInvalid",r);await MSP.promise(MSPCodes.MSP_FC_VARIANT,!1);const{flightControllerIdentifier:i}=FC.CONFIG;if(i!=="RTFL")throw bu("firmwareTypeNotSupported");await MSP.promise(MSPCodes.MSP_FC_VERSION,!1),await MSP.promise(MSPCodes.MSP_BUILD_INFO,!1);const{FW_VERSION_MIN_SUPPORTED:o,FW_VERSION_MAX_SUPPORTED:s}=CONFIGURATOR,{buildVersion:l,buildRevision:a,buildInfo:c}=FC.CONFIG;if(GUI.log(i18n.getMessage("firmwareInfoReceived",[i,l])),GUI.log(i18n.getMessage("buildInfoReceived",[a,c])),_e.valid(l)){if(!_e.gte(l,o)||!_e.lte(l,s))throw bu("firmwareVersionNotSupported")}else throw mh("firmwareVersionInvalid",l);await MSP.promise(MSPCodes.MSP_BOARD_INFO,!1),im()}catch(e){console.error("Error during connection:",e),GUI.log(e)}}else GUI.log(i18n.getMessage("serialPortOpenFail")),console.log("Failed to open serial port"),bT()}function bu(n,...e){const t=rm(n,e);return MT(),t}function mh(n,...e){const t=rm(n,e);return $("div.connect_controls a.connect").trigger("click"),t}function rm(n,...e){const t=i18n.getMessage(n,e),r=$(".dialogConnectWarning")[0];return $(".dialogConnectWarning-content").html(t),$(".dialogConnectWarning-closebtn").on("click",function(){r.close()}),r.showModal(),t}function IT(){GUI.connected_to=GUI.connecting_to,GUI.connecting_to=!1,CONFIGURATOR.connectionValid=!0,globalThis.mspHelper=new MspHelper,ET(),im(),lm(),Jr(FC.CONFIG.activeSensors),updateTabList(FC.FEATURE_CONFIG.features)}function bT(){$("div#connectbutton div.connect_state").text(i18n.getMessage("connect")),$("div#connectbutton a.connect").removeClass("active"),$("div#port-picker #port, div#port-picker #baud, div#port-picker #delay").prop("disabled",!1),$("div#connectbutton a.connect").data("clicks",!1)}function im(){if(GUI.log(i18n.getMessage("boardInfoReceived",[FC.getHardwareName(),FC.CONFIG.boardVersion])),FC.CONFIG.configurationState==FC.CONFIGURATION_STATES.DEFAULTS_BARE&&Zt(FC.CONFIG.targetCapabilities,FC.TARGET_CAPABILITIES_FLAGS.SUPPORTS_CUSTOM_DEFAULTS)&&Zt(FC.CONFIG.targetCapabilities,FC.TARGET_CAPABILITIES_FLAGS.HAS_CUSTOM_DEFAULTS)){const n=$("#dialogResetToCustomDefaults")[0];$("#dialogResetToCustomDefaults-acceptbtn").off("click").on("click",async()=>{$("#dialogResetToCustomDefaults-acceptbtn").off("click"),$("#dialogResetToCustomDefaults-cancelbtn").off("click"),n.close(),await MSP.promise(MSPCodes.MSP_RESET_CONF,[globalThis.mspHelper.RESET_TYPES.CUSTOM_DEFAULTS]),GUI.timeout_add("disconnect",function(){$("div.connect_controls a.connect").trigger("click")},0)}),$("#dialogResetToCustomDefaults-cancelbtn").off("click").on("click",()=>{$("#dialogResetToCustomDefaults-acceptbtn").off("click"),$("#dialogResetToCustomDefaults-cancelbtn").off("click"),n.close(),tm(),Ch()}),nm(),n.showModal();return}Ch()}async function Ch(){const n=$("#dialogReportProblems-listItemTemplate");function e(i,o){return Zt(FC.CONFIG.configurationProblems,FC.CONFIGURATION_PROBLEM_FLAGS[i])?(n.clone().html(i18n.getMessage(`reportProblemsDialog${i}`)).appendTo(o),!0):!1}await MSP.promise(MSPCodes.MSP_STATUS,!1);let t=!1;const r=$("#dialogReportProblems-list");if(r.empty(),_e.gt(FC.CONFIG.apiVersion,CONFIGURATOR.API_VERSION_MAX_SUPPORTED)&&(n.clone().html(i18n.getMessage("reportProblemsDialogAPI_VERSION_MAX_SUPPORTED",[CONFIGURATOR.latestVersion,CONFIGURATOR.latestVersionReleaseUrl,CONFIGURATOR.version,FC.CONFIG.buildVersion])).appendTo(r),t=!0),FC.CONFIG.configurationState==FC.CONFIGURATION_STATES.DEFAULTS_BARE&&Zt(FC.CONFIG.targetCapabilities,FC.TARGET_CAPABILITIES_FLAGS.SUPPORTS_CUSTOM_DEFAULTS)&&!Zt(FC.CONFIG.targetCapabilities,FC.TARGET_CAPABILITIES_FLAGS.HAS_CUSTOM_DEFAULTS)&&(n.clone().html(i18n.getMessage("reportProblemsDialogUNIFIED_FIRMWARE_WITHOUT_DEFAULTS")).appendTo(r),t=!0),Qr(FC.CONFIG.activeSensors,"acc")&&(t=e("ACC_NEEDS_CALIBRATION",r)||t),t){const i=$("#dialogReportProblems")[0];$("#dialogReportProblems-closebtn").off("click").on("click",()=>{$("#dialogReportProblems-closebtn").off("click"),i.close()}),i.showModal(),$("#dialogReportProblems").scrollTop(0),$("#dialogReportProblems-closebtn").trigger("focus")}await TT(),await OT(),await PT(),AT()}async function TT(){await MSP.promise(MSPCodes.MSP_UID,!1);const n=FC.CONFIG.uid[0].toString(16)+FC.CONFIG.uid[1].toString(16)+FC.CONFIG.uid[2].toString(16);GUI.log(i18n.getMessage("uniqueDeviceIdReceived",[n]))}async function OT(){await MSP.promise(MSPCodes.MSP_NAME,!1),GUI.log(i18n.getMessage("craftNameReceived",[FC.CONFIG.name]))}async function PT(){await MSP.promise(MSPCodes.MSP_SET_RTC,globalThis.mspHelper.crunch(MSPCodes.MSP_SET_RTC)),GUI.log(i18n.getMessage("realTimeClockSet"))}function AT(){CONFIGURATOR.connectionValid=!0,GUI.reboot_in_progress=!1,GUI.allowedTabs=GUI.defaultAllowedFCTabsWhenConnected.slice(),GUI.isCordova()&&UI_PHONES.reset(),om(),GUI.selectDefaultTabWhenConnected()}function MT(){CONFIGURATOR.connectionValid=!0,GUI.allowedTabs=["cli"],om(),$("#tabs .tab_cli a").trigger("click")}async function om(){console.log("On connnection"),$("div#flashbutton a.flash_state").hasClass("active")&&$("div#flashbutton a.flash").hasClass("active")&&($("div#flashbutton a.flash_state").removeClass("active"),$("div#flashbutton a.flash").removeClass("active")),nm(),$("div#connectbutton div.connect_state").text(i18n.getMessage("disconnect")).addClass("active"),$("div#connectbutton a.connect").addClass("active"),$("#tabs ul.mode-disconnected").hide(),$("#tabs ul.mode-connected-cli").show(),$("#tabs ul.mode-connected li").hide(),$("#tabs ul.mode-connected li").filter(function(){const r=$(this).attr("class").split(/\s+/);let i=!1;return $.each(GUI.allowedTabs,(o,s)=>{const l=`tab_${s}`;$.inArray(l,r)>=0&&(i=!0)}),FC.CONFIG.boardType==0&&r.indexOf("osd-required")>=0&&(i=!1),i}).show(),FC.CONFIG.flightControllerVersion!==""&&(FC.BEEPER_CONFIG.beepers=new Beepers(FC.CONFIG),FC.BEEPER_CONFIG.dshotBeaconConditions=new Beepers(FC.CONFIG,["RX_LOST","RX_SET"]),$("#tabs ul.mode-connected").show(),await new Promise(r=>setTimeout(r,100)),await MSP.promise(MSPCodes.MSP_FEATURE_CONFIG,!1),await MSP.promise(MSPCodes.MSP_BATTERY_CONFIG,!1),await MSP.promise(MSPCodes.MSP_STATUS,!1),await MSP.promise(MSPCodes.MSP_DATAFLASH_SUMMARY,!1),(FC.CONFIG.boardType==0||FC.CONFIG.boardType==2)&&am()),$("#sensor-status").show(),$("#portsinput").hide(),$("#dataflash_wrapper_global").show()}function NT(n){n?GUI.log(i18n.getMessage("serialPortClosedOk")):GUI.log(i18n.getMessage("serialPortClosedFail")),$("#tabs ul.mode-connected").hide(),$("#tabs ul.mode-connected-cli").hide(),$("#tabs ul.mode-disconnected").show(),$("#sensor-status").hide(),$("#portsinput").show(),$("#dataflash_wrapper_global").hide(),$("#quad-status_wrapper").hide(),MSP.clearListeners(),CONFIGURATOR.connectionValid=!1,CONFIGURATOR.cliEngineValid=!1,CONFIGURATOR.cliEngineActive=!1,CONFIGURATOR.cliTab=""}function sm(n){if(!CONFIGURATOR.cliEngineActive)MSP.read(n);else switch(CONFIGURATOR.cliTab){case"cli":TABS.cli.read(n);break;case"presets":TABS.presets.read(n);break}}function Jr(n){if(Jr.previous_sensors_detected||(Jr.previous_sensors_detected=-1),Jr.previous_sensors_detected==n)return;Jr.previous_sensors_detected=n;const e=$("div#sensor-status");Qr(n,"acc")?($(".accel",e).addClass("on"),$(".accicon",e).addClass("active")):($(".accel",e).removeClass("on"),$(".accicon",e).removeClass("active")),(FC.CONFIG.boardType==0||FC.CONFIG.boardType==2)&&Qr(n,"gyro")?($(".gyro",e).addClass("on"),$(".gyroicon",e).addClass("active")):($(".gyro",e).removeClass("on"),$(".gyroicon",e).removeClass("active")),Qr(n,"baro")?($(".baro",e).addClass("on"),$(".baroicon",e).addClass("active")):($(".baro",e).removeClass("on"),$(".baroicon",e).removeClass("active")),Qr(n,"mag")?($(".mag",e).addClass("on"),$(".magicon",e).addClass("active")):($(".mag",e).removeClass("on"),$(".magicon",e).removeClass("active")),Qr(n,"gps")?($(".gps",e).addClass("on"),$(".gpsicon",e).addClass("active")):($(".gps",e).removeClass("on"),$(".gpsicon",e).removeClass("active"))}function Qr(n,e){switch(e){case"acc":return Zt(n,0);case"baro":return Zt(n,1);case"mag":return Zt(n,2);case"gps":return Zt(n,3);case"sonar":return Zt(n,4);case"gyro":return Zt(n,5)}return!1}function am(){GUI.timeout_add("data_refresh",function(){xT()},100)}function xT(){const n=$("#quad-status_wrapper");$(".quad-status-contents").css({display:"inline-block"}),GUI.active_tab!="cli"&&GUI.active_tab!="presets"&&MSP.promise(MSPCodes.MSP_BOXNAMES,!1).then(()=>MSP.promise(MSPCodes.MSP_STATUS,!1)).then(()=>MSP.promise(MSPCodes.MSP_BATTERY_STATE,!1));for(let l=0;l<FC.AUX_CONFIG.length;l++)FC.AUX_CONFIG[l]==="ARM"&&(Zt(FC.CONFIG.mode,l)?$(".armedicon").addClass("active"):$(".armedicon").removeClass("active")),FC.AUX_CONFIG[l]==="FAILSAFE"&&(Zt(FC.CONFIG.mode,l)?$(".failsafeicon").addClass("active"):$(".failsafeicon").removeClass("active"));const e=FC.BATTERY_STATE.cellCount,t=FC.BATTERY_CONFIG.vbatmincellvoltage*e,r=FC.BATTERY_CONFIG.vbatmaxcellvoltage*e,i=FC.BATTERY_CONFIG.vbatwarningcellvoltage*e;FC.BATTERY_STATE.voltage<1.8?($(".battery-status").removeClass("state-empty").addClass("state-ok").removeClass("state-warning"),$(".battery-status").css({width:"0%"})):FC.BATTERY_STATE.voltage<t?($(".battery-status").addClass("state-empty").removeClass("state-ok").removeClass("state-warning"),$(".battery-status").css({width:"100%"})):($(".battery-status").css({width:`${(FC.BATTERY_STATE.voltage-t)/(r-t)*100}%`}),FC.BATTERY_STATE.voltage<i?$(".battery-status").addClass("state-warning").removeClass("state-empty").removeClass("state-ok"):$(".battery-status").addClass("state-ok").removeClass("state-warning").removeClass("state-empty")),Date.now()-MSP.last_received_timestamp<300?$(".linkicon").addClass("active"):$(".linkicon").removeClass("active"),n.show(),GUI.timeout_remove("data_refresh"),am()}function yT(n,e){return 255&n>>8*e}function Zt(n,e){return(n>>e)%2!=0}function wT(n,e){return n|1<<e}function GT(n,e){return n&~(1<<e)}function lm(){function n(t){if(t<1024)return t+"B";const r=t/1024;return r<1024?Math.round(r)+"kB":(r/1024).toFixed(1)+"MB"}FC.DATAFLASH.totalSize>0?($(".noflash_global").css({display:"none"}),$(".dataflash-contents_global").css({display:"block"}),$(".dataflash-free_global").css({width:100-(FC.DATAFLASH.totalSize-FC.DATAFLASH.usedSize)/FC.DATAFLASH.totalSize*100+"%",display:"block"}),$(".dataflash-free_global div").text("Dataflash: free "+n(FC.DATAFLASH.totalSize-FC.DATAFLASH.usedSize))):($(".noflash_global").css({display:"block"}),$(".dataflash-contents_global").css({display:"none"}))}function rl(n){CONFIGURATOR.virtualMode||(GUI.reboot_in_progress=!0),n?.()}const LT=Object.freeze(Object.defineProperty({__proto__:null,bit_check:Zt,bit_clear:GT,bit_set:wT,handleConnectClick:Dd,have_sensor:Qr,initializeSerialBackend:ST,read_serial:sm,reinitialiseConnection:rl,sensor_status:Jr,specificByte:yT,update_dataflash_global:lm},Symbol.toStringTag,{value:"Module"}));globalThis.TABS={};jQuery(cm);function cm(){$(".connect_b a.connect").removeClass("disabled"),$(".firmware_b a.flash").removeClass("disabled"),i18n.init().then(function(){um(),initializeSerialBackend()})}function $T(){const n=serial.connectionId;if(n&&qe.connectionValid&&!qe.virtualMode){let e=new ArrayBuffer(5),t=new Uint8Array(e);t[0]=101,t[1]=120,t[2]=105,t[3]=116,t[4]=13;const r=serial.connectionType==="serial"?chrome.serial.send:chrome.sockets.tcp.send;r(n,e,function(){console.log("Send exit")}),setTimeout(function(){e=new ArrayBuffer(22),t=new Uint8Array(e);let i=0;t[0]=36,t[1]=77,t[2]=60,t[3]=16,t[4]=214,i=t[3]^t[4];for(let o=0;o<16;o+=2)t[o+5]=FC.MOTOR_CONFIG.mincommand&255,t[o+6]=FC.MOTOR_CONFIG.mincommand>>8,i^=t[o+5],i^=t[o+6];t[21]=i,r(n,e,function(){serial.disconnect()})},100)}else n&&serial.disconnect()}function vh(){GUI.isCordova()||this.hide(),$T(),GUI.isCordova()||this.close(!0)}function um(){if(i18n.localizePage(),GUI.log(i18n.getMessage("infoVersions",{operatingSystem:GUI.operating_system,configuratorVersion:`${qe.version} (${qe.gitChangesetId})`})),GUI.isNWJS()){let t=GUI.nwGui.Window.get();t.on("new-win-policy",function(r,i,o){o.ignore(),GUI.nwGui.Shell.openExternal(i)}),t.on("close",vh)}else GUI.isCordova()&&(window.addEventListener("beforeunload",vh),document.addEventListener("backbutton",function(t){t.preventDefault(),navigator.notification.confirm(i18n.getMessage("cordovaExitAppMessage"),function(r){r===1&&navigator.app.exitApp()},i18n.getMessage("cordovaExitAppTitle"),[i18n.getMessage("yes"),i18n.getMessage("no")])}));$(".connect_b a.connect").removeClass("disabled"),GUI.isInstalled()&&fm(),document.createElement("canvas"),console.log(`Libraries: jQuery - ${$.fn.jquery}`),GUI.isCordova()&&UI_PHONES.init();const n=$("#tabs > ul");$("a",n).click(function(){if($(this).parent().hasClass("active")===!1&&!GUI.tab_switch_in_progress){const r=this,i=$(r).parent().prop("class"),o=$(r).parent().hasClass("mode-connected");var t=i.substring(4);if(GUI.connect_lock){GUI.log(i18n.getMessage("tabSwitchWaitForOperation"));return}if(o&&!qe.connectionValid){GUI.log(i18n.getMessage("tabSwitchConnectionRequired"));return}GUI.tab_switch_allowed(async function(){GUI.allowedTabs.indexOf(t)<0&&t==="firmware_flasher"&&(GUI.connected_to||GUI.connecting_to?await Dd.call($("a.connect")):r.disconnect(),$("div.open_firmware_flasher a.flash").click()),GUI.defaultAllowedFCTabsWhenConnected.indexOf(t)!=-1&&GUI.saveDefaultTab(t),GUI.tab_switch_cleanup(function(){$("div#flashbutton a.flash_state").hasClass("active")&&$("div#flashbutton a.flash").hasClass("active")&&($("div#flashbutton a.flash_state").removeClass("active"),$("div#flashbutton a.flash").removeClass("active")),$("li",n).removeClass("active");const s=$("#content");if(s.empty(),$("#cache .data-loading").clone().appendTo(s),$(r).parent().addClass("active"),TABS[t]&&!GUI.reboot_in_progress){let l=function(){a.initialize(function(){GUI.tab_switch_in_progress=!1})};const a=TABS[t];GUI.active_tab=t,GUI.current_tab=a,GUI.tab_switch_in_progress=!0,GUI.connected_to?mspHelper.setArmingEnabled(a.armingEnabled===!0&&FC.CONFIG.enableArmingFlag===!0,l):l()}else GUI.active_tab=null,GUI.current_tab=null,GUI.tab_switch_in_progress=!1})})}}),$("#tabs ul.mode-disconnected li a:first").click();const e=We("zoomLevel");if(e&&GUI.set_zoom(e,!1),$(document).on("wheel",function(t){let s=GUI.zoom_level;t.ctrlKey&&(t.originalEvent.deltaY>0?s=Math.min(s-10,200):s=Math.max(s+10,50),GUI.set_zoom(s,!0))}),$("#content").on("keydown",'input[type="number"]',function(t){[96,97,98,99,100,101,102,103,104,105,48,49,50,51,52,53,54,55,56,57,109,189,190,110,37,38,39,40,8,46,9,13].indexOf(t.keyCode)===-1&&t.preventDefault()}),$("#content").on("focus",'input[type="number"]',function(){const t=$(this),r=t.val();isNaN(r)||t.data("previousValue",parseFloat(r))}),$("#content").on("change",'input[type="number"]',function(){const t=$(this),r=il(t);t.val(r)}),$("#showlog").on("click",function(){let t=$(this).data("state");t?(setTimeout(function(){const r=$("div#log");r.scrollTop($("div.wrapper",r).height())},200),$("#log").removeClass("active"),$("#tab-content-container").removeClass("logopen"),$("#scrollicon").removeClass("active"),it({logopen:!1}),t=!1):($("#log").addClass("active"),$("#tab-content-container").addClass("logopen"),$("#scrollicon").addClass("active"),it({logopen:!0}),t=!0),$(this).text(t?i18n.getMessage("logActionHide"):i18n.getMessage("logActionShow")),$(this).data("state",t)}),We("logopen")&&$("#showlog").trigger("click"),qe.expertMode=We("expertMode")??!1,$("#expert-mode input").on("change",function(){qe.expertMode=this.checked,it({expertMode:this.checked})}).prop("checked",qe.expertMode),CliAutoComplete.setEnabled(We("cliAutoComplete")??!0),dm(We("darkTheme")??2),GUI.isCordova()){let t=!1;setInterval(function(){cordova.plugins.ThemeDetection.isDarkModeEnabled(function(i){i.value!==t&&(t=i.value,DarkTheme.autoSet())})},500)}else window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",function(){DarkTheme.autoSet()})}function dm(n){DarkTheme.setConfig(n)}function fm(){new ReleaseChecker("configurator","https://api.github.com/repos/rotorflight/rotorflight-configurator/releases").loadReleaseData(DT)}function DT(n){const e=n.filter(function(r){var i=/release\/(.*)/,o=i.exec(r.tag_name);return o&&(r.release=_e.valid(o[1]),r.release&&(!_e.prerelease(r.release)||We("checkForConfiguratorUnstableVersions")))?r:null}).sort(function(r,i){return _e.compare(i.release,r.release)});e.length>0&&(qe.latestVersion=e[0].release,qe.latestVersionReleaseUrl=e[0].html_url,console.log(`Latest Configurator version is ${qe.latestVersion}`));function t(r,i){const o=$(".dialogConfiguratorUpdate")[0];$(".dialogConfiguratorUpdate-content").html(r),$(".dialogConfiguratorUpdate-closebtn").click(function(){o.close()}),$(".dialogConfiguratorUpdate-websitebtn").click(function(){o.close(),window.open(i,"_blank")}),o.showModal()}if(qe.version.startsWith("0.0.0")){const r=i18n.getMessage("configuratorDevelopmentNotice");t(r,qe.allReleasesUrl)}else if(_e.lt(qe.version,qe.latestVersion)){const r=i18n.getMessage("configuratorUpdateNotice",[qe.latestVersion,qe.latestVersionReleaseUrl]);t(r,qe.latestVersionReleaseUrl)}}function kT(n){$("#tabs ul.mode-connected li.tab_gps").toggle(n.isEnabled("GPS")),$("#tabs ul.mode-connected li.tab_led_strip").toggle(n.isEnabled("LED_STRIP"))}function Ro(n,e){let t=String(n);for(;t.length<e;)t=`0${n}`;return t}function il(n){const e=$(n),t=parseFloat(e.prop("step"))||1,r=parseFloat(e.prop("min")),i=parseFloat(e.prop("max"));let o=parseFloat(e.val());isNaN(o)&&(o=e.data("previousValue")||0),e.prop("min")&&o<r&&(o=r),e.prop("max")&&o>i&&(o=i);const s=t%1===0?0:String(t).split(".")[1].length;return o=(Math.round(o/t)*t).toFixed(s),o}function UT(n,e=1){return Math.round(il(n)*e)}function BT(n,e=1){return il(n)*e}function VT(n){return JSON.parse(JSON.stringify(n))}function HT(n,e){const t=new Date;let r=n;FC.CONFIG&&(FC.CONFIG.flightControllerIdentifier&&(r=`${FC.CONFIG.flightControllerIdentifier}_${r}`),FC.CONFIG.name&&FC.CONFIG.name.trim()!==""&&(r=`${r}_${FC.CONFIG.name.trim().replace(" ","_")}`));const i=`${t.getFullYear()}${Ro(t.getMonth()+1,2)}${Ro(t.getDate(),2)}`,o=`${Ro(t.getHours(),2)}${Ro(t.getMinutes(),2)}${Ro(t.getSeconds(),2)}`;return r=`${r}_${i}_${o}`,`${r}.${e}`}function XT(n){const e=$(".dialogError")[0];$(".dialogError-content").html(n),$(".dialogError-closebtn").click(function(){e.close()}),e.showModal()}function YT(n,e){const t=$(".dialogTabExit")[0];function r(){$(".tabExitSaveBtn").off("click"),$(".tabExitRevertBtn").off("click"),$(".tabExitCancelBtn").off("click"),t.close()}$(".tabExitSaveBtn").click(function(){r(),n.save(e)}),$(".tabExitRevertBtn").click(function(){r(),n.revert(e)}),$(".tabExitCancelBtn").click(function(){r()}),t.showModal()}const zT=Object.freeze(Object.defineProperty({__proto__:null,appReady:cm,checkForConfiguratorUpdates:fm,deep_copy:VT,generateFilename:HT,getFloatValue:BT,getIntegerValue:UT,getNumberInput:il,setDarkTheme:dm,showErrorDialog:XT,showTabExitDialog:YT,startProcess:um,updateTabList:kT},Symbol.toStringTag,{value:"Module"}));let WT=0;const Zr={symbols:{BEGIN:36,PROTO_V1:77,PROTO_V2:88,FROM_MWC:62,TO_MWC:60,UNSUPPORTED:33},constants:{PROTOCOL_V1:1,PROTOCOL_V2:2,JUMBO_FRAME_MIN_SIZE:255},decoder_states:{IDLE:0,PROTO_IDENTIFIER:1,DIRECTION_V1:2,DIRECTION_V2:3,FLAG_V2:4,PAYLOAD_LENGTH_V1:5,PAYLOAD_LENGTH_JUMBO_LOW:6,PAYLOAD_LENGTH_JUMBO_HIGH:7,PAYLOAD_LENGTH_V2_LOW:8,PAYLOAD_LENGTH_V2_HIGH:9,CODE_V1:10,CODE_JUMBO_V1:11,CODE_V2_LOW:12,CODE_V2_HIGH:13,PAYLOAD_V1:14,PAYLOAD_V2:15,CHECKSUM_V1:16,CHECKSUM_V2:17},state:0,message_direction:1,code:0,dataView:0,message_length_expected:0,message_length_received:0,message_buffer:null,message_buffer_uint8_view:null,message_checksum:0,messageIsJumboFrame:!1,crcError:!1,callbacks:[],packet_error:WT,unsupported:0,last_received_timestamp:null,listeners:[],JUMBO_FRAME_SIZE_LIMIT:255,SDCARD_STATE_NOT_PRESENT:0,SDCARD_STATE_FATAL:1,SDCARD_STATE_CARD_INIT:2,SDCARD_STATE_FS_INIT:3,SDCARD_STATE_READY:4,read(n){if(CONFIGURATOR.virtualMode)return;const e=new Uint8Array(n.data);for(const t of e)switch(this.state){case this.decoder_states.IDLE:t===this.symbols.BEGIN&&(this.state=this.decoder_states.PROTO_IDENTIFIER);break;case this.decoder_states.PROTO_IDENTIFIER:switch(t){case this.symbols.PROTO_V1:this.state=this.decoder_states.DIRECTION_V1;break;case this.symbols.PROTO_V2:this.state=this.decoder_states.DIRECTION_V2;break;default:console.log(`Unknown protocol char ${String.fromCharCode(t)}`),this.state=this.decoder_states.IDLE}break;case this.decoder_states.DIRECTION_V1:case this.decoder_states.DIRECTION_V2:switch(this.unsupported=0,t){case this.symbols.FROM_MWC:this.message_direction=1;break;case this.symbols.TO_MWC:this.message_direction=0;break;case this.symbols.UNSUPPORTED:this.unsupported=1;break}this.state=this.state===this.decoder_states.DIRECTION_V1?this.decoder_states.PAYLOAD_LENGTH_V1:this.decoder_states.FLAG_V2;break;case this.decoder_states.FLAG_V2:this.state=this.decoder_states.CODE_V2_LOW;break;case this.decoder_states.PAYLOAD_LENGTH_V1:this.message_length_expected=t,this.message_length_expected===this.constants.JUMBO_FRAME_MIN_SIZE?this.state=this.decoder_states.CODE_JUMBO_V1:(this._initialize_read_buffer(),this.state=this.decoder_states.CODE_V1);break;case this.decoder_states.PAYLOAD_LENGTH_V2_LOW:this.message_length_expected=t,this.state=this.decoder_states.PAYLOAD_LENGTH_V2_HIGH;break;case this.decoder_states.PAYLOAD_LENGTH_V2_HIGH:this.message_length_expected|=t<<8,this._initialize_read_buffer(),this.state=this.message_length_expected>0?this.decoder_states.PAYLOAD_V2:this.decoder_states.CHECKSUM_V2;break;case this.decoder_states.CODE_V1:case this.decoder_states.CODE_JUMBO_V1:this.code=t,this.message_length_expected>0?this.state===this.decoder_states.CODE_JUMBO_V1?this.state=this.decoder_states.PAYLOAD_LENGTH_JUMBO_LOW:this.state=this.decoder_states.PAYLOAD_V1:this.state=this.decoder_states.CHECKSUM_V1;break;case this.decoder_states.CODE_V2_LOW:this.code=t,this.state=this.decoder_states.CODE_V2_HIGH;break;case this.decoder_states.CODE_V2_HIGH:this.code|=t<<8,this.state=this.decoder_states.PAYLOAD_LENGTH_V2_LOW;break;case this.decoder_states.PAYLOAD_LENGTH_JUMBO_LOW:this.message_length_expected=t,this.state=this.decoder_states.PAYLOAD_LENGTH_JUMBO_HIGH;break;case this.decoder_states.PAYLOAD_LENGTH_JUMBO_HIGH:this.message_length_expected|=t<<8,this._initialize_read_buffer(),this.state=this.decoder_states.PAYLOAD_V1;break;case this.decoder_states.PAYLOAD_V1:case this.decoder_states.PAYLOAD_V2:this.message_buffer_uint8_view[this.message_length_received]=t,this.message_length_received++,this.message_length_received>=this.message_length_expected&&(this.state=this.state===this.decoder_states.PAYLOAD_V1?this.decoder_states.CHECKSUM_V1:this.decoder_states.CHECKSUM_V2);break;case this.decoder_states.CHECKSUM_V1:this.message_length_expected>=this.constants.JUMBO_FRAME_MIN_SIZE?this.message_checksum=this.constants.JUMBO_FRAME_MIN_SIZE:this.message_checksum=this.message_length_expected,this.message_checksum^=this.code,this.message_length_expected>=this.constants.JUMBO_FRAME_MIN_SIZE&&(this.message_checksum^=this.message_length_expected&255,this.message_checksum^=(this.message_length_expected&65280)>>8);for(let r=0;r<this.message_length_received;r++)this.message_checksum^=this.message_buffer_uint8_view[r];this._dispatch_message(t);break;case this.decoder_states.CHECKSUM_V2:this.message_checksum=0,this.message_checksum=this.crc8_dvb_s2(this.message_checksum,0),this.message_checksum=this.crc8_dvb_s2(this.message_checksum,this.code&255),this.message_checksum=this.crc8_dvb_s2(this.message_checksum,(this.code&65280)>>8),this.message_checksum=this.crc8_dvb_s2(this.message_checksum,this.message_length_expected&255),this.message_checksum=this.crc8_dvb_s2(this.message_checksum,(this.message_length_expected&65280)>>8);for(let r=0;r<this.message_length_received;r++)this.message_checksum=this.crc8_dvb_s2(this.message_checksum,this.message_buffer_uint8_view[r]);this._dispatch_message(t);break;default:console.log(`Unknown state detected: ${this.state}`)}this.last_received_timestamp=Date.now()},_initialize_read_buffer(){this.message_buffer=new ArrayBuffer(this.message_length_expected),this.message_buffer_uint8_view=new Uint8Array(this.message_buffer)},_dispatch_message(n){this.message_checksum===n?this.dataView=new DataView(this.message_buffer,0,this.message_length_expected):(this.packet_error++,this.crcError=!0,this.dataView=new DataView(new ArrayBuffer(0))),this.notify(),this.message_length_received=0,this.state=0,this.messageIsJumboFrame=!1,this.crcError=!1},notify(){const n=this;n.listeners.forEach(function(e){e(n)})},listen(n){this.listeners.indexOf(n)==-1&&this.listeners.push(n)},clearListeners(){this.listeners=[]},crc8_dvb_s2(n,e){n^=e;for(let t=0;t<8;t++)n&128?n=n<<1&255^213:n=n<<1&255;return n},crc8_dvb_s2_data(n,e,t){let r=0;for(let i=e;i<t;i++)r=this.crc8_dvb_s2(r,n[i]);return r},encode_message_v1(n,e){let t;if(e){const r=e.length+6;let i=0;t=new ArrayBuffer(r);let o=new Uint8Array(t);o[0]=36,o[1]=77,o[2]=60,o[3]=e.length,o[4]=n,i=o[3]^o[4];for(let s=0;s<e.length;s++)o[s+5]=e[s],i^=o[s+5];o[5+e.length]=i}else{t=new ArrayBuffer(6);let r=new Uint8Array(t);r[0]=36,r[1]=77,r[2]=60,r[3]=0,r[4]=n,r[5]=r[3]^r[4]}return t},encode_message_v2(n,e){const t=e?e.length:0,r=t+9,i=new ArrayBuffer(r),o=new Uint8Array(i);o[0]=36,o[1]=88,o[2]=60,o[3]=0,o[4]=n&255,o[5]=n>>8&255,o[6]=t&255,o[7]=t>>8&255;for(let s=0;s<t;s++)o[8+s]=e[s];return o[r-1]=this.crc8_dvb_s2_data(o,3,r-1),i},send_message(n,e,t,r,i){if(CONFIGURATOR.virtualMode){r&&r();return}if(n===void 0)return;let o;n<=254?o=this.encode_message_v1(n,e):o=this.encode_message_v2(n,e);const s={code:n,requestBuffer:o,callback:r||!1,timer:!1,callbackOnError:i};let l=!1;for(const a of Zr.callbacks)if(a.code===n){l=!0;break}return l||(s.timer=setInterval(function(){if(console.log(`MSP data request timed-out: ${n} direction: ${Zr.message_direction} tab: ${GUI.active_tab}`),!serial.connected||CONFIGURATOR.cliEngineActive){console.log("Cancelling MSP request");const a=Zr.callbacks.findIndex(s);Zr.callbacks.splice(a,1),clearInterval(s.timer),i&&s.callback?.();return}serial.send(o,!1)},2500)),Zr.callbacks.push(s),(e||!l)&&serial.send(o,function(a){a.bytesSent==o.byteLength&&t&&t()}),!0},promise(n,e){const t=this;return new Promise(function(r){t.send_message(n,e,!1,function(i){r(i)})})},callbacks_cleanup(){for(let n=0;n<this.callbacks.length;n++)clearInterval(this.callbacks[n].timer);this.callbacks=[]},disconnect_cleanup(){this.state=0,this.packet_error=0,this.callbacks_cleanup()}},lt={MSP_API_VERSION:1,MSP_FC_VARIANT:2,MSP_FC_VERSION:3,MSP_BOARD_INFO:4,MSP_BUILD_INFO:5,MSP_NAME:10,MSP_SET_NAME:11,MSP_BATTERY_CONFIG:32,MSP_SET_BATTERY_CONFIG:33,MSP_MODE_RANGES:34,MSP_SET_MODE_RANGE:35,MSP_FEATURE_CONFIG:36,MSP_SET_FEATURE_CONFIG:37,MSP_BOARD_ALIGNMENT_CONFIG:38,MSP_SET_BOARD_ALIGNMENT_CONFIG:39,MSP_CURRENT_METER_CONFIG:40,MSP_SET_CURRENT_METER_CONFIG:41,MSP_MIXER_CONFIG:42,MSP_SET_MIXER_CONFIG:43,MSP_RX_CONFIG:44,MSP_SET_RX_CONFIG:45,MSP_LED_COLORS:46,MSP_SET_LED_COLORS:47,MSP_LED_STRIP_CONFIG:48,MSP_SET_LED_STRIP_CONFIG:49,MSP_RSSI_CONFIG:50,MSP_SET_RSSI_CONFIG:51,MSP_ADJUSTMENT_RANGES:52,MSP_SET_ADJUSTMENT_RANGE:53,MSP_SERIAL_CONFIG:54,MSP_SET_SERIAL_CONFIG:55,MSP_VOLTAGE_METER_CONFIG:56,MSP_SET_VOLTAGE_METER_CONFIG:57,MSP_SONAR:58,MSP_DEBUG_CONFIG:59,MSP_SET_DEBUG_CONFIG:60,MSP_ARMING_CONFIG:61,MSP_SET_ARMING_CONFIG:62,MSP_RX_MAP:64,MSP_SET_RX_MAP:65,MSP_RC_CONFIG:66,MSP_SET_RC_CONFIG:67,MSP_SET_REBOOT:68,MSP_BF_BUILD_INFO:69,MSP_DATAFLASH_SUMMARY:70,MSP_DATAFLASH_READ:71,MSP_DATAFLASH_ERASE:72,MSP_TELEMETRY_CONFIG:73,MSP_SET_TELEMETRY_CONFIG:74,MSP_FAILSAFE_CONFIG:75,MSP_SET_FAILSAFE_CONFIG:76,MSP_RXFAIL_CONFIG:77,MSP_SET_RXFAIL_CONFIG:78,MSP_SDCARD_SUMMARY:79,MSP_BLACKBOX_CONFIG:80,MSP_SET_BLACKBOX_CONFIG:81,MSP_TRANSPONDER_CONFIG:82,MSP_SET_TRANSPONDER_CONFIG:83,MSP_OSD_CONFIG:84,MSP_SET_OSD_CONFIG:85,MSP_OSD_CHAR_READ:86,MSP_OSD_CHAR_WRITE:87,MSP_ADVANCED_CONFIG:90,MSP_SET_ADVANCED_CONFIG:91,MSP_FILTER_CONFIG:92,MSP_SET_FILTER_CONFIG:93,MSP_PID_PROFILE:94,MSP_SET_PID_PROFILE:95,MSP_SENSOR_CONFIG:96,MSP_SET_SENSOR_CONFIG:97,MSP_ARMING_DISABLE:99,MSP_STATUS:101,MSP_RAW_IMU:102,MSP_SERVO:103,MSP_MOTOR:104,MSP_RC:105,MSP_RAW_GPS:106,MSP_COMP_GPS:107,MSP_ATTITUDE:108,MSP_ALTITUDE:109,MSP_ANALOG:110,MSP_RC_TUNING:111,MSP_PID_TUNING:112,MSP_RC_COMMAND:113,MSP_RX_CHANNELS:114,MSP_BOXNAMES:116,MSP_PIDNAMES:117,MSP_WP:118,MSP_BOXIDS:119,MSP_SERVO_CONFIGURATIONS:120,MSP_ESC_SENSOR_CONFIG:123,MSP_MOTOR_3D_CONFIG:124,MSP_SENSOR_ALIGNMENT:126,MSP_LED_STRIP_MODECOLOR:127,MSP_VOLTAGE_METERS:128,MSP_CURRENT_METERS:129,MSP_BATTERY_STATE:130,MSP_MOTOR_CONFIG:131,MSP_GPS_CONFIG:132,MSP_GPS_RESCUE:135,MSP_MOTOR_TELEMETRY:139,MSP_HELI_CONFIG:140,MSP_SET_HELI_CONFIG:141,MSP_GOVERNOR_CONFIG:142,MSP_SET_GOVERNOR_CONFIG:143,MSP_RPM_FILTER:144,MSP_SET_RPM_FILTER:145,MSP_RESCUE_PROFILE:146,MSP_SET_RESCUE_PROFILE:147,MSP_GOVERNOR_PROFILE:148,MSP_SET_GOVERNOR_PROFILE:149,MSP_LED_STRIP_SETTINGS:150,MSP_SET_LED_STRIP_SETTINGS:151,MSP_RPM_FILTER_V2:154,MSP_SET_RPM_FILTER_V2:155,MSP_UID:160,MSP_GPS_SV_INFO:164,MSP_MIXER_INPUTS:170,MSP_SET_MIXER_INPUT:171,MSP_MIXER_RULES:172,MSP_SET_MIXER_RULE:173,MSP_DISPLAYPORT:182,MSP_COPY_PROFILE:183,MSP_BEEPER_CONFIG:184,MSP_SET_BEEPER_CONFIG:185,MSP_MIXER_OVERRIDE:190,MSP_SET_MIXER_OVERRIDE:191,MSP_SERVO_OVERRIDE:192,MSP_SET_SERVO_OVERRIDE:193,MSP_MOTOR_OVERRIDE:194,MSP_SET_MOTOR_OVERRIDE:195,MSP_SET_RAW_RC:200,MSP_SET_RAW_GPS:201,MSP_SET_PID_TUNING:202,MSP_SET_RC_TUNING:204,MSP_ACC_CALIBRATION:205,MSP_MAG_CALIBRATION:206,MSP_RESET_CONF:208,MSP_SET_WP:209,MSP_SELECT_SETTING:210,MSP_SET_HEADING:211,MSP_SET_SERVO_CONFIGURATION:212,MSP_SET_MOTOR:214,MSP_SET_ESC_SENSOR_CONFIG:216,MSP_SET_MOTOR_3D_CONFIG:217,MSP_SET_RESET_CURR_PID:219,MSP_SET_SENSOR_ALIGNMENT:220,MSP_SET_LED_STRIP_MODECOLOR:221,MSP_SET_MOTOR_CONFIG:222,MSP_SET_GPS_CONFIG:223,MSP_SET_GPS_RESCUE:225,MSP_MULTIPLE_MSP:230,MSP_MODE_RANGES_EXTRA:238,MSP_SET_ACC_TRIM:239,MSP_ACC_TRIM:240,MSP_SERVO_MIX_RULES:241,MSP_SET_SERVO_MIX_RULE:242,MSP_SET_4WAY_IF:245,MSP_SET_RTC:246,MSP_RTC:247,MSP_SET_BOARD_INFO:248,MSP_SET_SIGNATURE:249,MSP_EEPROM_WRITE:250,MSP_DEBUGMSG:253,MSP_DEBUG:254,MSP2_BETAFLIGHT_BIND:12288,MSP2_MOTOR_OUTPUT_REORDERING:12289,MSP2_SET_MOTOR_OUTPUT_REORDERING:12290,MSP2_SEND_DSHOT_COMMAND:12291},ed=["n","e","s","w","u","d"],td=["c","f","a","l","s","g","r"],nd=["t","o","b","v","i","w","k","d"];function De(){const n=this;n.BAUD_RATES=["AUTO","9600","19200","38400","57600","115200","230400","250000","400000","460800","500000","921600","1000000","1500000","2000000","2470000"],n.SERIAL_PORT_FUNCTIONS={MSP:0,GPS:1,TELEMETRY_FRSKY:2,TELEMETRY_HOTT:3,TELEMETRY_MSP:4,TELEMETRY_LTM:4,TELEMETRY_SMARTPORT:5,RX_SERIAL:6,BLACKBOX:7,TELEMETRY_MAVLINK:9,ESC_SENSOR:10,TBS_SMARTAUDIO:11,TELEMETRY_IBUS:12,IRC_TRAMP:13,RUNCAM_DEVICE_CONTROL:14,LIDAR_TF:15,FRSKY_OSD:16,SBUS_OUT:18},n.REBOOT_TYPES={FIRMWARE:0,BOOTLOADER:1,MSC:2,MSC_UTC:3},n.RESET_TYPES={BASE_DEFAULTS:0,CUSTOM_DEFAULTS:1},n.SIGNATURE_LENGTH=32,n.CRSF_TELEMETRY_SENSOR_LENGTH=40,n.mspMultipleCache=[]}De.prototype.process_data=function(n){const e=this,t=n.dataView,r=n.code,i=n.crcError;let o=[],s="",l=0;if(i)console.warn(`code: ${r} - crc failed`);else if(n.unsupported)console.log("FC reports unsupported message error: "+r),r===MSPCodes.MSP_SET_REBOOT&&TABS.blackbox.mscRebootFailedCallback();else switch(r){case MSPCodes.MSP_STATUS:{FC.CONFIG.pidCycleTime=t.readU16(),FC.CONFIG.gyroCycleTime=t.readU16(),FC.CONFIG.activeSensors=t.readU16(),FC.CONFIG.mode=t.readU32(),t.readU8(),FC.CONFIG.rtLoadRaw=t.readU16(),FC.CONFIG.rtLoad=Math.floor(FC.CONFIG.rtLoadRaw/10),FC.CONFIG.cpuLoadRaw=t.readU16(),FC.CONFIG.cpuLoad=Math.floor(FC.CONFIG.cpuLoadRaw/10);const a=t.readU8();for(let c=0;c<a;c++)t.readU8();FC.CONFIG.armingDisableCount=t.readU8(),FC.CONFIG.armingDisableFlags=t.readU32(),FC.CONFIG.extraFlags=t.readU8(),FC.CONFIG.configurationState=t.readU8(),FC.CONFIG.profile=t.readU8(),FC.CONFIG.numProfiles=t.readU8(),FC.CONFIG.rateProfile=t.readU8(),FC.CONFIG.numRateProfiles=t.readU8(),FC.CONFIG.motorCount=t.readU8(),FC.CONFIG.servoCount=t.readU8(),FC.CONFIG.gyroDetectionFlags=t.readU8(),sensor_status(FC.CONFIG.activeSensors);break}case MSPCodes.MSP_RAW_IMU:{FC.SENSOR_DATA.accelerometer[0]=t.read16()/512,FC.SENSOR_DATA.accelerometer[1]=t.read16()/512,FC.SENSOR_DATA.accelerometer[2]=t.read16()/512,FC.SENSOR_DATA.gyroscope[0]=t.read16()*(4/16.4),FC.SENSOR_DATA.gyroscope[1]=t.read16()*(4/16.4),FC.SENSOR_DATA.gyroscope[2]=t.read16()*(4/16.4),FC.SENSOR_DATA.magnetometer[0]=t.read16()/1090,FC.SENSOR_DATA.magnetometer[1]=t.read16()/1090,FC.SENSOR_DATA.magnetometer[2]=t.read16()/1090;break}case MSPCodes.MSP_SERVO:{const a=t.byteLength/2;for(let c=0;c<a;c++)FC.SERVO_DATA[c]=t.readU16();break}case MSPCodes.MSP_SERVO_OVERRIDE:{const a=t.byteLength/2;for(let c=0;c<a;c++)FC.SERVO_OVERRIDE[c]=t.read16();break}case MSPCodes.MSP_MOTOR:{const a=t.byteLength/2;for(let c=0;c<a;c++)FC.MOTOR_DATA[c]=t.read16();break}case MSPCodes.MSP_MOTOR_OVERRIDE:{const a=t.byteLength/2;for(let c=0;c<a;c++)FC.MOTOR_OVERRIDE[c]=t.read16();break}case MSPCodes.MSP2_MOTOR_OUTPUT_REORDERING:{FC.MOTOR_OUTPUT_ORDER=[];const a=t.read8();for(let c=0;c<a;c++)FC.MOTOR_OUTPUT_ORDER[c]=t.readU8();break}case MSPCodes.MSP_MOTOR_TELEMETRY:{const a=t.readU8();for(let c=0;c<a;c++)FC.MOTOR_TELEMETRY_DATA.rpm[c]=t.readU32(),FC.MOTOR_TELEMETRY_DATA.invalidPercent[c]=t.readU16(),FC.MOTOR_TELEMETRY_DATA.voltage[c]=t.readU16(),FC.MOTOR_TELEMETRY_DATA.current[c]=t.readU16(),FC.MOTOR_TELEMETRY_DATA.consumption[c]=t.readU16(),FC.MOTOR_TELEMETRY_DATA.temperature[c]=t.read16(),FC.MOTOR_TELEMETRY_DATA.temperature2[c]=t.read16();break}case MSPCodes.MSP_RC:{FC.RC.active_channels=t.byteLength/2;for(let a=0;a<FC.RC.active_channels;a++)FC.RC.channels[a]=t.readU16();break}case MSPCodes.MSP_RAW_GPS:{FC.GPS_DATA.fix=t.readU8(),FC.GPS_DATA.numSat=t.readU8(),FC.GPS_DATA.lat=t.read32(),FC.GPS_DATA.lon=t.read32(),FC.GPS_DATA.alt=t.readU16(),FC.GPS_DATA.speed=t.readU16(),FC.GPS_DATA.ground_course=t.readU16();break}case MSPCodes.MSP_COMP_GPS:{FC.GPS_DATA.distanceToHome=t.readU16(),FC.GPS_DATA.directionToHome=t.readU16(),FC.GPS_DATA.update=t.readU8();break}case MSPCodes.MSP_ATTITUDE:{FC.SENSOR_DATA.kinematics[0]=t.read16()/10,FC.SENSOR_DATA.kinematics[1]=t.read16()/10,FC.SENSOR_DATA.kinematics[2]=t.read16();break}case MSPCodes.MSP_ALTITUDE:{FC.SENSOR_DATA.altitude=parseFloat((t.read32()/100).toFixed(2));break}case MSPCodes.MSP_SONAR:{FC.SENSOR_DATA.sonar=t.read32();break}case MSPCodes.MSP_ANALOG:{FC.ANALOG.voltage=t.readU8()/10,FC.ANALOG.mAhdrawn=t.readU16(),FC.ANALOG.rssi=t.readU16(),FC.ANALOG.amperage=t.read16()/100,FC.ANALOG.voltage=t.readU16()/100;break}case MSPCodes.MSP_VOLTAGE_METERS:{FC.VOLTAGE_METERS=[];const a=3;for(let c=0;c<t.byteLength/a;c++){const u={id:t.readU8(),voltage:t.readU16()/1e3};FC.VOLTAGE_METERS.push(u)}break}case MSPCodes.MSP_CURRENT_METERS:{FC.CURRENT_METERS=[];const a=5;for(let c=0;c<t.byteLength/a;c++){const u={id:t.readU8(),amperage:t.readU16()/100,mAhDrawn:t.readU16()};FC.CURRENT_METERS.push(u)}break}case MSPCodes.MSP_BATTERY_STATE:{FC.BATTERY_STATE.batteryState=t.readU8(),FC.BATTERY_STATE.cellCount=t.readU8(),FC.BATTERY_STATE.capacity=t.readU16(),FC.BATTERY_STATE.mAhDrawn=t.readU16(),FC.BATTERY_STATE.voltage=t.readU16()/100,FC.BATTERY_STATE.amperage=t.readU16()/100,FC.BATTERY_STATE.chargeLevel=t.readU8();break}case MSPCodes.MSP_VOLTAGE_METER_CONFIG:{FC.VOLTAGE_METER_CONFIGS=[];const a=t.readU8();for(let c=0;c<a;c++){const u=t.readU8();if(u!==7)for(let p=0;p<u;p++)t.readU8();else{const p={id:t.readU8(),sensorType:t.readU8(),vbatscale:t.readU16(),vbatresdivval:t.readU16(),vbatresdivmultiplier:t.readU8()};FC.VOLTAGE_METER_CONFIGS.push(p)}}break}case MSPCodes.MSP_CURRENT_METER_CONFIG:{FC.CURRENT_METER_CONFIGS=[];const a=t.readU8();for(let c=0;c<a;c++){const u={},p=t.readU8();if(p!==6)for(let h=0;h<p;h++)t.readU8();else u.id=t.readU8(),u.sensorType=t.readU8(),u.scale=t.read16(),u.offset=t.read16(),FC.CURRENT_METER_CONFIGS.push(u)}break}case MSPCodes.MSP_BATTERY_CONFIG:{FC.BATTERY_CONFIG.capacity=t.readU16(),FC.BATTERY_CONFIG.cellCount=t.readU8(),FC.BATTERY_CONFIG.voltageMeterSource=t.readU8(),FC.BATTERY_CONFIG.currentMeterSource=t.readU8(),FC.BATTERY_CONFIG.vbatmincellvoltage=t.readU16()/100,FC.BATTERY_CONFIG.vbatmaxcellvoltage=t.readU16()/100,FC.BATTERY_CONFIG.vbatfullcellvoltage=t.readU16()/100,FC.BATTERY_CONFIG.vbatwarningcellvoltage=t.readU16()/100,FC.BATTERY_CONFIG.lvcPercentage=t.readU8(),FC.BATTERY_CONFIG.mahWarningPercentage=t.readU8();break}case MSPCodes.MSP_SET_BATTERY_CONFIG:{console.log("Battery configuration saved");break}case MSPCodes.MSP_RC_TUNING:{FC.RC_TUNING.rates_type=t.readU8(),FC.RC_TUNING.RC_RATE=parseFloat((t.readU8()/100).toFixed(2)),FC.RC_TUNING.RC_EXPO=parseFloat((t.readU8()/100).toFixed(2)),FC.RC_TUNING.roll_rate=parseFloat((t.readU8()/100).toFixed(2)),FC.RC_TUNING.roll_response_time=t.readU8(),FC.RC_TUNING.roll_accel_limit=t.readU16(),FC.RC_TUNING.rcPitchRate=parseFloat((t.readU8()/100).toFixed(2)),FC.RC_TUNING.RC_PITCH_EXPO=parseFloat((t.readU8()/100).toFixed(2)),FC.RC_TUNING.pitch_rate=parseFloat((t.readU8()/100).toFixed(2)),FC.RC_TUNING.pitch_response_time=t.readU8(),FC.RC_TUNING.pitch_accel_limit=t.readU16(),FC.RC_TUNING.rcYawRate=parseFloat((t.readU8()/100).toFixed(2)),FC.RC_TUNING.RC_YAW_EXPO=parseFloat((t.readU8()/100).toFixed(2)),FC.RC_TUNING.yaw_rate=parseFloat((t.readU8()/100).toFixed(2)),FC.RC_TUNING.yaw_response_time=t.readU8(),FC.RC_TUNING.yaw_accel_limit=t.readU16(),FC.RC_TUNING.rcCollectiveRate=parseFloat((t.readU8()/100).toFixed(2)),FC.RC_TUNING.RC_COLLECTIVE_EXPO=parseFloat((t.readU8()/100).toFixed(2)),FC.RC_TUNING.collective_rate=parseFloat((t.readU8()/100).toFixed(2)),FC.RC_TUNING.collective_response_time=t.readU8(),FC.RC_TUNING.collective_accel_limit=t.readU16(),_e.gte(FC.CONFIG.apiVersion,API_VERSION_12_8)&&(FC.RC_TUNING.roll_setpoint_boost_gain=t.readU8(),FC.RC_TUNING.roll_setpoint_boost_cutoff=t.readU8(),FC.RC_TUNING.pitch_setpoint_boost_gain=t.readU8(),FC.RC_TUNING.pitch_setpoint_boost_cutoff=t.readU8(),FC.RC_TUNING.yaw_setpoint_boost_gain=t.readU8(),FC.RC_TUNING.yaw_setpoint_boost_cutoff=t.readU8(),FC.RC_TUNING.collective_setpoint_boost_gain=t.readU8(),FC.RC_TUNING.collective_setpoint_boost_cutoff=t.readU8(),FC.RC_TUNING.yaw_dynamic_ceiling_gain=t.readU8(),FC.RC_TUNING.yaw_dynamic_deadband_gain=t.readU8(),FC.RC_TUNING.yaw_dynamic_deadband_filter=t.readU8());break}case MSPCodes.MSP_PID_TUNING:{for(let a=0;a<3;a++)for(let c=0;c<4;c++)FC.PIDS_ACTIVE[a][c]=t.readU16(),FC.PIDS[a][c]=FC.PIDS_ACTIVE[a][c];for(let a=0;a<3;a++)FC.PIDS_ACTIVE[a][4]=t.readU16(),FC.PIDS[a][4]=FC.PIDS_ACTIVE[a][4];for(let a=0;a<2;a++)FC.PIDS_ACTIVE[a][5]=t.readU16(),FC.PIDS[a][5]=FC.PIDS_ACTIVE[a][5];break}case MSPCodes.MSP_ARMING_CONFIG:{FC.ARMING_CONFIG.auto_disarm_delay=t.readU8();break}case MSPCodes.MSP_MOTOR_CONFIG:{FC.MOTOR_CONFIG.minthrottle=t.readU16(),FC.MOTOR_CONFIG.maxthrottle=t.readU16(),FC.MOTOR_CONFIG.mincommand=t.readU16(),t.readU8(),t.readU8(),FC.MOTOR_CONFIG.use_dshot_telemetry=t.readU8()!=0,FC.MOTOR_CONFIG.motor_pwm_protocol=t.readU8(),FC.MOTOR_CONFIG.motor_pwm_rate=t.readU16(),FC.MOTOR_CONFIG.use_unsynced_pwm=t.readU8()!=0;for(let a=0;a<4;a++)FC.MOTOR_CONFIG.motor_poles[a]=t.readU8();for(let a=0;a<4;a++)FC.MOTOR_CONFIG.motor_rpm_lpf[a]=t.readU8();for(let a=0;a<2;a++)FC.MOTOR_CONFIG.main_rotor_gear_ratio[a]=t.readU16();for(let a=0;a<2;a++)FC.MOTOR_CONFIG.tail_rotor_gear_ratio[a]=t.readU16();break}case MSPCodes.MSP_GPS_CONFIG:{FC.GPS_CONFIG.provider=t.readU8(),FC.GPS_CONFIG.ublox_sbas=t.readU8(),FC.GPS_CONFIG.auto_config=t.readU8(),FC.GPS_CONFIG.auto_baud=t.readU8(),FC.GPS_CONFIG.home_point_once=t.readU8(),FC.GPS_CONFIG.ublox_use_galileo=t.readU8();break}case MSPCodes.MSP_GPS_RESCUE:{FC.GPS_RESCUE.angle=t.readU16(),FC.GPS_RESCUE.initialAltitudeM=t.readU16(),FC.GPS_RESCUE.descentDistanceM=t.readU16(),FC.GPS_RESCUE.rescueGroundspeed=t.readU16(),FC.GPS_RESCUE.throttleMin=t.readU16(),FC.GPS_RESCUE.throttleMax=t.readU16(),FC.GPS_RESCUE.throttleHover=t.readU16(),FC.GPS_RESCUE.sanityChecks=t.readU8(),FC.GPS_RESCUE.minSats=t.readU8(),FC.GPS_RESCUE.ascendRate=t.readU16(),FC.GPS_RESCUE.descendRate=t.readU16(),FC.GPS_RESCUE.allowArmingWithoutFix=t.readU8(),FC.GPS_RESCUE.altitudeMode=t.readU8();break}case MSPCodes.MSP_RSSI_CONFIG:{FC.RSSI_CONFIG.channel=t.readU8(),FC.RSSI_CONFIG.scale=t.readU8(),FC.RSSI_CONFIG.invert=t.readU8(),FC.RSSI_CONFIG.offset=t.readU8();break}case MSPCodes.MSP_BOXNAMES:{FC.AUX_CONFIG=[],o=[];for(let a=0;a<t.byteLength;a++)s=t.readU8(),s==59?(FC.AUX_CONFIG.push(String.fromCharCode.apply(null,o)),o=[]):o.push(s);break}case MSPCodes.MSP_PIDNAMES:{for(let a=0;a<t.byteLength;a++)s=t.readU8();break}case MSPCodes.MSP_BOXIDS:{FC.AUX_CONFIG_IDS=[];for(let a=0;a<t.byteLength;a++)FC.AUX_CONFIG_IDS.push(t.readU8());break}case MSPCodes.MSP_SERVO_CONFIGURATIONS:{FC.SERVO_CONFIG=[];const a=t.readU8();if(t.byteLength==1+a*16)for(let c=1;c<t.byteLength;c+=16){const u={mid:t.readU16(),min:t.read16(),max:t.read16(),rneg:t.read16(),rpos:t.read16(),rate:t.read16(),speed:t.readU16(),flags:t.read16()};FC.SERVO_CONFIG.push(u)}break}case MSPCodes.MSP_ESC_SENSOR_CONFIG:{FC.ESC_SENSOR_CONFIG.protocol=t.readU8(),FC.ESC_SENSOR_CONFIG.half_duplex=!!t.readU8(),FC.ESC_SENSOR_CONFIG.update_hz=t.readU16(),FC.ESC_SENSOR_CONFIG.current_offset=t.readU16(),FC.ESC_SENSOR_CONFIG.hw4_current_offset=t.readU16(),FC.ESC_SENSOR_CONFIG.hw4_current_gain=t.readU8(),FC.ESC_SENSOR_CONFIG.hw4_voltage_gain=t.readU8(),_e.gte(FC.CONFIG.apiVersion,API_VERSION_12_7)&&(FC.ESC_SENSOR_CONFIG.pinswap=!!t.readU8()),_e.gte(FC.CONFIG.apiVersion,API_VERSION_12_8)&&(FC.ESC_SENSOR_CONFIG.voltage_correction=t.read8(),FC.ESC_SENSOR_CONFIG.current_correction=t.read8(),FC.ESC_SENSOR_CONFIG.consumption_correction=t.read8());break}case MSPCodes.MSP_SENSOR_ALIGNMENT:{FC.SENSOR_ALIGNMENT.gyro_1_align=t.readU8(),FC.SENSOR_ALIGNMENT.gyro_2_align=t.readU8(),FC.SENSOR_ALIGNMENT.align_mag=t.readU8();break}case MSPCodes.MSP_DISPLAYPORT:break;case MSPCodes.MSP_SET_RAW_RC:break;case MSPCodes.MSP_SET_PID_TUNING:{console.log("PID settings saved"),FC.PIDS_ACTIVE=FC.PIDS.map(a=>a.slice());break}case MSPCodes.MSP_SET_RC_TUNING:{console.log("RC Tuning saved");break}case MSPCodes.MSP_ACC_CALIBRATION:{console.log("Accel calibration executed");break}case MSPCodes.MSP_MAG_CALIBRATION:{console.log("Mag calibration executed");break}case MSPCodes.MSP_SET_MOTOR_CONFIG:{console.log("Motor Configuration saved");break}case MSPCodes.MSP_SET_GPS_CONFIG:{console.log("GPS Configuration saved");break}case MSPCodes.MSP_SET_GPS_RESCUE:{console.log("GPS Rescue Configuration saved");break}case MSPCodes.MSP_SET_RSSI_CONFIG:{console.log("RSSI Configuration saved");break}case MSPCodes.MSP_SET_FEATURE_CONFIG:{console.log("Features saved");break}case MSPCodes.MSP_SET_BEEPER_CONFIG:{console.log("Beeper Configuration saved");break}case MSPCodes.MSP_RESET_CONF:{console.log("Settings Reset");break}case MSPCodes.MSP_SELECT_SETTING:{console.log("Profile selected");break}case MSPCodes.MSP_SET_SERVO_CONFIGURATION:{console.log("Servo Configuration saved");break}case MSPCodes.MSP_SET_SERVO_OVERRIDE:{console.log("Servo Override set");break}case MSPCodes.MSP_EEPROM_WRITE:{console.log("Settings Saved in EEPROM");break}case MSPCodes.MSP_SET_CURRENT_METER_CONFIG:{console.log("Amperage Settings saved");break}case MSPCodes.MSP_SET_VOLTAGE_METER_CONFIG:{console.log("Voltage config saved");break}case MSPCodes.MSP_DEBUG:{for(let a=0;a<8;a++)FC.SENSOR_DATA.debug[a]=t.read32();break}case MSPCodes.MSP_SET_MOTOR_OVERRIDE:{console.log("Motor Override set");break}case MSPCodes.MSP_UID:{FC.CONFIG.uid[0]=t.readU32(),FC.CONFIG.uid[1]=t.readU32(),FC.CONFIG.uid[2]=t.readU32();break}case MSPCodes.MSP_ACC_TRIM:{FC.CONFIG.accelerometerTrims[0]=t.read16(),FC.CONFIG.accelerometerTrims[1]=t.read16();break}case MSPCodes.MSP_SET_ACC_TRIM:{console.log("Accelerometer trimms saved.");break}case MSPCodes.MSP_GPS_SV_INFO:{if(t.byteLength>0){const a=t.readU8();for(let c=0;c<a;c++)FC.GPS_DATA.chn[c]=t.readU8(),FC.GPS_DATA.svid[c]=t.readU8(),FC.GPS_DATA.quality[c]=t.readU8(),FC.GPS_DATA.cno[c]=t.readU8()}break}case MSPCodes.MSP_RX_MAP:{FC.RC_MAP=[];for(let a=0;a<t.byteLength;a++)FC.RC_MAP.push(t.readU8());break}case MSPCodes.MSP_SET_RX_MAP:{console.log("RCMAP saved");break}case MSPCodes.MSP_RC_CONFIG:{FC.RC_CONFIG.rc_center=t.readU16(),FC.RC_CONFIG.rc_deflection=t.readU16(),FC.RC_CONFIG.rc_arm_throttle=t.readU16(),FC.RC_CONFIG.rc_min_throttle=t.readU16(),FC.RC_CONFIG.rc_max_throttle=t.readU16(),FC.RC_CONFIG.rc_deadband=t.readU8(),FC.RC_CONFIG.rc_yaw_deadband=t.readU8();break}case MSPCodes.MSP_RX_CHANNELS:{for(let a=0;a<t.byteLength/2;a++)FC.RX_CHANNELS[a]=t.readU16();break}case MSPCodes.MSP_RC_COMMAND:{for(let a=0;a<t.byteLength/2;a++)FC.RC_COMMAND[a]=t.read16();break}case MSPCodes.MSP_MIXER_CONFIG:{FC.MIXER_CONFIG.main_rotor_dir=t.readU8(),FC.MIXER_CONFIG.tail_rotor_mode=t.readU8(),FC.MIXER_CONFIG.tail_motor_idle=t.readU8(),FC.MIXER_CONFIG.tail_center_trim=t.read16(),FC.MIXER_CONFIG.swash_type=t.readU8(),FC.MIXER_CONFIG.swash_ring=t.readU8(),FC.MIXER_CONFIG.swash_phase=t.read16(),FC.MIXER_CONFIG.blade_pitch_limit=t.readU16(),FC.MIXER_CONFIG.swash_trim[0]=t.read16(),FC.MIXER_CONFIG.swash_trim[1]=t.read16(),FC.MIXER_CONFIG.swash_trim[2]=t.read16(),FC.MIXER_CONFIG.coll_rpm_correction=t.readU8(),FC.MIXER_CONFIG.coll_geo_correction=t.read8(),_e.gte(FC.CONFIG.apiVersion,API_VERSION_12_8)&&(FC.MIXER_CONFIG.coll_tilt_correction_pos=t.read8(),FC.MIXER_CONFIG.coll_tilt_correction_neg=t.read8());break}case MSPCodes.MSP_FEATURE_CONFIG:{FC.FEATURE_CONFIG.features.bitfield=t.readU32(),updateTabList(FC.FEATURE_CONFIG.features);break}case MSPCodes.MSP_BEEPER_CONFIG:{FC.BEEPER_CONFIG.beepers.setDisabledMask(t.readU32()),FC.BEEPER_CONFIG.dshotBeaconTone=t.readU8(),FC.BEEPER_CONFIG.dshotBeaconConditions.setDisabledMask(t.readU32());break}case MSPCodes.MSP_BOARD_ALIGNMENT_CONFIG:{FC.BOARD_ALIGNMENT_CONFIG.roll=t.read16(),FC.BOARD_ALIGNMENT_CONFIG.pitch=t.read16(),FC.BOARD_ALIGNMENT_CONFIG.yaw=t.read16();break}case MSPCodes.MSP_SET_REBOOT:{const a=t.read8();if((a===e.REBOOT_TYPES.MSC||a===e.REBOOT_TYPES.MSC_UTC)&&t.read8()===0){console.log("Storage device not ready."),showErrorDialog(i18n.getMessage("storageDeviceNotReady"));break}console.log("Reboot request accepted");break}case MSPCodes.MSP_API_VERSION:{FC.CONFIG.mspProtocolVersion=t.readU8(),FC.CONFIG.apiVersion=t.readU8()+"."+t.readU8()+".0";break}case MSPCodes.MSP_FC_VARIANT:{let a="";for(let c=0;c<4;c++)a+=String.fromCharCode(t.readU8());FC.CONFIG.flightControllerIdentifier=a;break}case MSPCodes.MSP_FC_VERSION:{const a=t.readU8(),c=t.readU8(),u=t.readU8();FC.CONFIG.flightControllerVersionMajor=a,FC.CONFIG.flightControllerVersionMinor=c,FC.CONFIG.flightControllerVersionPatch=u,FC.CONFIG.flightControllerVersion=`${a}.${c}.${u}`;break}case MSPCodes.MSP_BUILD_INFO:{let a="";for(let d=0;d<11;d++)a+=String.fromCharCode(t.readU8());a+=" ";const u=8;for(let d=0;d<u;d++)a+=String.fromCharCode(t.readU8());FC.CONFIG.buildInfo=a;let p="";const h=7;for(let d=0;d<h;d++)p+=String.fromCharCode(t.readU8());FC.CONFIG.buildRevision=p;let g="";const f=t.readU8();for(let d=0;d<f;d++)g+=String.fromCharCode(t.readU8());FC.CONFIG.buildVersion=g;break}case MSPCodes.MSP_BOARD_INFO:{FC.CONFIG.boardName="",FC.CONFIG.boardDesign="",FC.CONFIG.boardIdentifier="",FC.CONFIG.targetName="",FC.CONFIG.manufacturerId="";for(let c=0;c<4;c++)FC.CONFIG.boardIdentifier+=String.fromCharCode(t.readU8());FC.CONFIG.boardVersion=t.readU16(),FC.CONFIG.boardType=t.readU8(),FC.CONFIG.targetCapabilities=t.readU8();let a=t.readU8();for(let c=0;c<a;c++)FC.CONFIG.targetName+=String.fromCharCode(t.readU8());a=t.readU8();for(let c=0;c<a;c++)FC.CONFIG.boardName+=String.fromCharCode(t.readU8());a=t.readU8();for(let c=0;c<a;c++)FC.CONFIG.boardDesign+=String.fromCharCode(t.readU8());a=t.readU8();for(let c=0;c<a;c++)FC.CONFIG.manufacturerId+=String.fromCharCode(t.readU8());FC.CONFIG.signature=[];for(let c=0;c<e.SIGNATURE_LENGTH;c++)FC.CONFIG.signature.push(t.readU8());FC.CONFIG.mcuTypeId=t.readU8(),FC.CONFIG.configurationState=t.readU8(),FC.CONFIG.sampleRateHz=t.readU16(),FC.CONFIG.configurationProblems=t.readU32();break}case MSPCodes.MSP_NAME:{for(FC.CONFIG.name="";(s=t.readU8())!==null;)FC.CONFIG.name+=String.fromCharCode(s);break}case MSPCodes.MSP_SET_CHANNEL_FORWARDING:{console.log("Channel forwarding saved");break}case MSPCodes.MSP_SERIAL_CONFIG:{FC.SERIAL_CONFIG.ports=[];const c=t.byteLength/9;for(let u=0;u<c;u++){const p=t.readU8(),h=t.readU32(),g=[t.readU8(),t.readU8(),t.readU8(),t.readU8()],f={identifier:p,functions:e.serialPortFunctionMaskToFunctions(h),functionMask:h,msp_baudrate:e.BAUD_RATES[g[0]],gps_baudrate:e.BAUD_RATES[g[1]],telemetry_baudrate:e.BAUD_RATES[g[2]],blackbox_baudrate:e.BAUD_RATES[g[3]]};FC.SERIAL_CONFIG.ports.push(f)}break}case MSPCodes.MSP_SET_SERIAL_CONFIG:{console.log("Serial config saved");break}case MSPCodes.MSP_MODE_RANGES:{FC.MODE_RANGES=[];const a=t.byteLength/4;for(let c=0;c<a;c++){const u={id:t.readU8(),auxChannelIndex:t.readU8(),range:{start:1500+t.read8()*5,end:1500+t.read8()*5}};FC.MODE_RANGES.push(u)}break}case MSPCodes.MSP_MODE_RANGES_EXTRA:{FC.MODE_RANGES_EXTRA=[];const a=t.readU8();for(let c=0;c<a;c++){const u={id:t.readU8(),modeLogic:t.readU8(),linkedTo:t.readU8()};FC.MODE_RANGES_EXTRA.push(u)}break}case MSPCodes.MSP_ADJUSTMENT_RANGES:{FC.ADJUSTMENT_RANGES=[];const a=t.byteLength/14;for(let c=0;c<a;c++){const u={adjFunction:t.readU8(),enaChannel:t.readU8(),enaRange:{start:1500+t.read8()*5,end:1500+t.read8()*5},adjChannel:t.readU8(),adjRange1:{start:1500+t.read8()*5,end:1500+t.read8()*5},adjRange2:{start:1500+t.read8()*5,end:1500+t.read8()*5},adjMin:t.read16(),adjMax:t.read16(),adjStep:t.readU8()};FC.ADJUSTMENT_RANGES.push(u)}break}case MSPCodes.MSP_RX_CONFIG:{FC.RX_CONFIG.serialrx_provider=t.readU8(),FC.RX_CONFIG.serialrx_inverted=t.readU8(),FC.RX_CONFIG.serialrx_halfduplex=t.readU8(),FC.RX_CONFIG.rx_pulse_min=t.readU16(),FC.RX_CONFIG.rx_pulse_max=t.readU16(),FC.RX_CONFIG.rxSpiProtocol=t.readU8(),FC.RX_CONFIG.rxSpiId=t.readU32(),FC.RX_CONFIG.rxSpiRfChannelCount=t.readU8(),_e.gte(FC.CONFIG.apiVersion,API_VERSION_12_7)&&(FC.RX_CONFIG.serialrx_pinswap=t.readU8());break}case MSPCodes.MSP_FAILSAFE_CONFIG:{FC.FAILSAFE_CONFIG.failsafe_delay=t.readU8(),FC.FAILSAFE_CONFIG.failsafe_off_delay=t.readU8(),FC.FAILSAFE_CONFIG.failsafe_throttle=t.readU16(),FC.FAILSAFE_CONFIG.failsafe_switch_mode=t.readU8(),FC.FAILSAFE_CONFIG.failsafe_throttle_low_delay=t.readU16(),FC.FAILSAFE_CONFIG.failsafe_procedure=t.readU8();break}case MSPCodes.MSP_RXFAIL_CONFIG:{FC.RXFAIL_CONFIG=[];const a=t.byteLength/3;for(let c=0;c<a;c++){const u={mode:t.readU8(),value:t.readU16()};FC.RXFAIL_CONFIG.push(u)}break}case MSPCodes.MSP_TELEMETRY_CONFIG:{if(FC.TELEMETRY_CONFIG.telemetry_inverted=t.readU8(),FC.TELEMETRY_CONFIG.telemetry_halfduplex=t.readU8(),FC.TELEMETRY_CONFIG.telemetry_sensors=t.readU32(),_e.gte(FC.CONFIG.apiVersion,API_VERSION_12_7)){FC.TELEMETRY_CONFIG.telemetry_pinswap=t.readU8(),FC.TELEMETRY_CONFIG.crsf_telemetry_mode=t.readU8(),FC.TELEMETRY_CONFIG.crsf_telemetry_rate=t.readU16(),FC.TELEMETRY_CONFIG.crsf_telemetry_ratio=t.readU16();const a=[];for(let c=0;c<e.CRSF_TELEMETRY_SENSOR_LENGTH;c++)a.push(t.readU8());FC.TELEMETRY_CONFIG.telemetry_sensors_list=a}break}case MSPCodes.MSP_ADVANCED_CONFIG:{FC.ADVANCED_CONFIG.gyro_sync_denom=t.readU8(),FC.ADVANCED_CONFIG.pid_process_denom=t.readU8();break}case MSPCodes.MSP_FILTER_CONFIG:{FC.FILTER_CONFIG.gyro_hardware_lpf=t.readU8(),FC.FILTER_CONFIG.gyro_lowpass_type=t.readU8(),FC.FILTER_CONFIG.gyro_lowpass_hz=t.readU16(),FC.FILTER_CONFIG.gyro_lowpass2_type=t.readU8(),FC.FILTER_CONFIG.gyro_lowpass2_hz=t.readU16(),FC.FILTER_CONFIG.gyro_notch_hz=t.readU16(),FC.FILTER_CONFIG.gyro_notch_cutoff=t.readU16(),FC.FILTER_CONFIG.gyro_notch2_hz=t.readU16(),FC.FILTER_CONFIG.gyro_notch2_cutoff=t.readU16(),FC.FILTER_CONFIG.gyro_lowpass_dyn_min_hz=t.readU16(),FC.FILTER_CONFIG.gyro_lowpass_dyn_max_hz=t.readU16(),FC.FILTER_CONFIG.dyn_notch_count=t.readU8(),FC.FILTER_CONFIG.dyn_notch_q=t.readU8(),FC.FILTER_CONFIG.dyn_notch_min_hz=t.readU16(),FC.FILTER_CONFIG.dyn_notch_max_hz=t.readU16(),t.remaining()>=2&&(FC.FILTER_CONFIG.rpm_preset=t.readU8(),FC.FILTER_CONFIG.rpm_min_hz=t.readU8());break}case MSPCodes.MSP_RPM_FILTER:{if(FC.RPM_FILTER_CONFIG=[],t.byteLength%6==0)for(let a=0;a<t.byteLength;a+=6)FC.RPM_FILTER_CONFIG.push({rpm_source:t.readU8(),rpm_ratio:t.readU16(),rpm_limit:t.readU16(),notch_q:t.readU8()});break}case MSPCodes.MSP_RPM_FILTER_V2:break;case MSPCodes.MSP_SET_RPM_FILTER:{console.log("RPM Filter settings saved");break}case MSPCodes.MSP_SET_PID_PROFILE:{console.log("PID Profile settings saved");break}case MSPCodes.MSP_SET_RESCUE_PROFILE:{console.log("Rescue Mode Profile settings saved");break}case MSPCodes.MSP_SET_GOVERNOR_PROFILE:{console.log("Governor PRofile settings saved");break}case MSPCodes.MSP_SET_GOVERNOR_CONFIG:{console.log("Governor settings saved");break}case MSPCodes.MSP_PID_PROFILE:{FC.PID_PROFILE.pid_mode=t.readU8(),FC.PID_PROFILE.error_decay_time_ground=t.readU8(),FC.PID_PROFILE.error_decay_time_cyclic=t.readU8(),FC.PID_PROFILE.error_decay_time_yaw=t.readU8(),FC.PID_PROFILE.error_decay_limit_cyclic=t.readU8(),FC.PID_PROFILE.error_decay_limit_yaw=t.readU8(),FC.PID_PROFILE.error_rotation=t.readU8(),FC.PID_PROFILE.errorLimitRoll=t.readU8(),FC.PID_PROFILE.errorLimitPitch=t.readU8(),FC.PID_PROFILE.errorLimitYaw=t.readU8(),FC.PID_PROFILE.gyroCutoffRoll=t.readU8(),FC.PID_PROFILE.gyroCutoffPitch=t.readU8(),FC.PID_PROFILE.gyroCutoffYaw=t.readU8(),FC.PID_PROFILE.dtermCutoffRoll=t.readU8(),FC.PID_PROFILE.dtermCutoffPitch=t.readU8(),FC.PID_PROFILE.dtermCutoffYaw=t.readU8(),FC.PID_PROFILE.itermRelaxType=t.readU8(),FC.PID_PROFILE.itermRelaxCutoffRoll=t.readU8(),FC.PID_PROFILE.itermRelaxCutoffPitch=t.readU8(),FC.PID_PROFILE.itermRelaxCutoffYaw=t.readU8(),FC.PID_PROFILE.yawStopGainCW=t.readU8(),FC.PID_PROFILE.yawStopGainCCW=t.readU8(),FC.PID_PROFILE.yawPrecompCutoff=t.readU8(),FC.PID_PROFILE.yawFFCyclicGain=t.readU8(),FC.PID_PROFILE.yawFFCollectiveGain=t.readU8(),FC.PID_PROFILE.yawFFImpulseGain=t.read8(),FC.PID_PROFILE.yawFFImpulseDecay=t.readU8(),FC.PID_PROFILE.pitchFFCollectiveGain=t.readU8(),FC.PID_PROFILE.levelAngleStrength=t.readU8(),FC.PID_PROFILE.levelAngleLimit=t.readU8(),FC.PID_PROFILE.horizonLevelStrength=t.readU8(),FC.PID_PROFILE.acroTrainerGain=t.readU8(),FC.PID_PROFILE.acroTrainerLimit=t.readU8(),FC.PID_PROFILE.cyclicCrossCouplingGain=t.readU8(),FC.PID_PROFILE.cyclicCrossCouplingRatio=t.readU8(),FC.PID_PROFILE.cyclicCrossCouplingCutoff=t.readU8(),FC.PID_PROFILE.offsetLimitRoll=t.readU8(),FC.PID_PROFILE.offsetLimitPitch=t.readU8(),FC.PID_PROFILE.btermCutoffRoll=t.readU8(),FC.PID_PROFILE.btermCutoffPitch=t.readU8(),FC.PID_PROFILE.btermCutoffYaw=t.readU8(),_e.gte(FC.CONFIG.apiVersion,API_VERSION_12_8)&&(FC.PID_PROFILE.yaw_inertia_precomp_gain=t.readU8(),FC.PID_PROFILE.yaw_inertia_precomp_cutoff=t.readU8());break}case MSPCodes.MSP_RESCUE_PROFILE:{FC.PID_PROFILE.rescueMode=t.readU8(),FC.PID_PROFILE.rescueFlipMode=t.readU8(),FC.PID_PROFILE.rescueFlipGain=t.readU8(),FC.PID_PROFILE.rescueLevelGain=t.readU8(),FC.PID_PROFILE.rescuePullupTime=t.readU8(),FC.PID_PROFILE.rescueClimbTime=t.readU8(),FC.PID_PROFILE.rescueFlipTime=t.readU8(),FC.PID_PROFILE.rescueExitTime=t.readU8(),FC.PID_PROFILE.rescuePullupCollective=t.readU16(),FC.PID_PROFILE.rescueClimbCollective=t.readU16(),FC.PID_PROFILE.rescueHoverCollective=t.readU16(),FC.PID_PROFILE.rescueHoverAltitude=t.readU16(),FC.PID_PROFILE.rescueAltitudePGain=t.readU16(),FC.PID_PROFILE.rescueAltitudeIGain=t.readU16(),FC.PID_PROFILE.rescueAltitudeDGain=t.readU16(),FC.PID_PROFILE.rescueMaxCollective=t.readU16(),FC.PID_PROFILE.rescueMaxRate=t.readU16(),FC.PID_PROFILE.rescueMaxAccel=t.readU16();break}case MSPCodes.MSP_GOVERNOR_PROFILE:{FC.GOVERNOR.gov_headspeed=t.readU16(),FC.GOVERNOR.gov_gain=t.readU8(),FC.GOVERNOR.gov_p_gain=t.readU8(),FC.GOVERNOR.gov_i_gain=t.readU8(),FC.GOVERNOR.gov_d_gain=t.readU8(),FC.GOVERNOR.gov_f_gain=t.readU8(),FC.GOVERNOR.gov_tta_gain=t.readU8(),FC.GOVERNOR.gov_tta_limit=t.readU8(),FC.GOVERNOR.gov_yaw_ff_weight=t.readU8(),FC.GOVERNOR.gov_cyclic_ff_weight=t.readU8(),FC.GOVERNOR.gov_collective_ff_weight=t.readU8(),FC.GOVERNOR.gov_max_throttle=t.readU8(),_e.gte(FC.CONFIG.apiVersion,API_VERSION_12_7)&&(FC.GOVERNOR.gov_min_throttle=t.readU8());break}case MSPCodes.MSP_GOVERNOR_CONFIG:{FC.GOVERNOR.gov_mode=t.readU8(),FC.GOVERNOR.gov_startup_time=t.readU16(),FC.GOVERNOR.gov_spoolup_time=t.readU16(),FC.GOVERNOR.gov_tracking_time=t.readU16(),FC.GOVERNOR.gov_recovery_time=t.readU16(),FC.GOVERNOR.gov_zero_throttle_timeout=t.readU16(),FC.GOVERNOR.gov_lost_headspeed_timeout=t.readU16(),FC.GOVERNOR.gov_autorotation_timeout=t.readU16(),FC.GOVERNOR.gov_autorotation_bailout_time=t.readU16(),FC.GOVERNOR.gov_autorotation_min_entry_time=t.readU16(),FC.GOVERNOR.gov_handover_throttle=t.readU8(),FC.GOVERNOR.gov_pwr_filter=t.readU8(),FC.GOVERNOR.gov_rpm_filter=t.readU8(),FC.GOVERNOR.gov_tta_filter=t.readU8(),FC.GOVERNOR.gov_ff_filter=t.readU8(),_e.gte(FC.CONFIG.apiVersion,API_VERSION_12_8)&&(FC.GOVERNOR.gov_spoolup_min_throttle=t.readU8());break}case MSPCodes.MSP_MIXER_INPUTS:{FC.MIXER_INPUTS=[];const a=t.byteLength/6;for(let c=0;c<a;c++)FC.MIXER_INPUTS.push({rate:t.read16(),min:t.read16(),max:t.read16()});break}case MSPCodes.MSP_MIXER_RULES:{FC.MIXER_RULES=[];const a=t.byteLength/7;for(let c=0;c<a;c++)FC.MIXER_RULES.push({oper:t.readU8(),src:t.readU8(),dst:t.readU8(),offset:t.read16(),weight:t.read16()});break}case MSPCodes.MSP_MIXER_OVERRIDE:{FC.MIXER_OVERRIDE=[];const a=t.byteLength/2;for(let c=0;c<a;c++)FC.MIXER_OVERRIDE[c]=t.read16();break}case MSPCodes.MSP_SENSOR_CONFIG:{FC.SENSOR_CONFIG.acc_hardware=t.readU8(),FC.SENSOR_CONFIG.baro_hardware=t.readU8(),FC.SENSOR_CONFIG.mag_hardware=t.readU8(),FC.SENSOR_CONFIG.gyro_to_use=t.readU8(),FC.SENSOR_CONFIG.gyroHighFsr=t.readU8(),FC.SENSOR_CONFIG.gyroMovementCalibThreshold=t.readU8(),FC.SENSOR_CONFIG.gyroCalibDuration=t.readU16(),FC.SENSOR_CONFIG.gyroOffsetYaw=t.readU16(),FC.SENSOR_CONFIG.gyroCheckOverflow=t.readU8();break}case MSPCodes.MSP_LED_STRIP_CONFIG:{FC.LED_STRIP=[];const a=(t.byteLength-2)/8;for(let c=0;c<a;c++){const u=t.readU32(),p=t.readU32(),h=u>>8&15,g=[];for(let F=0;F<td.length;F++)if(h==F){g.push(td[F]);break}const f=u>>12&255;for(let F=0;F<nd.length;F++)bit_check(f,F)&&g.push(nd[F]);const d=u>>24&63,_=[];for(let F=0;F<ed.length;F++)bit_check(d,F)&&_.push(ed[F]);const m=p>>1&65535,C=p>>17&15,R=p>>21&15,S={y:u&15,x:u>>4&15,functions:g,color:u>>20&15,directions:_,parameters:u>>30&15,blinkPattern:m,blinkPause:C,altColor:R};FC.LED_STRIP.push(S)}break}case MSPCodes.MSP_SET_LED_STRIP_CONFIG:{console.log("Led strip config saved");break}case MSPCodes.MSP_LED_COLORS:{FC.LED_COLORS=[];const a=t.byteLength/4;for(let c=0;c<a;c++){const u={h:t.readU16(),s:t.readU8(),v:t.readU8()};FC.LED_COLORS.push(u)}break}case MSPCodes.MSP_SET_LED_COLORS:{console.log("Led strip colors saved");break}case MSPCodes.MSP_LED_STRIP_MODECOLOR:{FC.LED_MODE_COLORS=[];const a=t.byteLength/3;for(let c=0;c<a;c++){const u={mode:t.readU8(),direction:t.readU8(),color:t.readU8()};FC.LED_MODE_COLORS.push(u)}break}case MSPCodes.MSP_SET_LED_STRIP_MODECOLOR:{console.log("Led strip mode colors saved");break}case MSPCodes.MSP_LED_STRIP_SETTINGS:{FC.LED_STRIP_CONFIG.ledstrip_beacon_armed_only=t.readU8(),FC.LED_STRIP_CONFIG.ledstrip_beacon_color=t.readU8(),FC.LED_STRIP_CONFIG.ledstrip_beacon_percent=t.readU8(),FC.LED_STRIP_CONFIG.ledstrip_beacon_period_ms=t.readU16(),FC.LED_STRIP_CONFIG.ledstrip_blink_period_ms=t.readU16(),FC.LED_STRIP_CONFIG.ledstrip_brightness=t.readU8(),FC.LED_STRIP_CONFIG.ledstrip_fade_rate=t.readU8(),FC.LED_STRIP_CONFIG.ledstrip_flicker_rate=t.readU8(),FC.LED_STRIP_CONFIG.ledstrip_grb_rgb=t.readU8(),FC.LED_STRIP_CONFIG.ledstrip_profile=t.readU8(),FC.LED_STRIP_CONFIG.ledstrip_race_color=t.readU8(),FC.LED_STRIP_CONFIG.ledstrip_visual_beeper=t.readU8(),FC.LED_STRIP_CONFIG.ledstrip_visual_beeper_color=t.readU8();break}case MSPCodes.MSP_SET_LED_STRIP_SETTINGS:{console.log("Led strip settings saved");break}case MSPCodes.MSP_DATAFLASH_SUMMARY:{t.byteLength>=13?(l=t.readU8(),FC.DATAFLASH.ready=(l&1)!=0,FC.DATAFLASH.supported=(l&2)!=0,FC.DATAFLASH.sectors=t.readU32(),FC.DATAFLASH.totalSize=t.readU32(),FC.DATAFLASH.usedSize=t.readU32()):(FC.DATAFLASH.ready=!1,FC.DATAFLASH.supported=!1,FC.DATAFLASH.sectors=0,FC.DATAFLASH.totalSize=0,FC.DATAFLASH.usedSize=0),update_dataflash_global();break}case MSPCodes.MSP_DATAFLASH_READ:break;case MSPCodes.MSP_DATAFLASH_ERASE:{console.log("Data flash erase begun...");break}case MSPCodes.MSP_SDCARD_SUMMARY:{l=t.readU8(),FC.SDCARD.supported=(l&1)!=0,FC.SDCARD.state=t.readU8(),FC.SDCARD.filesystemLastError=t.readU8(),FC.SDCARD.freeSizeKB=t.readU32(),FC.SDCARD.totalSizeKB=t.readU32();break}case MSPCodes.MSP_BLACKBOX_CONFIG:{FC.BLACKBOX.supported=(t.readU8()&1)!=0,FC.BLACKBOX.blackboxDevice=t.readU8(),FC.BLACKBOX.blackboxMode=t.readU8(),FC.BLACKBOX.blackboxDenom=t.readU16(),FC.BLACKBOX.blackboxFields=t.readU32(),_e.gte(FC.CONFIG.apiVersion,API_VERSION_12_8)&&(FC.BLACKBOX.blackboxInitialEraseKiB=t.readU16(),FC.BLACKBOX.blackboxRollingErase=t.readU8(),FC.BLACKBOX.blackboxGracePeriod=t.readU8());break}case MSPCodes.MSP_SET_BLACKBOX_CONFIG:{console.log("Blackbox config saved");break}case MSPCodes.MSP_TRANSPONDER_CONFIG:{let a=t.byteLength;const c=t.readU8();a--,FC.TRANSPONDER.supported=c>0,FC.TRANSPONDER.providers=[];for(let u=0;u<c;u++){const p={id:t.readU8(),dataLength:t.readU8()};a-=2,FC.TRANSPONDER.providers.push(p)}FC.TRANSPONDER.provider=t.readU8(),a--,FC.TRANSPONDER.data=[];for(let u=0;u<a;u++)FC.TRANSPONDER.data.push(t.readU8());break}case MSPCodes.MSP_SET_TRANSPONDER_CONFIG:{console.log("Transponder config saved");break}case MSPCodes.MSP_SET_TUNING_SLIDERS:{console.log("Tuning Sliders data sent");break}case MSPCodes.MSP_TUNING_SLIDERS:{FC.TUNING_SLIDERS.slider_pids_mode=t.readU8(),FC.TUNING_SLIDERS.slider_master_multiplier=t.readU8(),FC.TUNING_SLIDERS.slider_roll_pitch_ratio=t.readU8(),FC.TUNING_SLIDERS.slider_i_gain=t.readU8(),FC.TUNING_SLIDERS.slider_pd_ratio=t.readU8(),FC.TUNING_SLIDERS.slider_pd_gain=t.readU8(),FC.TUNING_SLIDERS.slider_dmin_ratio=t.readU8(),FC.TUNING_SLIDERS.slider_ff_gain=t.readU8(),FC.TUNING_SLIDERS.slider_dterm_filter=t.readU8(),FC.TUNING_SLIDERS.slider_dterm_filter_multiplier=t.readU8(),FC.TUNING_SLIDERS.slider_gyro_filter=t.readU8(),FC.TUNING_SLIDERS.slider_gyro_filter_multiplier=t.readU8();break}case MSPCodes.MSP_SET_MODE_RANGE:{console.log("Mode range saved");break}case MSPCodes.MSP_SET_ADJUSTMENT_RANGE:{console.log("Adjustment range saved");break}case MSPCodes.MSP_SET_BOARD_ALIGNMENT_CONFIG:{console.log("Board alignment saved");break}case MSPCodes.MSP_DEBUG_CONFIG:{FC.DEBUG_CONFIG.debugModeCount=t.readU8(),FC.DEBUG_CONFIG.debugValueCount=t.readU8(),FC.DEBUG_CONFIG.debugMode=t.readU8(),FC.DEBUG_CONFIG.debugAxis=t.readU8();break}case MSPCodes.MSP_SET_DEBUG_CONFIG:{console.log("Debug flags changed");break}case MSPCodes.MSP_SET_ARMING_CONFIG:{console.log("Arming config saved");break}case MSPCodes.MSP_SET_RESET_CURR_PID:{console.log("Current PID profile reset");break}case MSPCodes.MSP_SET_MIXER_CONFIG:{console.log("Mixer config changed");break}case MSPCodes.MSP_SET_MIXER_INPUT:{console.log("Mixer input changed");break}case MSPCodes.MSP_SET_MIXER_RULE:{console.log("Mixer rule changed");break}case MSPCodes.MSP_SET_MIXER_OVERRIDE:{console.log("Mixer Override set");break}case MSPCodes.MSP_SET_RC_CONFIG:{console.log("RC controls settings saved");break}case MSPCodes.MSP_SET_SENSOR_ALIGNMENT:{console.log("Sensor alignment saved");break}case MSPCodes.MSP_SET_ESC_SENSOR_CONFIG:{console.log("ESC sensor config saved");break}case MSPCodes.MSP_SET_RX_CONFIG:{console.log("Rx config saved");break}case MSPCodes.MSP_SET_RXFAIL_CONFIG:{console.log("Rxfail config saved");break}case MSPCodes.MSP_SET_FAILSAFE_CONFIG:{console.log("Failsafe config saved");break}case MSPCodes.MSP_SET_TELEMETRY_CONFIG:{console.log("Telemetry config saved");break}case MSPCodes.MSP_OSD_CONFIG:break;case MSPCodes.MSP_SET_OSD_CONFIG:{console.log("OSD config set");break}case MSPCodes.MSP_OSD_CHAR_READ:break;case MSPCodes.MSP_OSD_CHAR_WRITE:{console.log("OSD char uploaded");break}case MSPCodes.MSP_SET_NAME:{console.log("Name set");break}case MSPCodes.MSP_SET_FILTER_CONFIG:{console.log("Filter config set");break}case MSPCodes.MSP_SET_ADVANCED_CONFIG:{console.log("Advanced config parameters set");break}case MSPCodes.MSP_SET_SENSOR_CONFIG:{console.log("Sensor config parameters set");break}case MSPCodes.MSP_COPY_PROFILE:{console.log("Copy profile");break}case MSPCodes.MSP_ARMING_DISABLE:{console.log("Arming disable");break}case MSPCodes.MSP_SET_RTC:{console.log("Real time clock set");break}case MSPCodes.MSP2_SET_MOTOR_OUTPUT_REORDERING:{console.log("Motor output reordering set");break}case MSPCodes.MSP2_SEND_DSHOT_COMMAND:{console.log("DSHOT command sent");break}case MSPCodes.MSP_MULTIPLE_MSP:{let a=!1;for(;t.offset<t.byteLength;){a=!0;const c=e.mspMultipleCache.shift(),u=t.readU8();if(u!=0){const p={code:c,dataView:new DataView(t.buffer,t.offset,u),callbacks:[]};e.process_data(p),t.offset+=u}}if(a){if(e.mspMultipleCache.length>0){const c=[];for(let u=0;u<e.mspMultipleCache.length;u++)c.push8(e.mspMultipleCache[u]);MSP.send_message(MSPCodes.MSP_MULTIPLE_MSP,c,!1,n.callbacks),n.callbacks=[]}}else console.log("MSP Multiple can't process the command"),e.mspMultipleCache=[];break}default:console.log("Unknown code detected: "+r);break}for(let a=n.callbacks.length-1;a>=0;a--)if(n.callbacks[a]?.code===r){const c=n.callbacks[a].callback,u=n.callbacks[a].callbackOnError;clearInterval(n.callbacks[a].timer),n.callbacks.splice(a,1),!i||u?c&&c({command:r,data:t,length:t.byteLength,crcError:i}):console.warn(`code: ${r} - crc failed. No callback`)}};De.prototype.crunch=function(n){const e=[],t=this;switch(n){case MSPCodes.MSP_SET_FEATURE_CONFIG:{e.push32(FC.FEATURE_CONFIG.features.bitfield);break}case MSPCodes.MSP_SET_BEEPER_CONFIG:{const r=FC.BEEPER_CONFIG.beepers.getDisabledMask();e.push32(r),e.push8(FC.BEEPER_CONFIG.dshotBeaconTone),e.push32(FC.BEEPER_CONFIG.dshotBeaconConditions.getDisabledMask());break}case MSPCodes.MSP_SET_MIXER_CONFIG:{e.push8(FC.MIXER_CONFIG.main_rotor_dir).push8(FC.MIXER_CONFIG.tail_rotor_mode).push8(FC.MIXER_CONFIG.tail_motor_idle).push16(FC.MIXER_CONFIG.tail_center_trim).push8(FC.MIXER_CONFIG.swash_type).push8(FC.MIXER_CONFIG.swash_ring).push16(FC.MIXER_CONFIG.swash_phase).push16(FC.MIXER_CONFIG.blade_pitch_limit).push16(FC.MIXER_CONFIG.swash_trim[0]).push16(FC.MIXER_CONFIG.swash_trim[1]).push16(FC.MIXER_CONFIG.swash_trim[2]).push8(FC.MIXER_CONFIG.coll_rpm_correction).push8(FC.MIXER_CONFIG.coll_geo_correction),_e.gte(FC.CONFIG.apiVersion,API_VERSION_12_8)&&e.push8(FC.MIXER_CONFIG.coll_tilt_correction_pos).push8(FC.MIXER_CONFIG.coll_tilt_correction_neg);break}case MSPCodes.MSP_SET_BOARD_ALIGNMENT_CONFIG:{e.push16(FC.BOARD_ALIGNMENT_CONFIG.roll).push16(FC.BOARD_ALIGNMENT_CONFIG.pitch).push16(FC.BOARD_ALIGNMENT_CONFIG.yaw);break}case MSPCodes.MSP_SET_PID_TUNING:{for(let r=0;r<3;r++)for(let i=0;i<4;i++)e.push16(parseInt(FC.PIDS[r][i]));for(let r=0;r<3;r++)e.push16(parseInt(FC.PIDS[r][4]));for(let r=0;r<2;r++)e.push16(parseInt(FC.PIDS[r][5]));break}case MSPCodes.MSP_SET_RC_TUNING:{e.push8(FC.RC_TUNING.rates_type),e.push8(Math.round(FC.RC_TUNING.RC_RATE*100)).push8(Math.round(FC.RC_TUNING.RC_EXPO*100)).push8(Math.round(FC.RC_TUNING.roll_rate*100)).push8(FC.RC_TUNING.roll_response_time).push16(FC.RC_TUNING.roll_accel_limit),e.push8(Math.round(FC.RC_TUNING.rcPitchRate*100)).push8(Math.round(FC.RC_TUNING.RC_PITCH_EXPO*100)).push8(Math.round(FC.RC_TUNING.pitch_rate*100)).push8(FC.RC_TUNING.pitch_response_time).push16(FC.RC_TUNING.pitch_accel_limit),e.push8(Math.round(FC.RC_TUNING.rcYawRate*100)).push8(Math.round(FC.RC_TUNING.RC_YAW_EXPO*100)).push8(Math.round(FC.RC_TUNING.yaw_rate*100)).push8(FC.RC_TUNING.yaw_response_time).push16(FC.RC_TUNING.yaw_accel_limit),e.push8(Math.round(FC.RC_TUNING.rcCollectiveRate*100)).push8(Math.round(FC.RC_TUNING.RC_COLLECTIVE_EXPO*100)).push8(Math.round(FC.RC_TUNING.collective_rate*100)).push8(FC.RC_TUNING.collective_response_time).push16(FC.RC_TUNING.collective_accel_limit),_e.gte(FC.CONFIG.apiVersion,API_VERSION_12_8)&&e.push8(FC.RC_TUNING.roll_setpoint_boost_gain).push8(FC.RC_TUNING.roll_setpoint_boost_cutoff).push8(FC.RC_TUNING.pitch_setpoint_boost_gain).push8(FC.RC_TUNING.pitch_setpoint_boost_cutoff).push8(FC.RC_TUNING.yaw_setpoint_boost_gain).push8(FC.RC_TUNING.yaw_setpoint_boost_cutoff).push8(FC.RC_TUNING.collective_setpoint_boost_gain).push8(FC.RC_TUNING.collective_setpoint_boost_cutoff).push8(FC.RC_TUNING.yaw_dynamic_ceiling_gain).push8(FC.RC_TUNING.yaw_dynamic_deadband_gain).push8(FC.RC_TUNING.yaw_dynamic_deadband_filter);break}case MSPCodes.MSP_SET_RX_MAP:{for(let r=0;r<FC.RC_MAP.length;r++)e.push8(FC.RC_MAP[r]);break}case MSPCodes.MSP_SET_ACC_TRIM:{e.push16(FC.CONFIG.accelerometerTrims[0]).push16(FC.CONFIG.accelerometerTrims[1]);break}case MSPCodes.MSP_SET_DEBUG_CONFIG:{e.push8(FC.DEBUG_CONFIG.debugMode),e.push8(FC.DEBUG_CONFIG.debugAxis);break}case MSPCodes.MSP_SET_ARMING_CONFIG:{e.push8(FC.ARMING_CONFIG.auto_disarm_delay);break}case MSPCodes.MSP_SET_MOTOR_CONFIG:{e.push16(FC.MOTOR_CONFIG.minthrottle).push16(FC.MOTOR_CONFIG.maxthrottle).push16(FC.MOTOR_CONFIG.mincommand).push8(FC.MOTOR_CONFIG.motor_poles[0]).push8(FC.MOTOR_CONFIG.use_dshot_telemetry?1:0).push8(FC.MOTOR_CONFIG.motor_pwm_protocol).push16(FC.MOTOR_CONFIG.motor_pwm_rate).push8(FC.MOTOR_CONFIG.use_unsynced_pwm?1:0);for(let r=0;r<4;r++)e.push8(FC.MOTOR_CONFIG.motor_poles[r]);for(let r=0;r<4;r++)e.push8(FC.MOTOR_CONFIG.motor_rpm_lpf[r]);for(let r=0;r<2;r++)e.push16(FC.MOTOR_CONFIG.main_rotor_gear_ratio[r]);for(let r=0;r<2;r++)e.push16(FC.MOTOR_CONFIG.tail_rotor_gear_ratio[r]);break}case MSPCodes.MSP_SET_GPS_CONFIG:{e.push8(FC.GPS_CONFIG.provider).push8(FC.GPS_CONFIG.ublox_sbas).push8(FC.GPS_CONFIG.auto_config).push8(FC.GPS_CONFIG.auto_baud).push8(FC.GPS_CONFIG.home_point_once).push8(FC.GPS_CONFIG.ublox_use_galileo);break}case MSPCodes.MSP_SET_GPS_RESCUE:{e.push16(FC.GPS_RESCUE.angle).push16(FC.GPS_RESCUE.initialAltitudeM).push16(FC.GPS_RESCUE.descentDistanceM).push16(FC.GPS_RESCUE.rescueGroundspeed).push16(FC.GPS_RESCUE.throttleMin).push16(FC.GPS_RESCUE.throttleMax).push16(FC.GPS_RESCUE.throttleHover).push8(FC.GPS_RESCUE.sanityChecks).push8(FC.GPS_RESCUE.minSats).push16(FC.GPS_RESCUE.ascendRate).push16(FC.GPS_RESCUE.descendRate).push8(FC.GPS_RESCUE.allowArmingWithoutFix).push8(FC.GPS_RESCUE.altitudeMode);break}case MSPCodes.MSP_SET_RSSI_CONFIG:{e.push8(FC.RSSI_CONFIG.channel).push8(FC.RSSI_CONFIG.scale).push8(FC.RSSI_CONFIG.invert).push8(FC.RSSI_CONFIG.offset);break}case MSPCodes.MSP_SET_BATTERY_CONFIG:{e.push16(FC.BATTERY_CONFIG.capacity).push8(FC.BATTERY_CONFIG.cellCount).push8(FC.BATTERY_CONFIG.voltageMeterSource).push8(FC.BATTERY_CONFIG.currentMeterSource).push16(Math.round(FC.BATTERY_CONFIG.vbatmincellvoltage*100)).push16(Math.round(FC.BATTERY_CONFIG.vbatmaxcellvoltage*100)).push16(Math.round(FC.BATTERY_CONFIG.vbatfullcellvoltage*100)).push16(Math.round(FC.BATTERY_CONFIG.vbatwarningcellvoltage*100)).push8(FC.BATTERY_CONFIG.lvcPercentage).push8(FC.BATTERY_CONFIG.mahWarningPercentage);break}case MSPCodes.MSP_SET_VOLTAGE_METER_CONFIG:break;case MSPCodes.MSP_SET_CURRENT_METER_CONFIG:break;case MSPCodes.MSP_SET_ESC_SENSOR_CONFIG:{e.push8(FC.ESC_SENSOR_CONFIG.protocol).push8(Number(FC.ESC_SENSOR_CONFIG.half_duplex)).push16(FC.ESC_SENSOR_CONFIG.update_hz).push16(FC.ESC_SENSOR_CONFIG.current_offset).push16(FC.ESC_SENSOR_CONFIG.hw4_current_offset).push8(FC.ESC_SENSOR_CONFIG.hw4_current_gain).push8(FC.ESC_SENSOR_CONFIG.hw4_voltage_gain),_e.gte(FC.CONFIG.apiVersion,API_VERSION_12_7)&&e.push8(Number(FC.ESC_SENSOR_CONFIG.pinswap)),_e.gte(FC.CONFIG.apiVersion,API_VERSION_12_8)&&e.push8(FC.ESC_SENSOR_CONFIG.voltage_correction).push8(FC.ESC_SENSOR_CONFIG.current_correction).push8(FC.ESC_SENSOR_CONFIG.consumption_correction);break}case MSPCodes.MSP_SET_RX_CONFIG:{e.push8(FC.RX_CONFIG.serialrx_provider).push8(FC.RX_CONFIG.serialrx_inverted).push8(FC.RX_CONFIG.serialrx_halfduplex).push16(FC.RX_CONFIG.rx_pulse_min).push16(FC.RX_CONFIG.rx_pulse_max).push8(FC.RX_CONFIG.rxSpiProtocol).push32(FC.RX_CONFIG.rxSpiId).push8(FC.RX_CONFIG.rxSpiRfChannelCount),_e.gte(FC.CONFIG.apiVersion,API_VERSION_12_7)&&e.push8(FC.RX_CONFIG.serialrx_pinswap);break}case MSPCodes.MSP_SET_FAILSAFE_CONFIG:{e.push8(FC.FAILSAFE_CONFIG.failsafe_delay).push8(FC.FAILSAFE_CONFIG.failsafe_off_delay).push16(FC.FAILSAFE_CONFIG.failsafe_throttle).push8(FC.FAILSAFE_CONFIG.failsafe_switch_mode).push16(FC.FAILSAFE_CONFIG.failsafe_throttle_low_delay).push8(FC.FAILSAFE_CONFIG.failsafe_procedure);break}case MSPCodes.MSP_SET_TELEMETRY_CONFIG:{if(e.push8(FC.TELEMETRY_CONFIG.telemetry_inverted).push8(FC.TELEMETRY_CONFIG.telemetry_halfduplex).push32(FC.TELEMETRY_CONFIG.telemetry_sensors),_e.gte(FC.CONFIG.apiVersion,API_VERSION_12_7)){e.push8(FC.TELEMETRY_CONFIG.telemetry_pinswap).push8(FC.TELEMETRY_CONFIG.crsf_telemetry_mode).push16(FC.TELEMETRY_CONFIG.crsf_telemetry_rate).push16(FC.TELEMETRY_CONFIG.crsf_telemetry_ratio);for(let r=0;r<t.CRSF_TELEMETRY_SENSOR_LENGTH;r++)e.push8(FC.TELEMETRY_CONFIG.telemetry_sensors_list[r]??0)}break}case MSPCodes.MSP_SET_TRANSPONDER_CONFIG:{e.push8(FC.TRANSPONDER.provider);for(let r=0;r<FC.TRANSPONDER.data.length;r++)e.push8(FC.TRANSPONDER.data[r]);break}case MSPCodes.MSP_SET_CHANNEL_FORWARDING:break;case MSPCodes.MSP_SET_SERIAL_CONFIG:{for(let r=0;r<FC.SERIAL_CONFIG.ports.length;r++){const i=FC.SERIAL_CONFIG.ports[r];e.push8(i.identifier).push32(i.functionMask).push8(t.BAUD_RATES.indexOf(i.msp_baudrate)).push8(t.BAUD_RATES.indexOf(i.gps_baudrate)).push8(t.BAUD_RATES.indexOf(i.telemetry_baudrate)).push8(t.BAUD_RATES.indexOf(i.blackbox_baudrate))}break}case MSPCodes.MSP_SET_RC_CONFIG:{e.push16(FC.RC_CONFIG.rc_center).push16(FC.RC_CONFIG.rc_deflection).push16(FC.RC_CONFIG.rc_arm_throttle).push16(FC.RC_CONFIG.rc_min_throttle).push16(FC.RC_CONFIG.rc_max_throttle).push8(FC.RC_CONFIG.rc_deadband).push8(FC.RC_CONFIG.rc_yaw_deadband);break}case MSPCodes.MSP_SET_SENSOR_ALIGNMENT:{e.push8(FC.SENSOR_ALIGNMENT.gyro_1_align).push8(FC.SENSOR_ALIGNMENT.gyro_2_align).push8(FC.SENSOR_ALIGNMENT.align_mag);break}case MSPCodes.MSP_SET_ADVANCED_CONFIG:{e.push8(FC.ADVANCED_CONFIG.gyro_sync_denom).push8(FC.ADVANCED_CONFIG.pid_process_denom);break}case MSPCodes.MSP_SET_FILTER_CONFIG:{e.push8(FC.FILTER_CONFIG.gyro_hardware_lpf).push8(FC.FILTER_CONFIG.gyro_lowpass_type).push16(FC.FILTER_CONFIG.gyro_lowpass_hz).push8(FC.FILTER_CONFIG.gyro_lowpass2_type).push16(FC.FILTER_CONFIG.gyro_lowpass2_hz).push16(FC.FILTER_CONFIG.gyro_notch_hz).push16(FC.FILTER_CONFIG.gyro_notch_cutoff).push16(FC.FILTER_CONFIG.gyro_notch2_hz).push16(FC.FILTER_CONFIG.gyro_notch2_cutoff).push16(FC.FILTER_CONFIG.gyro_lowpass_dyn_min_hz).push16(FC.FILTER_CONFIG.gyro_lowpass_dyn_max_hz).push8(FC.FILTER_CONFIG.dyn_notch_count).push8(FC.FILTER_CONFIG.dyn_notch_q).push16(FC.FILTER_CONFIG.dyn_notch_min_hz).push16(FC.FILTER_CONFIG.dyn_notch_max_hz).push8(FC.FILTER_CONFIG.rpm_preset).push8(FC.FILTER_CONFIG.rpm_min_hz);break}case MSPCodes.MSP_SET_PID_PROFILE:{e.push8(FC.PID_PROFILE.pid_mode).push8(FC.PID_PROFILE.error_decay_time_ground).push8(FC.PID_PROFILE.error_decay_time_cyclic).push8(FC.PID_PROFILE.error_decay_time_yaw).push8(FC.PID_PROFILE.error_decay_limit_cyclic).push8(FC.PID_PROFILE.error_decay_limit_yaw).push8(FC.PID_PROFILE.error_rotation).push8(FC.PID_PROFILE.errorLimitRoll).push8(FC.PID_PROFILE.errorLimitPitch).push8(FC.PID_PROFILE.errorLimitYaw).push8(FC.PID_PROFILE.gyroCutoffRoll).push8(FC.PID_PROFILE.gyroCutoffPitch).push8(FC.PID_PROFILE.gyroCutoffYaw).push8(FC.PID_PROFILE.dtermCutoffRoll).push8(FC.PID_PROFILE.dtermCutoffPitch).push8(FC.PID_PROFILE.dtermCutoffYaw).push8(FC.PID_PROFILE.itermRelaxType).push8(FC.PID_PROFILE.itermRelaxCutoffRoll).push8(FC.PID_PROFILE.itermRelaxCutoffPitch).push8(FC.PID_PROFILE.itermRelaxCutoffYaw).push8(FC.PID_PROFILE.yawStopGainCW).push8(FC.PID_PROFILE.yawStopGainCCW).push8(FC.PID_PROFILE.yawPrecompCutoff).push8(FC.PID_PROFILE.yawFFCyclicGain).push8(FC.PID_PROFILE.yawFFCollectiveGain).push8(FC.PID_PROFILE.yawFFImpulseGain).push8(FC.PID_PROFILE.yawFFImpulseDecay).push8(FC.PID_PROFILE.pitchFFCollectiveGain).push8(FC.PID_PROFILE.levelAngleStrength).push8(FC.PID_PROFILE.levelAngleLimit).push8(FC.PID_PROFILE.horizonLevelStrength).push8(FC.PID_PROFILE.acroTrainerGain).push8(FC.PID_PROFILE.acroTrainerLimit).push8(FC.PID_PROFILE.cyclicCrossCouplingGain).push8(FC.PID_PROFILE.cyclicCrossCouplingRatio).push8(FC.PID_PROFILE.cyclicCrossCouplingCutoff).push8(FC.PID_PROFILE.offsetLimitRoll).push8(FC.PID_PROFILE.offsetLimitPitch).push8(FC.PID_PROFILE.btermCutoffRoll).push8(FC.PID_PROFILE.btermCutoffPitch).push8(FC.PID_PROFILE.btermCutoffYaw),_e.gte(FC.CONFIG.apiVersion,API_VERSION_12_8)&&e.push8(FC.PID_PROFILE.yaw_inertia_precomp_gain).push8(FC.PID_PROFILE.yaw_inertia_precomp_cutoff);break}case MSPCodes.MSP_SET_RESCUE_PROFILE:{e.push8(FC.PID_PROFILE.rescueMode).push8(FC.PID_PROFILE.rescueFlipMode).push8(FC.PID_PROFILE.rescueFlipGain).push8(FC.PID_PROFILE.rescueLevelGain).push8(FC.PID_PROFILE.rescuePullupTime).push8(FC.PID_PROFILE.rescueClimbTime).push8(FC.PID_PROFILE.rescueFlipTime).push8(FC.PID_PROFILE.rescueExitTime).push16(FC.PID_PROFILE.rescuePullupCollective).push16(FC.PID_PROFILE.rescueClimbCollective).push16(FC.PID_PROFILE.rescueHoverCollective).push16(FC.PID_PROFILE.rescueHoverAltitude).push16(FC.PID_PROFILE.rescueAltitudePGain).push16(FC.PID_PROFILE.rescueAltitudeIGain).push16(FC.PID_PROFILE.rescueAltitudeDGain).push16(FC.PID_PROFILE.rescueMaxCollective).push16(FC.PID_PROFILE.rescueMaxRate).push16(FC.PID_PROFILE.rescueMaxAccel);break}case MSPCodes.MSP_SET_GOVERNOR_PROFILE:{e.push16(FC.GOVERNOR.gov_headspeed).push8(FC.GOVERNOR.gov_gain).push8(FC.GOVERNOR.gov_p_gain).push8(FC.GOVERNOR.gov_i_gain).push8(FC.GOVERNOR.gov_d_gain).push8(FC.GOVERNOR.gov_f_gain).push8(FC.GOVERNOR.gov_tta_gain).push8(FC.GOVERNOR.gov_tta_limit).push8(FC.GOVERNOR.gov_yaw_ff_weight).push8(FC.GOVERNOR.gov_cyclic_ff_weight).push8(FC.GOVERNOR.gov_collective_ff_weight).push8(FC.GOVERNOR.gov_max_throttle),_e.gte(FC.CONFIG.apiVersion,API_VERSION_12_7)&&e.push8(FC.GOVERNOR.gov_min_throttle);break}case MSPCodes.MSP_SET_GOVERNOR_CONFIG:{e.push8(FC.GOVERNOR.gov_mode).push16(FC.GOVERNOR.gov_startup_time).push16(FC.GOVERNOR.gov_spoolup_time).push16(FC.GOVERNOR.gov_tracking_time).push16(FC.GOVERNOR.gov_recovery_time).push16(FC.GOVERNOR.gov_zero_throttle_timeout).push16(FC.GOVERNOR.gov_lost_headspeed_timeout).push16(FC.GOVERNOR.gov_autorotation_timeout).push16(FC.GOVERNOR.gov_autorotation_bailout_time).push16(FC.GOVERNOR.gov_autorotation_min_entry_time).push8(FC.GOVERNOR.gov_handover_throttle).push8(FC.GOVERNOR.gov_pwr_filter).push8(FC.GOVERNOR.gov_rpm_filter).push8(FC.GOVERNOR.gov_tta_filter).push8(FC.GOVERNOR.gov_ff_filter),_e.gte(FC.CONFIG.apiVersion,API_VERSION_12_8)&&e.push8(FC.GOVERNOR.gov_spoolup_min_throttle);break}case MSPCodes.MSP_SET_LED_STRIP_SETTINGS:{e.push8(FC.LED_STRIP_CONFIG.ledstrip_beacon_armed_only).push8(FC.LED_STRIP_CONFIG.ledstrip_beacon_color).push8(FC.LED_STRIP_CONFIG.ledstrip_beacon_percent).push16(FC.LED_STRIP_CONFIG.ledstrip_beacon_period_ms).push16(FC.LED_STRIP_CONFIG.ledstrip_blink_period_ms).push8(FC.LED_STRIP_CONFIG.ledstrip_brightness).push8(FC.LED_STRIP_CONFIG.ledstrip_fade_rate).push8(FC.LED_STRIP_CONFIG.ledstrip_flicker_rate).push8(FC.LED_STRIP_CONFIG.ledstrip_grb_rgb).push8(FC.LED_STRIP_CONFIG.ledstrip_profile).push8(FC.LED_STRIP_CONFIG.ledstrip_race_color).push8(FC.LED_STRIP_CONFIG.ledstrip_visual_beeper).push8(FC.LED_STRIP_CONFIG.ledstrip_visual_beeper_color);break}case MSPCodes.MSP_SET_SENSOR_CONFIG:{e.push8(FC.SENSOR_CONFIG.acc_hardware).push8(FC.SENSOR_CONFIG.baro_hardware).push8(FC.SENSOR_CONFIG.mag_hardware).push8(FC.SENSOR_CONFIG.gyro_to_use).push8(FC.SENSOR_CONFIG.gyroHighFsr).push8(FC.SENSOR_CONFIG.gyroMovementCalibThreshold).push16(FC.SENSOR_CONFIG.gyroCalibDuration).push16(FC.SENSOR_CONFIG.gyroOffsetYaw).push8(FC.SENSOR_CONFIG.gyroCheckOverflow);break}case MSPCodes.MSP_SET_NAME:{for(let i=0;i<FC.CONFIG.name.length&&i<64;i++)e.push8(FC.CONFIG.name.charCodeAt(i));break}case MSPCodes.MSP_SET_BLACKBOX_CONFIG:{e.push8(FC.BLACKBOX.blackboxDevice).push8(FC.BLACKBOX.blackboxMode).push16(FC.BLACKBOX.blackboxDenom).push32(FC.BLACKBOX.blackboxFields),_e.gte(FC.CONFIG.apiVersion,API_VERSION_12_8)&&e.push16(FC.BLACKBOX.blackboxInitialEraseKiB).push8(FC.BLACKBOX.blackboxRollingErase).push8(FC.BLACKBOX.blackboxGracePeriod);break}case MSPCodes.MSP_COPY_PROFILE:{e.push8(FC.COPY_PROFILE.type).push8(FC.COPY_PROFILE.dstProfile).push8(FC.COPY_PROFILE.srcProfile);break}case MSPCodes.MSP_ARMING_DISABLE:{e.push8(FC.CONFIG.armingDisabled?1:0);break}case MSPCodes.MSP_SET_RTC:{const r=new Date,o=r.getTime()-r.getTimezoneOffset()*6e4,s=o/1e3,l=o%1e3;e.push32(s),e.push16(l);break}case MSPCodes.MSP_MULTIPLE_MSP:{for(;FC.MULTIPLE_MSP.msp_commands.length>0;){const r=FC.MULTIPLE_MSP.msp_commands.shift();t.mspMultipleCache.push(r),e.push8(r)}break}case MSPCodes.MSP2_SET_MOTOR_OUTPUT_REORDERING:{e.push8(FC.MOTOR_OUTPUT_ORDER.length);for(let r=0;r<FC.MOTOR_OUTPUT_ORDER.length;r++)e.push8(FC.MOTOR_OUTPUT_ORDER[r]);break}case MSPCodes.MSP2_SEND_DSHOT_COMMAND:{e.push8(1);break}default:return!1}return e};De.prototype.setRawRx=function(n){const e=[];for(let t=0;t<n.length;t++)e.push16(n[t]);MSP.send_message(MSPCodes.MSP_SET_RAW_RC,e,!1)};De.prototype.dataflashRead=function(n,e,t){let r=[n&255,n>>8&255,n>>16&255,n>>24&255];r=r.concat([e&255,e>>8&255]),r=r.concat([1]),MSP.send_message(MSPCodes.MSP_DATAFLASH_READ,r,!1,function(i){if(i.crcError)console.log("CRC error for address "+n+" - retrying"),t(n,null);else{const o=i.data.readU32();let s=4,l=i.data.buffer.byteLength-s,a=0;if(s=s+3,l=i.data.readU16(),a=i.data.readU8(),o==n){if(a==0)t(n,new DataView(i.data.buffer,i.data.byteOffset+s,l));else if(a==1){const c=i.data.readU16(),u=new Uint8Array(i.data.buffer,i.data.byteOffset+s+2,l-2),p=huffmanDecodeBuf(u,c,defaultHuffmanTree,defaultHuffmanLenIndex);t(n,new DataView(p.buffer),l)}}else console.log("Expected address "+n+" but received "+o+" - retrying"),t(n,null)}},!0)};De.prototype.sendRPMFilters=async function(){for(let n=0;n<FC.RPM_FILTER_CONFIG.length;n++){const e=FC.RPM_FILTER_CONFIG[n],t=[];t.push8(n).push8(e.rpm_source).push16(e.rpm_ratio).push16(e.rpm_limit).push8(e.notch_q),await MSP.promise(MSPCodes.MSP_SET_RPM_FILTER,t)}};De.prototype.sendRPMFiltersV2=async function(){for(let n=0;n<FC.RPM_FILTER_CONFIG_V2.length;n++){const e=FC.RPM_FILTER_CONFIG_V2[n],t=[];t.push8(n);for(let r=0;r<e.length;r++){const i=e[r];t.push8(i.rpm_source).push16(i.notch_center).push8(i.notch_q)}await MSP.promise(MSPCodes.MSP_SET_RPM_FILTER_V2,t)}};De.prototype.resetMotorOverrides=async function(){for(let n=0;n<FC.MOTOR_OVERRIDE.length;n++)FC.MOTOR_OVERRIDE[n]=0,await this.sendMotorOverride(n)};De.prototype.sendMotorOverride=function(n){if(!serial.connected)return;const e=FC.MOTOR_OVERRIDE[n],t=[];return t.push8(n).push16(e),new Promise(r=>MSP.send_message(MSPCodes.MSP_SET_MOTOR_OVERRIDE,t,!1,r,!0))};De.prototype.resetServoOverrides=function(n){for(let e=0;e<FC.SERVO_OVERRIDE.length;e++)FC.SERVO_OVERRIDE[e]=2001;this.sendServoOverrides(n)};De.prototype.sendServoOverride=function(n,e){const t=FC.SERVO_OVERRIDE[n],r=[];r.push8(n).push16(t),MSP.send_message(MSPCodes.MSP_SET_SERVO_OVERRIDE,r,!1,e)};De.prototype.sendServoOverrides=function(n){const e=this;var t=0;function r(){t<FC.SERVO_OVERRIDE.length?e.sendServoOverride(t++,r):n&&n()}r()};De.prototype.sendServoConfig=function(n,e){const t=FC.SERVO_CONFIG[n],r=[];r.push8(n).push16(t.mid).push16(t.min).push16(t.max).push16(t.rneg).push16(t.rpos).push16(t.rate).push16(t.speed).push16(t.flags),MSP.send_message(MSPCodes.MSP_SET_SERVO_CONFIGURATION,r,!1,e)};De.prototype.sendServoConfigurations=function(n){const e=this;var t=0;function r(){t<FC.SERVO_CONFIG.length?e.sendServoConfig(t++,r):n&&n()}r()};De.prototype.sendMixerInput=function(n,e){const t=FC.MIXER_INPUTS[n],r=[];r.push8(n).push16(t.rate).push16(t.min).push16(t.max),MSP.send_message(MSPCodes.MSP_SET_MIXER_INPUT,r,!1,e)};De.prototype.sendMixerInputs=function(n){const e=this;var t=0;function r(){t<FC.MIXER_INPUTS.length?e.sendMixerInput(t++,r):n()}r()};De.prototype.sendMixerRule=function(n,e){const t=FC.MIXER_RULES[n],r=[];r.push8(n).push8(t.oper).push8(t.src).push8(t.dst).push16(t.offset).push16(t.weight),MSP.send_message(MSPCodes.MSP_SET_MIXER_RULE,r,!1,e)};De.prototype.sendMixerRules=function(n){const e=this;var t=0;function r(){t<FC.MIXER_RULES.length?e.sendMixerRule(t++,r):n()}r()};De.prototype.resetMixerOverrides=function(n){for(let e=0;e<FC.MIXER_OVERRIDE.length;e++)FC.MIXER_OVERRIDE[e]=2501;this.sendMixerOverrides(n)};De.prototype.sendMixerOverride=function(n,e){const t=FC.MIXER_OVERRIDE[n],r=[];r.push8(n).push16(t),MSP.send_message(MSPCodes.MSP_SET_MIXER_OVERRIDE,r,!1,e)};De.prototype.sendMixerOverrides=function(n){const e=this;var t=0;function r(){t<FC.MIXER_OVERRIDE.length?e.sendMixerOverride(t++,r):n&&n()}r()};De.prototype.sendModeRange=function(n,e){const t=[],r=FC.MODE_RANGES[n];t.push8(n).push8(r.id).push8(r.auxChannelIndex).push8((r.range.start-1500)/5).push8((r.range.end-1500)/5);const i=FC.MODE_RANGES_EXTRA[n];t.push8(i.modeLogic).push8(i.linkedTo),MSP.send_message(MSPCodes.MSP_SET_MODE_RANGE,t,!1,e)};De.prototype.sendModeRanges=function(n){const e=this;var t=0;function r(){t<FC.MODE_RANGES.length?e.sendModeRange(t++,r):n&&n()}r()};De.prototype.sendAdjustmentRange=function(n,e){const t=FC.ADJUSTMENT_RANGES[n],r=[];r.push8(n).push8(t.adjFunction).push8(t.enaChannel).push8((t.enaRange.start-1500)/5).push8((t.enaRange.end-1500)/5).push8(t.adjChannel).push8((t.adjRange1.start-1500)/5).push8((t.adjRange1.end-1500)/5).push8((t.adjRange2.start-1500)/5).push8((t.adjRange2.end-1500)/5).push16(t.adjMin).push16(t.adjMax).push8(t.adjStep),MSP.send_message(MSPCodes.MSP_SET_ADJUSTMENT_RANGE,r,!1,e)};De.prototype.sendAdjustmentRanges=function(n){const e=this;var t=0;function r(){t<FC.ADJUSTMENT_RANGES.length?e.sendAdjustmentRange(t++,r):n&&n()}r()};De.prototype.sendVoltageMeterConfig=function(n,e){const t=FC.VOLTAGE_METER_CONFIGS[n],r=[];r.push8(t.id).push16(t.vbatscale).push16(t.vbatresdivval).push8(t.vbatresdivmultiplier),MSP.send_message(MSPCodes.MSP_SET_VOLTAGE_METER_CONFIG,r,!1,e)};De.prototype.sendVoltageConfig=function(n){const e=this;var t=0;function r(){t<FC.VOLTAGE_METER_CONFIGS.length?e.sendVoltageMeterConfig(t++,r):n&&n()}r()};De.prototype.sendCurrentMeterConfig=function(n,e){const t=FC.CURRENT_METER_CONFIGS[n],r=[];r.push8(t.id).push16(t.scale).push16(t.offset),MSP.send_message(MSPCodes.MSP_SET_CURRENT_METER_CONFIG,r,!1,e)};De.prototype.sendCurrentConfig=function(n){const e=this;var t=0;function r(){t<FC.CURRENT_METER_CONFIGS.length?e.sendCurrentMeterConfig(t++,r):n&&n()}r()};De.prototype.sendLedConfig=function(n,e){const t=FC.LED_STRIP[n],r=[];r.push(n);let i=0;i|=t.y<<0,i|=t.x<<4;for(let o=0;o<t.functions.length;o++){const s=td.indexOf(t.functions[o]);if(s>=0){i|=s<<8;break}}for(let o=0;o<t.functions.length;o++){const s=nd.indexOf(t.functions[o]);s>=0&&(i|=bit_set(i,s+12))}i|=t.color<<20;for(let o=0;o<t.directions.length;o++){const s=ed.indexOf(t.directions[o]);s>=0&&(i|=bit_set(i,s+24))}i|=0,r.push32(i),i=t.blinkPattern<<1,i|=t.blinkPause<<17,i|=t.altColor<<21,r.push32(i),MSP.send_message(MSPCodes.MSP_SET_LED_STRIP_CONFIG,r,!1,e)};De.prototype.sendLedStripConfig=function(n){const e=this;var t=0;function r(){t<FC.LED_STRIP.length?e.sendLedConfig(t++,r):n&&n()}r()};De.prototype.sendLedStripColors=function(n){if(FC.LED_COLORS.length==0)n&&n();else{const e=[];for(const t of FC.LED_COLORS)e.push16(t.h).push8(t.s).push8(t.v);MSP.send_message(MSPCodes.MSP_SET_LED_COLORS,e,!1,n)}};De.prototype.sendLedStripModeColor=function(n,e){const t=FC.LED_MODE_COLORS[n],r=[];r.push8(t.mode).push8(t.direction).push8(t.color),MSP.send_message(MSPCodes.MSP_SET_LED_STRIP_MODECOLOR,r,!1,e)};De.prototype.sendLedStripModeColors=function(n){const e=this;var t=0;function r(){t<FC.LED_MODE_COLORS.length?e.sendLedStripModeColor(t++,r):n&&n()}r()};De.prototype.sendLedStripSettings=function(n){MSP.send_message(MSPCodes.MSP_SET_LED_STRIP_SETTINGS,mspHelper.crunch(MSPCodes.MSP_SET_LED_STRIP_SETTINGS),!1,function(){n&&n()})};De.prototype.serialPortFunctionMaskToFunctions=function(n){const e=this,t=[],r=Object.keys(e.SERIAL_PORT_FUNCTIONS);for(const i of r){const o=e.SERIAL_PORT_FUNCTIONS[i];bit_check(n,o)&&t.push(i)}return t};De.prototype.serialPortFunctionsToMask=function(n){const e=this;let t=0;for(let r=0;r<n.length;r++){const i=n[r],o=e.SERIAL_PORT_FUNCTIONS[i];o>=0&&(t=bit_set(t,o))}return t};De.prototype.sendRxFailChannel=async function(n){const e=FC.RXFAIL_CONFIG[n],t=[];t.push8(n).push8(e.mode).push16(e.value),await MSP.promise(MSPCodes.MSP_SET_RXFAIL_CONFIG,t)};De.prototype.sendRxFailConfig=async function(){for(let n=0;n<FC.RXFAIL_CONFIG.length;n++)await this.sendRxFailChannel(n)};De.prototype.setArmingEnabled=function(n,e){FC.CONFIG.armingDisabled===n?(FC.CONFIG.armingDisabled=!n,MSP.send_message(MSPCodes.MSP_ARMING_DISABLE,mspHelper.crunch(MSPCodes.MSP_ARMING_DISABLE),!1,function(){console.log(i18n.getMessage(n?"armingEnabled":"armingDisabled")),e?.()})):e?.()};De.prototype.requestRpmFilterBanks=async function(){if(CONFIGURATOR.virtualMode)return;const n=[];for(let e=0;e<3;e++){const t=[];n.push(t);const{data:r}=await MSP.promise(MSPCodes.MSP_RPM_FILTER_V2,[e]);if(r.byteLength%4!==0)return;for(;r.remaining();)t.push({rpm_source:r.readU8(),notch_center:r.read16(),notch_q:r.readU8()})}FC.RPM_FILTER_CONFIG_V2=n};const jT={background:"#background",tabContainer:".tab_container",tabContentContainer:"#tab-content-container",headerbar:".headerbar",init:function(){const n=this;$("#menu_btn").click(function(){n.openSideMenu()}),$(this.background).click(function(){n.closeSideMenu()}),$("#tabs a").click(function(){$(".tab_container").hasClass("reveal")&&n.closeSideMenu()}),$("#reveal_btn").click(function(){n.expandHeader()}),$(`${this.background}, ${this.tabContainer}`).swipe({swipeLeft:function(){n.closeSideMenu()}}),$("#side_menu_swipe").swipe({swipeRight:function(){n.openSideMenu()}})},initToolbar:function(){$(".toolbar_expand_btn").click(this.expandToolbar)},openSideMenu:function(){$(this.background).fadeIn(300),$(this.tabContainer).addClass("reveal")},closeSideMenu:function(){$(this.background).fadeOut(300),$(this.tabContainer).removeClass("reveal")},expandHeader:function(){const n=this;let e,t,r;GUI.connected_to?(e="expand2",t="header_expanded2",r=".header-wrapper"):(e="expand",t="headerExpanded",r="#port-picker"),$(n.headerbar).hasClass(e)?($(r).removeClass("reveal"),setTimeout(function(){$(n.tabContentContainer).removeClass(t),$(n.headerbar).removeClass(e)},100)):($(n.tabContentContainer).addClass(t),$(n.headerbar).addClass(e),setTimeout(function(){$(r).addClass("reveal")},100))},expandToolbar:function(){const n=$(".content_toolbar.xs-compressed");n.length>0&&($(".content_toolbar.xs-compressed").hasClass("expanded")?n.removeClass("expanded"):n.addClass("expanded"))},reset:function(){$(this.tabContentContainer).removeClass("header_expanded2 header_expanded"),$("#port-picker, .header-wrapper").removeClass("reveal"),$(this.headerbar).removeClass("expand2 expand")}},qT=500,kd={filters:[{vendorId:1155,productId:57105},{vendorId:10473,productId:393}]},Dt=new function(){this.initialPorts=!1,this.port_detected_callbacks=[],this.port_removed_callbacks=[],this.dfu_available=!1,this.showingAllPorts=!1};Dt.initialize=function(n){const e="div#port-picker #port";this.portPickerElement=$(e),this.selectList=document.querySelector(e),this.initialWidth=this.selectList.offsetWidth+12,this.showingAllPorts=n,generateVirtualApiVersions(),this.check()};Dt.check=function(){const n=this;n.check_usb_devices(),n.check_serial_devices(),GUI.updateManualPortVisibility(),setTimeout(function(){n.check()},qT)};function _m({portName:n,pathSelect:e}){if(n){const t=GUI.operating_system==="Windows",r=e.includes("tty"),i=n.includes("STM")||n.includes("CP210"),o=n.includes("usb");if(t&&i||r&&(i||o))return!0}return!1}Dt.showAllPorts=function(n){this.showingAllPorts!=n&&(this.initialPorts=!1,this.showingAllPorts=n)};Dt.check_serial_devices=function(){const n=this;serial.getDevices(function(e){!GUI.isBrowser&&!n.showingAllPorts&&(e=e.filter(_m)),n.initialPorts?(n.removePort(e),n.detectPort(e)):(e=n.updatePortSelect(e),n.selectPort(e),n.initialPorts=e)})};Dt.check_usb_devices=function(n){const e=this;chrome.usb.getDevices(kd,function(t){const r=e.portPickerElement.children("[value='DFU']");if(t?.length){if(!r.length){e.portPickerElement.empty();let i;t[0].productName?i=`DFU - ${t[0].productName}`:i="DFU",e.portPickerElement.append($("<option/>",{value:"DFU",text:i,data:{isDFU:!0}})),e.portPickerElement.append($("<option/>",{value:"manual",text:i18n.getMessage("portsSelectManual"),data:{isManual:!0}})),e.portPickerElement.val("DFU").change(),e.setPortsInputWidth()}e.dfu_available=!0}else r.length&&(r.remove(),e.setPortsInputWidth()),e.dfu_available=!1;n&&n(e.dfu_available),$("option:selected",e.portPickerElement).data().isDFU||(GUI.connected_to||GUI.connect_lock||FC.resetState(),e.portPickerElement.trigger("change"))})};Dt.removePort=function(n){const e=this,t=e.array_difference(e.initialPorts,n);if(t.length){if(console.log(`PortHandler - Removed: ${JSON.stringify(t)}`),GUI.connected_to)for(let r=0;r<t.length;r++)t[r]===GUI.connected_to&&$("div#header_btns a.connect").click();for(let r=e.port_removed_callbacks.length-1;r>=0;r--){const i=e.port_removed_callbacks[r];clearTimeout(i.timer),i.code(t);const o=e.port_removed_callbacks.indexOf(i);o>-1&&e.port_removed_callbacks.splice(o,1)}for(let r=0;r<t.length;r++)e.initialPorts.splice(e.initialPorts.indexOf(t[r]),1);e.updatePortSelect(e.initialPorts)}};Dt.detectPort=function(n){const e=this,t=e.array_difference(n,e.initialPorts);if(t.length){n=e.updatePortSelect(n),console.log(`PortHandler - Found: ${JSON.stringify(t)}`);const r=We("last_used_port");r&&(r.includes("tcp")?e.portPickerElement.val("manual"):t.length===1?e.portPickerElement.val(t[0].path):t.length>1&&e.selectPort(n)),GUI.auto_connect&&!GUI.connecting_to&&!GUI.connected_to&&GUI.active_tab!=="firmware_flasher"&&GUI.timeout_add("auto-connect_timeout",function(){$("div#header_btns a.connect").click()},We("connectionTimeout")??100);for(let i=e.port_detected_callbacks.length-1;i>=0;i--){const o=e.port_detected_callbacks[i];clearTimeout(o.timer),o.code(t);const s=e.port_detected_callbacks.indexOf(o);s>-1&&e.port_detected_callbacks.splice(s,1)}e.initialPorts=n}};Dt.sortPorts=function(n){return n.sort(function(e,t){return e.path.localeCompare(t.path,window.navigator.language,{numeric:!0,sensitivity:"base"})})};Dt.updatePortSelect=function(n){n=this.sortPorts(n),this.portPickerElement.empty();for(let e=0;e<n.length;e++){let t;n[e].displayName?t=`${n[e].path} - ${n[e].displayName}`:t=n[e].path,this.portPickerElement.append($("<option/>",{value:n[e].path,text:t,data:{isManual:!1}}))}return this.portPickerElement.append($("<option/>",{value:"manual",text:i18n.getMessage("portsSelectManual"),data:{isManual:!0}})),GUI.isBrowser()&&(this.portPickerElement.append($("<option/>",{value:"serialPermission",text:i18n.getMessage("portsSelectPermission"),data:{isManual:!1,requestPermission:e=>chrome.serial.requestPermission(e)}})),this.portPickerElement.append($("<option/>",{value:"usbPermission",text:i18n.getMessage("portsSelectPermissionDFU"),data:{isManual:!1,requestPermission:()=>chrome.usb.requestPermission(kd)}}))),this.setPortsInputWidth(),n};Dt.selectPort=function(n){for(let e=0;e<n.length;e++){const t=n[e].displayName;if(t){const r=n[e].path;_m(t)&&(this.portPickerElement.val(r),console.log(`Porthandler detected device ${t} on port: ${r}`))}}this.portPickerElement.data("current",this.portPickerElement.val())};Dt.setPortsInputWidth=function(){function n(i){let o=0;return $(i.options).each(function(){const s=getTextWidth(this.textContent);s>o&&(o=s)}),o}let t=n(this.selectList)+24;t=t>this.initialWidth?t:this.initialWidth;const r=document.querySelector("div#port-picker #portsinput");r.style.width=`${t}px`};Dt.port_detected=function(n,e,t,r){const i=this,o={name:n,code:e,timeout:t||1e4};return r?(o.timer=!1,o.timeout=!1):o.timer=setTimeout(function(){console.log(`PortHandler - timeout - ${o.name}`),e(!1);const s=i.port_detected_callbacks.indexOf(o);s>-1&&i.port_detected_callbacks.splice(s,1)},t||1e4),this.port_detected_callbacks.push(o),o};Dt.port_removed=function(n,e,t,r){const i=this,o={name:n,code:e,timeout:t||1e4};return r?(o.timer=!1,o.timeout=!1):o.timer=setTimeout(function(){console.log(`PortHandler - timeout - ${o.name}`),e(!1);const s=i.port_removed_callbacks.indexOf(o);s>-1&&i.port_removed_callbacks.splice(s,1)},t||1e4),this.port_removed_callbacks.push(o),o};Dt.array_difference=function(n,e){const t=[];for(let r=0;r<n.length;r++)t.push(n[r]);for(let r=0;r<e.length;r++){const i=t.findIndex(o=>o.path===e[r].path);i!==-1&&t.splice(i,1)}return t};Dt.flush_callbacks=function(){let n=0;for(let e=this.port_detected_callbacks.length-1;e>=0;e--)this.port_detected_callbacks[e].timer&&clearTimeout(this.port_detected_callbacks[e].timer),this.port_detected_callbacks.splice(e,1),n++;for(let e=this.port_removed_callbacks.length-1;e>=0;e--)this.port_removed_callbacks[e].timer&&clearTimeout(this.port_removed_callbacks[e].timer),this.port_removed_callbacks.splice(e,1),n++;return n};const Ud=function(){this.baud=void 0,this.port=void 0,this.onConnectCallback=void 0,this.onTimeoutCallback=void 0,this.onDisconnectCallback=void 0};Ud.prototype.connect=function(n,e,t,r,i){const o=this;o.port=n,o.baud=e,o.onConnectCallback=t,o.onTimeoutCallback=r,o.onFailureCallback=i,serial.connect(o.port,{bitrate:o.baud},function(s){if(s){const l=function(){serial.disconnect(function(){console.log("Disconnected"),MSP.clearListeners(),o.onTimeoutCallback()}),MSP.disconnect_cleanup()};FC.resetState(),GUI.timeout_add("msp_connector",function(){CONFIGURATOR.connectionValid||(GUI.log(i18n.getMessage("noConfigurationReceived")),l())},1e4),serial.onReceive.addListener(read_serial);const a=new MspHelper;MSP.listen(a.process_data.bind(a)),MSP.send_message(MSPCodes.MSP_API_VERSION,!1,!1,function(){CONFIGURATOR.connectionValid=!0,GUI.timeout_remove("msp_connector"),console.log("Connected"),o.onConnectCallback()})}else GUI.log(i18n.getMessage("serialPortOpenFail")),o.onFailureCallback()})};Ud.prototype.disconnect=function(n){self.onDisconnectCallback=n,serial.disconnect(function(e){MSP.clearListeners(),console.log("Disconnected"),self.onDisconnectCallback(e)}),MSP.disconnect_cleanup()};var Hn=function(){this.baud=null,this.options={},this.callback=null,this.hex=null,this.verify_hex=[],this.receive_buffer=[],this.bytes_to_read=0,this.read_callback=null,this.upload_time_start=0,this.upload_process_alive=!1,this.msp_connector=new Ud,this.status={ACK:121,NACK:31},this.command={get:0,get_ver_r_protect_s:1,get_ID:2,read_memory:17,go:33,write_memory:49,erase:67,extended_erase:68,write_protect:99,write_unprotect:115,readout_protect:130,readout_unprotect:146},this.available_flash_size=0,this.page_size=0,this.useExtendedErase=!1};Hn.prototype.connect=function(n,e,t,r,i){var o=this;if(o.hex=t,o.port=n,o.baud=e,o.callback=i,o.options={no_reboot:!1,reboot_baud:!1,erase_chip:!1},r.no_reboot?o.options.no_reboot=!0:o.options.reboot_baud=r.reboot_baud,r.erase_chip&&(o.options.erase_chip=!0),o.options.no_reboot)serial.connect(n,{bitrate:o.baud,parityBit:"even",stopBits:"one"},function(u){u?(GUI.connect_lock=!0,o.initialize()):GUI.log(i18n.getMessage("serialPortOpenFail"))});else{var s=function(){PortHandler.check_usb_devices(async function(u){u||GUI.isBrowser&&await chrome.usb.requestPermission(usbDevices)?STM32DFU.connect(usbDevices,t,r):serial.connect(o.port,{bitrate:o.baud,parityBit:"even",stopBits:"one"},function(p){p?o.initialize():(GUI.connect_lock=!1,GUI.log(i18n.getMessage("serialPortOpenFail")))})})},l=function(){GUI.log(i18n.getMessage("apiVersionReceived",[FC.CONFIG.apiVersion])),console.log("Looking for capabilities via MSP"),MSP.send_message(MSPCodes.MSP_BOARD_INFO,!1,!1,function(){var u=0;bit_check(FC.CONFIG.targetCapabilities,FC.TARGET_CAPABILITIES_FLAGS.HAS_FLASH_BOOTLOADER)?(GUI.log(i18n.getMessage("deviceRebooting_flashBootloader")),console.log("flash bootloader detected"),u=4):(GUI.log(i18n.getMessage("deviceRebooting_romBootloader")),console.log("no flash bootloader detected"),u=1);var p=[];p.push8(u),MSP.send_message(MSPCodes.MSP_SET_REBOOT,p,function(){o.msp_connector.disconnect(function(h){h?setTimeout(s,1e3):GUI.connect_lock=!1})},function(){console.log("Reboot request recevied by device")})})},a=function(){GUI.connect_lock=!1,console.log("Looking for capabilities via MSP failed"),TABS.firmware_flasher.flashingMessage(i18n.getMessage("stm32RebootingToBootloaderFailed"),TABS.firmware_flasher.FLASH_MESSAGE_TYPES.INVALID)},c=function(){GUI.connect_lock=!1};GUI.connect_lock=!0,TABS.firmware_flasher.flashingMessage(i18n.getMessage("stm32RebootingToBootloader"),TABS.firmware_flasher.FLASH_MESSAGE_TYPES.NEUTRAL),o.msp_connector.connect(o.port,o.options.reboot_baud,l,a,c)}};Hn.prototype.initialize=function(){var n=this;n.receive_buffer=[],n.verify_hex=[],n.upload_time_start=new Date().getTime(),n.upload_process_alive=!1,TABS.firmware_flasher.flashingMessage(null,TABS.firmware_flasher.FLASH_MESSAGE_TYPES.NEUTRAL).flashProgress(0),$('select[name="release"]').prop("disabled",!0),serial.onReceive.addListener(function(e){n.read(e)}),GUI.interval_add("STM32_timeout",function(){n.upload_process_alive?n.upload_process_alive=!1:(console.log("STM32 - timed out, programming failed ..."),TABS.firmware_flasher.flashingMessage(i18n.getMessage("stm32TimedOut"),TABS.firmware_flasher.FLASH_MESSAGE_TYPES.INVALID),GUI.interval_remove("STM32_timeout"),n.upload_procedure(99))},2e3),n.upload_procedure(1)};Hn.prototype.read=function(n){let e=new Uint8Array(n.data);for(var t=0;t<e.length;t++)this.receive_buffer.push(e[t]);this.receive_buffer.length>=this.bytes_to_read&&this.bytes_to_read!=0&&(e=this.receive_buffer.slice(0,this.bytes_to_read),this.receive_buffer.splice(0,this.bytes_to_read),this.bytes_to_read=0,this.read_callback(e))};Hn.prototype.retrieve=function(n,e){if(this.receive_buffer.length>=n){var t=this.receive_buffer.slice(0,n);this.receive_buffer.splice(0,n),e(t)}else this.bytes_to_read=n,this.read_callback=e};Hn.prototype.send=function(n,e,t){this.upload_process_alive=!0;var r=new ArrayBuffer(n.length),i=new Uint8Array(r);i.set(n),this.bytes_to_read=e,this.read_callback=t,this.receive_buffer=[],serial.send(r,function(){})};Hn.prototype.verify_response=function(n,e){if(n!=e[0]){var t="STM32 Communication failed, wrong response, expected: "+n+" (0x"+n.toString(16)+") received: "+e[0]+" (0x"+e[0].toString(16)+")";return console.error(t),TABS.firmware_flasher.flashingMessage(i18n.getMessage("stm32WrongResponse",[n,n.toString(16),e[0],e[0].toString(16)]),TABS.firmware_flasher.FLASH_MESSAGE_TYPES.INVALID),this.upload_procedure(99),!1}return!0};Hn.prototype.verify_chip_signature=function(n){switch(n){case 1042:console.log("Chip recognized as F1 Low-density");break;case 1040:console.log("Chip recognized as F1 Medium-density"),this.available_flash_size=131072,this.page_size=1024;break;case 1044:this.available_flash_size=262144,this.page_size=2048,console.log("Chip recognized as F1 High-density");break;case 1048:console.log("Chip recognized as F1 Connectivity line");break;case 1056:console.log("Chip recognized as F1 Medium-density value line");break;case 1064:console.log("Chip recognized as F1 High-density value line");break;case 1072:console.log("Chip recognized as F1 XL-density value line");break;case 1046:console.log("Chip recognized as L1 Medium-density ultralow power");break;case 1078:console.log("Chip recognized as L1 High-density ultralow power");break;case 1063:console.log("Chip recognized as L1 Medium-density plus ultralow power");break;case 1041:console.log("Chip recognized as F2 STM32F2xxxx");break;case 1088:console.log("Chip recognized as F0 STM32F051xx");break;case 1092:console.log("Chip recognized as F0 STM32F050xx");break;case 1043:console.log("Chip recognized as F4 STM32F40xxx/41xxx");break;case 1049:console.log("Chip recognized as F4 STM32F427xx/437xx, STM32F429xx/439xx");break;case 1074:console.log("Chip recognized as F3 STM32F37xxx, STM32F38xxx");break;case 1058:console.log("Chip recognized as F3 STM32F30xxx, STM32F31xxx"),this.available_flash_size=262144,this.page_size=2048;break}return this.available_flash_size>0?this.hex.bytes_total<this.available_flash_size?!0:(console.log("Supplied hex is bigger then flash available on the chip, HEX: "+this.hex.bytes_total+" bytes, limit = "+this.available_flash_size+" bytes"),!1):(console.log("Chip NOT recognized: "+n),!1)};Hn.prototype.verify_flash=function(n,e){for(var t=0;t<n.length;t++)if(n[t]!=e[t])return console.log("Verification failed on byte: "+t+" expected: 0x"+n[t].toString(16)+" received: 0x"+e[t].toString(16)),!1;return console.log("Verification successful, matching: "+n.length+" bytes"),!0};Hn.prototype.upload_procedure=function(n){var e=this;switch(n){case 1:{TABS.firmware_flasher.flashingMessage(i18n.getMessage("stm32ContactingBootloader"),TABS.firmware_flasher.FLASH_MESSAGE_TYPES.NEUTRAL);var t=0;GUI.interval_add("stm32_initialize_mcu",function(){e.send([127],1,function(s){s[0]==127||s[0]==e.status.ACK||s[0]==e.status.NACK?(GUI.interval_remove("stm32_initialize_mcu"),console.log("STM32 - Serial interface initialized on the MCU side"),e.upload_procedure(2)):(TABS.firmware_flasher.flashingMessage(i18n.getMessage("stm32ContactingBootloaderFailed"),TABS.firmware_flasher.FLASH_MESSAGE_TYPES.INVALID),GUI.interval_remove("stm32_initialize_mcu"),e.upload_procedure(99))}),t++>3&&(console.log("STM32 - no response from bootloader, disconnecting"),TABS.firmware_flasher.flashingMessage(i18n.getMessage("stm32ResponseBootloaderFailed"),TABS.firmware_flasher.FLASH_MESSAGE_TYPES.INVALID),GUI.interval_remove("stm32_initialize_mcu"),GUI.interval_remove("STM32_timeout"),e.upload_procedure(99))},250,!0);break}case 2:{e.send([e.command.get,255],2,function(s){e.verify_response(e.status.ACK,s)&&e.retrieve(s[1]+1+1,function(l){console.log("STM32 - Bootloader version: "+(parseInt(l[0].toString(16))/10).toFixed(1)),e.useExtendedErase=l[7]==e.command.extended_erase,e.upload_procedure(3)})});break}case 3:{e.send([e.command.get_ID,253],2,function(s){e.verify_response(e.status.ACK,s)&&e.retrieve(s[1]+1+1,function(l){var a=l[0]<<8|l[1];console.log("STM32 - Signature: 0x"+a.toString(16)),e.verify_chip_signature(a)?e.upload_procedure(4):e.upload_procedure(99)})});break}case 4:{if(e.useExtendedErase){e.options.erase_chip?(console.log("Executing global chip erase (via extended erase)"),TABS.firmware_flasher.flashingMessage(i18n.getMessage("stm32GlobalEraseExtended"),TABS.firmware_flasher.FLASH_MESSAGE_TYPES.NEUTRAL),e.send([e.command.extended_erase,187],1,function(l){e.verify_response(e.status.ACK,l)&&e.send([255,255,0],1,function(a){e.verify_response(e.status.ACK,a)&&(console.log("Executing global chip extended erase: done"),e.upload_procedure(5))})})):(console.log("Executing local erase (via extended erase)"),TABS.firmware_flasher.flashingMessage(i18n.getMessage("stm32LocalEraseExtended"),TABS.firmware_flasher.FLASH_MESSAGE_TYPES.NEUTRAL),e.send([e.command.extended_erase,187],1,function(l){if(e.verify_response(e.status.ACK,l)){var a=e.hex.data[e.hex.data.length-1].address+e.hex.data[e.hex.data.length-1].bytes-134217728,c=Math.ceil(a/e.page_size),u=[],p=0,h;h=c-1>>8,u.push(h),p^=h,h=c-1&255,u.push(h),p^=h;for(var g=0;g<c;g++)h=g>>8,u.push(h),p^=h,h=g&255,u.push(h),p^=h;u.push(p),console.log("Erasing. pages: 0x00 - 0x"+c.toString(16)+", checksum: 0x"+p.toString(16)),e.send(u,1,function(f){e.verify_response(e.status.ACK,f)&&(console.log("Erasing: done"),e.upload_procedure(5))})}}));break}e.options.erase_chip?(console.log("Executing global chip erase"),TABS.firmware_flasher.flashingMessage(i18n.getMessage("stm32GlobalErase"),TABS.firmware_flasher.FLASH_MESSAGE_TYPES.NEUTRAL),e.send([e.command.erase,188],1,function(l){e.verify_response(e.status.ACK,l)&&e.send([255,0],1,function(a){e.verify_response(e.status.ACK,a)&&(console.log("Erasing: done"),e.upload_procedure(5))})})):(console.log("Executing local erase"),TABS.firmware_flasher.flashingMessage(i18n.getMessage("stm32LocalErase"),TABS.firmware_flasher.FLASH_MESSAGE_TYPES.NEUTRAL),e.send([e.command.erase,188],1,function(l){if(e.verify_response(e.status.ACK,l)){var a=e.hex.data[e.hex.data.length-1].address+e.hex.data[e.hex.data.length-1].bytes-134217728,c=Math.ceil(a/e.page_size),u=[],p=c-1;u.push(c-1);for(var h=0;h<c;h++)u.push(h),p^=h;u.push(p),e.send(u,1,function(g){e.verify_response(e.status.ACK,g)&&(console.log("Erasing: done"),e.upload_procedure(5))})}}));break}case 5:{console.log("Writing data ..."),TABS.firmware_flasher.flashingMessage(i18n.getMessage("stm32Flashing"),TABS.firmware_flasher.FLASH_MESSAGE_TYPES.NEUTRAL);let s=e.hex.data.length-1,l=0,a=e.hex.data[l].address,c=0,u=0;var r=function(){if(c<e.hex.data[l].bytes){var p=c+256<=e.hex.data[l].bytes?256:e.hex.data[l].bytes-c;e.send([e.command.write_memory,206],1,function(h){if(e.verify_response(e.status.ACK,h)){var g=[a>>24,a>>16,a>>8,a],f=g[0]^g[1]^g[2]^g[3];e.send([g[0],g[1],g[2],g[3],f],1,function(d){if(e.verify_response(e.status.ACK,d)){var _=new Array(p+2);_[0]=p-1;for(var m=_[0],C=0;C<p;C++)_[C+1]=e.hex.data[l].data[c],m^=e.hex.data[l].data[c],c++;_[_.length-1]=m,a+=p,u+=p,e.send(_,1,function(R){e.verify_response(e.status.ACK,R)&&r()}),TABS.firmware_flasher.flashProgress(Math.round(u/(e.hex.bytes_total*2)*100))}})}})}else l<s?(l++,a=e.hex.data[l].address,c=0,r()):(console.log("Writing: done"),e.upload_procedure(6))};r();break}case 6:{console.log("Verifying data ..."),TABS.firmware_flasher.flashingMessage(i18n.getMessage("stm32Verifying"),TABS.firmware_flasher.FLASH_MESSAGE_TYPES.NEUTRAL);let s=e.hex.data.length-1,l=0,a=e.hex.data[l].address,c=0,u=0;for(var i=0;i<=s;i++)e.verify_hex.push([]);var o=function(){if(c<e.hex.data[l].bytes){var p=c+256<=e.hex.data[l].bytes?256:e.hex.data[l].bytes-c;e.send([e.command.read_memory,238],1,function(f){if(e.verify_response(e.status.ACK,f)){var d=[a>>24,a>>16,a>>8,a],_=d[0]^d[1]^d[2]^d[3];e.send([d[0],d[1],d[2],d[3],_],1,function(m){if(e.verify_response(e.status.ACK,m)){var C=p-1;e.send([C,~C&255],1,function(R){e.verify_response(e.status.ACK,R)&&e.retrieve(p,function(S){for(var F=0;F<S.length;F++)e.verify_hex[l].push(S[F]);a+=p,c+=p,u+=p,o()})}),TABS.firmware_flasher.flashProgress(Math.round((e.hex.bytes_total+u)/(e.hex.bytes_total*2)*100))}})}})}else if(l<s)l++,a=e.hex.data[l].address,c=0,o();else{for(var h=!0,g=0;g<=s&&(h=e.verify_flash(e.hex.data[g].data,e.verify_hex[g]),!!h);g++);h?(console.log("Programming: SUCCESSFUL"),TABS.firmware_flasher.flashingMessage(i18n.getMessage("stm32ProgrammingSuccessful"),TABS.firmware_flasher.FLASH_MESSAGE_TYPES.VALID),e.upload_procedure(7)):(console.log("Programming: FAILED"),TABS.firmware_flasher.flashingMessage(i18n.getMessage("stm32ProgrammingFailed"),TABS.firmware_flasher.FLASH_MESSAGE_TYPES.INVALID),e.upload_procedure(99))}};o();break}case 7:{console.log("Sending GO command: 0x8000000"),e.send([e.command.go,222],1,function(s){if(e.verify_response(e.status.ACK,s)){var l=134217728,a=[l>>24,l>>16,l>>8,l],c=a[0]^a[1]^a[2]^a[3];e.send([a[0],a[1],a[2],a[3],c],1,function(u){e.verify_response(e.status.ACK,u)&&e.upload_procedure(99)})}});break}case 99:{GUI.interval_remove("STM32_timeout"),serial.connectionId?serial.disconnect(e.cleanup):e.cleanup();break}}};Hn.prototype.cleanup=function(){jo.reset(),GUI.connect_lock=!1,$('select[name="release"]').prop("disabled",!1);var n=new Date().getTime()-self.upload_time_start;console.log("Script finished after: "+n/1e3+" seconds"),self.callback?.()};const KT=new Hn;var Pt=function(){this.callback=null,this.hex=null,this.verify_hex=[],this.handle=null,this.request={DETACH:0,DNLOAD:1,UPLOAD:2,GETSTATUS:3,CLRSTATUS:4,GETSTATE:5,ABORT:6},this.status={OK:0,errTARGET:1,errFILE:2,errWRITE:3,errERASE:4,errCHECK_ERASED:5,errPROG:6,errVERIFY:7,errADDRESS:8,errNOTDONE:9,errFIRMWARE:10,errVENDOR:11,errUSBR:12,errPOR:13,errUNKNOWN:14,errSTALLEDPKT:15},this.state={appIDLE:0,appDETACH:1,dfuIDLE:2,dfuDNLOAD_SYNC:3,dfuDNBUSY:4,dfuDNLOAD_IDLE:5,dfuMANIFEST_SYNC:6,dfuMANIFEST:7,dfuMANIFEST_WAIT_RESET:8,dfuUPLOAD_IDLE:9,dfuERROR:10},this.chipInfo=null,this.flash_layout={start_address:0,total_size:0,sectors:[]},this.transferSize=2048};Pt.prototype.connect=function(n,e,t,r){var i=this;i.hex=e,i.callback=r,i.options={erase_chip:!1,exitDfu:!1},t.exitDfu?i.options.exitDfu=!0:t.erase_chip&&(i.options.erase_chip=!0),i.upload_time_start=new Date().getTime(),i.verify_hex=[],TABS.firmware_flasher.flashingMessage(null,TABS.firmware_flasher.FLASH_MESSAGE_TYPES.NEUTRAL).flashProgress(0),chrome.usb.getDevices(n,function(o){o.length?(console.log("USB DFU detected with ID: "+o[0].device),i.openDevice(o[0])):(console.log("USB DFU not found"),GUI.log(i18n.getMessage("stm32UsbDfuNotFound")))})};Pt.prototype.openDevice=function(n){var e=this;chrome.usb.openDevice(n,function(t){if(checkChromeRuntimeError()){console.log("Failed to open USB device!"),GUI.log(i18n.getMessage("usbDeviceOpenFail")),GUI.operating_system==="Linux"&&GUI.log(i18n.getMessage("usbDeviceUdevNotice"));return}e.handle=t,GUI.log(i18n.getMessage("usbDeviceOpened",t.handle.toString())),console.log("Device opened with Handle ID: "+t.handle),e.claimInterface(0)})};Pt.prototype.closeDevice=function(){var n=this;chrome.usb.closeDevice(this.handle,function(){checkChromeRuntimeError()&&(console.log("Failed to close USB device!"),GUI.log(i18n.getMessage("usbDeviceCloseFail"))),GUI.log(i18n.getMessage("usbDeviceClosed")),console.log("Device closed with Handle ID: "+n.handle.handle),n.handle=null})};Pt.prototype.claimInterface=function(n){var e=this;chrome.usb.claimInterface(this.handle,n,function(){checkChromeRuntimeError()&&GUI.operating_system!=="MacOS"&&(console.log("Failed to claim USB device!"),e.cleanup()),console.log("Claimed interface: "+n),e.options.exitDfu?e.leave():e.upload_procedure(0)})};Pt.prototype.releaseInterface=function(n){var e=this;chrome.usb.releaseInterface(this.handle,n,function(){console.log("Released interface: "+n),e.closeDevice()})};Pt.prototype.resetDevice=function(n){chrome.usb.resetDevice(this.handle,function(e){console.log("Reset Device: "+e),n?.()})};Pt.prototype.getString=function(n,e){var t=this;chrome.usb.controlTransfer(t.handle,{direction:"in",recipient:"device",requestType:"standard",request:6,value:768|n,index:0,length:255},function(r){if(checkChromeRuntimeError()){console.log("USB getString failed! "+r.resultCode),e("",r.resultCode);return}for(var i=new DataView(r.data),o=i.getUint8(0),s="",l=2;l<o;l+=2){var a=i.getUint16(l,!0);s+=String.fromCharCode(a)}e(s,r.resultCode)})};Pt.prototype.getInterfaceDescriptors=function(n,e){var t=this;chrome.usb.getConfiguration(this.handle,function(r){if(checkChromeRuntimeError()){console.log("USB getConfiguration failed!"),e([],-200);return}let i=r.interfaces.length,o;i===0?e(0,1):GUI.isBrowser&&i===1?o=r.interfaces[0].alternates.length:i>1&&(o=i);var s=0,l=[],a=function(){if(s<o)t.getInterfaceDescriptor(s,function(c,u){if(u){e([],u);return}s++,t.getString(c.iInterface,function(p,h){if(h){e([],h);return}c.bInterfaceNumber==n&&l.push(p),a()})});else{e(l,0);return}};a()})};Pt.prototype.getInterfaceDescriptor=function(n,e){chrome.usb.controlTransfer(this.handle,{direction:"in",recipient:"device",requestType:"standard",request:6,value:512,index:0,length:18+n*9},function(t){if(checkChromeRuntimeError()){console.log("USB getInterfaceDescriptor failed! "+t.resultCode),e({},t.resultCode);return}var r=new Uint8Array(t.data,9+n*9),i={bLength:r[0],bDescriptorType:r[1],bInterfaceNumber:r[2],bAlternateSetting:r[3],bNumEndpoints:r[4],bInterfaceClass:r[5],bInterfaceSubclass:r[6],bInterfaceProtocol:r[7],iInterface:r[8]};e(i,t.resultCode)})};Pt.prototype.getFunctionalDescriptor=function(n,e){chrome.usb.controlTransfer(this.handle,{direction:"in",recipient:"interface",requestType:"standard",request:6,value:8448,index:0,length:255},function(t){if(checkChromeRuntimeError()){console.log("USB getFunctionalDescriptor failed! "+t.resultCode),e({},t.resultCode);return}var r=new Uint8Array(t.data),i={bLength:r[0],bDescriptorType:r[1],bmAttributes:r[2],wDetachTimeOut:r[4]<<8|r[3],wTransferSize:r[6]<<8|r[5],bcdDFUVersion:r[7]};e(i,t.resultCode)})};Pt.prototype.getChipInfo=function(n,e){var t=this;t.getInterfaceDescriptors(0,function(r,i){if(i){e({},i);return}var o=function(l){l=="@External Flash /0x90000000/1001*128Kg,3*128Kg,20*128Ka"&&(l="@External Flash /0x90000000/998*128Kg,1*128Kg,4*128Kg,21*128Ka");var a=l.replace(/[^\x20-\x7E]+/g,""),c=a.split("/");if(c.length>3&&(console.log('parseDescriptor: shrinking long descriptor "'+l+'"'),c.length=3),!c[0].startsWith("@"))return null;var u=c[0].trim().replace("@",""),p=parseInt(c[1]),h=[],g=0,f=c[2].split(",");if(f.length<1)return null;for(var d=0;d<f.length;d++){var _=f[d].split("*");if(_.length!=2)return null;var m=parseInt(_[0]),C=parseInt(_[1]);if(!C)return null;var R=_[1].slice(-2,-1);switch(R){case"M":C*=1024;case"K":C*=1024;break}h.push({num_pages:m,start_address:p+g,page_size:C,total_size:m*C}),g+=m*C}var S={type:u,start_address:p,sectors:h,total_size:g};return S},s=r.map(o).reduce(function(l,a){return l[a.type.toLowerCase().replace(" ","_")]=a,l},{});e(s,i)})};Pt.prototype.controlTransfer=function(n,e,t,r,i,o,s,l){var a;if(typeof l>"u"?a=0:a=l,n=="in")chrome.usb.controlTransfer(this.handle,{direction:"in",recipient:"interface",requestType:"class",request:e,value:t,index:r,length:i,timeout:a},function(u){checkChromeRuntimeError()&&console.log("USB controlTransfer IN failed for request "+e+"!"),u.resultCode&&console.log("USB transfer result code: "+u.resultCode);var p=new Uint8Array(u.data);s(p,u.resultCode)});else{let u;if(o){u=new ArrayBuffer(o.length);var c=new Uint8Array(u);c.set(o)}else u=new ArrayBuffer(0);chrome.usb.controlTransfer(this.handle,{direction:"out",recipient:"interface",requestType:"class",request:e,value:t,index:r,data:u,timeout:a},function(p){checkChromeRuntimeError()&&console.log("USB controlTransfer OUT failed for request "+e+"!"),p.resultCode&&console.log("USB transfer result code: "+p.resultCode),s(p)})}};Pt.prototype.clearStatus=function(n){var e=this;function t(){e.controlTransfer("in",e.request.GETSTATUS,0,0,6,0,function(i){if(i[4]==e.state.dfuIDLE)n(i);else{var o=i[1]|i[2]<<8|i[3]<<16;setTimeout(r,o)}})}function r(){e.controlTransfer("out",e.request.CLRSTATUS,0,0,0,0,t)}t()};Pt.prototype.loadAddress=function(n,e,t){var r=this;r.controlTransfer("out",r.request.DNLOAD,0,0,0,[33,n&255,n>>8&255,n>>16&255,n>>24&255],function(){r.controlTransfer("in",r.request.GETSTATUS,0,0,6,0,function(i){if(i[4]==r.state.dfuDNBUSY){var o=i[1]|i[2]<<8|i[3]<<16;setTimeout(function(){r.controlTransfer("in",r.request.GETSTATUS,0,0,6,0,function(s){s[4]==r.state.dfuDNLOAD_IDLE?e(s):(console.log("Failed to execute address load"),typeof t>"u"||t?r.cleanup():e(s))})},o)}else console.log("Failed to request address load"),r.cleanup()})})};Pt.prototype.verify_flash=function(n,e){for(var t=0;t<n.length;t++)if(n[t]!=e[t])return console.log("Verification failed on byte: "+t+" expected: 0x"+n[t].toString(16)+" received: 0x"+e[t].toString(16)),!1;return console.log("Verification successful, matching: "+n.length+" bytes"),!0};Pt.prototype.upload_procedure=function(n){var e=this;switch(n){case 0:{e.getChipInfo(0,function(G,U){if(U!=0||typeof G>"u")console.log("Failed to detect chip info, resultCode: "+U),e.cleanup();else if(typeof G.internal_flash<"u")e.chipInfo=G,e.flash_layout=G.internal_flash,e.available_flash_size=e.flash_layout.total_size-(e.hex.start_linear_address-e.flash_layout.start_address),GUI.log(i18n.getMessage("dfu_device_flash_info",(e.flash_layout.total_size/1024).toString())),e.hex.bytes_total>e.available_flash_size?(GUI.log(i18n.getMessage("dfu_error_image_size",[(e.hex.bytes_total/1024).toFixed(1),(e.available_flash_size/1024).toFixed(1)])),e.cleanup()):e.getFunctionalDescriptor(0,function(x,k){e.transferSize=k?2048:x.wTransferSize,console.log("Using transfer size: "+e.transferSize),e.clearStatus(function(){e.upload_procedure(1)})});else if(typeof G.external_flash<"u"){e.chipInfo=G,e.flash_layout=G.external_flash;var M=2,N=e.flash_layout.sectors[M],w=N.total_size;e.available_flash_size=w,GUI.log(i18n.getMessage("dfu_device_flash_info",(e.flash_layout.total_size/1024).toString())),e.hex.bytes_total>e.available_flash_size?(GUI.log(i18n.getMessage("dfu_error_image_size",[(e.hex.bytes_total/1024).toFixed(1),(e.available_flash_size/1024).toFixed(1)])),e.cleanup()):e.getFunctionalDescriptor(0,function(x,k){e.transferSize=k?2048:x.wTransferSize,console.log("Using transfer size: "+e.transferSize),e.clearStatus(function(){e.upload_procedure(2)})})}else console.log("Failed to detect internal or external flash"),e.cleanup()});break}case 1:{if(typeof e.chipInfo.option_bytes>"u"){console.log("Failed to detect option bytes"),e.cleanup();return}var t=function(){console.log("Initiate read unprotect");let G=i18n.getMessage("stm32ReadProtected");GUI.log(G),TABS.firmware_flasher.flashingMessage(G,TABS.firmware_flasher.FLASH_MESSAGE_TYPES.ACTION),e.controlTransfer("out",e.request.DNLOAD,0,0,0,[146],function(){e.controlTransfer("in",e.request.GETSTATUS,0,0,6,0,function(U){if(U[4]==e.state.dfuDNBUSY)var M=U[1]|U[2]<<8|U[3]<<16,N=M+2e4,w=0,x=1e3,k=setInterval(function(){if(TABS.firmware_flasher.flashProgress(Math.min(w/N,1)*100),w<N){w+=x;return}clearInterval(k),e.controlTransfer("in",e.request.GETSTATUS,0,0,6,0,function(O,D){if(D){console.log("Unprotect memory command ran successfully. Unplug flight controller. Connect again in DFU mode and try flashing again."),GUI.log(i18n.getMessage("stm32UnprotectSuccessful"));let Y=i18n.getMessage("stm32UnprotectUnplug");GUI.log(Y),TABS.firmware_flasher.flashingMessage(Y,TABS.firmware_flasher.FLASH_MESSAGE_TYPES.ACTION).flashProgress(0)}else console.log("Failed to execute unprotect memory command"),GUI.log(i18n.getMessage("stm32UnprotectFailed")),TABS.firmware_flasher.flashingMessage(i18n.getMessage("stm32UnprotectFailed"),TABS.firmware_flasher.FLASH_MESSAGE_TYPES.INVALID),console.log(O),e.cleanup()},2e3)},x);else{console.log("Failed to initiate unprotect memory command");let O=i18n.getMessage("stm32UnprotectInitFailed");GUI.log(O),TABS.firmware_flasher.flashingMessage(O,TABS.firmware_flasher.FLASH_MESSAGE_TYPES.INVALID),e.cleanup()}})})},r=function(){e.controlTransfer("in",e.request.UPLOAD,2,0,e.chipInfo.option_bytes.total_size,0,function(G,U){if(U){console.log("USB transfer error while reading option bytes: "+errcode1),e.cleanup();return}e.controlTransfer("in",e.request.GETSTATUS,0,0,6,0,function(M){M[4]==e.state.dfuUPLOAD_IDLE&&G.length==e.chipInfo.option_bytes.total_size?(console.log("Option bytes read successfully"),console.log("Chip does not appear read protected"),GUI.log(i18n.getMessage("stm32NotReadProtected")),e.clearStatus(function(){e.upload_procedure(2)})):(console.log("Option bytes could not be read. Quite possibly read protected."),e.clearStatus(t))})})},i=function(G){if(G[4]==e.state.dfuERROR&&G[0]==e.status.errVENDOR){GUI.log(i18n.getMessage("stm32AddressLoadFailed")),e.clearStatus(t);return}else G[4]==e.state.dfuDNLOAD_IDLE?(console.log("Address load for option bytes sector succeeded."),e.clearStatus(r)):(GUI.log(i18n.getMessage("stm32AddressLoadUnknown")),e.cleanup())};e.clearStatus(function(){e.loadAddress(e.chipInfo.option_bytes.start_address,i,!1)});break}case 2:{var o=[];for(let G=0;G<e.flash_layout.sectors.length;G++)for(var s=0;s<e.flash_layout.sectors[G].num_pages;s++)if(e.options.erase_chip)o.push({sector:G,page:s});else for(var l=e.flash_layout.sectors[G].start_address+s*e.flash_layout.sectors[G].page_size,a=l+e.flash_layout.sectors[G].page_size-1,c=0;c<e.hex.data.length;c++){var u=e.hex.data[c].address>=l&&e.hex.data[c].address<=a,p=e.hex.data[c].address+e.hex.data[c].bytes-1,h=p>=l&&p<=a,g=e.hex.data[c].address<l&&p>a;if(u||h||g){var f=o.findIndex(function(U){return U.sector==G&&U.page==s});f==-1&&o.push({sector:G,page:s})}}if(o.length===0){console.log("Aborting, No flash pages to erase"),TABS.firmware_flasher.flashingMessage(i18n.getMessage("stm32InvalidHex"),TABS.firmware_flasher.FLASH_MESSAGE_TYPES.INVALID),e.cleanup();break}TABS.firmware_flasher.flashingMessage(i18n.getMessage("stm32Erase"),TABS.firmware_flasher.FLASH_MESSAGE_TYPES.NEUTRAL),console.log("Executing local chip erase",o);var d=0,_=0,m=function(){TABS.firmware_flasher.flashProgress((d+1)/o.length*100),d++,d==o.length?(console.log("Erase: complete"),GUI.log(i18n.getMessage("dfu_erased_kilobytes",(_/1024).toString())),e.upload_procedure(4)):C()},C=function(){var G=o[d].page*e.flash_layout.sectors[o[d].sector].page_size+e.flash_layout.sectors[o[d].sector].start_address,U=[65,G&255,G>>8&255,G>>16&255,G>>24&255];_+=e.flash_layout.sectors[o[d].sector].page_size,console.log("Erasing. sector "+o[d].sector+", page "+o[d].page+" @ 0x"+G.toString(16)),e.controlTransfer("out",e.request.DNLOAD,0,0,0,U,function(){e.controlTransfer("in",e.request.GETSTATUS,0,0,6,0,function(M){if(M[4]==e.state.dfuDNBUSY){var N=M[1]|M[2]<<8|M[3]<<16;setTimeout(function(){e.controlTransfer("in",e.request.GETSTATUS,0,0,6,0,function(w){w[4]==e.state.dfuDNBUSY?(console.log("erase_page: dfuDNBUSY after timeout, clearing"),e.clearStatus(function(){e.controlTransfer("in",e.request.GETSTATUS,0,0,6,0,function(x){x[4]==e.state.dfuIDLE?m():(console.log("Failed to erase page 0x"+G.toString(16)+" (did not reach dfuIDLE after clearing"),e.cleanup())})})):w[4]==e.state.dfuDNLOAD_IDLE?m():(console.log("Failed to erase page 0x"+G.toString(16)),e.cleanup())})},N)}else console.log("Failed to initiate page erase, page 0x"+G.toString(16)),e.cleanup()})})};C();break}case 4:{console.log("Writing data ..."),TABS.firmware_flasher.flashingMessage(i18n.getMessage("stm32Flashing"),TABS.firmware_flasher.FLASH_MESSAGE_TYPES.NEUTRAL);let G=e.hex.data.length-1;var R=0;let U=e.hex.data[R].address;var S=0,F=0;let M=2;var I=function(){if(S<e.hex.data[R].bytes){var N=S+e.transferSize<=e.hex.data[R].bytes?e.transferSize:e.hex.data[R].bytes-S,w=e.hex.data[R].data.slice(S,S+N);U+=N,S+=N,F+=N,e.controlTransfer("out",e.request.DNLOAD,M++,0,0,w,function(){e.controlTransfer("in",e.request.GETSTATUS,0,0,6,0,function(x){if(x[4]==e.state.dfuDNBUSY){var k=x[1]|x[2]<<8|x[3]<<16;setTimeout(function(){e.controlTransfer("in",e.request.GETSTATUS,0,0,6,0,function(O){O[4]==e.state.dfuDNLOAD_IDLE?(TABS.firmware_flasher.flashProgress(F/(e.hex.bytes_total*2)*100),I()):(console.log("Failed to write "+N+"bytes to 0x"+U.toString(16)),e.cleanup())})},k)}else console.log("Failed to initiate write "+N+"bytes to 0x"+U.toString(16)),e.cleanup()})})}else R<G?(R++,U=e.hex.data[R].address,S=0,M=2,e.loadAddress(U,I)):(console.log("Writing: done"),e.upload_procedure(5))};e.loadAddress(U,I);break}case 5:{console.log("Verifying data ..."),TABS.firmware_flasher.flashingMessage(i18n.getMessage("stm32Verifying"),TABS.firmware_flasher.FLASH_MESSAGE_TYPES.NEUTRAL);let G=e.hex.data.length-1;var T=0;let U=e.hex.data[T].address;var P=0,y=0;let M=2;for(let N=0;N<=G;N++)e.verify_hex.push([]);e.clearStatus(function(){e.loadAddress(U,function(){e.clearStatus(L)})});var L=function(){if(P<e.hex.data[T].bytes){var N=P+e.transferSize<=e.hex.data[T].bytes?e.transferSize:e.hex.data[T].bytes-P;e.controlTransfer("in",e.request.UPLOAD,M++,0,N,0,function(x){for(let k=0;k<x.length;k++)e.verify_hex[T].push(x[k]);U+=N,P+=N,y+=N,TABS.firmware_flasher.flashProgress((e.hex.bytes_total+y)/(e.hex.bytes_total*2)*100),L()})}else if(T<G)T++,U=e.hex.data[T].address,P=0,M=2,e.clearStatus(function(){e.loadAddress(U,function(){e.clearStatus(L)})});else{var w=!0;for(let x=0;x<=G&&(w=e.verify_flash(e.hex.data[x].data,e.verify_hex[x]),!!w);x++);w?(console.log("Programming: SUCCESSFUL"),TABS.firmware_flasher.flashingMessage(i18n.getMessage("stm32ProgrammingSuccessful"),TABS.firmware_flasher.FLASH_MESSAGE_TYPES.VALID),e.leave()):(console.log("Programming: FAILED"),TABS.firmware_flasher.flashingMessage(i18n.getMessage("stm32ProgrammingFailed"),TABS.firmware_flasher.FLASH_MESSAGE_TYPES.INVALID),e.cleanup())}};break}}};Pt.prototype.leave=function(){const n=this;let e;n.hex?e=n.hex.data[0].address:e=134217728,n.clearStatus(function(){n.loadAddress(e,function(){n.controlTransfer("out",n.request.DNLOAD,0,0,0,0,function(){n.controlTransfer("in",n.request.GETSTATUS,0,0,6,0,function(){n.cleanup()})})})})};Pt.prototype.cleanup=function(){const n=this;n.releaseInterface(0),GUI.connect_lock=!1;var e=new Date().getTime()-n.upload_time_start;console.log("Script finished after: "+e/1e3+" seconds"),n.callback?.()};const QT=new Pt,ol=function(n,e){var t=this;t._releaseName=n,t._releaseDataTag=`${t._releaseName}ReleaseData`,t._releaseLastUpdateTag=`${t._releaseName}ReleaseLastUpdate`,t._releaseUrl=e};ol.prototype.loadReleaseData=function(n){const e=this;chrome.storage.local.get([e._releaseLastUpdateTag,e._releaseDataTag],function(t){const r=$.now(),i=t[e._releaseDataTag],o=t[e._releaseLastUpdateTag];!i||!o||r-o>3600*1e3?$.get(e._releaseUrl,function(s){GUI.log(i18n.getMessage("releaseCheckLoaded",[e._releaseName]));const l={};l[e._releaseDataTag]=s,l[e._releaseLastUpdateTag]=r,chrome.storage.local.set(l,function(){}),e._processReleaseData(s,n)}).fail(function(s){let l="";s.responseJSON&&(l=s.responseJSON.message),GUI.log(i18n.getMessage("releaseCheckFailed",[e._releaseName,l])),e._processReleaseData(i,n)}):(i&&GUI.log(i18n.getMessage("releaseCheckCached",[e._releaseName])),e._processReleaseData(i,n))})};ol.prototype._processReleaseData=function(n,e){n?e(n):(GUI.log(i18n.getMessage("releaseCheckNoInfo",[self._releaseName])),e())};function ZT(){return new Date().getTime()/1e3}function JT(){return new Date().getTime()}const eO=Math.PI/180;function tO(n){return n*eO}function nO(n){let e;return n<1024?e=`${n} Bytes`:n<1048576?e=`${(n/1024).toFixed(3)} KB`:n<1073741824?e=`${(n/1048576).toFixed(3)} MB`:e=`${(n/1073741824).toFixed(3)} GB`,e}function rO(){return chrome.runtime.lastError?(console.error(`Chrome API Error: ${chrome.runtime.lastError.message}.
 Traced ${new Error().stack}`),!0):!1}const iO=[{fw:"4.3.0",msp:"12.6.0",label:"Rotorflight 2.0.x"},{fw:"4.4.0",msp:"12.7.0",label:"Rotorflight 2.1.x"},{fw:"4.5.0",msp:"12.8.0",label:"Rotorflight 2.2.x"},{fw:"4.6.0",msp:"12.9.0",label:"Rotorflight 2.3.x"}];function oO(){const n=document.getElementById("firmware-version-dropdown");for(const e of iO.reverse()){const t=document.createElement("option");t.value=e.msp,t.text=e.label,t.setAttribute("data-fw",e.fw),n.appendChild(t)}}function sO(n){const t=document.createElement("canvas").getContext("2d");return t.font=getComputedStyle(document.body).font,Math.ceil(t.measureText(n).width)}function pm(...n){const e=Object.create(null);for(const t of n)e[t]=Symbol(t);return Object.freeze(e)}const aO=Object.freeze(Object.defineProperty({__proto__:null,bytesToSize:nO,checkChromeRuntimeError:rO,createEnum:pm,degToRad:tO,generateVirtualApiVersions:oO,getTextWidth:sO,microtime:ZT,millitime:JT},Symbol.toStringTag,{value:"Module"}));Number.prototype.clamp=function(n,e){return Math.min(Math.max(this,n),e)};Array.prototype.push8=function(n){return this.push(255&n),this};Array.prototype.push16=function(n){return this.push(255&n),this.push(n>>8),this};Array.prototype.push32=function(n){return this.push8(n).push8(n>>8).push8(n>>16).push8(n>>24),this};DataView.prototype.offset=0;DataView.prototype.readU8=function(){return this.byteLength>=this.offset+1?this.getUint8(this.offset++):null};DataView.prototype.readU16=function(){return this.byteLength>=this.offset+2?this.readU8()+this.readU8()*256:null};DataView.prototype.readU32=function(){return this.byteLength>=this.offset+4?this.readU16()+this.readU16()*65536:null};DataView.prototype.read8=function(){return this.byteLength>=this.offset+1?this.getInt8(this.offset++,1):null};DataView.prototype.read16=function(){return this.offset+=2,this.byteLength>=this.offset?this.getInt16(this.offset-2,1):null};DataView.prototype.read32=function(){return this.offset+=4,this.byteLength>=this.offset?this.getInt32(this.offset-4,1):null};DataView.prototype.remaining=function(){return this.byteLength-this.offset};var Tu={exports:{}},Eh;function lO(){return Eh||(Eh=1,function(n,e){(function(t){n.exports=t()})(function(){var t=["decimals","thousand","mark","prefix","suffix","encoder","decoder","negativeBefore","negative","edit","undo"];function r(f){return f.split("").reverse().join("")}function i(f,d){return f.substring(0,d.length)===d}function o(f,d){return f.slice(-1*d.length)===d}function s(f,d,_){if((f[d]||f[_])&&f[d]===f[_])throw new Error(d)}function l(f){return typeof f=="number"&&isFinite(f)}function a(f,d){return f=f.toString().split("e"),f=Math.round(+(f[0]+"e"+(f[1]?+f[1]+d:d))),f=f.toString().split("e"),(+(f[0]+"e"+(f[1]?+f[1]-d:-d))).toFixed(d)}function c(f,d,_,m,C,R,S,F,I,T,P,y){var L=y,G,U,M,N="",w="";return R&&(y=R(y)),l(y)?(f!==!1&&parseFloat(y.toFixed(f))===0&&(y=0),y<0&&(G=!0,y=Math.abs(y)),f!==!1&&(y=a(y,f)),y=y.toString(),y.indexOf(".")!==-1?(U=y.split("."),M=U[0],_&&(N=_+U[1])):M=y,d&&(M=r(M).match(/.{1,3}/g),M=r(M.join(r(d)))),G&&F&&(w+=F),m&&(w+=m),G&&I&&(w+=I),w+=M,w+=N,C&&(w+=C),T&&(w=T(w,L)),w):!1}function u(f,d,_,m,C,R,S,F,I,T,P,y){var L,G="";return P&&(y=P(y)),!y||typeof y!="string"||(F&&i(y,F)&&(y=y.replace(F,""),L=!0),m&&i(y,m)&&(y=y.replace(m,"")),I&&i(y,I)&&(y=y.replace(I,""),L=!0),C&&o(y,C)&&(y=y.slice(0,-1*C.length)),d&&(y=y.split(d).join("")),_&&(y=y.replace(_,".")),L&&(G+="-"),G+=y,G=G.replace(/[^0-9\.\-.]/g,""),G==="")||(G=Number(G),S&&(G=S(G)),!l(G))?!1:G}function p(f){var d,_,m,C={};for(f.suffix===void 0&&(f.suffix=f.postfix),d=0;d<t.length;d+=1)if(_=t[d],m=f[_],m===void 0)_==="negative"&&!C.negativeBefore?C[_]="-":_==="mark"&&C.thousand!=="."?C[_]=".":C[_]=!1;else if(_==="decimals")if(m>=0&&m<8)C[_]=m;else throw new Error(_);else if(_==="encoder"||_==="decoder"||_==="edit"||_==="undo")if(typeof m=="function")C[_]=m;else throw new Error(_);else if(typeof m=="string")C[_]=m;else throw new Error(_);return s(C,"mark","thousand"),s(C,"prefix","negative"),s(C,"prefix","negativeBefore"),C}function h(f,d,_){var m,C=[];for(m=0;m<t.length;m+=1)C.push(f[t[m]]);return C.push(_),d.apply("",C)}function g(f){if(!(this instanceof g))return new g(f);typeof f=="object"&&(f=p(f),this.to=function(d){return h(f,c,d)},this.from=function(d){return h(f,u,d)})}return g})}(Tu)),Tu.exports}var cO=lO();const ei=ng(cO),ga={tabName:"adjustments",isDirty:!1,AUX_MIN:875,AUX_MAX:2125,ALWAYS_ON_CH:255,PRIMARY_CHANNEL_COUNT:5,callback_stack:[],toggle_speed:300};function uO(){const n=_e.gte(FC.CONFIG.apiVersion,API_VERSION_12_8);return[{id:0,name:"None",min:0,max:100,ticks:10,pips:[0,20,40,60,80,100]},{id:1,name:"RateProfile",min:1,max:6,ticks:.25,pips:[1,2,3,4,5,6]},{id:2,name:"PIDProfile",min:1,max:6,ticks:.25,pips:[1,2,3,4,5,6]},{id:3,name:"LEDProfile",min:1,max:4,ticks:.25,pips:[1,2,3,4]},{id:4,name:"OSDProfile",min:1,max:3,ticks:.25,pips:[1,2,3]},{id:5,name:"PitchRate",min:0,max:255,ticks:10,pips:[0,50,100,150,200,250]},{id:6,name:"RollRate",min:0,max:255,ticks:10,pips:[0,50,100,150,200,250]},{id:7,name:"YawRate",min:0,max:255,ticks:10,pips:[0,50,100,150,200,250]},{id:8,name:"PitchRCRate",min:0,max:255,ticks:10,pips:[0,50,100,150,200,250]},{id:9,name:"RollRCRate",min:0,max:255,ticks:10,pips:[0,50,100,150,200,250]},{id:10,name:"YawRCRate",min:0,max:255,ticks:10,pips:[0,50,100,150,200,250]},{id:11,name:"PitchRCExpo",min:0,max:100,ticks:5,pips:[0,20,40,60,80,100]},{id:12,name:"RollRCExpo",min:0,max:100,ticks:5,pips:[0,20,40,60,80,100]},{id:13,name:"YawRCExpo",min:0,max:100,ticks:5,pips:[0,20,40,60,80,100]},{id:14,name:"PitchP",min:0,max:250,ticks:10,pips:[0,50,100,150,200,250]},{id:15,name:"PitchI",min:0,max:250,ticks:10,pips:[0,50,100,150,200,250]},{id:16,name:"PitchD",min:0,max:250,ticks:10,pips:[0,50,100,150,200,250]},{id:17,name:"PitchF",min:0,max:250,ticks:10,pips:[0,50,100,150,200,250]},{id:18,name:"RollP",min:0,max:250,ticks:10,pips:[0,50,100,150,200,250]},{id:19,name:"RollI",min:0,max:250,ticks:10,pips:[0,50,100,150,200,250]},{id:20,name:"RollD",min:0,max:250,ticks:10,pips:[0,50,100,150,200,250]},{id:21,name:"RollF",min:0,max:250,ticks:10,pips:[0,50,100,150,200,250]},{id:22,name:"YawP",min:0,max:250,ticks:10,pips:[0,50,100,150,200,250]},{id:23,name:"YawI",min:0,max:250,ticks:10,pips:[0,50,100,150,200,250]},{id:24,name:"YawD",min:0,max:250,ticks:10,pips:[0,50,100,150,200,250]},{id:25,name:"YawF",min:0,max:250,ticks:10,pips:[0,50,100,150,200,250]},{id:26,name:"YawCWStopGain",min:25,max:250,ticks:10,pips:[50,100,150,200,250]},{id:27,name:"YawCCWStopGain",min:25,max:250,ticks:10,pips:[50,100,150,200,250]},{id:28,name:"YawCyclicFF",min:0,max:250,ticks:10,pips:[0,50,100,150,200,250]},{id:29,name:"YawCollectiveFF",min:0,max:250,ticks:10,pips:[0,50,100,150,200,250]},{id:30,name:"YawCollectiveDyn",min:-125,max:125,ticks:10,pips:[-100,-50,0,50,100],hide:n},{id:31,name:"YawCollectiveDecay",min:1,max:250,ticks:10,pips:[0,50,100,150,200,250],hide:n},{id:32,name:"PitchCollectiveFF",min:0,max:250,ticks:10,pips:[0,50,100,150,200,250]},{id:33,name:"PitchGyroCutoff",min:0,max:250,ticks:10,pips:[0,50,100,150,200,250]},{id:34,name:"RollGyroCutoff",min:0,max:250,ticks:10,pips:[0,50,100,150,200,250]},{id:35,name:"YawGyroCutoff",min:0,max:250,ticks:10,pips:[0,50,100,150,200,250]},{id:36,name:"PitchDtermCutoff",min:0,max:250,ticks:10,pips:[0,50,100,150,200,250]},{id:37,name:"RollDtermCutoff",min:0,max:250,ticks:10,pips:[0,50,100,150,200,250]},{id:38,name:"YawDtermCutoff",min:0,max:250,ticks:10,pips:[0,50,100,150,200,250]},{id:39,name:"RescueClimbCollective",min:0,max:1e3,ticks:50,pips:[0,100,200,300,400,500,600,700,800,900,1e3]},{id:40,name:"RescueHoverCollective",min:0,max:1e3,ticks:50,pips:[0,100,200,300,400,500,600,700,800,900,1e3]},{id:41,name:"RescueHoverAltitude",min:0,max:2500,ticks:50,pips:[0,200,400,600,800,1e3,1200,1400,1600,1800,2e3,2200,2400]},{id:42,name:"RescueAltP",min:0,max:250,ticks:10,pips:[0,50,100,150,200,250]},{id:43,name:"RescueAltI",min:0,max:250,ticks:10,pips:[0,50,100,150,200,250]},{id:44,name:"RescueAltD",min:0,max:250,ticks:10,pips:[0,50,100,150,200,250]},{id:45,name:"AngleLevelGain",min:0,max:200,ticks:10,pips:[0,50,100,150,200]},{id:46,name:"HorizonLevelGain",min:0,max:200,ticks:10,pips:[0,50,100,150,200]},{id:47,name:"AcroTrainerGain",min:25,max:255,ticks:10,pips:[0,50,100,150,200,250]},{id:48,name:"GovernorGain",min:0,max:250,ticks:10,pips:[0,50,100,150,200,250]},{id:49,name:"GovernorP",min:0,max:250,ticks:10,pips:[0,50,100,150,200,250]},{id:50,name:"GovernorI",min:0,max:250,ticks:10,pips:[0,50,100,150,200,250]},{id:51,name:"GovernorD",min:0,max:250,ticks:10,pips:[0,50,100,150,200,250]},{id:52,name:"GovernorF",min:0,max:250,ticks:10,pips:[0,50,100,150,200,250]},{id:53,name:"GovernorTTA",min:0,max:250,ticks:10,pips:[0,50,100,150,200,250]},{id:54,name:"GovernorCyclicFF",min:0,max:250,ticks:10,pips:[0,50,100,150,200,250]},{id:55,name:"GovernorCollectiveFF",min:0,max:250,ticks:10,pips:[0,50,100,150,200,250]},{id:56,name:"PitchB",min:0,max:250,ticks:10,pips:[0,50,100,150,200,250]},{id:57,name:"RollB",min:0,max:250,ticks:10,pips:[0,50,100,150,200,250]},{id:58,name:"YawB",min:0,max:250,ticks:10,pips:[0,50,100,150,200,250]},{id:59,name:"PitchO",min:0,max:250,ticks:10,pips:[0,50,100,150,200,250]},{id:60,name:"RollO",min:0,max:250,ticks:10,pips:[0,50,100,150,200,250]},{id:61,name:"CrossCouplingGain",min:0,max:250,ticks:10,pips:[0,50,100,150,200,250]},{id:62,name:"CrossCouplingRatio",min:0,max:250,ticks:10,pips:[0,50,100,150,200,250]},{id:63,name:"CrossCouplingCutoff",min:0,max:250,ticks:10,pips:[0,50,100,150,200,250]},{id:64,name:"AccTrimPitch",min:-300,max:300,ticks:10,pips:[-300,-200,-100,0,100,200,300]},{id:65,name:"AccTrimRoll",min:-300,max:300,ticks:10,pips:[-300,-200,-100,0,100,200,300]},{id:66,name:"YawInertiaPrecompGain",min:0,max:250,ticks:10,pips:[0,50,100,150,200,250],hide:!n},{id:67,name:"YawInertiaPrecompCutoff",min:0,max:250,ticks:10,pips:[0,50,100,150,200,250],hide:!n},{id:68,name:"PitchSetpointBoostGain",min:0,max:255,ticks:10,pips:[0,50,100,150,200,250],hide:!n},{id:69,name:"RollSetpointBoostGain",min:0,max:255,ticks:10,pips:[0,50,100,150,200,250],hide:!n},{id:70,name:"YawSetpointBoostGain",min:0,max:255,ticks:10,pips:[0,50,100,150,200,250],hide:!n},{id:71,name:"CollectiveSetpointBoostGain",min:0,max:255,ticks:10,pips:[0,50,100,150,200,250],hide:!n},{id:72,name:"YawDynCeilingGain",min:0,max:250,ticks:10,pips:[0,50,100,150,200,250],hide:!n},{id:73,name:"YawDynDeadbandGain",min:0,max:250,ticks:10,pips:[0,50,100,150,200,250],hide:!n},{id:74,name:"YawDynDeadbandFilter",min:0,max:250,ticks:10,pips:[0,50,100,150,200,250],hide:!n},{id:75,name:"YawPrecompCutoff",min:0,max:250,ticks:10,pips:[0,50,100,150,200,250],hide:!n}]}ga.initialize=function(n){const e=this;r(t);function t(){$("#content").load("/src/tabs/adjustments.html",g)}function r(f){Promise.resolve(!0).then(()=>MSP.promise(MSPCodes.MSP_STATUS)).then(()=>MSP.promise(MSPCodes.MSP_RC)).then(()=>MSP.promise(MSPCodes.MSP_ADJUSTMENT_RANGES)).then(f)}function i(f){var d=0;function _(){d<FC.ADJUSTMENT_RANGES.length?FC.ADJUSTMENT_RANGES[d].dirty?(FC.ADJUSTMENT_RANGES[d].dirty=!1,mspHelper.sendAdjustmentRange(d++,_)):(d++,_()):MSP.send_message(MSPCodes.MSP_EEPROM_WRITE,!1,!1,function(){GUI.log(i18n.getMessage("eepromSaved")),f?.()})}_()}function o(){e.isDirty||(e.isDirty=!0,$(".tab-adjustments").removeClass("toolbar_hidden"))}function s(f,d){return d*Math.floor(f/d)}function l(f,d){return f>=d.start&&f<=d.end}function a(f,d,_){return 100/((d-f)/_)}function c(f){const d={active:!1,value:0,string:"-"};if(f.adjType==1){if(f.enaChannel==e.ALWAYS_ON_CH||l(f.enaChannelPos,f.enaRange)){const _=f.adjRange1.end-f.adjRange1.start,m=f.adjMax-f.adjMin;if(_>0&&m>0){const C=_/2,R=f.adjMin+Math.floor(((f.adjChannelPos-f.adjRange1.start)*m+C)/_);d.value=R.clamp(f.adjMin,f.adjMax)}else d.value=f.adjMin;d.string=d.value.toFixed(0),d.active=!0}}else f.adjType==2&&l(f.enaChannelPos,f.enaRange)&&(l(f.adjChannelPos,f.adjRange1)?(d.string="-"+f.adjStep.toFixed(0),d.active=!0):l(f.adjChannelPos,f.adjRange2)&&(d.string="+"+f.adjStep.toFixed(0),d.active=!0));return d}function u(f,d){const _=$("#tab-adjustments-templates .adjustmentBody").clone();d.dirty=!1,d.adjType=0,d.enaChannelPos=0,d.adjChannelPos=0,d.adjFunction>=e.FUNCTIONS.length&&(d.adjFunction=0);var m=e.FUNCTIONS[d.adjFunction];d.adjFunction>0&&(d.adjStep>0?d.adjType=2:d.adjType=1),_.find(".adjTypeOptionInput").attr("name",`adjTypeOptionInput${f}`);const C={min:e.AUX_MIN,max:e.AUX_MAX},R=[900,1e3,1250,1500,1750,2e3,2100],S=_.find(".ena-slider"),F=_.find(".inc-slider"),I=_.find(".dec-slider"),T=_.find(".val-slider");Gr(S.get(0),{start:[d.enaRange.start,d.enaRange.end],behaviour:"snap-drag",step:5,connect:!0,range:C,format:ei({decimals:0}),pips:{mode:"values",values:R,density:a(e.AUX_MIN,e.AUX_MAX,50),stepped:!0}}),Gr(I.get(0),{start:[d.adjRange1.start,d.adjRange1.end],behaviour:"snap-drag",step:5,connect:!0,range:C,format:ei({decimals:0}),pips:{mode:"values",values:R,density:a(e.AUX_MIN,e.AUX_MAX,50),stepped:!0}}),Gr(F.get(0),{start:[d.adjRange2.start,d.adjRange2.end],behaviour:"snap-drag",step:5,connect:!0,range:C,format:ei({decimals:0})});const P={start:[d.adjMin,d.adjMax],behaviour:"snap-drag",step:1,connect:!0,range:{min:m.min,max:m.max},format:ei({decimals:0}),pips:{mode:"values",values:m.pips,density:a(m.min,m.max,m.ticks),stepped:!0}};Gr(T.get(0),P);const y=_.find("select.enaChannel");y.val(d.enaChannel);const L=_.find("select.adjChannel");L.val(d.adjChannel);const G=_.find("select.function");G.val(d.adjFunction);const U=_.find(".lowerEnaValue");U.val(d.enaRange.start).attr("max",d.enaRange.end);const M=_.find(".upperEnaValue");M.val(d.enaRange.end).attr("min",d.enaRange.start);const N=_.find(".lowerDecValue");N.val(d.adjRange1.start).attr("max",d.adjRange1.end);const w=_.find(".upperDecValue");w.val(d.adjRange1.end).attr("min",d.adjRange1.start);const x=_.find(".lowerIncValue");x.val(d.adjRange2.start).attr("max",d.adjRange2.end);const k=_.find(".upperIncValue");k.val(d.adjRange2.end).attr("min",d.adjRange2.start);const O=_.find(".functionMinValue");O.val(d.adjMin).attr("min",m.min).attr("max",d.adjMax);const D=_.find(".functionMaxValue");D.val(d.adjMax).attr("min",d.adjMin).attr("max",m.max);const Y=_.find(".functionStepSize");Y.val(d.adjStep);function z(ie,te,fe){U.attr("max",te).val(ie),M.attr("min",ie).val(te),fe||S.get(0).noUiSlider.set([ie,te]),d.dirty=!0,d.enaRange.start=ie,d.enaRange.end=te}S.get(0).noUiSlider.on("change",o),S.get(0).noUiSlider.on("slide",function(ie){const te=parseInt(ie[0]),fe=parseInt(ie[1]);z(te,fe,!0)}),U.on("change",function(){const ie=parseInt(U.val()),te=parseInt(M.val());z(ie,te)}),M.on("change",function(){const ie=parseInt(U.val()),te=parseInt(M.val());z(ie,te)});function ee(ie,te,fe){N.attr("max",te).val(ie),w.attr("min",ie).val(te),fe||I.get(0).noUiSlider.set([ie,te]),d.dirty=!0,d.adjRange1.start=ie,d.adjRange1.end=te}I.get(0).noUiSlider.on("change",o),I.get(0).noUiSlider.on("slide",function(ie){const te=parseInt(ie[0]),fe=parseInt(ie[1]);ee(te,fe,!0)}),N.on("change",function(){const ie=parseInt(N.val()),te=parseInt(w.val());ee(ie,te)}),w.on("change",function(){const ie=parseInt(N.val()),te=parseInt(w.val());ee(ie,te)});function re(ie,te,fe){x.attr("max",te).val(ie),k.attr("min",ie).val(te),fe||F.get(0).noUiSlider.set([ie,te]),d.dirty=!0,d.adjRange2.start=ie,d.adjRange2.end=te}F.get(0).noUiSlider.on("change",o),F.get(0).noUiSlider.on("slide",function(ie){const te=parseInt(ie[0]),fe=parseInt(ie[1]);re(te,fe,!0)}),x.on("change",function(){const ie=parseInt(x.val()),te=parseInt(k.val());re(ie,te)}),k.on("change",function(){const ie=parseInt(x.val()),te=parseInt(k.val());re(ie,te)});function le(ie,te,fe){O.attr("max",te).val(ie),D.attr("min",ie).val(te),fe||T.get(0).noUiSlider.set([ie,te]),d.dirty=!0,d.adjMin=ie,d.adjMax=te}T.get(0).noUiSlider.on("change",o),T.get(0).noUiSlider.on("slide",function(ie){const te=parseInt(ie[0]),fe=parseInt(ie[1]);le(te,fe,!0)}),O.on("change",function(){const ie=parseInt(O.val()),te=parseInt(D.val());le(ie,te)}),D.on("change",function(){const ie=parseInt(O.val()),te=parseInt(D.val());le(ie,te)}),Y.on("change",function(){d.dirty=!0,d.adjStep=parseInt(Y.val())}),G.on("change",function(){const ie=G.val();m=e.FUNCTIONS[ie],d.dirty=!0,d.adjFunction=ie,T.get(0).noUiSlider.updateOptions({range:{min:m.min,max:m.max},pips:{mode:"values",values:m.pips,density:a(m.min,m.max,m.ticks),stepped:!0}},!0),m.id>0&&d.adjType==1&&T.find(".marker").show(e.toggle_speed),O.attr("min",m.min),D.attr("max",m.max),le(m.min,m.max)}),y.on("change",function(){const ie=parseInt(y.val());d.dirty=!0,d.enaChannel=ie,ie==e.ALWAYS_ON_CH?(z(1500,1500),_.find(".ena-channel-value").text("-"),_.find(".ena-slider").attr("disabled","disabled"),_.find(".enaChannelRanges input").prop("disabled",!0),_.find(".enaMarker").hide(e.toggle_speed)):(_.find(".ena-slider").removeAttr("disabled"),_.find(".enaChannelRanges input").prop("disabled",!1),_.find(".enaMarker").show(e.toggle_speed))}),L.on("change",function(){const ie=parseInt(L.val());d.dirty=!0,d.adjChannel=ie});function J(){const ie=s(d.enaChannelPos-25,5),te=s(d.enaChannelPos+25,5);z(ie,te)}S.find(".noUi-handle-lower").on("dblclick",J),S.find(".noUi-handle-upper").on("dblclick",J),I.find(".noUi-handle-lower").on("dblclick",function(){if(d.adjType==1){const ie=s(d.adjChannelPos,5),te=Math.max(d.adjRange1.end,ie);ee(ie,te)}else if(d.adjType==2){const ie=s(d.adjChannelPos-10,5),te=s(d.adjChannelPos+10,5);ee(ie,te)}}),I.find(".noUi-handle-upper").on("dblclick",function(){if(d.adjType==1){const ie=s(d.adjChannelPos+4,5),te=Math.min(d.adjRange1.start,ie);ee(te,ie)}else if(d.adjType==2){const ie=s(d.adjChannelPos-10,5),te=s(d.adjChannelPos+10,5);ee(ie,te)}}),F.find(".noUi-handle-lower").on("dblclick",function(){if(d.adjType==2){const ie=s(d.adjChannelPos-10,5),te=s(d.adjChannelPos+10,5);re(ie,te)}}),F.find(".noUi-handle-upper").on("dblclick",function(){if(d.adjType==2){const ie=s(d.adjChannelPos-10,5),te=s(d.adjChannelPos+10,5);re(ie,te)}});const oe=_.find(".adjTypeOptionInput");oe.filter(`[value="${d.adjType}"]`).prop("checked",!0);function ae(){d.adjType=parseInt(oe.filter(":checked").val());function ie(te){te?(F.find(".noUi-handle").addClass("handle-icon").find(".noUi-touch-area").addClass(["fas","fa-plus"]),I.find(".noUi-handle").addClass("handle-icon").find(".noUi-touch-area").addClass(["fas","fa-minus"])):(F.find(".noUi-handle").removeClass("handle-icon").find(".noUi-touch-area").removeClass(["fas","fa-plus"]),I.find(".noUi-handle").removeClass("handle-icon").find(".noUi-touch-area").removeClass(["fas","fa-minus"]))}d.adjType==0?(_.find(".input-element").prop("disabled",!0),_.find(".adj-slider").attr("disabled","disabled"),_.find(".value-box").text("-"),_.find(".marker").hide(e.toggle_speed),ie(!1),d.adjFunction!=0&&G.val(0).trigger("change"),(d.adjMin!=0||d.adjMax!=100)&&le(0,100)):d.adjType==1?(_.find(".input-element").prop("disabled",!1),_.find(".adj-slider").removeAttr("disabled"),_.find(".adjMarker").show(e.toggle_speed),_.find(".valMarker").show(e.toggle_speed),d.enaChannel!=e.ALWAYS_ON_CH?_.find(".enaMarker").show(e.toggle_speed):_.find(".enaMarker").hide(e.toggle_speed),ie(!1),d.adjStep>0&&Y.val(0).trigger("change")):d.adjType==2&&(_.find(".input-element").prop("disabled",!1),_.find(".adj-slider").removeAttr("disabled"),_.find(".adjMarker").show(e.toggle_speed),_.find(".valMarker").hide(e.toggle_speed),d.enaChannel!=e.ALWAYS_ON_CH?_.find(".enaMarker").show(e.toggle_speed):_.find(".enaMarker").hide(e.toggle_speed),ie(!0),d.adjStep==0&&Y.val(1).trigger("change")),d.enaChannel==e.ALWAYS_ON_CH&&(_.find(".ena-slider").attr("disabled","disabled"),_.find(".enaChannelRanges input").prop("disabled",!0)),_.find(".mapped-only").toggle(d.adjType==1),_.find(".stepped-only").toggle(d.adjType==2)}oe.on("change",ae);function de(){if(d.adjType>0){if(d.enaChannel>=0&&d.enaChannel<e.ALWAYS_ON_CH){const te=d.enaChannel+e.PRIMARY_CHANNEL_COUNT,fe=FC.RC.channels[te],Re=(fe-e.AUX_MIN)/(e.AUX_MAX-e.AUX_MIN)*100;_.find(".enaMarker").css("left",Re.clamp(0,100).toFixed(2)+"%"),_.find(".ena-channel-value").text(fe+"µs"),d.enaChannelPos=fe}if(d.adjChannel>=0){const te=d.adjChannel+e.PRIMARY_CHANNEL_COUNT,fe=FC.RC.channels[te],Re=(fe-e.AUX_MIN)/(e.AUX_MAX-e.AUX_MIN)*100;_.find(".adjMarker").css("left",Re.clamp(0,100).toFixed(2)+"%"),_.find(".adj-channel-value").text(fe+"µs"),d.adjChannelPos=fe}const ie=c(d);if(_.find(".function-value").text(ie.string),ie.active){const te=(ie.value-m.min)/(m.max-m.min)*100;_.find(".valMarker").css("left",te.clamp(0,100).toFixed(2)+"%")}}}return e.callback_stack.push(de),ae(),de(),_}function p(){const f=$("#tab-adjustments-templates .adjustmentBody select.function");e.FUNCTIONS.forEach(function(F,I){const T=new Option(i18n.getMessage("adjustmentsFunction"+F.name),I);F.hide&&(T.style.display="none"),f.append(T)});const d=$("#tab-adjustments-templates .adjustmentBody select.enaChannel"),_=new Option(i18n.getMessage("auxiliaryAlwaysChannelSelect"),e.ALWAYS_ON_CH);d.append(_);const m=$("#tab-adjustments-templates .adjustmentBody select.channel"),C=new Option(i18n.getMessage("auxiliaryAutoChannelSelect"),-1);m.append(C);const R=FC.RC.active_channels-e.PRIMARY_CHANNEL_COUNT;for(let F=0;F<R;F++){const I=new Option(`AUX${F+1}`,F);m.append(I)}const S=$(".tab-adjustments table.adjustments");FC.ADJUSTMENT_RANGES.forEach(function(F,I){S.append(u(I,F))})}function h(){const f=$('.tab-adjustments select.channel option[value="-1"]:selected');if(f.length>0){const d=FC.RC.channels.slice(e.PRIMARY_CHANNEL_COUNT,FC.RC.active_channels);if(e.RCchannels){let _=null,m=100;for(let C=0;C<d.length;C++){let R=Math.abs(d[C]-e.RCchannels[C]);R>m&&(_=C,m=R)}_!==null&&(f.parent().val(_).trigger("change"),e.RCchannels=null)}else e.RCchannels=d}else e.RCchannels=null}function g(){e.FUNCTIONS=uO(),i18n.localizePage(),p(),$(".tab-adjustments").addClass("toolbar_hidden"),e.isDirty=!1;function f(){for(const d of e.callback_stack)d?.();h()}e.save=function(d){i(d)},e.revert=function(d){d?.()},$("a.save").click(function(){e.save(()=>GUI.tab_switch_reload())}),$("a.revert").click(function(){e.revert(()=>GUI.tab_switch_reload())}),$(".content_wrapper").on("change",function(){o()}),GUI.interval_add("rc_pull",function(){MSP.send_message(MSPCodes.MSP_RC,!1,!1,f)},200,!0),GUI.content_ready(n)}};ga.cleanup=function(n){this.isDirty=!1,n?.()};TABS[ga.tabName]=ga;const ma={tabName:"auxiliary",isDirty:!1,PRIMARY_CHANNEL_COUNT:5};ma.initialize=function(n){const e=this;r(t);function t(){$("#content").load("/src/tabs/auxiliary.html",f)}function r(d){Promise.resolve(!0).then(()=>MSP.promise(MSPCodes.MSP_STATUS)).then(()=>MSP.promise(MSPCodes.MSP_RC)).then(()=>MSP.promise(MSPCodes.MSP_BOXIDS)).then(()=>MSP.promise(MSPCodes.MSP_BOXNAMES)).then(()=>MSP.promise(MSPCodes.MSP_RSSI_CONFIG)).then(()=>MSP.promise(MSPCodes.MSP_MODE_RANGES)).then(()=>MSP.promise(MSPCodes.MSP_MODE_RANGES_EXTRA)).then(()=>MSP.promise(MSPCodes.MSP_SERIAL_CONFIG)).then(d)}function i(d){mspHelper.sendModeRanges(_);function _(){MSP.send_message(MSPCodes.MSP_EEPROM_WRITE,!1,!1,function(){GUI.log(i18n.getMessage("eepromSaved")),d?.()})}}function o(){e.isDirty||(e.isDirty=!0,$(".tab-auxiliary").removeClass("toolbar_hidden"))}function s(d,_){const C=$("#tab-auxiliary-templates .mode").clone(),R=FC.AUX_CONFIG[d];let S=i18n.existsMessage("mode "+R)?i18n.getMessage("mode "+R):R;return $(C).attr("id","mode-"+d),$(C).find(".name").text(R),S!=R&&$(C).find(".desc").text(S),$(C).data("index",d),$(C).data("id",_),$(C).find(".name").data("modeElement",C),$(C).find("a.addRange").data("modeElement",C),$(C).find("a.addLink").data("modeElement",C),_==0&&$(C).find(".addLink").hide(),C}function l(d){const _=$(d).find(".logic"),m=$(_).find("option");m.remove();let C=m.clone();C.text(i18n.getMessage("auxiliaryModeLogicOR")),C.val(0),_.append(C),C=m.clone(),C.text(i18n.getMessage("auxiliaryModeLogicAND")),C.val(1),_.append(C),m.val(0)}function a(d){const _=$("#tab-auxiliary-templates .range"),m=$(_).find(".channel"),C=$(m).find("option");C.remove();let R=C.clone();R.text(i18n.getMessage("auxiliaryAutoChannelSelect")),R.val(-1),m.append(R);for(let S=0;S<d;S++)R=C.clone(),R.text("AUX "+(S+1)),R.val(S),m.append(R);C.val(-1),l(_)}function c(){const d=$("#tab-auxiliary-templates .link"),_=$(d).find(".linkedTo"),m=$(_).find("option");m.remove();let C=m.clone();C.text(""),C.val(0),_.append(C);for(let R=1;R<FC.AUX_CONFIG.length;R++)C=m.clone(),C.text(FC.AUX_CONFIG[R]),C.val(FC.AUX_CONFIG_IDS[R]),_.append(C);m.val(0),l(d)}function u(d,_,m,C){const R=$(d).data("index"),S=$(d).find(".ranges"),F={min:[900],max:[2100]};let I=[1300,1700];C!==void 0&&(I=[C.start,C.end]);const T=S.children().length;let P=$("#tab-auxiliary-templates .range").clone();P.attr("id","mode-"+R+"-range-"+T),S.append(P),T==0?$(P).find(".logic").hide():T==1&&S.children().eq(0).find(".logic").show();let y=[900,1e3,1200,1400,1500,1600,1800,2e3,2100];$(window).width()<575&&(y=[1e3,1200,1400,1600,1800,2e3]);const L=Gr($(P).find(".channel-slider").get(0),{start:I,behaviour:"snap-drag",margin:25,step:5,connect:!0,range:F,format:ei({decimals:0}),pips:{mode:"values",values:y,density:4,stepped:!0}});L.on("change",o);function G(U){P.find(".lowerLimitValue").text(U[0]),P.find(".upperLimitValue").text(U[1])}G(I),L.on("slide",function(U){G(U)}),$(P).find(".deleteRange").data("rangeElement",P),$(P).find(".deleteRange").data("modeElement",d),$(P).find("a.deleteRange").click(function(){d=$(this).data("modeElement"),P=$(this).data("rangeElement"),P.remove();const U=$(d).find(".ranges").children();U.length==1&&U.eq(0).find(".logic").hide(),o()}),$(P).find(".channel").val(_),$(P).find(".logic").val(m)}function p(d,_,m){const C=$(d).data("id"),R=$(d).data("index"),S=$(d).find(".ranges"),F=S.children().length;let I=$("#tab-auxiliary-templates .link").clone();I.attr("id","mode-"+R+"-link-"+F),S.append(I),F==0?$(I).find(".logic").hide():F==1&&S.children().eq(0).find(".logic").show();const T=$(I).find(".linkedTo");$(T).find('option[value="'+C+'"]').prop("disabled",!0),$(I).find(".deleteLink").data("linkElement",I),$(I).find(".deleteLink").data("modeElement",d),$(I).find("a.deleteLink").click(function(){d=$(this).data("modeElement"),I=$(this).data("linkElement"),I.remove();const P=$(d).find(".ranges").children();P.length==1&&P.eq(0).find(".logic").hide(),o()}),$(I).find(".linkedTo").val(m),$(I).find(".logic").val(_)}function h(){const d=FC.MODE_RANGES.length;FC.MODE_RANGES=[],FC.MODE_RANGES_EXTRA=[],$(".tab-auxiliary .modes .mode").each(function(){const _=$(this),m=_.data("id");$(_).find(".range").each(function(){const C=$(this).find(".channel-slider").get(0).noUiSlider.get(),R={id:m,auxChannelIndex:parseInt($(this).find(".channel").val()),range:{start:parseInt(C[0]),end:parseInt(C[1])}};FC.MODE_RANGES.push(R);const S={id:m,modeLogic:parseInt($(this).find(".logic").val()),linkedTo:0};FC.MODE_RANGES_EXTRA.push(S)}),$(_).find(".link").each(function(){const C=parseInt($(this).find(".linkedTo").val());if(C==0)$(this).remove();else{const R={id:m,auxChannelIndex:0,range:{start:900,end:900}};FC.MODE_RANGES.push(R);const S={id:m,modeLogic:parseInt($(this).find(".logic").val()),linkedTo:C};FC.MODE_RANGES_EXTRA.push(S)}})});for(let _=FC.MODE_RANGES.length;_<d;_++){const m={id:0,auxChannelIndex:0,range:{start:900,end:900}};FC.MODE_RANGES.push(m);const C={id:0,modeLogic:0,linkedTo:0};FC.MODE_RANGES_EXTRA.push(C)}}function g(){const d=FC.RC.active_channels-e.PRIMARY_CHANNEL_COUNT;a(d),c();const _=$(".tab-auxiliary .modes");for(let C=0;C<FC.AUX_CONFIG.length;C++){const R=FC.AUX_CONFIG_IDS[C],S=s(C,R);_.append(S);for(let F=0;F<FC.MODE_RANGES.length;F++){const I=FC.MODE_RANGES[F],T=FC.MODE_RANGES_EXTRA[F];if(!(I.id!=R||T.id!=R))if(R==0||T.linkedTo==0){const P=I.range;if(P.start>=P.end)continue;u(S,I.auxChannelIndex,T.modeLogic,P)}else p(S,T.modeLogic,T.linkedTo)}}const m=Math.max(...FC.AUX_CONFIG.map(C=>C.length));$(".tab-auxiliary .mode .info").css("min-width",`${Math.round(m*getTextWidth("A"))}px`)}function f(){i18n.localizePage(),g(),$(".tab-auxiliary").addClass("toolbar_hidden"),e.isDirty=!1,$("a.addRange").click(function(){const S=$(this).data("modeElement");u(S,-1,0),o()}),$("a.addLink").click(function(){const S=$(this).data("modeElement");p(S,0,0),o()});function d(S){return S<900?S=900:S>2100&&(S=2100),S}function _(S,F){const I=(F-900)/1200*100;$(".modes .ranges .range").each(function(){parseInt($(this).find(".channel").val())===S&&$(this).find(".marker").css("left",I+"%")})}function m(){let S=!1;for(let T=0;T<FC.AUX_CONFIG.length;T++){let P=$("#mode-"+T);if(P.find(" .range").length==0&&P.find(" .link").length==0){P.removeClass("off").removeClass("on").removeClass("disabled");continue}if(bit_check(FC.CONFIG.mode,T))$(".mode .name").eq(T).data("modeElement").addClass("on").removeClass("off").removeClass("disabled"),T==0&&$(".mode .name").eq(T).html(FC.AUX_CONFIG[T]);else if(T==0){let y=!1;if(FC.CONFIG.armingDisableCount>0){const L=1<<FC.CONFIG.armingDisableCount-1;(FC.CONFIG.armingDisableFlags&L)>0&&(y=!0)}y?($(".mode .name").eq(T).data("modeElement").removeClass("on").removeClass("off").addClass("disabled"),$(".mode .name").eq(T).html(FC.AUX_CONFIG[T]+"<br>"+i18n.getMessage("auxiliaryDisabled"))):($(".mode .name").eq(T).data("modeElement").removeClass("on").removeClass("disabled").addClass("off"),$(".mode .name").eq(T).html(FC.AUX_CONFIG[T]))}else $(".mode .name").eq(T).data("modeElement").removeClass("on").removeClass("disabled").addClass("off");S=!0}let F=R&&S;for(let T=0;T<FC.AUX_CONFIG.length;T++){let P=$("#mode-"+T);P.find(" .range").length==0&&P.find(" .link").length==0&&P.toggle(!F)}C();const I=FC.RC.active_channels-e.PRIMARY_CHANNEL_COUNT;for(let T=0;T<I;T++)_(T,d(FC.RC.channels[T+e.PRIMARY_CHANNEL_COUNT]))}function C(){const S=$('.tab-auxiliary select.channel option[value="-1"]:selected');if(S.length>0){const F=FC.RC.channels.slice(e.PRIMARY_CHANNEL_COUNT,FC.RC.active_channels);if(e.RCchannels){let I=-1,T=100;for(let P=0;P<F.length;P++){let y=Math.abs(F[P]-e.RCchannels[P]);y>T&&(I=P,T=y)}I!=-1&&(S.parent().val(I),e.RCchannels=null)}else e.RCchannels=F}else e.RCchannels=null}let R=!1;$("input#switch-toggle-unused").on("change",function(){R=$(this).prop("checked"),it({hideUnusedModes:R}),m()}).prop("checked",!!We("hideUnusedModes")).trigger("change"),e.save=function(S){h(),i(S)},e.revert=function(S){S?.()},$("a.save").click(function(){e.save(()=>GUI.tab_switch_reload())}),$("a.revert").click(function(){e.revert(()=>GUI.tab_switch_reload())}),$(".modes").change(function(){o()}),m(),GUI.interval_add("aux_data_pull",function(){MSP.send_message(MSPCodes.MSP_RC,!1,!1,m)},200,!1),GUI.interval_add("status_pull",function(){MSP.send_message(MSPCodes.MSP_STATUS)},500,!0),GUI.content_ready(n)}};ma.cleanup=function(n){this.isDirty=!1,n?.()};TABS[ma.tabName]=ma;const Ca={tabName:"beepers",isDirty:!1};Ca.initialize=function(n){const e=this;r(t);function t(){$("#content").load("/src/tabs/beepers.html",o)}function r(s){Promise.resolve(!0).then(()=>MSP.promise(MSPCodes.MSP_STATUS)).then(()=>MSP.promise(MSPCodes.MSP_BEEPER_CONFIG)).then(s)}function i(s){Promise.resolve(!0).then(()=>MSP.promise(MSPCodes.MSP_SET_BEEPER_CONFIG,mspHelper.crunch(MSPCodes.MSP_SET_BEEPER_CONFIG))).then(()=>MSP.promise(MSPCodes.MSP_EEPROM_WRITE)).then(()=>{GUI.log(i18n.getMessage("eepromSaved")),s?.()})}function o(){i18n.localizePage(),$(".tab-beepers").addClass("toolbar_hidden"),e.isDirty=!1;function s(){e.isDirty||(e.isDirty=!0,$(".tab-beepers").removeClass("toolbar_hidden"))}const l=$(".tab-beepers .dshotbeeper"),a=$("select.dshotBeeperBeaconTone"),c=$("tbody.dshotBeaconConditions");for(let g=1;g<=5;g++)a.append('<option value="'+g+'">'+g+"</option>");l.show(),a.change(function(){FC.BEEPER_CONFIG.dshotBeaconTone=a.val()}),a.val(FC.BEEPER_CONFIG.dshotBeaconTone);const u=$(".beepers .beeper-template");FC.BEEPER_CONFIG.dshotBeaconConditions.generateElements(u,c),$("input.condition",c).change(function(){const g=$(this);FC.BEEPER_CONFIG.dshotBeaconConditions.updateData(g)});const p=$(".beepers .beeper-configuration"),h=$(".tab-beepers .beepers");FC.BEEPER_CONFIG.beepers.generateElements(u,p),$("input.condition",h).change(function(){const g=$(this);FC.BEEPER_CONFIG.beepers.updateData(g)}),e.save=function(g){i(g)},e.revert=function(g){g?.()},$("a.save").click(function(){e.save(()=>GUI.tab_switch_reload())}),$("a.revert").click(function(){e.revert(()=>GUI.tab_switch_reload())}),$(".content_wrapper").change(function(){s()}),GUI.content_ready(n)}};Ca.cleanup=function(n){this.isDirty=!1,n?.()};TABS[Ca.tabName]=Ca;let sl,rd,al;function dO(n){return/(?:\.([^.]+))?$/.exec(n)[1]}sl=async n=>{try{const[e]=await showOpenFilePicker({types:[{description:n.description,accept:{"text/plain":n.extensions}}]});if(!e)return;const t=await e.getFile();return{name:t.name,content:await t.text(),lastModified:t.lastModifiedDate}}catch(e){console.log(e)}},rd=async n=>{try{return await(await showSaveFilePicker({suggestedName:n.suggestedName,types:[{description:n.description,accept:{[n.mimeType]:`.${dO(n.suggestedName)}`}}]})).createWritable()}catch(e){console.log(e)}},al=async(n,e)=>{const t=await rd({...e,mimeType:"text/plain"});if(t)try{await t.write(new Blob([n],{type:"text/plain"})),await t.close()}catch(r){console.log(r)}};let Yi;const qo={tabName:"blackbox",isDirty:!1,blockSize:128,writeError:!1,BLOCK_SIZE:4096,VCP_BLOCK_SIZE_3_0:512,VCP_BLOCK_SIZE:4096,DEBUG_MODES:["NONE","CYCLETIME","BATTERY","GYRO_FILTERED","ACCELEROMETER","PIDLOOP","GYRO_SCALED","RC_COMMAND","RC_SETPOINT","ESC_SENSOR","SCHEDULER","STACK","ESC_SENSOR_DATA","ESC_SENSOR_FRAME","ALTITUDE","DYN_NOTCH","DYN_NOTCH_TIME","DYN_NOTCH_FREQ","RX_FRSKY_SPI","RX_SFHSS_SPI","GYRO_RAW","DUAL_GYRO_RAW","DUAL_GYRO_DIFF","MAX7456_SIGNAL","MAX7456_SPICLOCK","SBUS","FPORT","RANGEFINDER","RANGEFINDER_QUALITY","LIDAR_TF","ADC_INTERNAL","GOVERNOR","SDIO","CURRENT_SENSOR","USB","SMARTAUDIO","RTH","ITERM_RELAX","ACRO_TRAINER","SETPOINT","RX_SIGNAL_LOSS","RC_RAW","RC_DATA","DYN_LPF","RX_SPEKTRUM_SPI","DSHOT_RPM_TELEMETRY","RPM_FILTER","RPM_SOURCE","TTA","AIRBORNE","DUAL_GYRO_SCALED","DSHOT_RPM_ERRORS","CRSF_LINK_STATISTICS_UPLINK","CRSF_LINK_STATISTICS_PWR","CRSF_LINK_STATISTICS_DOWN","BARO","GPS_RESCUE_THROTTLE_PID","FREQ_SENSOR","FEEDFORWARD_LIMIT","FEEDFORWARD","BLACKBOX_OUTPUT","GYRO_SAMPLE","RX_TIMING","D_LPF","VTX_TRAMP","GHST","SCHEDULER_DETERMINISM","TIMING_ACCURACY","RX_EXPRESSLRS_SPI","RX_EXPRESSLRS_PHASELOCK","RX_STATE_TIME","PITCH_PRECOMP","YAW_PRECOMP","RESCUE","RESCUE_ALTHOLD","CROSS_COUPLING","ERROR_DECAY","HS_OFFSET","HS_BLEED","USER1","USER2","USER3","USER4"],DEBUG_AXIS:["0 / ROLL","1 / PITCH","2 / YAW","3 / COLLECTIVE","4 / THROTTLE","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31"],LOG_RATES:{8e3:[8,16,32,80,160,320,800],4e3:[4,8,16,40,80,160,400],2e3:[2,4,8,20,40,80,200],1e3:[1,2,4,10,20,40,100],3200:[3,6,12,32,64,128,320],1600:[2,4,8,16,32,64,160],1067:[1,2,4,10,21,42,106],800:[1,2,4,8,16,32,80],0:[1,2,4,8,16,32,64,128,256]},LOG_FIELDS:[],initLogFields(){this.LOG_FIELDS=["command","setpoint","mixer","pid","attitude","gyroraw","gyro","acc","mag","alt","battery","rssi","gps","rpm","motors","servos","vbec","vbus","temps"],_e.gte(FC.CONFIG.apiVersion,API_VERSION_12_7)&&this.LOG_FIELDS.push("esc","bec","esc2")}};qo.initialize=function(n){const e=this;let t,r;o(i);function i(){$("#content").load("/src/tabs/blackbox.html",l)}function o(M){Promise.resolve(!0).then(()=>MSP.promise(MSPCodes.MSP_STATUS)).then(()=>MSP.promise(MSPCodes.MSP_NAME)).then(()=>MSP.promise(MSPCodes.MSP_FEATURE_CONFIG)).then(()=>MSP.promise(MSPCodes.MSP_ADVANCED_CONFIG)).then(()=>MSP.promise(MSPCodes.MSP_DATAFLASH_SUMMARY)).then(()=>MSP.promise(MSPCodes.MSP_SDCARD_SUMMARY)).then(()=>MSP.promise(MSPCodes.MSP_BLACKBOX_CONFIG)).then(()=>MSP.promise(MSPCodes.MSP_DEBUG_CONFIG)).then(M)}function s(M){Promise.resolve(!0).then(()=>MSP.promise(MSPCodes.MSP_SET_DEBUG_CONFIG,mspHelper.crunch(MSPCodes.MSP_SET_DEBUG_CONFIG))).then(()=>MSP.promise(MSPCodes.MSP_SET_BLACKBOX_CONFIG,mspHelper.crunch(MSPCodes.MSP_SET_BLACKBOX_CONFIG))).then(()=>MSP.promise(MSPCodes.MSP_EEPROM_WRITE)).then(()=>{GUI.log(i18n.getMessage("eepromSaved")),MSP.send_message(MSPCodes.MSP_SET_REBOOT),GUI.log(i18n.getMessage("deviceRebooting")),reinitialiseConnection(M)})}function l(){i18n.localizePage(),$(".tab-blackbox").addClass("toolbar_hidden"),e.isDirty=!1;function M(){e.isDirty||(e.isDirty=!0,$(".tab-blackbox").removeClass("toolbar_hidden"))}const N=FC.DATAFLASH.totalSize>0;let w;FC.BLACKBOX.supported||FC.DATAFLASH.supported?w="yes":w="no",$(".tab-blackbox").addClass("serial-supported").toggleClass("dataflash-supported",FC.DATAFLASH.supported).toggleClass("dataflash-present",N).toggleClass("sdcard-supported",FC.SDCARD.supported).toggleClass("blackbox-config-supported",FC.BLACKBOX.supported).toggleClass("blackbox-supported",w==="yes").toggleClass("blackbox-maybe-supported",w==="maybe").toggleClass("blackbox-unsupported",w==="no"),N&&($(".tab-blackbox a.erase-flash").click(y),$(".tab-blackbox a.erase-flash-confirm").click(G),$(".tab-blackbox a.erase-flash-cancel").click(U),$(".tab-blackbox a.save-flash").click(P),$(".tab-blackbox a.save-flash-cancel").click(R),$(".tab-blackbox a.save-flash-dismiss").click(F));const x=$(".tab-blackbox .blackboxDevice select"),k=$(".tab-blackbox .blackboxMode select"),O=$(".tab-blackbox .blackboxRate select"),D=$(".tab-blackbox .blackboxDebugMode select"),Y=$(".tab-blackbox .blackboxDebugAxis select"),z=$(".tab-blackbox .blackboxInitialErase input"),ee=$(".tab-blackbox .blackboxRollingErase input"),re=$(".tab-blackbox .blackboxGracePeriod input");u(x),p(k),h(O),g(D),f(Y),c(),re.val(FC.BLACKBOX.blackboxGracePeriod),z.val(Math.round(FC.BLACKBOX.blackboxInitialEraseKiB/1024)),z.prop("max",Math.min(64,FC.DATAFLASH.totalSize/1024/1024)),ee.prop("checked",!!FC.BLACKBOX.blackboxRollingErase).change();function le(){x.val()!=0?($("div.blackboxMode").show(),k.val()!=0?($("div.blackboxRate").show(),$("div.blackboxFlags").show()):($("div.blackboxRate").hide(),$("div.blackboxFlags").hide())):($("div.blackboxMode").hide(),$("div.blackboxRate").hide(),$("div.blackboxFlags").hide()),x.val()!=0&&(k.val()==1||k.val()==2)&&_e.gte(FC.CONFIG.apiVersion,API_VERSION_12_8)?$("div.blackboxGracePeriod").show():$("div.blackboxGracePeriod").hide(),x.val()==1&&_e.gte(FC.CONFIG.apiVersion,API_VERSION_12_8)?($("div.blackboxInitialErase").show(),$("div.blackboxRollingErase").show()):($("div.blackboxInitialErase").hide(),$("div.blackboxRollingErase").hide())}x.change(le).change(),k.change(le).change(),(FC.SDCARD.supported&&x.val()==2||FC.DATAFLASH.supported&&x.val()==1)&&($(".tab-blackbox").toggleClass("msc-supported",!0),$("a.blackboxRebootMsc").click(function(){const oe=[];GUI.operating_system==="Linux"?oe.push(mspHelper.REBOOT_TYPES.MSC_UTC):oe.push(mspHelper.REBOOT_TYPES.MSC),MSP.send_message(MSPCodes.MSP_SET_REBOOT,oe,!1)}));function J(){FC.BLACKBOX.blackboxDevice=parseInt(x.val(),10),FC.BLACKBOX.blackboxMode=parseInt(k.val(),10),FC.BLACKBOX.blackboxDenom=parseInt(O.val(),10),FC.DEBUG_CONFIG.debugMode=parseInt(D.val(),10),FC.DEBUG_CONFIG.debugAxis=parseInt(Y.val(),10),FC.BLACKBOX.blackboxInitialEraseKiB=Math.min(65535,parseInt(z.val(),10)*1024),FC.BLACKBOX.blackboxRollingErase=Number(ee.prop("checked")),FC.BLACKBOX.blackboxGracePeriod=parseInt(re.val(),10)}FC.BLACKBOX.supported&&(e.save=function(oe){J(),a(),s(oe)},e.revert=function(oe){oe?.()},$(".tab-blackbox a.reboot").click(function(){e.save(()=>GUI.tab_switch_reload())}),$(".tab-blackbox a.revert").click(function(){e.revert(()=>GUI.tab_switch_reload())}),$(".tab-blackbox .blackbox-changes").change(function(){M()})),C(),GUI.content_ready(n)}function a(){$.each(e.LOG_FIELDS,function(M,N){$(`.tab-blackbox input[id="blackboxlog_${N}"]`).is(":checked")?FC.BLACKBOX.blackboxFields|=1<<M:FC.BLACKBOX.blackboxFields&=~(1<<M)})}function c(){e.initLogFields();const M=$(".tab-blackbox .blackboxLogFlags");$.each(e.LOG_FIELDS,function(N,w){const x=FC.BLACKBOX.blackboxFields&1<<N?"checked":"",k=i18n.getMessage(`blackboxLog_${w}`);M.append(`<div class="flag_box"><input type="checkbox" id="blackboxlog_${w}" class="toggle" ${x} /><span>${k}</span></div>`)})}function u(M){M.empty(),M.append('<option value="0">'+i18n.getMessage("blackboxLoggingNone")+"</option>"),FC.DATAFLASH.supported&&M.append('<option value="1">'+i18n.getMessage("blackboxLoggingFlash")+"</option>"),FC.SDCARD.supported&&M.append('<option value="2">'+i18n.getMessage("blackboxLoggingSdCard")+"</option>"),M.append('<option value="3">'+i18n.getMessage("blackboxLoggingSerial")+"</option>"),M.val(FC.BLACKBOX.blackboxDevice)}function p(M){M.empty(),M.append('<option value="0">'+i18n.getMessage("blackboxModeOff")+"</option>"),M.append('<option value="1">'+i18n.getMessage("blackboxModeNormal")+"</option>"),M.append('<option value="2">'+i18n.getMessage("blackboxModeArmed")+"</option>"),M.append('<option value="3">'+i18n.getMessage("blackboxModeSwitch")+"</option>"),M.val(FC.BLACKBOX.blackboxMode)}function h(M){const N=FC.ADVANCED_CONFIG.pid_process_denom,w=FC.CONFIG.sampleRateHz/N,x=Math.round(w);let k=e.LOG_RATES[x];k===void 0&&(k=e.LOG_RATES[0]),M.empty();let O=!1;if($.each(k,function(D,Y){const ee=`${(w/Y).toFixed(0)}Hz`;M.append(new Option(ee,Y)),Y==FC.BLACKBOX.blackboxDenom&&(O=!0)}),!O){const D=w/FC.BLACKBOX.blackboxDenom,Y=i18n.getMessage("blackboxRateCustom");M.append(new Option(`${Y} ${D.toFixed(0)}Hz [1/${FC.BLACKBOX.blackboxDenom}]`,FC.BLACKBOX.blackboxDenom))}M.val(FC.BLACKBOX.blackboxDenom)}function g(M){M.empty();for(let N=0;N<FC.DEBUG_CONFIG.debugModeCount;N++)N<e.DEBUG_MODES.length?M.append(new Option(e.DEBUG_MODES[N],N)):M.append(new Option(i18n.getMessage("blackboxDebugModeUnknown"),N));M.val(FC.DEBUG_CONFIG.debugMode),M.select2({sorter(N){return N.sort(function(w,x){return w.text==="NONE"||x.text===i18n.getMessage("blackboxDebugModeUnknown")?-1:x.text==="NONE"||w.text===i18n.getMessage("blackboxDebugModeUnknown")?1:w.text.localeCompare(x.text)})},width:"style"})}function f(M){M.empty(),$.each(e.DEBUG_AXIS,function(N,w){M.append(new Option(w,N))}),M.val(FC.DEBUG_CONFIG.debugAxis)}function d(M){if(M<1024)return Math.round(M)+"kB";const N=M/1024;let w;return N<900?N.toFixed(1)+"MB":(w=N/1024,w.toFixed(1)+"GB")}function _(M){return M<1024?M+"B":d(M/1024)}function m(M,N,w,x,k){N>0?(M.css({width:N/w*100+"%",display:"block"}),$("div",M).text((x?x+" ":"")+(k?d(N):_(N)))):M.css({display:"none"})}function C(){const M=FC.DATAFLASH.totalSize>0;m($(".tab-blackbox .dataflash-used"),FC.DATAFLASH.usedSize,FC.DATAFLASH.totalSize,i18n.getMessage("dataflashUsedSpace"),!1),m($(".tab-blackbox .dataflash-free"),FC.DATAFLASH.totalSize-FC.DATAFLASH.usedSize,FC.DATAFLASH.totalSize,i18n.getMessage("dataflashFreeSpace"),!1),m($(".tab-blackbox .sdcard-other"),FC.SDCARD.totalSizeKB-FC.SDCARD.freeSizeKB,FC.SDCARD.totalSizeKB,i18n.getMessage("dataflashUnavSpace"),!0),m($(".tab-blackbox .sdcard-free"),FC.SDCARD.freeSizeKB,FC.SDCARD.totalSizeKB,i18n.getMessage("dataflashLogsSpace"),!0),$(".btn a.erase-flash, .btn a.save-flash").toggleClass("disabled",FC.DATAFLASH.usedSize===0),$(".tab-blackbox").toggleClass("sdcard-error",FC.SDCARD.state===MSP.SDCARD_STATE_FATAL).toggleClass("sdcard-initializing",FC.SDCARD.state===MSP.SDCARD_STATE_CARD_INIT||FC.SDCARD.state===MSP.SDCARD_STATE_FS_INIT).toggleClass("sdcard-ready",FC.SDCARD.state===MSP.SDCARD_STATE_READY);const N=M||FC.SDCARD.state===MSP.SDCARD_STATE_READY;switch($(".tab-blackbox").toggleClass("msc-not-ready",!N),N?$("a.blackboxRebootMsc").removeClass("disabled"):$("a.blackboxRebootMsc").addClass("disabled"),FC.SDCARD.state){case MSP.SDCARD_STATE_NOT_PRESENT:$(".sdcard-status").text(i18n.getMessage("sdcardStatusNoCard"));break;case MSP.SDCARD_STATE_FATAL:$(".sdcard-status").html(i18n.getMessage("sdcardStatusReboot"));break;case MSP.SDCARD_STATE_READY:$(".sdcard-status").text(i18n.getMessage("sdcardStatusReady"));break;case MSP.SDCARD_STATE_CARD_INIT:$(".sdcard-status").text(i18n.getMessage("sdcardStatusStarting"));break;case MSP.SDCARD_STATE_FS_INIT:$(".sdcard-status").text(i18n.getMessage("sdcardStatusFileSystem"));break;default:$(".sdcard-status").text(i18n.getMessage("sdcardStatusUnknown",[FC.SDCARD.state]))}FC.SDCARD.supported&&!Yi&&(Yi=setTimeout(function(){Yi=!1,CONFIGURATOR.connectionValid&&MSP.send_message(MSPCodes.MSP_SDCARD_SUMMARY,!1,!1,function(){C()})},2e3))}function R(){t=!0}function S(){$(".dataflash-saving progress").attr("value",0),t=!1,$(".dataflash-saving").removeClass("done"),$(".dataflash-saving")[0].showModal()}function F(){$(".dataflash-saving")[0].close()}function I(M,N,w){const x=(new Date().getTime()-M)/1e3;console.log("Received "+N+" bytes in "+x.toFixed(2)+"s ("+(N/x/1024).toFixed(2)+"kB / s) with block size "+e.blockSize+"."),isNaN(w)||console.log("Compressed into",w,"bytes with mean compression factor of",N/w),$(".dataflash-saving").addClass("done")}function T(M){MSP.send_message(MSPCodes.MSP_DATAFLASH_SUMMARY,!1,!1,function(){C(),M&&M()})}function P(){GUI.connected_to&&(FC.boardHasVcp()?e.blockSize=e.VCP_BLOCK_SIZE:e.blockSize=e.BLOCK_SIZE,T(async function(){const M=FC.DATAFLASH.usedSize,N="BLACKBOX_LOG",w="BBL",x=await rd({suggestedName:generateFilename(N,w),description:`${w.toUpperCase()} files`,mimeType:"application/octet-stream"});if(!x)return;let k=0,O=0;S();async function D(){await x.close(),F()}async function Y(){await x.close(),I(ee,k,O)}async function z(re,le,J){if(!le){mspHelper.dataflashRead(k,e.blockSize,z);return}if(le.byteLength===0)return await Y();k+=le.byteLength,isNaN(J)||isNaN(O)?O=null:O+=J,$(".dataflash-saving progress").attr("value",k/M*100);const oe=new Blob([le]);try{await x.write(oe),t?await D():k>=M?await Y():mspHelper.dataflashRead(k,e.blockSize,z)}catch(ae){console.log(ae),await D()}}const ee=new Date().getTime();mspHelper.dataflashRead(k,e.blockSize,z)}))}function y(){r=!1,$(".dataflash-confirm-erase").removeClass("erasing"),$(".dataflash-confirm-erase")[0].showModal()}function L(){T(function(){CONFIGURATOR.connectionValid&&!r&&(FC.DATAFLASH.ready?$(".dataflash-confirm-erase")[0].close():setTimeout(L,500))})}function G(){$(".dataflash-confirm-erase").addClass("erasing"),MSP.send_message(MSPCodes.MSP_DATAFLASH_ERASE,!1,!1,L)}function U(){r=!0,$(".dataflash-confirm-erase")[0].close()}};qo.cleanup=function(n){this.isDirty=!1,Yi&&(clearTimeout(Yi),Yi=!1),n?.()};qo.mscRebootFailedCallback=function(){$(".tab-blackbox").toggleClass("msc-supported",!1),showErrorDialog(i18n.getMessage("operationNotSupported"))};TABS[qo.tabName]=qo;let fO;const Xs=8,Sh=10,Rh=13;class hm{#e=15;#i=100;#s=100;#r="";#o="";#n=!1;#t=0;#u=void 0;#c=void 0;#l=void 0;#_=!1;#f=!1;#a={window:null,windowWrapper:null,textarea:null};#g={history:[],wipCommand:"",index:0,add:function(e){this.history.push(e),this.index=this.history.length,this.wipCommand=""},prev:function(){return this.index>0&&(this.index-=1),this.history[this.index]},next:function(){return this.index<this.history.length&&(this.index+=1),this.history[this.index-1]}};get outputHistory(){return this.#r}clearOutputHistory(){this.#r="",this.#a.windowWrapper.empty()}get errorsCount(){return this.#t}get inBatchMode(){return this.#f}setUi(e,t,r){this.#a.window=e,this.#a.windowWrapper=t,this.#a.textarea=r,this.#p()}initializeAutoComplete(){const e=this;wt.initialize(this.#a.textarea,this.sendLine.bind(this),this.writeToOutput.bind(this)),$(wt).on("build:start",function(){e.#a.textarea.val("").attr("placeholder",i18n.getMessage("cliInputPlaceholderBuilding")).prop("disabled",!0)}),$(wt).on("build:stop",function(){e.#a.textarea.attr("placeholder",i18n.getMessage("cliInputPlaceholder")).prop("disabled",!1).focus()}),this.#l=wt}setProgressCallback(e){this.#u=e}#d(e){this.#u?.(e)}enterCliMode(){const e=new ArrayBuffer(1),t=new Uint8Array(e);this.#o="",t[0]=35,serial.send(e)}#p(){this.#a.textarea.keydown(e=>{if(e.key==="Tab"&&(e.preventDefault(),this.#l))if(this.#l.isEnabled())!this.#l.isOpen()&&!this.#l.isBuilding()&&this.#l.openLater(!0);else{const r=this.#a.textarea.val().split(`
`).pop();this.#v(r)}}),this.#a.textarea.keypress(e=>{if(e.key==="Enter"){if(e.preventDefault(),this.#l&&this.#l.isBuilding())return;const t=this.#a.textarea.val();this.#g.add(t),this.executeCommands(t),this.#a.textarea.val("")}}),this.#a.textarea.keyup(e=>{this.#l&&this.#l.isOpen()||(e.key==="ArrowUp"&&this.#a.textarea.val(this.#g.prev()),e.key==="ArrowDown"&&this.#a.textarea.val(this.#g.next()))}),this.#a.textarea.focus()}close(e){let t="exit\r";this.#n&&(t=this.#h(t)),this.#E(t,function(){e?.(),qe.cliEngineActive=!1,qe.cliEngineValid=!1,qe.cliTab=""})}async executeCommands(e){const t=e.split(`
`);await this.executeCommandsArray(t)}async executeCommandsArray(e){this.#d(0);for(let t=0,r=0;t<e.length;t++){let i=e[t].trim();i.length!==0&&(r&&await new Promise(o=>setTimeout(o,r)),this.#n&&(i=this.#h(i)),await new Promise(o=>this.sendLine(i,o)),this.#d(100*t/e.length),i.toLowerCase().startsWith("profile")?r=this.#i:i.toLowerCase().startsWith("rateprofile")?r=this.#s:r=this.#e)}this.#d(100)}#m(e){return e.replace(/^# /,"")}#h(e){const t=this.#m(this.#o),r=new RegExp(`^${t}`,"g");if(e.match(r))return e.replace(r,"");let i=0;for(let l=0;l<t.length&&e[l]===t[l];l++)i++;const o=t.length-i;return"".repeat(o)+e.substring(t.length-o,e.length)}writeToOutput(e){this.#a.windowWrapper.append(e),this.#a.window.scrollTop(this.#a.window.prop("scrollHeight"))}#C(e){this.#l&&this.#l.isBuilding()?this.#l.builderParseLine(e):e.startsWith("###ERROR")?(this.writeToOutput(`<span class="error_message">${e}</span><br>`),this.#t++):this.writeToOutput(`${e}<br>`),this.#c?.()}readSerial(e){const t=new Uint8Array(e.data??e);let r="",i=0;for(const o of t){const s=String.fromCharCode(o),l=s.charCodeAt()===Sh||s.charCodeAt()===Rh;if(!qe.cliEngineValid&&(l||this.#_)){this.#_=!0,r+=s,this.writeToOutput(s);continue}if(o===27&&!i&&(i=3),i){i--;continue}this.#S(o),this.#o==="Rebooting"&&Xs!==o&&(qe.cliEngineActive=!1,qe.cliEngineValid=!1,qe.cliTab="",GUI.log(i18n.getMessage("cliReboot")),rl()),this.#o==="Command batch started"&&Xs!==o&&(this.#f=!0),this.#o==="Command batch ended"&&Xs!==o&&(this.#f=!1)}if(!qe.cliEngineValid&&r.indexOf("CLI")!==-1){GUI.log(i18n.getMessage("cliEnter")),qe.cliEngineValid=!0;const o=r.split(`
`).pop();this.#r=o,this.#l&&this.#l.isEnabled()&&!this.#l.isBuilding()&&this.#l.builderStart()}qe.cliEngineValid&&(this.#l&&!this.#l.isEnabled()||this.#l==null)&&this.#n&&this.setPrompt(this.#m(this.#o))}setPrompt(e){this.#a.textarea.val(e)}sendLine(e,t){this.#E(`${e}
`,t)}#v(e,t){this.#n?e=this.#h(e):this.#n=!0,this.#E(e+"	",t)}subscribeResponseCallback(e){this.#c=e}unsubscribeResponseCallback(){this.#c=void 0}#E(e,t){const r=new ArrayBuffer(e.length),i=new Uint8Array(r);for(let o=0;o<e.length;o++)i[o]=e.charCodeAt(o);serial.send(r,t)}#S(e){if(qe.cliEngineValid){const t=String.fromCharCode(e);switch(e){case Sh:GUI.operating_system==="Windows"&&(this.#C(this.#o),this.#o="");break;case Rh:GUI.operating_system!=="Windows"&&(this.#C(this.#o),this.#o="");break;case 60:this.#o+="&lt";break;case 62:this.#o+="&gt";break;case Xs:this.#o=this.#o.slice(0,-1),this.#r=this.#r.slice(0,-1);return;default:this.#o+=t}this.#r+=t}}}const Fn={tabName:"cli",cliEngine:null,GUI:{snippetPreviewWindow:null,copyButton:null,window:null,windowWrapper:null,textarea:null}};async function _O(n){try{await fO(n);const e=Fn.GUI.copyButton,t=e.text(),r=e.css("width");e.text(i18n.getMessage("cliCopySuccessful")),e.css({width:r,textAlign:"center"}),setTimeout(()=>{e.text(t),e.css({width:"",textAlign:""})},1500)}catch(e){console.warn(e)}}Fn.initialize=function(n){const e=this;GUI.active_tab!=="cli"&&(GUI.active_tab="cli"),e.cliEngine=new hm,$("#content").load("/src/tabs/cli.html",function(){i18n.localizePage(),Fn.adaptPhones(),e.GUI.copyButton=$(".tab-cli .copy"),e.GUI.window=$(".tab-cli .window"),e.GUI.windowWrapper=$(".tab-cli .window .wrapper"),e.GUI.textarea=$('.tab-cli textarea[name="commands"]'),$(".tab-cli .save").on("click",async function(){const t="cli",r="txt";try{await al(e.cliEngine.outputHistory,{suggestedName:generateFilename(t,r),description:`${r.toUpperCase()} files`})}catch(i){console.log("Failed to save config",i)}}),$(".tab-cli .clear").on("click",function(){e.cliEngine.clearOutputHistory()}),e.GUI.copyButton.click(function(){_O(e.cliEngine.outputHistory)}),$(".tab-cli .load").on("click",async function(){const t=$("#snippetpreviewcontent textarea#preview");function r(){const o=t.val();e.cliEngine.executeCommands(o),e.GUI.snippetPreviewWindow.close()}function i(o,s){e.GUI.snippetPreviewWindow||(e.GUI.snippetPreviewWindow=new jBox("Modal",{id:"snippetPreviewWindow",width:"auto",height:"auto",closeButton:"title",animation:!1,isolateScroll:!1,title:i18n.getMessage("cliConfirmSnippetDialogTitle",{fileName:s}),content:$("#snippetpreviewcontent"),onCreated:()=>$("#snippetpreviewcontent a.confirm").on("click",()=>r())}));const l=o.split(`
`).map(a=>{const c=a.toLowerCase().trim();return c.startsWith("dump")||c.startsWith("diff")||c.startsWith("exit")?`# ${a}`:a}).join(`
`);t.val(l),e.GUI.snippetPreviewWindow.open()}try{const o=await sl({description:"Config files",extensions:[".txt",".config"]});if(!o)return;i(o.content,o.name)}catch(o){console.log("Failed to load config",o)}}),e.exit=function(t){if(CONFIGURATOR.cliEngineActive){const r=$(".dialogCLIExit")[0];$(".cliExitBackBtn").click(function(){$(".cliExitBackBtn").off("click"),r.close()}),r.showModal()}else t?.()},e.activateCli(),GUI.saveDefaultTab("status"),GUI.content_ready(n)})};Fn.activateCli=function(){return new Promise(n=>{CONFIGURATOR.cliEngineActive=!0,CONFIGURATOR.cliTab="cli",this.cliEngine.setUi(this.GUI.window,this.GUI.windowWrapper,this.GUI.textarea),this.cliEngine.initializeAutoComplete(),this.cliEngine.enterCliMode();const e=setInterval(()=>{CONFIGURATOR.cliEngineValid&&(clearInterval(e),GUI.timeout_add("enter_cli",()=>{n()},500))},500)})};Fn.adaptPhones=function(){if($(window).width()<575){const n=$(".note").height()+22+38;$(".backdrop").css("height",`calc(100% - ${n}px)`)}GUI.isCordova()&&UI_PHONES.initToolbar()};Fn.read=function(n){this.cliEngine.readSerial(n)};Fn.cleanup=function(n){if(Fn.GUI.snippetPreviewWindow&&(Fn.GUI.snippetPreviewWindow.destroy(),Fn.GUI.snippetPreviewWindow=null),!(CONFIGURATOR.connectionValid&&CONFIGURATOR.cliEngineValid&&CONFIGURATOR.cliEngineActive)){n?.();return}this.cliEngine.close(n),CliAutoComplete.cleanup(),$(CliAutoComplete).off()};TABS[Fn.tabName]=Fn;const ir=function(n,e){const t=FC.MIXER_CONFIG.main_rotor_dir===0;this.wrapper=n,this.canvas=e,this.renderer=new BF({canvas:this.canvas[0],alpha:!0,antialias:!0}),this.renderer.setSize(this.wrapper.width()*2,this.wrapper.height()*2),this.renderer.outputColorSpace=VF,this.scene=new HF,this.modelWrapper=new XF,this.camera=new YF(10,this.wrapper.width()/this.wrapper.height(),1,1e4),this.camera.position.z=800;const r=new zF(16777215,1.2),i=new WF(new jF(1,1,1),3);i.position.set(0,600,800),this.scene.add(r),this.scene.add(i),this.scene.add(this.camera),this.scene.add(this.modelWrapper),this.loadGLTF(`bell_${t?"cw":"ccw"}`,o=>{this.model=o,this.modelWrapper.add(o),this.scene.add(this.modelWrapper),this.render()})};ir.prototype.loadGLTF=function(n,e){new qF().load("/resources/models/"+n+".gltf",function(r){e(r.scene)})};ir.prototype.rotateTo=function(n,e,t){this.model&&(this.model.rotation.x=n,this.modelWrapper.rotation.y=e,this.model.rotation.z=t,this.render())};ir.prototype.rotateBy=function(n,e,t){this.model&&(this.model.rotateX(n),this.model.rotateY(e),this.model.rotateZ(t),this.render())};ir.prototype.render=function(){this.model&&this.renderer.render(this.scene,this.camera)};ir.prototype.resize=function(){this.renderer.setSize(this.wrapper.width()*2,this.wrapper.height()*2),this.camera.aspect=this.wrapper.width()/this.wrapper.height(),this.camera.updateProjectionMatrix(),this.render()};ir.prototype.dispose=function(){this.renderer.forceContextLoss(),this.renderer.dispose()};const Qi={tabName:"configuration",isDirty:!1,yaw_fix:0};Qi.initialize=function(n){const e=this,t={0:"UART1",1:"UART2",2:"UART3",3:"UART4",4:"UART5",5:"UART6",6:"UART7",7:"UART8",8:"UART9",9:"UART10",20:"USB VCP",30:"SOFTSERIAL1",31:"SOFTSERIAL2"},r={F7A1:{0:"DSM Ⓓ",1:"S.BUS",2:"Port Ⓒ",3:"Port Ⓐ",4:"Port Ⓔ",5:"Port Ⓑ"},F7A2:{0:"DSM Ⓓ",1:"S.BUS",2:"Port Ⓖ",3:"Port Ⓐ",4:"Port Ⓔ",5:"Port Ⓖ"},F7A3:{0:"DSM Ⓓ",1:"S.BUS",2:"Port Ⓒ",3:"Port Ⓐ",4:"Int.Rx",5:"Port Ⓑ"},F7A4:{0:"DSM Ⓓ",1:"S.BUS",2:"Port Ⓖ",3:"Port Ⓐ",4:"Int.Rx",5:"Port Ⓖ"},F7B1:{0:"S.BUS",1:"TELEM",2:"Port Ⓒ",3:"Port Ⓐ",4:"DSM Ⓓ",5:"Port Ⓑ"},F7B2:{0:"S.BUS",1:"TELEM",2:"Port Ⓖ",3:"Port Ⓐ",4:"DSM Ⓓ",5:"Port Ⓖ"},F7B3:{0:"S.BUS",1:"TELEM",2:"Port Ⓒ",3:"Port Ⓐ",4:"Port Ⓔ",5:"Port Ⓑ"},F7B4:{0:"S.BUS",1:"TELEM",2:"Port Ⓖ",3:"Port Ⓐ",4:"Port Ⓔ",5:"Port Ⓖ"},F7B5:{0:"S.BUS",1:"TELEM",2:"Port Ⓒ",3:"Port Ⓐ",4:"Int.Rx",5:"Port Ⓑ"},F7B6:{0:"S.BUS",1:"TELEM",2:"Port Ⓖ",3:"Port Ⓐ",4:"Int.Rx",5:"Port Ⓖ"},F7C1:{0:"S.BUS",1:"TELEM",2:"Port Ⓒ",3:"Port Ⓐ",4:"DSM Ⓓ",5:"Port Ⓑ"},F7C2:{0:"S.BUS",1:"TELEM",2:"Port Ⓖ",3:"Port Ⓐ",4:"DSM Ⓓ",5:"Port Ⓖ"},F7C3:{0:"S.BUS",1:"TELEM",2:"Port Ⓒ",3:"Port Ⓐ",4:"Port Ⓔ",5:"Port Ⓑ"},F7C4:{0:"S.BUS",1:"TELEM",2:"Port Ⓖ",3:"Port Ⓐ",4:"Port Ⓔ",5:"Port Ⓖ"},F7C5:{0:"S.BUS",1:"TELEM",2:"Port Ⓒ",3:"Port Ⓐ",4:"Int.Rx",5:"Port Ⓑ"},F7C6:{0:"S.BUS",1:"TELEM",2:"Port Ⓖ",3:"Port Ⓐ",4:"Int.Rx",5:"Port Ⓖ"}},i={DISABLED:0,MSP:1,GPS:2,TELEM:3,MAVLINK:4,BLACKBOX:5,CUSTOM:6,AUTO:7},o={};o[i.DISABLED]=["DISABLED"],o[i.MSP]=["9600","19200","38400","57600","115200","230400","250000","460800","500000","921600","1000000"],o[i.GPS]=["AUTO","9600","19200","38400","57600","115200","230400","460800"],o[i.MAVLINK]=["AUTO","9600","19200","38400","57600","115200","230400","460800"],o[i.TELEM]=["AUTO"],o[i.BLACKBOX]=["AUTO","19200","38400","57600","115200","230400","250000","460800","500000","921600","1000000","1500000","2000000","2470000"],o[i.CUSTOM]=["CUSTOM"],o[i.AUTO]=["AUTO"];const s=[{id:0,excl:0,name:"DISABLED",type:i.DISABLED},{id:1,excl:1,name:"MSP",type:i.MSP},{id:2,excl:2,name:"GPS",type:i.GPS},{id:64,excl:64,name:"RX_SERIAL",type:i.AUTO},{id:1024,excl:1024,name:"ESC_SENSOR",type:i.AUTO},{id:128,excl:128,name:"BLACKBOX",type:i.BLACKBOX},{id:262144,excl:262144,name:"SBUS_OUT",type:i.AUTO},{id:4,excl:4668,name:"TELEMETRY_FRSKY",type:i.TELEM},{id:32,excl:4668,name:"TELEMETRY_SMARTPORT",type:i.TELEM},{id:4096,excl:4668,name:"TELEMETRY_IBUS",type:i.TELEM},{id:8,excl:4668,name:"TELEMETRY_HOTT",type:i.TELEM},{id:512,excl:4668,name:"TELEMETRY_MAVLINK",type:i.MAVLINK},{id:16,excl:4668,name:"TELEMETRY_LTM",type:i.TELEM}];GUI.configuration_loaded=!0,a(l);function l(){$("#content").load("/src/tabs/configuration.html",C)}function a(R){Promise.resolve(!0).then(()=>MSP.promise(MSPCodes.MSP_STATUS)).then(()=>MSP.promise(MSPCodes.MSP_NAME)).then(()=>MSP.promise(MSPCodes.MSP_BOARD_INFO)).then(()=>MSP.promise(MSPCodes.MSP_FEATURE_CONFIG)).then(()=>MSP.promise(MSPCodes.MSP_ADVANCED_CONFIG)).then(()=>MSP.promise(MSPCodes.MSP_MIXER_CONFIG)).then(()=>MSP.promise(MSPCodes.MSP_SENSOR_CONFIG)).then(()=>MSP.promise(MSPCodes.MSP_SENSOR_ALIGNMENT)).then(()=>MSP.promise(MSPCodes.MSP_BOARD_ALIGNMENT_CONFIG)).then(()=>MSP.promise(MSPCodes.MSP_ACC_TRIM)).then(()=>MSP.promise(MSPCodes.MSP_SERIAL_CONFIG)).then(R)}function c(R){Promise.resolve(!0).then(()=>MSP.promise(MSPCodes.MSP_SET_NAME,mspHelper.crunch(MSPCodes.MSP_SET_NAME))).then(()=>MSP.promise(MSPCodes.MSP_SET_FEATURE_CONFIG,mspHelper.crunch(MSPCodes.MSP_SET_FEATURE_CONFIG))).then(()=>MSP.promise(MSPCodes.MSP_SET_ADVANCED_CONFIG,mspHelper.crunch(MSPCodes.MSP_SET_ADVANCED_CONFIG))).then(()=>MSP.promise(MSPCodes.MSP_SET_SENSOR_CONFIG,mspHelper.crunch(MSPCodes.MSP_SET_SENSOR_CONFIG))).then(()=>MSP.promise(MSPCodes.MSP_SET_SENSOR_ALIGNMENT,mspHelper.crunch(MSPCodes.MSP_SET_SENSOR_ALIGNMENT))).then(()=>MSP.promise(MSPCodes.MSP_SET_BOARD_ALIGNMENT_CONFIG,mspHelper.crunch(MSPCodes.MSP_SET_BOARD_ALIGNMENT_CONFIG))).then(()=>MSP.promise(MSPCodes.MSP_SET_ACC_TRIM,mspHelper.crunch(MSPCodes.MSP_SET_ACC_TRIM))).then(()=>MSP.promise(MSPCodes.MSP_SET_SERIAL_CONFIG,mspHelper.crunch(MSPCodes.MSP_SET_SERIAL_CONFIG))).then(()=>MSP.promise(MSPCodes.MSP_EEPROM_WRITE)).then(()=>{GUI.log(i18n.getMessage("eepromSaved")),MSP.send_message(MSPCodes.MSP_SET_REBOOT),GUI.log(i18n.getMessage("deviceRebooting")),reinitialiseConnection(R)})}function u(R,S){const F=FC.SERIAL_CONFIG.ports[R];switch(S){case i.MSP:return F.msp_baudrate;case i.GPS:return F.gps_baudrate;case i.MAVLINK:return F.telemetry_baudrate;case i.BLACKBOX:return F.blackbox_baudrate;case i.AUTO:case i.TELEM:return"AUTO";case i.CUSTOM:return"CUSTOM";default:return"DISABLED"}}function p(R,S,F){const I=FC.SERIAL_CONFIG.ports[R];switch(S){case i.MSP:return I.msp_baudrate=F;case i.GPS:return I.gps_baudrate=F;case i.MAVLINK:return I.telemetry_baudrate=F;case i.BLACKBOX:return I.blackbox_baudrate=F;case i.AUTO:case i.TELEM:return"AUTO";case i.CUSTOM:return"CUSTOM";default:return"DISABLED"}}function h(R){for(const S of s)if(S.id==R)return S}function g(R){for(const S of s)if(S.id==R)return S.type;return i.CUSTOM}function f(R){for(const S of s)if(S.id==R)return S.excl;return R}function d(R,S,F){const I=u(S,F);R.empty();for(const T of o[F]){const P=i18n.existsMessage("baudrate_"+T)?i18n.getMessage("baudrate_"+T):T;R.append(`<option value="${T}">${P}</option>`)}if(!o[F].includes(I)){const T=i18n.existsMessage("baudrate_"+I)?i18n.getMessage("baudrate_"+I):I;R.append(`<option value="${I}">${T}</option>`)}R.val(I)}function _(){let R=0;$(".tab-configuration .serialPorts .portConfiguration select.function").each(function(){const S=$(this).val();R|=f(S)}),$(".tab-configuration .serialPorts .portConfiguration select.function").each(function(){const S=$(this).val(),F=R^f(S);$("option",this).each(function(){const I=$(this),T=I.val();I.prop("disabled",T&F)})})}function m(){const S=$(".tab-configuration .serialPorts"),F=$("#tab-configuration-templates .portConfiguration");for(let I=0;I<FC.SERIAL_CONFIG.ports.length;I++){const T=FC.SERIAL_CONFIG.ports[I];if(T.identifier===20)continue;const P=F.clone(),y=P.find(".portid"),L=P.find(".uartid"),G=P.find("select.function"),U=P.find("select.baudrate");if(FC.CONFIG.boardDesign in r){const M=r[FC.CONFIG.boardDesign];y.text(M[T.identifier]),L.text("["+t[T.identifier]+"]")}else y.text(t[T.identifier]);for(const M of s){const N=i18n.getMessage("portsFunction_"+M.name);(M.name!=="SBUS_OUT"||_e.gte(FC.CONFIG.apiVersion,API_VERSION_12_7))&&G.append(`<option value="${M.id}">${N}</option>`)}if(!h(T.functionMask)){const M=i18n.getMessage("portsFunction_CUSTOM");G.append(`<option value="${T.functionMask}">${M}</option>`)}d(U,I,g(T.functionMask)),U.change(function(){const M=U.val(),N=G.val();p(I,g(N),M)}),G.change(function(){const M=G.val();T.functionMask=M,d(U,I,g(M)),_()}),G.val(T.functionMask),S.append(P)}_()}function C(){$(".tab-configuration").addClass("toolbar_hidden");const R=$(".tab-configuration .features");R.each(function(){const M=$(this);for(const N of Object.keys(Features.GROUPS))if(M.hasClass(N))for(const w of Features.GROUPS[N]){let x="";i18n.existsMessage(`featureTip_${w}`)&&(x=`<div class="helpicon cf_tip" i18n_title="featureTip_${w}"></div>`);const k=$(`<tr>
                <td><input class="feature toggle" id="feature-${w}" name="${w}" title="${w}" type="checkbox"/></td>
                <td><div>${w}</div><span class="xs" i18n="feature_${w}"></span></td>
                <td><span class="sm-min" i18n="feature_${w}"></span>${x}</td>
                </tr>`);k.find("input.feature").prop("checked",FC.FEATURE_CONFIG.features.isEnabled(w)).data("featureName",w),M.append(k)}}),i18n.localizePage(),e.initModel(),e.isDirty=!1;function S(){e.isDirty||(e.isDirty=!0,$(".tab-configuration").removeClass("toolbar_hidden"))}const F=["CW 0°","CW 90°","CW 180°","CW 270°","CW 0° flip","CW 90° flip","CW 180° flip","CW 270° flip","Custom"],I=$("select.magalign");for(let M=0;M<F.length;M++)I.append(`<option value="${M+1}">${F[M]}</option>`);I.val(FC.SENSOR_ALIGNMENT.align_mag),I.change(function(){let M=parseInt($(this).val());FC.SENSOR_ALIGNMENT.align_mag=M});const T=$("input.gyroFrequency"),P=$("select.pidProcessDenom");function y(M,N,w){let x;w===0?x=i18n.getMessage("configurationSpeedPidNoGyro",{value:N}):x=i18n.getMessage("configurationKHzUnitLabel",{value:(w/N/1e3).toFixed(2)}),M.append(`<option value="${N}">${x}</option>`)}const L=function(M){let N;M===0?N=i18n.getMessage("configurationSpeedGyroNoGyro"):N=i18n.getMessage("configurationKHzUnitLabel",{value:(M/1e3).toFixed(2)}),T.val(N)},G=FC.CONFIG.sampleRateHz;L(G),P.empty();for(let M=1;M<=16;M++)G/M>=1e3&&y(P,M,G);P.val(FC.ADVANCED_CONFIG.pid_process_denom),$('input[name="craftName"]').val(FC.CONFIG.name),$('input[id="accHardwareSwitch"]').prop("checked",FC.SENSOR_CONFIG.acc_hardware!==1),$('input[id="baroHardwareSwitch"]').prop("checked",FC.SENSOR_CONFIG.baro_hardware!==1),$('input[id="magHardwareSwitch"]').prop("checked",FC.SENSOR_CONFIG.mag_hardware!==1),$('input[name="board_align_roll"]').val(FC.BOARD_ALIGNMENT_CONFIG.roll),$('input[name="board_align_pitch"]').val(FC.BOARD_ALIGNMENT_CONFIG.pitch),$('input[name="board_align_yaw"]').val(FC.BOARD_ALIGNMENT_CONFIG.yaw),$('input[name="roll"]').val(FC.CONFIG.accelerometerTrims[1]),$('input[name="pitch"]').val(FC.CONFIG.accelerometerTrims[0]),$("div#interactive_block > a.reset").text(i18n.getMessage("statusButtonResetZaxisValue",[e.yaw_fix])),$("div#interactive_block > a.reset").click(function(){e.yaw_fix=FC.SENSOR_DATA.kinematics[2]*-1,$(this).text(i18n.getMessage("statusButtonResetZaxisValue",[e.yaw_fix])),console.log("YAW reset to 0 deg, fix: "+e.yaw_fix+" deg")}),m();function U(){FC.CONFIG.name=$.trim($('input[name="craftName"]').val()),FC.SENSOR_CONFIG.acc_hardware=$('input[id="accHardwareSwitch"]').is(":checked")?0:1,FC.SENSOR_CONFIG.baro_hardware=$('input[id="baroHardwareSwitch"]').is(":checked")?0:1,FC.SENSOR_CONFIG.mag_hardware=$('input[id="magHardwareSwitch"]').is(":checked")?0:1,FC.BOARD_ALIGNMENT_CONFIG.roll=parseInt($('input[name="board_align_roll"]').val()),FC.BOARD_ALIGNMENT_CONFIG.pitch=parseInt($('input[name="board_align_pitch"]').val()),FC.BOARD_ALIGNMENT_CONFIG.yaw=parseInt($('input[name="board_align_yaw"]').val()),FC.CONFIG.accelerometerTrims[1]=parseInt($('input[name="roll"]').val()),FC.CONFIG.accelerometerTrims[0]=parseInt($('input[name="pitch"]').val()),FC.ADVANCED_CONFIG.pid_process_denom=parseInt(P.val())}$("input.feature",R).change(function(){const M=$(this);FC.FEATURE_CONFIG.features.setFeature(M.data("featureName"),M.is(":checked")),updateTabList(FC.FEATURE_CONFIG.features)}),$('input[id="accHardwareSwitch"]').change(function(){const M=$(this).is(":checked");$(".accelNeeded").toggle(M)}).change(),$(R).filter("select").change(function(){const M=$(this);FC.FEATURE_CONFIG.features.setFeature(M.data("featureName"),M.is(":checked")),updateTabList(FC.FEATURE_CONFIG.features)}),e.save=function(M){U(),c(M)},e.revert=function(M){M?.()},$("a.save").click(function(){e.save(()=>GUI.tab_switch_reload())}),$("a.revert").click(function(){e.revert(()=>GUI.tab_switch_reload())}),$(".content_wrapper").change(function(){S()}),GUI.interval_add("attitude_pull",function(){MSP.send_message(MSPCodes.MSP_ATTITUDE,!1,!1,function(){e.renderModel()})},50,!0),GUI.content_ready(n)}};Qi.initModel=function(){try{this.model=new ir($(".model-and-info #canvas_wrapper"),$(".model-and-info #canvas")),$("#canvas_wrapper .webgl-error").hide(),$(window).on("resize",$.proxy(this.model.resize,this.model))}catch(n){console.log("Error initialising model",n),$("#canvas_wrapper .webgl-error").show()}};Qi.renderModel=function(){const n=-FC.SENSOR_DATA.kinematics[1]*.017453292519943295,e=(-FC.SENSOR_DATA.kinematics[2]-this.yaw_fix)*.017453292519943295,t=-FC.SENSOR_DATA.kinematics[0]*.017453292519943295;this.model?.rotateTo(n,e,t)};Qi.cleanup=function(n){this.model&&($(window).off("resize",$.proxy(this.model.resize,this.model)),this.model.dispose()),this.isDirty=!1,n?.()};TABS[Qi.tabName]=Qi;const pO="5";typeof window<"u"&&((window.__svelte??={}).v??=new Set).add(pO);const hO={Date:!0,RegExp:!0,String:!0,Number:!0};function cs(n,e,t={cyclesFix:!0},r=[]){let i=[];const o=Array.isArray(n);for(const l in n){const a=n[l],c=o?+l:l;if(!(l in e)){i.push({type:"REMOVE",path:[c],oldValue:n[l]});continue}const u=e[l],p=typeof a=="object"&&typeof u=="object"&&Array.isArray(a)===Array.isArray(u);a&&u&&p&&!hO[Object.getPrototypeOf(a)?.constructor?.name]&&(!t.cyclesFix||!r.includes(a))?i.push.apply(i,cs(a,u,t,t.cyclesFix?r.concat([a]):[]).map(h=>(h.path.unshift(c),h))):a!==u&&!(Number.isNaN(a)&&Number.isNaN(u))&&!(p&&(isNaN(a)?a+""==u+"":+a==+u))&&i.push({path:[c],type:"CHANGE",value:u,oldValue:a})}const s=Array.isArray(e);for(const l in e)l in n||i.push({type:"CREATE",path:[s?+l:l],value:e[l]});return i}function gO(n){const e=n-1;return e*e*e+1}function Ue(n,{delay:e=0,duration:t=400,easing:r=gO,axis:i="y"}={}){const o=getComputedStyle(n),s=+o.opacity,l=i==="y"?"height":"width",a=parseFloat(o[l]),c=i==="y"?["top","bottom"]:["left","right"],u=c.map(m=>`${m[0].toUpperCase()}${m.slice(1)}`),p=parseFloat(o[`padding${u[0]}`]),h=parseFloat(o[`padding${u[1]}`]),g=parseFloat(o[`margin${u[0]}`]),f=parseFloat(o[`margin${u[1]}`]),d=parseFloat(o[`border${u[0]}Width`]),_=parseFloat(o[`border${u[1]}Width`]);return{delay:e,duration:t,easing:r,css:m=>`overflow: hidden;opacity: ${Math.min(m*20,1)*s};${l}: ${m*a}px;padding-${c[0]}: ${m*p}px;padding-${c[1]}: ${m*h}px;margin-${c[0]}: ${m*g}px;margin-${c[1]}: ${m*f}px;border-${c[0]}-width: ${m*d}px;border-${c[1]}-width: ${m*_}px;min-${l}: 0`}}const Ou=Ug(!0);class mO{constructor(e){this.i18n=this.createInstance(e),this.isLoading=this.createLoadingInstance(e)}createInstance(e){const t=Ug(e);return e.on("initialized",()=>{t.set(e)}),e.on("loaded",()=>{t.set(e)}),e.on("added",()=>t.set(e)),e.on("languageChanged",()=>{t.set(e)}),t}createLoadingInstance(e){return e.on("loaded",t=>{Object.keys(t).length!==0&&Ou.set(!1)}),e.on("failedLoading",()=>{Ou.set(!0)}),Ou}}const CO=n=>new mO(n).i18n,St=CO(LF);function vO(n,e){we(e,!0);var t=Ct(),r=me(t);{var i=o=>{var s=Ct(),l=me(s);Ot(l,()=>e.children??et),Z(o,s)};Ce(r,o=>{qe.expertMode&&o(i)})}Z(n,t),Ge()}const Ko=Math.min,zi=Math.max,va=Math.round,Zn=n=>({x:n,y:n}),EO={left:"right",right:"left",bottom:"top",top:"bottom"},SO={start:"end",end:"start"};function id(n,e,t){return zi(n,Ko(e,t))}function us(n,e){return typeof n=="function"?n(e):n}function si(n){return n.split("-")[0]}function ds(n){return n.split("-")[1]}function gm(n){return n==="x"?"y":"x"}function Bd(n){return n==="y"?"height":"width"}const RO=new Set(["top","bottom"]);function Dr(n){return RO.has(si(n))?"y":"x"}function Vd(n){return gm(Dr(n))}function FO(n,e,t){t===void 0&&(t=!1);const r=ds(n),i=Vd(n),o=Bd(i);let s=i==="x"?r===(t?"end":"start")?"right":"left":r==="start"?"bottom":"top";return e.reference[o]>e.floating[o]&&(s=Ea(s)),[s,Ea(s)]}function IO(n){const e=Ea(n);return[od(n),e,od(e)]}function od(n){return n.replace(/start|end/g,e=>SO[e])}const Fh=["left","right"],Ih=["right","left"],bO=["top","bottom"],TO=["bottom","top"];function OO(n,e,t){switch(n){case"top":case"bottom":return t?e?Ih:Fh:e?Fh:Ih;case"left":case"right":return e?bO:TO;default:return[]}}function PO(n,e,t,r){const i=ds(n);let o=OO(si(n),t==="start",r);return i&&(o=o.map(s=>s+"-"+i),e&&(o=o.concat(o.map(od)))),o}function Ea(n){return n.replace(/left|right|bottom|top/g,e=>EO[e])}function AO(n){return{top:0,right:0,bottom:0,left:0,...n}}function mm(n){return typeof n!="number"?AO(n):{top:n,right:n,bottom:n,left:n}}function Sa(n){const{x:e,y:t,width:r,height:i}=n;return{width:r,height:i,top:t,left:e,right:e+r,bottom:t+i,x:e,y:t}}function bh(n,e,t){let{reference:r,floating:i}=n;const o=Dr(e),s=Vd(e),l=Bd(s),a=si(e),c=o==="y",u=r.x+r.width/2-i.width/2,p=r.y+r.height/2-i.height/2,h=r[l]/2-i[l]/2;let g;switch(a){case"top":g={x:u,y:r.y-i.height};break;case"bottom":g={x:u,y:r.y+r.height};break;case"right":g={x:r.x+r.width,y:p};break;case"left":g={x:r.x-i.width,y:p};break;default:g={x:r.x,y:r.y}}switch(ds(e)){case"start":g[s]-=h*(t&&c?-1:1);break;case"end":g[s]+=h*(t&&c?-1:1);break}return g}const MO=async(n,e,t)=>{const{placement:r="bottom",strategy:i="absolute",middleware:o=[],platform:s}=t,l=o.filter(Boolean),a=await(s.isRTL==null?void 0:s.isRTL(e));let c=await s.getElementRects({reference:n,floating:e,strategy:i}),{x:u,y:p}=bh(c,r,a),h=r,g={},f=0;for(let d=0;d<l.length;d++){const{name:_,fn:m}=l[d],{x:C,y:R,data:S,reset:F}=await m({x:u,y:p,initialPlacement:r,placement:h,strategy:i,middlewareData:g,rects:c,platform:s,elements:{reference:n,floating:e}});u=C??u,p=R??p,g={...g,[_]:{...g[_],...S}},F&&f<=50&&(f++,typeof F=="object"&&(F.placement&&(h=F.placement),F.rects&&(c=F.rects===!0?await s.getElementRects({reference:n,floating:e,strategy:i}):F.rects),{x:u,y:p}=bh(c,h,a)),d=-1)}return{x:u,y:p,placement:h,strategy:i,middlewareData:g}};async function Cm(n,e){var t;e===void 0&&(e={});const{x:r,y:i,platform:o,rects:s,elements:l,strategy:a}=n,{boundary:c="clippingAncestors",rootBoundary:u="viewport",elementContext:p="floating",altBoundary:h=!1,padding:g=0}=us(e,n),f=mm(g),_=l[h?p==="floating"?"reference":"floating":p],m=Sa(await o.getClippingRect({element:(t=await(o.isElement==null?void 0:o.isElement(_)))==null||t?_:_.contextElement||await(o.getDocumentElement==null?void 0:o.getDocumentElement(l.floating)),boundary:c,rootBoundary:u,strategy:a})),C=p==="floating"?{x:r,y:i,width:s.floating.width,height:s.floating.height}:s.reference,R=await(o.getOffsetParent==null?void 0:o.getOffsetParent(l.floating)),S=await(o.isElement==null?void 0:o.isElement(R))?await(o.getScale==null?void 0:o.getScale(R))||{x:1,y:1}:{x:1,y:1},F=Sa(o.convertOffsetParentRelativeRectToViewportRelativeRect?await o.convertOffsetParentRelativeRectToViewportRelativeRect({elements:l,rect:C,offsetParent:R,strategy:a}):C);return{top:(m.top-F.top+f.top)/S.y,bottom:(F.bottom-m.bottom+f.bottom)/S.y,left:(m.left-F.left+f.left)/S.x,right:(F.right-m.right+f.right)/S.x}}const NO=n=>({name:"arrow",options:n,async fn(e){const{x:t,y:r,placement:i,rects:o,platform:s,elements:l,middlewareData:a}=e,{element:c,padding:u=0}=us(n,e)||{};if(c==null)return{};const p=mm(u),h={x:t,y:r},g=Vd(i),f=Bd(g),d=await s.getDimensions(c),_=g==="y",m=_?"top":"left",C=_?"bottom":"right",R=_?"clientHeight":"clientWidth",S=o.reference[f]+o.reference[g]-h[g]-o.floating[f],F=h[g]-o.reference[g],I=await(s.getOffsetParent==null?void 0:s.getOffsetParent(c));let T=I?I[R]:0;(!T||!await(s.isElement==null?void 0:s.isElement(I)))&&(T=l.floating[R]||o.floating[f]);const P=S/2-F/2,y=T/2-d[f]/2-1,L=Ko(p[m],y),G=Ko(p[C],y),U=L,M=T-d[f]-G,N=T/2-d[f]/2+P,w=id(U,N,M),x=!a.arrow&&ds(i)!=null&&N!==w&&o.reference[f]/2-(N<U?L:G)-d[f]/2<0,k=x?N<U?N-U:N-M:0;return{[g]:h[g]+k,data:{[g]:w,centerOffset:N-w-k,...x&&{alignmentOffset:k}},reset:x}}}),xO=function(n){return n===void 0&&(n={}),{name:"flip",options:n,async fn(e){var t,r;const{placement:i,middlewareData:o,rects:s,initialPlacement:l,platform:a,elements:c}=e,{mainAxis:u=!0,crossAxis:p=!0,fallbackPlacements:h,fallbackStrategy:g="bestFit",fallbackAxisSideDirection:f="none",flipAlignment:d=!0,..._}=us(n,e);if((t=o.arrow)!=null&&t.alignmentOffset)return{};const m=si(i),C=Dr(l),R=si(l)===l,S=await(a.isRTL==null?void 0:a.isRTL(c.floating)),F=h||(R||!d?[Ea(l)]:IO(l)),I=f!=="none";!h&&I&&F.push(...PO(l,d,f,S));const T=[l,...F],P=await Cm(e,_),y=[];let L=((r=o.flip)==null?void 0:r.overflows)||[];if(u&&y.push(P[m]),p){const N=FO(i,s,S);y.push(P[N[0]],P[N[1]])}if(L=[...L,{placement:i,overflows:y}],!y.every(N=>N<=0)){var G,U;const N=(((G=o.flip)==null?void 0:G.index)||0)+1,w=T[N];if(w&&(!(p==="alignment"?C!==Dr(w):!1)||L.every(O=>O.overflows[0]>0&&Dr(O.placement)===C)))return{data:{index:N,overflows:L},reset:{placement:w}};let x=(U=L.filter(k=>k.overflows[0]<=0).sort((k,O)=>k.overflows[1]-O.overflows[1])[0])==null?void 0:U.placement;if(!x)switch(g){case"bestFit":{var M;const k=(M=L.filter(O=>{if(I){const D=Dr(O.placement);return D===C||D==="y"}return!0}).map(O=>[O.placement,O.overflows.filter(D=>D>0).reduce((D,Y)=>D+Y,0)]).sort((O,D)=>O[1]-D[1])[0])==null?void 0:M[0];k&&(x=k);break}case"initialPlacement":x=l;break}if(i!==x)return{reset:{placement:x}}}return{}}}},yO=new Set(["left","top"]);async function wO(n,e){const{placement:t,platform:r,elements:i}=n,o=await(r.isRTL==null?void 0:r.isRTL(i.floating)),s=si(t),l=ds(t),a=Dr(t)==="y",c=yO.has(s)?-1:1,u=o&&a?-1:1,p=us(e,n);let{mainAxis:h,crossAxis:g,alignmentAxis:f}=typeof p=="number"?{mainAxis:p,crossAxis:0,alignmentAxis:null}:{mainAxis:p.mainAxis||0,crossAxis:p.crossAxis||0,alignmentAxis:p.alignmentAxis};return l&&typeof f=="number"&&(g=l==="end"?f*-1:f),a?{x:g*u,y:h*c}:{x:h*c,y:g*u}}const GO=function(n){return n===void 0&&(n=0),{name:"offset",options:n,async fn(e){var t,r;const{x:i,y:o,placement:s,middlewareData:l}=e,a=await wO(e,n);return s===((t=l.offset)==null?void 0:t.placement)&&(r=l.arrow)!=null&&r.alignmentOffset?{}:{x:i+a.x,y:o+a.y,data:{...a,placement:s}}}}},LO=function(n){return n===void 0&&(n={}),{name:"shift",options:n,async fn(e){const{x:t,y:r,placement:i}=e,{mainAxis:o=!0,crossAxis:s=!1,limiter:l={fn:_=>{let{x:m,y:C}=_;return{x:m,y:C}}},...a}=us(n,e),c={x:t,y:r},u=await Cm(e,a),p=Dr(si(i)),h=gm(p);let g=c[h],f=c[p];if(o){const _=h==="y"?"top":"left",m=h==="y"?"bottom":"right",C=g+u[_],R=g-u[m];g=id(C,g,R)}if(s){const _=p==="y"?"top":"left",m=p==="y"?"bottom":"right",C=f+u[_],R=f-u[m];f=id(C,f,R)}const d=l.fn({...e,[h]:g,[p]:f});return{...d,data:{x:d.x-t,y:d.y-r,enabled:{[h]:o,[p]:s}}}}}};function ll(){return typeof window<"u"}function co(n){return vm(n)?(n.nodeName||"").toLowerCase():"#document"}function dn(n){var e;return(n==null||(e=n.ownerDocument)==null?void 0:e.defaultView)||window}function Fr(n){var e;return(e=(vm(n)?n.ownerDocument:n.document)||window.document)==null?void 0:e.documentElement}function vm(n){return ll()?n instanceof Node||n instanceof dn(n).Node:!1}function kn(n){return ll()?n instanceof Element||n instanceof dn(n).Element:!1}function nr(n){return ll()?n instanceof HTMLElement||n instanceof dn(n).HTMLElement:!1}function Th(n){return!ll()||typeof ShadowRoot>"u"?!1:n instanceof ShadowRoot||n instanceof dn(n).ShadowRoot}const $O=new Set(["inline","contents"]);function fs(n){const{overflow:e,overflowX:t,overflowY:r,display:i}=Un(n);return/auto|scroll|overlay|hidden|clip/.test(e+r+t)&&!$O.has(i)}const DO=new Set(["table","td","th"]);function kO(n){return DO.has(co(n))}const UO=[":popover-open",":modal"];function cl(n){return UO.some(e=>{try{return n.matches(e)}catch{return!1}})}const BO=["transform","translate","scale","rotate","perspective"],VO=["transform","translate","scale","rotate","perspective","filter"],HO=["paint","layout","strict","content"];function Hd(n){const e=Xd(),t=kn(n)?Un(n):n;return BO.some(r=>t[r]?t[r]!=="none":!1)||(t.containerType?t.containerType!=="normal":!1)||!e&&(t.backdropFilter?t.backdropFilter!=="none":!1)||!e&&(t.filter?t.filter!=="none":!1)||VO.some(r=>(t.willChange||"").includes(r))||HO.some(r=>(t.contain||"").includes(r))}function XO(n){let e=Ur(n);for(;nr(e)&&!Zi(e);){if(Hd(e))return e;if(cl(e))return null;e=Ur(e)}return null}function Xd(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const YO=new Set(["html","body","#document"]);function Zi(n){return YO.has(co(n))}function Un(n){return dn(n).getComputedStyle(n)}function ul(n){return kn(n)?{scrollLeft:n.scrollLeft,scrollTop:n.scrollTop}:{scrollLeft:n.scrollX,scrollTop:n.scrollY}}function Ur(n){if(co(n)==="html")return n;const e=n.assignedSlot||n.parentNode||Th(n)&&n.host||Fr(n);return Th(e)?e.host:e}function Em(n){const e=Ur(n);return Zi(e)?n.ownerDocument?n.ownerDocument.body:n.body:nr(e)&&fs(e)?e:Em(e)}function Sm(n,e,t){var r;e===void 0&&(e=[]);const i=Em(n),o=i===((r=n.ownerDocument)==null?void 0:r.body),s=dn(i);return o?(sd(s),e.concat(s,s.visualViewport||[],fs(i)?i:[],[])):e.concat(i,Sm(i,[]))}function sd(n){return n.parent&&Object.getPrototypeOf(n.parent)?n.frameElement:null}function Rm(n){const e=Un(n);let t=parseFloat(e.width)||0,r=parseFloat(e.height)||0;const i=nr(n),o=i?n.offsetWidth:t,s=i?n.offsetHeight:r,l=va(t)!==o||va(r)!==s;return l&&(t=o,r=s),{width:t,height:r,$:l}}function Fm(n){return kn(n)?n:n.contextElement}function Wi(n){const e=Fm(n);if(!nr(e))return Zn(1);const t=e.getBoundingClientRect(),{width:r,height:i,$:o}=Rm(e);let s=(o?va(t.width):t.width)/r,l=(o?va(t.height):t.height)/i;return(!s||!Number.isFinite(s))&&(s=1),(!l||!Number.isFinite(l))&&(l=1),{x:s,y:l}}const zO=Zn(0);function Im(n){const e=dn(n);return!Xd()||!e.visualViewport?zO:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function WO(n,e,t){return e===void 0&&(e=!1),!t||e&&t!==dn(n)?!1:e}function Qo(n,e,t,r){e===void 0&&(e=!1),t===void 0&&(t=!1);const i=n.getBoundingClientRect(),o=Fm(n);let s=Zn(1);e&&(r?kn(r)&&(s=Wi(r)):s=Wi(n));const l=WO(o,t,r)?Im(o):Zn(0);let a=(i.left+l.x)/s.x,c=(i.top+l.y)/s.y,u=i.width/s.x,p=i.height/s.y;if(o){const h=dn(o),g=r&&kn(r)?dn(r):r;let f=h,d=sd(f);for(;d&&r&&g!==f;){const _=Wi(d),m=d.getBoundingClientRect(),C=Un(d),R=m.left+(d.clientLeft+parseFloat(C.paddingLeft))*_.x,S=m.top+(d.clientTop+parseFloat(C.paddingTop))*_.y;a*=_.x,c*=_.y,u*=_.x,p*=_.y,a+=R,c+=S,f=dn(d),d=sd(f)}}return Sa({width:u,height:p,x:a,y:c})}function Yd(n,e){const t=ul(n).scrollLeft;return e?e.left+t:Qo(Fr(n)).left+t}function bm(n,e,t){t===void 0&&(t=!1);const r=n.getBoundingClientRect(),i=r.left+e.scrollLeft-(t?0:Yd(n,r)),o=r.top+e.scrollTop;return{x:i,y:o}}function jO(n){let{elements:e,rect:t,offsetParent:r,strategy:i}=n;const o=i==="fixed",s=Fr(r),l=e?cl(e.floating):!1;if(r===s||l&&o)return t;let a={scrollLeft:0,scrollTop:0},c=Zn(1);const u=Zn(0),p=nr(r);if((p||!p&&!o)&&((co(r)!=="body"||fs(s))&&(a=ul(r)),nr(r))){const g=Qo(r);c=Wi(r),u.x=g.x+r.clientLeft,u.y=g.y+r.clientTop}const h=s&&!p&&!o?bm(s,a,!0):Zn(0);return{width:t.width*c.x,height:t.height*c.y,x:t.x*c.x-a.scrollLeft*c.x+u.x+h.x,y:t.y*c.y-a.scrollTop*c.y+u.y+h.y}}function qO(n){return Array.from(n.getClientRects())}function KO(n){const e=Fr(n),t=ul(n),r=n.ownerDocument.body,i=zi(e.scrollWidth,e.clientWidth,r.scrollWidth,r.clientWidth),o=zi(e.scrollHeight,e.clientHeight,r.scrollHeight,r.clientHeight);let s=-t.scrollLeft+Yd(n);const l=-t.scrollTop;return Un(r).direction==="rtl"&&(s+=zi(e.clientWidth,r.clientWidth)-i),{width:i,height:o,x:s,y:l}}function QO(n,e){const t=dn(n),r=Fr(n),i=t.visualViewport;let o=r.clientWidth,s=r.clientHeight,l=0,a=0;if(i){o=i.width,s=i.height;const c=Xd();(!c||c&&e==="fixed")&&(l=i.offsetLeft,a=i.offsetTop)}return{width:o,height:s,x:l,y:a}}const ZO=new Set(["absolute","fixed"]);function JO(n,e){const t=Qo(n,!0,e==="fixed"),r=t.top+n.clientTop,i=t.left+n.clientLeft,o=nr(n)?Wi(n):Zn(1),s=n.clientWidth*o.x,l=n.clientHeight*o.y,a=i*o.x,c=r*o.y;return{width:s,height:l,x:a,y:c}}function Oh(n,e,t){let r;if(e==="viewport")r=QO(n,t);else if(e==="document")r=KO(Fr(n));else if(kn(e))r=JO(e,t);else{const i=Im(n);r={x:e.x-i.x,y:e.y-i.y,width:e.width,height:e.height}}return Sa(r)}function Tm(n,e){const t=Ur(n);return t===e||!kn(t)||Zi(t)?!1:Un(t).position==="fixed"||Tm(t,e)}function e1(n,e){const t=e.get(n);if(t)return t;let r=Sm(n,[]).filter(l=>kn(l)&&co(l)!=="body"),i=null;const o=Un(n).position==="fixed";let s=o?Ur(n):n;for(;kn(s)&&!Zi(s);){const l=Un(s),a=Hd(s);!a&&l.position==="fixed"&&(i=null),(o?!a&&!i:!a&&l.position==="static"&&!!i&&ZO.has(i.position)||fs(s)&&!a&&Tm(n,s))?r=r.filter(u=>u!==s):i=l,s=Ur(s)}return e.set(n,r),r}function t1(n){let{element:e,boundary:t,rootBoundary:r,strategy:i}=n;const s=[...t==="clippingAncestors"?cl(e)?[]:e1(e,this._c):[].concat(t),r],l=s[0],a=s.reduce((c,u)=>{const p=Oh(e,u,i);return c.top=zi(p.top,c.top),c.right=Ko(p.right,c.right),c.bottom=Ko(p.bottom,c.bottom),c.left=zi(p.left,c.left),c},Oh(e,l,i));return{width:a.right-a.left,height:a.bottom-a.top,x:a.left,y:a.top}}function n1(n){const{width:e,height:t}=Rm(n);return{width:e,height:t}}function r1(n,e,t){const r=nr(e),i=Fr(e),o=t==="fixed",s=Qo(n,!0,o,e);let l={scrollLeft:0,scrollTop:0};const a=Zn(0);function c(){a.x=Yd(i)}if(r||!r&&!o)if((co(e)!=="body"||fs(i))&&(l=ul(e)),r){const g=Qo(e,!0,o,e);a.x=g.x+e.clientLeft,a.y=g.y+e.clientTop}else i&&c();o&&!r&&i&&c();const u=i&&!r&&!o?bm(i,l):Zn(0),p=s.left+l.scrollLeft-a.x-u.x,h=s.top+l.scrollTop-a.y-u.y;return{x:p,y:h,width:s.width,height:s.height}}function Pu(n){return Un(n).position==="static"}function Ph(n,e){if(!nr(n)||Un(n).position==="fixed")return null;if(e)return e(n);let t=n.offsetParent;return Fr(n)===t&&(t=t.ownerDocument.body),t}function Om(n,e){const t=dn(n);if(cl(n))return t;if(!nr(n)){let i=Ur(n);for(;i&&!Zi(i);){if(kn(i)&&!Pu(i))return i;i=Ur(i)}return t}let r=Ph(n,e);for(;r&&kO(r)&&Pu(r);)r=Ph(r,e);return r&&Zi(r)&&Pu(r)&&!Hd(r)?t:r||XO(n)||t}const i1=async function(n){const e=this.getOffsetParent||Om,t=this.getDimensions,r=await t(n.floating);return{reference:r1(n.reference,await e(n.floating),n.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function o1(n){return Un(n).direction==="rtl"}const s1={convertOffsetParentRelativeRectToViewportRelativeRect:jO,getDocumentElement:Fr,getClippingRect:t1,getOffsetParent:Om,getElementRects:i1,getClientRects:qO,getDimensions:n1,getScale:Wi,isElement:kn,isRTL:o1},a1=GO,l1=LO,c1=xO,u1=NO,d1=(n,e,t)=>{const r=new Map,i={platform:s1,...t},o={...i.platform,_c:r};return MO(n,e,{...i,platform:o})};var f1=ne('<div class="container svelte-n96ib4"><!> <div class="tooltip svelte-n96ib4" role="tooltip" popover=""><!> <div class="tooltip-arrow svelte-n96ib4"></div></div></div>');function _1(n,e){we(e,!0);let t,r,i;function o(){i.hidePopover()}async function s(){i.showPopover();const{x:h,y:g,placement:f,middlewareData:d}=await d1(t,i,{placement:"right",middleware:[a1(16),c1(),l1({padding:4}),u1({element:r})]});Object.assign(i.style,{left:`${h}px`,top:`${g}px`});const _={top:"bottom",right:"left",bottom:"top",left:"right"}[f.split("-")[0]];let m="";switch(_){case"right":m="scaleX(-1)";break;case"top":m="rotate(90deg) translateX(-50%) translateY(50%)";break;case"bottom":m="rotate(-90deg) translateX(-50%) translateY(-50%)";break}const C=d.arrow;Object.assign(r.style,{top:`${C.y}px`,left:C.x?`${C.x}px`:"",bottom:"",right:"",transform:m,[_]:"-8px"})}var l=f1();l.__mouseover=s;var a=W(l);Ot(a,()=>e.children??et);var c=K(a,2),u=W(c);Ot(u,()=>e.tooltip??et);var p=K(u,2);Hi(p,h=>r=h,()=>r),Hi(c,h=>i=h,()=>i),Hi(l,h=>t=h,()=>t),Go("mouseleave",l,o),Z(n,l),Ge()}pn(["mouseover"]);var p1=(n,e,t,r)=>{b(e)&&t.tooltip&&(n.preventDefault(),ce(r,!b(r)))},h1=ne('<span class="field-label svelte-1j382d7"><!></span>'),g1=ne('<span class="units svelte-1j382d7"> </span>'),m1=ne('<div class="tooltip-container svelte-1j382d7"><!></div>'),C1=ne('<div class="container svelte-1j382d7"><div class="content svelte-1j382d7"><label class="svelte-1j382d7"><!> <!></label> <div class="control svelte-1j382d7"><!></div></div> <!></div>');function ge(n,e){we(e,!0);const[t,r]=Et(),i=()=>vt(St,"$i18n",t);let o=pe(0),s=ue(()=>b(o)<=480),l=pe(!1);var a=C1(),c=W(a),u=W(c);u.__click=[p1,s,e,l];var p=W(u);{var h=I=>{var T=h1(),P=W(T);fi(P,()=>i().t(e.label)),Z(I,T)},g=(I,T)=>{{var P=y=>{var L=Ct(),G=me(L);Ot(G,()=>e.label),Z(y,L)};Ce(I,y=>{typeof e.label=="function"&&y(P)},T)}};Ce(p,I=>{typeof e.label=="string"?I(h):I(g,!1)})}var f=K(p,2);{var d=I=>{var T=g1(),P=W(T);Ae(()=>Ee(P,`[ ${e.unit??""} ]`)),Z(I,T)};Ce(f,I=>{e.unit&&I(d)})}var _=K(u,2),m=W(_);{var C=I=>{_1(I,{get tooltip(){return e.tooltip},children:(T,P)=>{var y=Ct(),L=me(y);Ot(L,()=>e.children??et),Z(T,y)},$$slots:{default:!0}})},R=I=>{var T=Ct(),P=me(T);Ot(P,()=>e.children??et),Z(I,T)};Ce(m,I=>{!b(s)&&e.tooltip?I(C):I(R,!1)})}var S=K(c,2);{var F=I=>{var T=m1(),P=W(T);Ot(P,()=>e.tooltip),ke(3,T,()=>Ue),Z(I,T)};Ce(S,I=>{b(s)&&e.tooltip&&b(l)&&I(F)})}Ae(()=>os(u,"for",e.id)),Dg("innerWidth",I=>ce(o,I,!0)),Z(n,a),Ge(),r()}pn(["click"]);function v1(n,e,t){switch(n.key){case"ArrowUp":{e();break}case"ArrowDown":{t();break}default:return}n.preventDefault()}var E1=(n,e)=>e(!1),S1=(n,e)=>e(!0),R1=ne('<div class="container svelte-1eyt0gy"><button class="dec fas fa-minus svelte-1eyt0gy" aria-label="decrement"></button> <input type="text" inputmode="numeric" autocomplete="off" class="svelte-1eyt0gy"/> <button class="inc fas fa-plus svelte-1eyt0gy" aria-label="increment"></button></div>');function Oe(n,e){we(e,!0);let t=ft(e,"value",15,0),r=ft(e,"min",3,0),i=ft(e,"max",3,100),o=ft(e,"step",3,1),s=ue(()=>parseFloat(o())),l=ue(()=>parseFloat(r())),a=ue(()=>parseFloat(i()));function c(M){if(!isFinite(M))return 0;let N=1,w=0;for(;Math.round(M*N)/N!==M;)N*=10,w++;return w}let u,p=ue(()=>c(b(s))),h=pe(""),g=pe(""),f=null,d=null,_;di(()=>{u=t(),ce(h,u.toFixed(b(p)),!0)}),Ka(()=>{P()}),bn(()=>{u!==t()&&m(t())});function m(M){u=M,F()}function C(){m(u+b(s))}function R(){m(u-b(s))}function S(M){const N=["0","1","2","3","4","5","6","7","8","9","-","."];function w(){ce(g,b(h),!0)}function x(){_.value=b(g)}if(!M.data||M.data.length>1)return w();if(M.data.length===1&&!N.includes(M.data))return x();if(_.value.length===0||_.value==="-")return w();if(_.value==="00"||_.value==="-00"||_.value==="."||_.value==="-."||M.data==="-")return x();if(M.data==="."){let k=0;for(const O of _.value)if(k+=O===".",k>1)return x()}return w()}function F(){isNaN(u)&&(u=0),u=Math.round(u/b(s))*b(s),u=Math.max(b(l),Math.min(u,b(a))),ce(h,u.toFixed(b(p)),!0),ce(g,b(h),!0),u=parseFloat(b(h)),t(u)}function I(){u=parseFloat(b(h)),F()}function T(M){const N=M?C:R;N(),f=setTimeout(()=>{d=setInterval(()=>{N()},40)},400)}function P(){f&&clearTimeout(f),d&&clearInterval(d)}var y=R1(),L=W(y);L.__pointerdown=[E1,T],L.__pointerup=P;var G=K(L,2);G.__input=S,G.__change=I,G.__keydown=[v1,C,R],Hi(G,M=>_=M,()=>_);var U=K(G,2);U.__pointerdown=[S1,T],U.__pointerup=P,Ae(()=>{L.disabled=t()<=b(l)||e.disabled,os(G,"id",e.id),G.disabled=e.disabled,U.disabled=t()>=b(a)||e.disabled}),Go("pointerleave",L,P),Go("blur",G,I),Ob(G,()=>b(h),M=>ce(h,M)),Go("pointerleave",U,P),Z(n,y),Ge()}pn(["pointerdown","pointerup","input","change","keydown"]);var F1=ne('<div class="loading svelte-1lcnxyw"><div class="spinner svelte-1lcnxyw"></div> <p class="svelte-1lcnxyw">Waiting for data...</p></div>'),I1=ne('<div class="content svelte-1lcnxyw"><!></div>'),b1=ne('<div class="toolbar svelte-1lcnxyw"><!></div>'),T1=ne('<div class="container svelte-1lcnxyw"><div class="wrapper svelte-1lcnxyw"><header class="header svelte-1lcnxyw"><!></header> <main class="svelte-1lcnxyw"><!></main></div> <!></div>');function zd(n,e){let t=ft(e,"loading",3,!1);var r=T1(),i=W(r),o=W(i),s=W(o);Ot(s,()=>e.header??et);var l=K(o,2),a=W(l);{var c=g=>{var f=F1();Z(g,f)},u=g=>{var f=I1(),d=W(f);Ot(d,()=>e.children??et),Z(g,f)};Ce(a,g=>{t()?g(c):g(u,!1)})}var p=K(i,2);{var h=g=>{var f=b1(),d=W(f);Ot(d,()=>e.toolbar??et),Z(g,f)};Ce(p,g=>{e.toolbar&&g(h)})}Z(n,r)}function O1(n,e){ce(e,!b(e))}var P1=ne('<div class="grow svelte-f5k6de"></div> <button aria-label="help"></button>',1),A1=ne('<div class="header svelte-f5k6de"><span class="title svelte-f5k6de"> </span> <!></div>'),M1=ne('<div class="summary svelte-f5k6de"><p class="svelte-f5k6de"><!></p></div>'),N1=ne('<div class="wrapper svelte-f5k6de"><div class="container svelte-f5k6de"><!> <!> <div class="content svelte-f5k6de"><div class="content-wrapper svelte-f5k6de"><!></div></div></div></div>');function Gt(n,e){we(e,!0);const[t,r]=Et(),i=()=>vt(St,"$i18n",t);let o=pe(!1);var s=N1(),l=W(s),a=W(l);{var c=_=>{var m=Ct(),C=me(m);Ot(C,()=>e.header),Z(_,m)},u=_=>{var m=A1(),C=W(m),R=W(C),S=K(C,2);{var F=I=>{var T=P1(),P=K(me(T),2);P.__click=[O1,o],Ae(()=>ii(P,1,Wo(["icon","fas","fa-question-circle",b(o)&&"active"]),"svelte-f5k6de")),Z(I,T)};Ce(S,I=>{e.summary&&I(F)})}Ae(I=>Ee(R,I),[()=>i().t(e.label)]),Z(_,m)};Ce(a,_=>{e.header?_(c):_(u,!1)})}var p=K(a,2);{var h=_=>{var m=M1(),C=W(m),R=W(C);fi(R,()=>i().t(e.summary)),ke(3,m,()=>Ue),Z(_,m)};Ce(p,_=>{b(o)&&typeof e.summary=="string"&&_(h)})}var g=K(p,2),f=W(g),d=W(f);Ot(d,()=>e.children??et),Z(n,s),Ge(),r()}pn(["click"]);var x1=ne('<div class="header svelte-1h2i37l"> </div>'),y1=ne('<div class="container svelte-1h2i37l"><!> <div class="content svelte-1h2i37l"><!></div></div>');function Be(n,e){we(e,!0);const[t,r]=Et(),i=()=>vt(St,"$i18n",t);var o=y1(),s=W(o);{var l=u=>{var p=x1(),h=W(p);Ae(g=>Ee(h,g),[()=>i().t(e.label)]),Z(u,p)};Ce(s,u=>{e.label&&u(l)})}var a=K(s,2),c=W(a);Ot(c,()=>e.children??et),Z(n,o),Ge(),r()}var w1=ne('<span class="message svelte-1qguxff"><!></span>'),G1=ne('<tr class="svelte-1qguxff"><th class="svelte-1qguxff"> </th><td class="svelte-1qguxff"> </td></tr>'),L1=ne('<table class="attrs svelte-1qguxff"></table>'),$1=ne('<div class="container svelte-1qguxff"><!> <!></div>');function Te(n,e){we(e,!0);const[t,r]=Et(),i=()=>vt(St,"$i18n",t);var o=$1(),s=W(o);{var l=u=>{var p=w1(),h=W(p);fi(h,()=>i().t(e.help)),Z(u,p)};Ce(s,u=>{e.help&&u(l)})}var a=K(s,2);{var c=u=>{var p=L1();xt(p,21,()=>e.attrs,h=>h.name,(h,g)=>{var f=G1(),d=W(f),_=W(d),m=K(d),C=W(m);Ae(R=>{Ee(_,R),Ee(C,b(g).value)},[()=>i().t(b(g).name)]),Z(h,f)}),Z(u,p)};Ce(a,u=>{e.attrs&&u(c)})}Z(n,o),Ge(),r()}function D1(){window.open(getTabHelpURL("tabFailsafe"),"_system")}var k1=ne('<h1 class="svelte-1hbu6jl"> </h1> <div class="grow svelte-1hbu6jl"></div> <button class="help-btn svelte-1hbu6jl">Help</button>',1),U1=ne('<button class="svelte-1hbu6jl"> </button> <button class="svelte-1hbu6jl"> </button>',1),B1=ne("<!> <!>",1),V1=ne('<div class="svelte-1hbu6jl"><!></div>'),H1=ne('<option class="svelte-1hbu6jl"> </option>'),X1=ne('<div class="fallback-group svelte-1hbu6jl"><!> <select class="switchMode svelte-1hbu6jl"><!><option class="svelte-1hbu6jl"> </option><option class="svelte-1hbu6jl"> </option></select></div>'),Y1=ne('<div class="content svelte-1hbu6jl"><div class="svelte-1hbu6jl"><!> <!></div> <div class="svelte-1hbu6jl"></div></div>');function z1(n,e){we(e,!0);const[t,r]=Et(),i=()=>vt(St,"$i18n",t),o=C=>{var R=k1(),S=me(R),F=W(S),I=K(S,4);I.__click=[D1],Ae(T=>Ee(F,T),[()=>i().t("tabFailsafe")]),Z(C,R)},s=C=>{var R=U1(),S=me(R);S.__click=f;var F=W(S),I=K(S,2);I.__click=g;var T=W(I);Ae((P,y)=>{Ee(F,P),Ee(T,y)},[()=>i().t("buttonRevert"),()=>i().t("buttonSaveReboot")]),Z(C,R)};let l=pe(!0),a;function c(){return Qn({RX_CONFIG:V.RX_CONFIG,RXFAIL_CONFIG:V.RXFAIL_CONFIG,features:V.FEATURE_CONFIG.features.bitfield})}let u=ue(()=>a?cs(a,c()):[]),p=ue(()=>!b(l)&&b(u).length>0);const h=["controlAxisRoll","controlAxisPitch","controlAxisYaw","controlAxisCollective","controlAxisThrottle"];di(async()=>{await MSP.promise(lt.MSP_FEATURE_CONFIG),await MSP.promise(lt.MSP_RXFAIL_CONFIG),await MSP.promise(lt.MSP_RX_CONFIG),a=c(),ce(l,!1)});async function g(){function C(R){return MSP.promise(R,mspHelper.crunch(R))}await mspHelper.sendRxFailConfig(),await C(lt.MSP_SET_RX_CONFIG),await MSP.promise(lt.MSP_EEPROM_WRITE),GUI.log(i().t("eepromSaved")),MSP.send_message(lt.MSP_SET_REBOOT),GUI.log(i().t("deviceRebooting")),rl()}function f(){Object.assign(V.RX_CONFIG,a.RX_CONFIG),Object.assign(V.RXFAIL_CONFIG,a.RXFAIL_CONFIG),V.FEATURE_CONFIG.features.bitfield=a.features}function d(){return b(u).length>0}const _=ue(()=>b(p)&&s);zd(n,{get header(){return o},get loading(){return b(l)},get toolbar(){return b(_)},children:(C,R)=>{var S=Y1(),F=W(S),I=W(F);vO(I,{children:(P,y)=>{var L=V1(),G=W(L);Gt(G,{label:"failsafePulsrangeTitle",summary:"failsafePulsrangeHelp",children:(U,M)=>{Be(U,{children:(N,w)=>{var x=B1(),k=me(x);ge(k,{id:"rx-pulse-min",label:"failsafeRxMinUsecItem",unit:"μs",tooltip:Y=>{Te(Y,{attrs:[{name:"genericDefault",value:"885μs"},{name:"genericRange",value:"750μs - 2250μs "}]})},children:(Y,z)=>{Oe(Y,{id:"rx-pulse-min",min:"750",max:"2250",get value(){return V.RX_CONFIG.rx_pulse_min},set value(ee){V.RX_CONFIG.rx_pulse_min=ee}})},$$slots:{tooltip:!0,default:!0}});var O=K(k,2);ge(O,{id:"rx-pulse-max",label:"failsafeRxMaxUsecItem",unit:"μs",tooltip:Y=>{Te(Y,{attrs:[{name:"genericDefault",value:"2115μs"},{name:"genericRange",value:"750μs - 2250μs "}]})},children:(Y,z)=>{Oe(Y,{id:"rx-pulse-max",min:"750",max:"2250",get value(){return V.RX_CONFIG.rx_pulse_max},set value(ee){V.RX_CONFIG.rx_pulse_max=ee}})},$$slots:{tooltip:!0,default:!0}}),Z(N,x)},$$slots:{default:!0}})},$$slots:{default:!0}}),ke(3,L,()=>Ue),Z(P,L)},$$slots:{default:!0}});var T=K(I,2);Gt(T,{label:"failsafeChannelFallbackSettingsTitle",summary:"failsafeChannelFallbackSettingsHelp",children:(P,y)=>{Be(P,{children:(L,G)=>{var U=Ct(),M=me(U);xt(M,17,()=>({length:V.RXFAIL_CONFIG?.length??0}),is,(N,w,x)=>{const k=ue(()=>h[x]??`controlAxisAux${x-h.length+1}`);ge(N,{id:`fallback-${x}`,get label(){return b(k)},children:(O,D)=>{var Y=X1(),z=W(Y);{var ee=te=>{Oe(te,{id:`set-${x}`,min:"875",max:"2125",step:"5",get value(){return V.RXFAIL_CONFIG[x].value},set value(fe){V.RXFAIL_CONFIG[x].value=fe}})};Ce(z,te=>{V.RXFAIL_CONFIG[x].mode===2&&te(ee)})}var re=K(z,2);os(re,"id",`fallback-${x}`);var le=W(re);{var J=te=>{var fe=H1(),Re=W(fe);fe.value=fe.__value=0,Ae($e=>Ee(Re,$e),[()=>i().t("failsafeChannelFallbackOptionAuto")]),Z(te,fe)};Ce(le,te=>{x<h.length&&te(J)})}var oe=K(le),ae=W(oe);oe.value=oe.__value=1;var de=K(oe),ie=W(de);de.value=de.__value=2,Ae((te,fe)=>{Ee(ae,te),Ee(ie,fe)},[()=>i().t("failsafeChannelFallbackOptionHold"),()=>i().t("failsafeChannelFallbackOptionSet")]),vr(re,()=>V.RXFAIL_CONFIG[x].mode,te=>V.RXFAIL_CONFIG[x].mode=te),Z(O,Y)},$$slots:{default:!0}})}),Z(L,U)},$$slots:{default:!0}})},$$slots:{default:!0}}),Z(C,S)},$$slots:{default:!0}});var m=Ge({onSave:g,onRevert:f,isDirty:d});return r(),m}pn(["click"]);const Ah={tabName:"failsafe",svelteComponent:null,get isDirty(){return this.svelteComponent?.isDirty()},initialize(n){const e=document.querySelector("#content");e.innerHTML="",this.svelteComponent=Rr(z1,{target:e}),GUI.content_ready(n)},cleanup(n){this.svelteComponent&&(ni(this.svelteComponent),this.svelteComponent=null),n?.()},save(n){this.svelteComponent?this.svelteComponent.onSave().finally(n):n?.()},revert(n){this.svelteComponent?.onRevert(),n?.()}};TABS[Ah.tabName]=Ah;function Wd(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}var _i=Wd();function Pm(n){_i=n}var $o={exec:()=>null};function Je(n,e=""){let t=typeof n=="string"?n:n.source;const r={replace:(i,o)=>{let s=typeof o=="string"?o:o.source;return s=s.replace(Xt.caret,"$1"),t=t.replace(i,s),r},getRegex:()=>new RegExp(t,e)};return r}var Xt={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceTabs:/^\t+/,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] /,listReplaceTask:/^\[[ xX]\] +/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:n=>new RegExp(`^( {0,3}${n})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:n=>new RegExp(`^ {0,${Math.min(3,n-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:n=>new RegExp(`^ {0,${Math.min(3,n-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:n=>new RegExp(`^ {0,${Math.min(3,n-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:n=>new RegExp(`^ {0,${Math.min(3,n-1)}}#`),htmlBeginRegex:n=>new RegExp(`^ {0,${Math.min(3,n-1)}}<(?:[a-z].*>|!--)`,"i")},W1=/^(?:[ \t]*(?:\n|$))+/,j1=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,q1=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,_s=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,K1=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,jd=/(?:[*+-]|\d{1,9}[.)])/,Am=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,Mm=Je(Am).replace(/bull/g,jd).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),Q1=Je(Am).replace(/bull/g,jd).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),qd=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,Z1=/^[^\n]+/,Kd=/(?!\s*\])(?:\\.|[^\[\]\\])+/,J1=Je(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",Kd).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),eP=Je(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,jd).getRegex(),dl="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",Qd=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,tP=Je("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",Qd).replace("tag",dl).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),Nm=Je(qd).replace("hr",_s).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",dl).getRegex(),nP=Je(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",Nm).getRegex(),Zd={blockquote:nP,code:j1,def:J1,fences:q1,heading:K1,hr:_s,html:tP,lheading:Mm,list:eP,newline:W1,paragraph:Nm,table:$o,text:Z1},Mh=Je("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",_s).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",dl).getRegex(),rP={...Zd,lheading:Q1,table:Mh,paragraph:Je(qd).replace("hr",_s).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",Mh).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",dl).getRegex()},iP={...Zd,html:Je(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",Qd).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:$o,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:Je(qd).replace("hr",_s).replace("heading",` *#{1,6} *[^
]`).replace("lheading",Mm).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},oP=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,sP=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,xm=/^( {2,}|\\)\n(?!\s*$)/,aP=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,fl=/[\p{P}\p{S}]/u,Jd=/[\s\p{P}\p{S}]/u,ym=/[^\s\p{P}\p{S}]/u,lP=Je(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,Jd).getRegex(),wm=/(?!~)[\p{P}\p{S}]/u,cP=/(?!~)[\s\p{P}\p{S}]/u,uP=/(?:[^\s\p{P}\p{S}]|~)/u,dP=/\[[^[\]]*?\]\((?:\\.|[^\\\(\)]|\((?:\\.|[^\\\(\)])*\))*\)|`[^`]*?`|<[^<>]*?>/g,Gm=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,fP=Je(Gm,"u").replace(/punct/g,fl).getRegex(),_P=Je(Gm,"u").replace(/punct/g,wm).getRegex(),Lm="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",pP=Je(Lm,"gu").replace(/notPunctSpace/g,ym).replace(/punctSpace/g,Jd).replace(/punct/g,fl).getRegex(),hP=Je(Lm,"gu").replace(/notPunctSpace/g,uP).replace(/punctSpace/g,cP).replace(/punct/g,wm).getRegex(),gP=Je("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,ym).replace(/punctSpace/g,Jd).replace(/punct/g,fl).getRegex(),mP=Je(/\\(punct)/,"gu").replace(/punct/g,fl).getRegex(),CP=Je(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),vP=Je(Qd).replace("(?:-->|$)","-->").getRegex(),EP=Je("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",vP).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),Ra=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,SP=Je(/^!?\[(label)\]\(\s*(href)(?:(?:[ \t]*(?:\n[ \t]*)?)(title))?\s*\)/).replace("label",Ra).replace("href",/<(?:\\.|[^\n<>\\])+>|[^ \t\n\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),$m=Je(/^!?\[(label)\]\[(ref)\]/).replace("label",Ra).replace("ref",Kd).getRegex(),Dm=Je(/^!?\[(ref)\](?:\[\])?/).replace("ref",Kd).getRegex(),RP=Je("reflink|nolink(?!\\()","g").replace("reflink",$m).replace("nolink",Dm).getRegex(),ef={_backpedal:$o,anyPunctuation:mP,autolink:CP,blockSkip:dP,br:xm,code:sP,del:$o,emStrongLDelim:fP,emStrongRDelimAst:pP,emStrongRDelimUnd:gP,escape:oP,link:SP,nolink:Dm,punctuation:lP,reflink:$m,reflinkSearch:RP,tag:EP,text:aP,url:$o},FP={...ef,link:Je(/^!?\[(label)\]\((.*?)\)/).replace("label",Ra).getRegex(),reflink:Je(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",Ra).getRegex()},ad={...ef,emStrongRDelimAst:hP,emStrongLDelim:_P,url:Je(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\.|[^\\])*?(?:\\.|[^\s~\\]))\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},IP={...ad,br:Je(xm).replace("{2,}","*").getRegex(),text:Je(ad.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},Ys={normal:Zd,gfm:rP,pedantic:iP},Fo={normal:ef,gfm:ad,breaks:IP,pedantic:FP},bP={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Nh=n=>bP[n];function qn(n,e){if(e){if(Xt.escapeTest.test(n))return n.replace(Xt.escapeReplace,Nh)}else if(Xt.escapeTestNoEncode.test(n))return n.replace(Xt.escapeReplaceNoEncode,Nh);return n}function xh(n){try{n=encodeURI(n).replace(Xt.percentDecode,"%")}catch{return null}return n}function yh(n,e){const t=n.replace(Xt.findPipe,(o,s,l)=>{let a=!1,c=s;for(;--c>=0&&l[c]==="\\";)a=!a;return a?"|":" |"}),r=t.split(Xt.splitPipe);let i=0;if(r[0].trim()||r.shift(),r.length>0&&!r.at(-1)?.trim()&&r.pop(),e)if(r.length>e)r.splice(e);else for(;r.length<e;)r.push("");for(;i<r.length;i++)r[i]=r[i].trim().replace(Xt.slashPipe,"|");return r}function Io(n,e,t){const r=n.length;if(r===0)return"";let i=0;for(;i<r&&n.charAt(r-i-1)===e;)i++;return n.slice(0,r-i)}function TP(n,e){if(n.indexOf(e[1])===-1)return-1;let t=0;for(let r=0;r<n.length;r++)if(n[r]==="\\")r++;else if(n[r]===e[0])t++;else if(n[r]===e[1]&&(t--,t<0))return r;return t>0?-2:-1}function wh(n,e,t,r,i){const o=e.href,s=e.title||null,l=n[1].replace(i.other.outputLinkReplace,"$1");r.state.inLink=!0;const a={type:n[0].charAt(0)==="!"?"image":"link",raw:t,href:o,title:s,text:l,tokens:r.inlineTokens(l)};return r.state.inLink=!1,a}function OP(n,e,t){const r=n.match(t.other.indentCodeCompensation);if(r===null)return e;const i=r[1];return e.split(`
`).map(o=>{const s=o.match(t.other.beginningSpace);if(s===null)return o;const[l]=s;return l.length>=i.length?o.slice(i.length):o}).join(`
`)}var Fa=class{options;rules;lexer;constructor(n){this.options=n||_i}space(n){const e=this.rules.block.newline.exec(n);if(e&&e[0].length>0)return{type:"space",raw:e[0]}}code(n){const e=this.rules.block.code.exec(n);if(e){const t=e[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:e[0],codeBlockStyle:"indented",text:this.options.pedantic?t:Io(t,`
`)}}}fences(n){const e=this.rules.block.fences.exec(n);if(e){const t=e[0],r=OP(t,e[3]||"",this.rules);return{type:"code",raw:t,lang:e[2]?e[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):e[2],text:r}}}heading(n){const e=this.rules.block.heading.exec(n);if(e){let t=e[2].trim();if(this.rules.other.endingHash.test(t)){const r=Io(t,"#");(this.options.pedantic||!r||this.rules.other.endingSpaceChar.test(r))&&(t=r.trim())}return{type:"heading",raw:e[0],depth:e[1].length,text:t,tokens:this.lexer.inline(t)}}}hr(n){const e=this.rules.block.hr.exec(n);if(e)return{type:"hr",raw:Io(e[0],`
`)}}blockquote(n){const e=this.rules.block.blockquote.exec(n);if(e){let t=Io(e[0],`
`).split(`
`),r="",i="";const o=[];for(;t.length>0;){let s=!1;const l=[];let a;for(a=0;a<t.length;a++)if(this.rules.other.blockquoteStart.test(t[a]))l.push(t[a]),s=!0;else if(!s)l.push(t[a]);else break;t=t.slice(a);const c=l.join(`
`),u=c.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");r=r?`${r}
${c}`:c,i=i?`${i}
${u}`:u;const p=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(u,o,!0),this.lexer.state.top=p,t.length===0)break;const h=o.at(-1);if(h?.type==="code")break;if(h?.type==="blockquote"){const g=h,f=g.raw+`
`+t.join(`
`),d=this.blockquote(f);o[o.length-1]=d,r=r.substring(0,r.length-g.raw.length)+d.raw,i=i.substring(0,i.length-g.text.length)+d.text;break}else if(h?.type==="list"){const g=h,f=g.raw+`
`+t.join(`
`),d=this.list(f);o[o.length-1]=d,r=r.substring(0,r.length-h.raw.length)+d.raw,i=i.substring(0,i.length-g.raw.length)+d.raw,t=f.substring(o.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:r,tokens:o,text:i}}}list(n){let e=this.rules.block.list.exec(n);if(e){let t=e[1].trim();const r=t.length>1,i={type:"list",raw:"",ordered:r,start:r?+t.slice(0,-1):"",loose:!1,items:[]};t=r?`\\d{1,9}\\${t.slice(-1)}`:`\\${t}`,this.options.pedantic&&(t=r?t:"[*+-]");const o=this.rules.other.listItemRegex(t);let s=!1;for(;n;){let a=!1,c="",u="";if(!(e=o.exec(n))||this.rules.block.hr.test(n))break;c=e[0],n=n.substring(c.length);let p=e[2].split(`
`,1)[0].replace(this.rules.other.listReplaceTabs,m=>" ".repeat(3*m.length)),h=n.split(`
`,1)[0],g=!p.trim(),f=0;if(this.options.pedantic?(f=2,u=p.trimStart()):g?f=e[1].length+1:(f=e[2].search(this.rules.other.nonSpaceChar),f=f>4?1:f,u=p.slice(f),f+=e[1].length),g&&this.rules.other.blankLine.test(h)&&(c+=h+`
`,n=n.substring(h.length+1),a=!0),!a){const m=this.rules.other.nextBulletRegex(f),C=this.rules.other.hrRegex(f),R=this.rules.other.fencesBeginRegex(f),S=this.rules.other.headingBeginRegex(f),F=this.rules.other.htmlBeginRegex(f);for(;n;){const I=n.split(`
`,1)[0];let T;if(h=I,this.options.pedantic?(h=h.replace(this.rules.other.listReplaceNesting,"  "),T=h):T=h.replace(this.rules.other.tabCharGlobal,"    "),R.test(h)||S.test(h)||F.test(h)||m.test(h)||C.test(h))break;if(T.search(this.rules.other.nonSpaceChar)>=f||!h.trim())u+=`
`+T.slice(f);else{if(g||p.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||R.test(p)||S.test(p)||C.test(p))break;u+=`
`+h}!g&&!h.trim()&&(g=!0),c+=I+`
`,n=n.substring(I.length+1),p=T.slice(f)}}i.loose||(s?i.loose=!0:this.rules.other.doubleBlankLine.test(c)&&(s=!0));let d=null,_;this.options.gfm&&(d=this.rules.other.listIsTask.exec(u),d&&(_=d[0]!=="[ ] ",u=u.replace(this.rules.other.listReplaceTask,""))),i.items.push({type:"list_item",raw:c,task:!!d,checked:_,loose:!1,text:u,tokens:[]}),i.raw+=c}const l=i.items.at(-1);if(l)l.raw=l.raw.trimEnd(),l.text=l.text.trimEnd();else return;i.raw=i.raw.trimEnd();for(let a=0;a<i.items.length;a++)if(this.lexer.state.top=!1,i.items[a].tokens=this.lexer.blockTokens(i.items[a].text,[]),!i.loose){const c=i.items[a].tokens.filter(p=>p.type==="space"),u=c.length>0&&c.some(p=>this.rules.other.anyLine.test(p.raw));i.loose=u}if(i.loose)for(let a=0;a<i.items.length;a++)i.items[a].loose=!0;return i}}html(n){const e=this.rules.block.html.exec(n);if(e)return{type:"html",block:!0,raw:e[0],pre:e[1]==="pre"||e[1]==="script"||e[1]==="style",text:e[0]}}def(n){const e=this.rules.block.def.exec(n);if(e){const t=e[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),r=e[2]?e[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",i=e[3]?e[3].substring(1,e[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):e[3];return{type:"def",tag:t,raw:e[0],href:r,title:i}}}table(n){const e=this.rules.block.table.exec(n);if(!e||!this.rules.other.tableDelimiter.test(e[2]))return;const t=yh(e[1]),r=e[2].replace(this.rules.other.tableAlignChars,"").split("|"),i=e[3]?.trim()?e[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],o={type:"table",raw:e[0],header:[],align:[],rows:[]};if(t.length===r.length){for(const s of r)this.rules.other.tableAlignRight.test(s)?o.align.push("right"):this.rules.other.tableAlignCenter.test(s)?o.align.push("center"):this.rules.other.tableAlignLeft.test(s)?o.align.push("left"):o.align.push(null);for(let s=0;s<t.length;s++)o.header.push({text:t[s],tokens:this.lexer.inline(t[s]),header:!0,align:o.align[s]});for(const s of i)o.rows.push(yh(s,o.header.length).map((l,a)=>({text:l,tokens:this.lexer.inline(l),header:!1,align:o.align[a]})));return o}}lheading(n){const e=this.rules.block.lheading.exec(n);if(e)return{type:"heading",raw:e[0],depth:e[2].charAt(0)==="="?1:2,text:e[1],tokens:this.lexer.inline(e[1])}}paragraph(n){const e=this.rules.block.paragraph.exec(n);if(e){const t=e[1].charAt(e[1].length-1)===`
`?e[1].slice(0,-1):e[1];return{type:"paragraph",raw:e[0],text:t,tokens:this.lexer.inline(t)}}}text(n){const e=this.rules.block.text.exec(n);if(e)return{type:"text",raw:e[0],text:e[0],tokens:this.lexer.inline(e[0])}}escape(n){const e=this.rules.inline.escape.exec(n);if(e)return{type:"escape",raw:e[0],text:e[1]}}tag(n){const e=this.rules.inline.tag.exec(n);if(e)return!this.lexer.state.inLink&&this.rules.other.startATag.test(e[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(e[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(e[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(e[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:e[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:e[0]}}link(n){const e=this.rules.inline.link.exec(n);if(e){const t=e[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(t)){if(!this.rules.other.endAngleBracket.test(t))return;const o=Io(t.slice(0,-1),"\\");if((t.length-o.length)%2===0)return}else{const o=TP(e[2],"()");if(o===-2)return;if(o>-1){const l=(e[0].indexOf("!")===0?5:4)+e[1].length+o;e[2]=e[2].substring(0,o),e[0]=e[0].substring(0,l).trim(),e[3]=""}}let r=e[2],i="";if(this.options.pedantic){const o=this.rules.other.pedanticHrefTitle.exec(r);o&&(r=o[1],i=o[3])}else i=e[3]?e[3].slice(1,-1):"";return r=r.trim(),this.rules.other.startAngleBracket.test(r)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(t)?r=r.slice(1):r=r.slice(1,-1)),wh(e,{href:r&&r.replace(this.rules.inline.anyPunctuation,"$1"),title:i&&i.replace(this.rules.inline.anyPunctuation,"$1")},e[0],this.lexer,this.rules)}}reflink(n,e){let t;if((t=this.rules.inline.reflink.exec(n))||(t=this.rules.inline.nolink.exec(n))){const r=(t[2]||t[1]).replace(this.rules.other.multipleSpaceGlobal," "),i=e[r.toLowerCase()];if(!i){const o=t[0].charAt(0);return{type:"text",raw:o,text:o}}return wh(t,i,t[0],this.lexer,this.rules)}}emStrong(n,e,t=""){let r=this.rules.inline.emStrongLDelim.exec(n);if(!r||r[3]&&t.match(this.rules.other.unicodeAlphaNumeric))return;if(!(r[1]||r[2]||"")||!t||this.rules.inline.punctuation.exec(t)){const o=[...r[0]].length-1;let s,l,a=o,c=0;const u=r[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(u.lastIndex=0,e=e.slice(-1*n.length+o);(r=u.exec(e))!=null;){if(s=r[1]||r[2]||r[3]||r[4]||r[5]||r[6],!s)continue;if(l=[...s].length,r[3]||r[4]){a+=l;continue}else if((r[5]||r[6])&&o%3&&!((o+l)%3)){c+=l;continue}if(a-=l,a>0)continue;l=Math.min(l,l+a+c);const p=[...r[0]][0].length,h=n.slice(0,o+r.index+p+l);if(Math.min(o,l)%2){const f=h.slice(1,-1);return{type:"em",raw:h,text:f,tokens:this.lexer.inlineTokens(f)}}const g=h.slice(2,-2);return{type:"strong",raw:h,text:g,tokens:this.lexer.inlineTokens(g)}}}}codespan(n){const e=this.rules.inline.code.exec(n);if(e){let t=e[2].replace(this.rules.other.newLineCharGlobal," ");const r=this.rules.other.nonSpaceChar.test(t),i=this.rules.other.startingSpaceChar.test(t)&&this.rules.other.endingSpaceChar.test(t);return r&&i&&(t=t.substring(1,t.length-1)),{type:"codespan",raw:e[0],text:t}}}br(n){const e=this.rules.inline.br.exec(n);if(e)return{type:"br",raw:e[0]}}del(n){const e=this.rules.inline.del.exec(n);if(e)return{type:"del",raw:e[0],text:e[2],tokens:this.lexer.inlineTokens(e[2])}}autolink(n){const e=this.rules.inline.autolink.exec(n);if(e){let t,r;return e[2]==="@"?(t=e[1],r="mailto:"+t):(t=e[1],r=t),{type:"link",raw:e[0],text:t,href:r,tokens:[{type:"text",raw:t,text:t}]}}}url(n){let e;if(e=this.rules.inline.url.exec(n)){let t,r;if(e[2]==="@")t=e[0],r="mailto:"+t;else{let i;do i=e[0],e[0]=this.rules.inline._backpedal.exec(e[0])?.[0]??"";while(i!==e[0]);t=e[0],e[1]==="www."?r="http://"+e[0]:r=e[0]}return{type:"link",raw:e[0],text:t,href:r,tokens:[{type:"text",raw:t,text:t}]}}}inlineText(n){const e=this.rules.inline.text.exec(n);if(e){const t=this.lexer.state.inRawBlock;return{type:"text",raw:e[0],text:e[0],escaped:t}}}},fr=class ld{tokens;options;state;tokenizer;inlineQueue;constructor(e){this.tokens=[],this.tokens.links=Object.create(null),this.options=e||_i,this.options.tokenizer=this.options.tokenizer||new Fa,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const t={other:Xt,block:Ys.normal,inline:Fo.normal};this.options.pedantic?(t.block=Ys.pedantic,t.inline=Fo.pedantic):this.options.gfm&&(t.block=Ys.gfm,this.options.breaks?t.inline=Fo.breaks:t.inline=Fo.gfm),this.tokenizer.rules=t}static get rules(){return{block:Ys,inline:Fo}}static lex(e,t){return new ld(t).lex(e)}static lexInline(e,t){return new ld(t).inlineTokens(e)}lex(e){e=e.replace(Xt.carriageReturn,`
`),this.blockTokens(e,this.tokens);for(let t=0;t<this.inlineQueue.length;t++){const r=this.inlineQueue[t];this.inlineTokens(r.src,r.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,t=[],r=!1){for(this.options.pedantic&&(e=e.replace(Xt.tabCharGlobal,"    ").replace(Xt.spaceLine,""));e;){let i;if(this.options.extensions?.block?.some(s=>(i=s.call({lexer:this},e,t))?(e=e.substring(i.raw.length),t.push(i),!0):!1))continue;if(i=this.tokenizer.space(e)){e=e.substring(i.raw.length);const s=t.at(-1);i.raw.length===1&&s!==void 0?s.raw+=`
`:t.push(i);continue}if(i=this.tokenizer.code(e)){e=e.substring(i.raw.length);const s=t.at(-1);s?.type==="paragraph"||s?.type==="text"?(s.raw+=`
`+i.raw,s.text+=`
`+i.text,this.inlineQueue.at(-1).src=s.text):t.push(i);continue}if(i=this.tokenizer.fences(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.heading(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.hr(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.blockquote(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.list(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.html(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.def(e)){e=e.substring(i.raw.length);const s=t.at(-1);s?.type==="paragraph"||s?.type==="text"?(s.raw+=`
`+i.raw,s.text+=`
`+i.raw,this.inlineQueue.at(-1).src=s.text):this.tokens.links[i.tag]||(this.tokens.links[i.tag]={href:i.href,title:i.title});continue}if(i=this.tokenizer.table(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.lheading(e)){e=e.substring(i.raw.length),t.push(i);continue}let o=e;if(this.options.extensions?.startBlock){let s=1/0;const l=e.slice(1);let a;this.options.extensions.startBlock.forEach(c=>{a=c.call({lexer:this},l),typeof a=="number"&&a>=0&&(s=Math.min(s,a))}),s<1/0&&s>=0&&(o=e.substring(0,s+1))}if(this.state.top&&(i=this.tokenizer.paragraph(o))){const s=t.at(-1);r&&s?.type==="paragraph"?(s.raw+=`
`+i.raw,s.text+=`
`+i.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=s.text):t.push(i),r=o.length!==e.length,e=e.substring(i.raw.length);continue}if(i=this.tokenizer.text(e)){e=e.substring(i.raw.length);const s=t.at(-1);s?.type==="text"?(s.raw+=`
`+i.raw,s.text+=`
`+i.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=s.text):t.push(i);continue}if(e){const s="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(s);break}else throw new Error(s)}}return this.state.top=!0,t}inline(e,t=[]){return this.inlineQueue.push({src:e,tokens:t}),t}inlineTokens(e,t=[]){let r=e,i=null;if(this.tokens.links){const l=Object.keys(this.tokens.links);if(l.length>0)for(;(i=this.tokenizer.rules.inline.reflinkSearch.exec(r))!=null;)l.includes(i[0].slice(i[0].lastIndexOf("[")+1,-1))&&(r=r.slice(0,i.index)+"["+"a".repeat(i[0].length-2)+"]"+r.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(i=this.tokenizer.rules.inline.anyPunctuation.exec(r))!=null;)r=r.slice(0,i.index)+"++"+r.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;(i=this.tokenizer.rules.inline.blockSkip.exec(r))!=null;)r=r.slice(0,i.index)+"["+"a".repeat(i[0].length-2)+"]"+r.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);let o=!1,s="";for(;e;){o||(s=""),o=!1;let l;if(this.options.extensions?.inline?.some(c=>(l=c.call({lexer:this},e,t))?(e=e.substring(l.raw.length),t.push(l),!0):!1))continue;if(l=this.tokenizer.escape(e)){e=e.substring(l.raw.length),t.push(l);continue}if(l=this.tokenizer.tag(e)){e=e.substring(l.raw.length),t.push(l);continue}if(l=this.tokenizer.link(e)){e=e.substring(l.raw.length),t.push(l);continue}if(l=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(l.raw.length);const c=t.at(-1);l.type==="text"&&c?.type==="text"?(c.raw+=l.raw,c.text+=l.text):t.push(l);continue}if(l=this.tokenizer.emStrong(e,r,s)){e=e.substring(l.raw.length),t.push(l);continue}if(l=this.tokenizer.codespan(e)){e=e.substring(l.raw.length),t.push(l);continue}if(l=this.tokenizer.br(e)){e=e.substring(l.raw.length),t.push(l);continue}if(l=this.tokenizer.del(e)){e=e.substring(l.raw.length),t.push(l);continue}if(l=this.tokenizer.autolink(e)){e=e.substring(l.raw.length),t.push(l);continue}if(!this.state.inLink&&(l=this.tokenizer.url(e))){e=e.substring(l.raw.length),t.push(l);continue}let a=e;if(this.options.extensions?.startInline){let c=1/0;const u=e.slice(1);let p;this.options.extensions.startInline.forEach(h=>{p=h.call({lexer:this},u),typeof p=="number"&&p>=0&&(c=Math.min(c,p))}),c<1/0&&c>=0&&(a=e.substring(0,c+1))}if(l=this.tokenizer.inlineText(a)){e=e.substring(l.raw.length),l.raw.slice(-1)!=="_"&&(s=l.raw.slice(-1)),o=!0;const c=t.at(-1);c?.type==="text"?(c.raw+=l.raw,c.text+=l.text):t.push(l);continue}if(e){const c="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(c);break}else throw new Error(c)}}return t}},Ia=class{options;parser;constructor(n){this.options=n||_i}space(n){return""}code({text:n,lang:e,escaped:t}){const r=(e||"").match(Xt.notSpaceStart)?.[0],i=n.replace(Xt.endingNewline,"")+`
`;return r?'<pre><code class="language-'+qn(r)+'">'+(t?i:qn(i,!0))+`</code></pre>
`:"<pre><code>"+(t?i:qn(i,!0))+`</code></pre>
`}blockquote({tokens:n}){return`<blockquote>
${this.parser.parse(n)}</blockquote>
`}html({text:n}){return n}heading({tokens:n,depth:e}){return`<h${e}>${this.parser.parseInline(n)}</h${e}>
`}hr(n){return`<hr>
`}list(n){const e=n.ordered,t=n.start;let r="";for(let s=0;s<n.items.length;s++){const l=n.items[s];r+=this.listitem(l)}const i=e?"ol":"ul",o=e&&t!==1?' start="'+t+'"':"";return"<"+i+o+`>
`+r+"</"+i+`>
`}listitem(n){let e="";if(n.task){const t=this.checkbox({checked:!!n.checked});n.loose?n.tokens[0]?.type==="paragraph"?(n.tokens[0].text=t+" "+n.tokens[0].text,n.tokens[0].tokens&&n.tokens[0].tokens.length>0&&n.tokens[0].tokens[0].type==="text"&&(n.tokens[0].tokens[0].text=t+" "+qn(n.tokens[0].tokens[0].text),n.tokens[0].tokens[0].escaped=!0)):n.tokens.unshift({type:"text",raw:t+" ",text:t+" ",escaped:!0}):e+=t+" "}return e+=this.parser.parse(n.tokens,!!n.loose),`<li>${e}</li>
`}checkbox({checked:n}){return"<input "+(n?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph({tokens:n}){return`<p>${this.parser.parseInline(n)}</p>
`}table(n){let e="",t="";for(let i=0;i<n.header.length;i++)t+=this.tablecell(n.header[i]);e+=this.tablerow({text:t});let r="";for(let i=0;i<n.rows.length;i++){const o=n.rows[i];t="";for(let s=0;s<o.length;s++)t+=this.tablecell(o[s]);r+=this.tablerow({text:t})}return r&&(r=`<tbody>${r}</tbody>`),`<table>
<thead>
`+e+`</thead>
`+r+`</table>
`}tablerow({text:n}){return`<tr>
${n}</tr>
`}tablecell(n){const e=this.parser.parseInline(n.tokens),t=n.header?"th":"td";return(n.align?`<${t} align="${n.align}">`:`<${t}>`)+e+`</${t}>
`}strong({tokens:n}){return`<strong>${this.parser.parseInline(n)}</strong>`}em({tokens:n}){return`<em>${this.parser.parseInline(n)}</em>`}codespan({text:n}){return`<code>${qn(n,!0)}</code>`}br(n){return"<br>"}del({tokens:n}){return`<del>${this.parser.parseInline(n)}</del>`}link({href:n,title:e,tokens:t}){const r=this.parser.parseInline(t),i=xh(n);if(i===null)return r;n=i;let o='<a href="'+n+'"';return e&&(o+=' title="'+qn(e)+'"'),o+=">"+r+"</a>",o}image({href:n,title:e,text:t,tokens:r}){r&&(t=this.parser.parseInline(r,this.parser.textRenderer));const i=xh(n);if(i===null)return qn(t);n=i;let o=`<img src="${n}" alt="${t}"`;return e&&(o+=` title="${qn(e)}"`),o+=">",o}text(n){return"tokens"in n&&n.tokens?this.parser.parseInline(n.tokens):"escaped"in n&&n.escaped?n.text:qn(n.text)}},tf=class{strong({text:n}){return n}em({text:n}){return n}codespan({text:n}){return n}del({text:n}){return n}html({text:n}){return n}text({text:n}){return n}link({text:n}){return""+n}image({text:n}){return""+n}br(){return""}},_r=class cd{options;renderer;textRenderer;constructor(e){this.options=e||_i,this.options.renderer=this.options.renderer||new Ia,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new tf}static parse(e,t){return new cd(t).parse(e)}static parseInline(e,t){return new cd(t).parseInline(e)}parse(e,t=!0){let r="";for(let i=0;i<e.length;i++){const o=e[i];if(this.options.extensions?.renderers?.[o.type]){const l=o,a=this.options.extensions.renderers[l.type].call({parser:this},l);if(a!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(l.type)){r+=a||"";continue}}const s=o;switch(s.type){case"space":{r+=this.renderer.space(s);continue}case"hr":{r+=this.renderer.hr(s);continue}case"heading":{r+=this.renderer.heading(s);continue}case"code":{r+=this.renderer.code(s);continue}case"table":{r+=this.renderer.table(s);continue}case"blockquote":{r+=this.renderer.blockquote(s);continue}case"list":{r+=this.renderer.list(s);continue}case"html":{r+=this.renderer.html(s);continue}case"paragraph":{r+=this.renderer.paragraph(s);continue}case"text":{let l=s,a=this.renderer.text(l);for(;i+1<e.length&&e[i+1].type==="text";)l=e[++i],a+=`
`+this.renderer.text(l);t?r+=this.renderer.paragraph({type:"paragraph",raw:a,text:a,tokens:[{type:"text",raw:a,text:a,escaped:!0}]}):r+=a;continue}default:{const l='Token with "'+s.type+'" type was not found.';if(this.options.silent)return console.error(l),"";throw new Error(l)}}}return r}parseInline(e,t=this.renderer){let r="";for(let i=0;i<e.length;i++){const o=e[i];if(this.options.extensions?.renderers?.[o.type]){const l=this.options.extensions.renderers[o.type].call({parser:this},o);if(l!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(o.type)){r+=l||"";continue}}const s=o;switch(s.type){case"escape":{r+=t.text(s);break}case"html":{r+=t.html(s);break}case"link":{r+=t.link(s);break}case"image":{r+=t.image(s);break}case"strong":{r+=t.strong(s);break}case"em":{r+=t.em(s);break}case"codespan":{r+=t.codespan(s);break}case"br":{r+=t.br(s);break}case"del":{r+=t.del(s);break}case"text":{r+=t.text(s);break}default:{const l='Token with "'+s.type+'" type was not found.';if(this.options.silent)return console.error(l),"";throw new Error(l)}}}return r}},ta=class{options;block;constructor(n){this.options=n||_i}static passThroughHooks=new Set(["preprocess","postprocess","processAllTokens"]);preprocess(n){return n}postprocess(n){return n}processAllTokens(n){return n}provideLexer(){return this.block?fr.lex:fr.lexInline}provideParser(){return this.block?_r.parse:_r.parseInline}},PP=class{defaults=Wd();options=this.setOptions;parse=this.parseMarkdown(!0);parseInline=this.parseMarkdown(!1);Parser=_r;Renderer=Ia;TextRenderer=tf;Lexer=fr;Tokenizer=Fa;Hooks=ta;constructor(...n){this.use(...n)}walkTokens(n,e){let t=[];for(const r of n)switch(t=t.concat(e.call(this,r)),r.type){case"table":{const i=r;for(const o of i.header)t=t.concat(this.walkTokens(o.tokens,e));for(const o of i.rows)for(const s of o)t=t.concat(this.walkTokens(s.tokens,e));break}case"list":{const i=r;t=t.concat(this.walkTokens(i.items,e));break}default:{const i=r;this.defaults.extensions?.childTokens?.[i.type]?this.defaults.extensions.childTokens[i.type].forEach(o=>{const s=i[o].flat(1/0);t=t.concat(this.walkTokens(s,e))}):i.tokens&&(t=t.concat(this.walkTokens(i.tokens,e)))}}return t}use(...n){const e=this.defaults.extensions||{renderers:{},childTokens:{}};return n.forEach(t=>{const r={...t};if(r.async=this.defaults.async||r.async||!1,t.extensions&&(t.extensions.forEach(i=>{if(!i.name)throw new Error("extension name required");if("renderer"in i){const o=e.renderers[i.name];o?e.renderers[i.name]=function(...s){let l=i.renderer.apply(this,s);return l===!1&&(l=o.apply(this,s)),l}:e.renderers[i.name]=i.renderer}if("tokenizer"in i){if(!i.level||i.level!=="block"&&i.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");const o=e[i.level];o?o.unshift(i.tokenizer):e[i.level]=[i.tokenizer],i.start&&(i.level==="block"?e.startBlock?e.startBlock.push(i.start):e.startBlock=[i.start]:i.level==="inline"&&(e.startInline?e.startInline.push(i.start):e.startInline=[i.start]))}"childTokens"in i&&i.childTokens&&(e.childTokens[i.name]=i.childTokens)}),r.extensions=e),t.renderer){const i=this.defaults.renderer||new Ia(this.defaults);for(const o in t.renderer){if(!(o in i))throw new Error(`renderer '${o}' does not exist`);if(["options","parser"].includes(o))continue;const s=o,l=t.renderer[s],a=i[s];i[s]=(...c)=>{let u=l.apply(i,c);return u===!1&&(u=a.apply(i,c)),u||""}}r.renderer=i}if(t.tokenizer){const i=this.defaults.tokenizer||new Fa(this.defaults);for(const o in t.tokenizer){if(!(o in i))throw new Error(`tokenizer '${o}' does not exist`);if(["options","rules","lexer"].includes(o))continue;const s=o,l=t.tokenizer[s],a=i[s];i[s]=(...c)=>{let u=l.apply(i,c);return u===!1&&(u=a.apply(i,c)),u}}r.tokenizer=i}if(t.hooks){const i=this.defaults.hooks||new ta;for(const o in t.hooks){if(!(o in i))throw new Error(`hook '${o}' does not exist`);if(["options","block"].includes(o))continue;const s=o,l=t.hooks[s],a=i[s];ta.passThroughHooks.has(o)?i[s]=c=>{if(this.defaults.async)return Promise.resolve(l.call(i,c)).then(p=>a.call(i,p));const u=l.call(i,c);return a.call(i,u)}:i[s]=(...c)=>{let u=l.apply(i,c);return u===!1&&(u=a.apply(i,c)),u}}r.hooks=i}if(t.walkTokens){const i=this.defaults.walkTokens,o=t.walkTokens;r.walkTokens=function(s){let l=[];return l.push(o.call(this,s)),i&&(l=l.concat(i.call(this,s))),l}}this.defaults={...this.defaults,...r}}),this}setOptions(n){return this.defaults={...this.defaults,...n},this}lexer(n,e){return fr.lex(n,e??this.defaults)}parser(n,e){return _r.parse(n,e??this.defaults)}parseMarkdown(n){return(t,r)=>{const i={...r},o={...this.defaults,...i},s=this.onError(!!o.silent,!!o.async);if(this.defaults.async===!0&&i.async===!1)return s(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof t>"u"||t===null)return s(new Error("marked(): input parameter is undefined or null"));if(typeof t!="string")return s(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(t)+", string expected"));o.hooks&&(o.hooks.options=o,o.hooks.block=n);const l=o.hooks?o.hooks.provideLexer():n?fr.lex:fr.lexInline,a=o.hooks?o.hooks.provideParser():n?_r.parse:_r.parseInline;if(o.async)return Promise.resolve(o.hooks?o.hooks.preprocess(t):t).then(c=>l(c,o)).then(c=>o.hooks?o.hooks.processAllTokens(c):c).then(c=>o.walkTokens?Promise.all(this.walkTokens(c,o.walkTokens)).then(()=>c):c).then(c=>a(c,o)).then(c=>o.hooks?o.hooks.postprocess(c):c).catch(s);try{o.hooks&&(t=o.hooks.preprocess(t));let c=l(t,o);o.hooks&&(c=o.hooks.processAllTokens(c)),o.walkTokens&&this.walkTokens(c,o.walkTokens);let u=a(c,o);return o.hooks&&(u=o.hooks.postprocess(u)),u}catch(c){return s(c)}}}onError(n,e){return t=>{if(t.message+=`
Please report this to https://github.com/markedjs/marked.`,n){const r="<p>An error occurred:</p><pre>"+qn(t.message+"",!0)+"</pre>";return e?Promise.resolve(r):r}if(e)return Promise.reject(t);throw t}}},ai=new PP;function Ze(n,e){return ai.parse(n,e)}Ze.options=Ze.setOptions=function(n){return ai.setOptions(n),Ze.defaults=ai.defaults,Pm(Ze.defaults),Ze};Ze.getDefaults=Wd;Ze.defaults=_i;Ze.use=function(...n){return ai.use(...n),Ze.defaults=ai.defaults,Pm(Ze.defaults),Ze};Ze.walkTokens=function(n,e){return ai.walkTokens(n,e)};Ze.parseInline=ai.parseInline;Ze.Parser=_r;Ze.parser=_r.parse;Ze.Renderer=Ia;Ze.TextRenderer=tf;Ze.Lexer=fr;Ze.lexer=fr.lex;Ze.Tokenizer=Fa;Ze.Hooks=ta;Ze.parse=Ze;Ze.options;Ze.setOptions;Ze.use;Ze.walkTokens;Ze.parseInline;var AP=Ze;_r.parse;fr.lex;const km=function(){const n=this;n.GITHUB_API_URL="https://api.github.com/"};km.prototype.getFileLastCommitInfo=function(n,e,t,r){const i=this;$.getJSON(`${i.GITHUB_API_URL}repos/${encodeURI(n)}/commits?sha=${encodeURIComponent(e)}&path=${encodeURIComponent(t)}`,function(o){const s={};try{s.commitHash=o[0].sha.substring(0,8),s.date=o[0].commit.author.date}catch(l){console.log(`Error while parsing commit: ${l}`)}console.log(`Found commit info for file ${t}:`,s),r(s)})};const ze={tabName:"firmware_flasher",releases:null,releaseChecker:new ol("firmware","https://api.github.com/repos/rotorflight/rotorflight-firmware/releases"),gitHubApi:new km,localFirmwareLoaded:!1,selectedBoard:void 0,intel_hex:void 0,parsed_hex:void 0,unifiedTarget:{},isConfigLocal:!1,boardDetectionInProgress:!1};ze.initialize=function(n){var e=this;e.selectedBoard=void 0,e.localFirmwareLoaded=!1,e.isConfigLocal=!1,e.intel_hex=void 0,e.parsed_hex=void 0;var t="https://api.github.com/repos/rotorflight/rotorflight-targets/contents/configs";function r(o){$('select[name="firmware_version"] option').each(function(){const s=$(this),l=s.data("summary");l&&l.file===o.file&&s.toggleClass("cached",FirmwareCache.has(o))})}function i(){FirmwareCache.load(),FirmwareCache.onPutToCache(r),FirmwareCache.onRemoveFromCache(r);function o(O){return new Promise(D=>{var Y=new Worker(new URL(""+new URL("hex_parser-DcwiDNoz.js",import.meta.url).href,import.meta.url));Y.onmessage=function(z){D(z.data)},Y.postMessage(O)})}function s(O){e.flashingMessage('<a class="save_firmware" href="#" title="Save Firmware">'+i18n.getMessage("firmwareFlasherFirmwareOnlineLoaded",e.parsed_hex.bytes_total)+"</a>",e.FLASH_MESSAGE_TYPES.NEUTRAL),e.enableFlashing(!0),e.unifiedTarget.manufacturerId?($("div.release_info #manufacturer").text(e.unifiedTarget.manufacturerId),$("div.release_info #manufacturerInfo").show()):$("div.release_info #manufacturerInfo").hide(),$("div.release_info .target").text(ze.selectedBoard),$("div.release_info .name").text(O.version).prop("href",O.releaseUrl),$("div.release_info .date").text(O.date),$("div.release_info .file").text(O.file).prop("href",O.url),Object.keys(e.unifiedTarget).length>0?($("div.release_info #unifiedTargetInfo").show(),$("div.release_info #unifiedTargetFile").text(e.unifiedTarget.fileName).prop("href",e.unifiedTarget.fileUrl),$("div.release_info #unifiedTargetDate").text(e.unifiedTarget.date)):$("div.release_info #unifiedTargetInfo").hide();var D=O.notes;D=AP(D),$("div.release_info .notes").html(D),$("div.release_info .notes").find("a").each(function(){$(this).attr("target","_blank")}),$("div.release_info").slideDown(),$(".tab-firmware_flasher .content_wrapper").animate({scrollTop:$("div.release_info").position().top},1e3)}function l(O,D){e.intel_hex=O,o(e.intel_hex).then(Y=>{e.parsed_hex=Y,e.parsed_hex?(FirmwareCache.has(D)||FirmwareCache.put(D,e.intel_hex),s(D)):e.flashingMessage(i18n.getMessage("firmwareFlasherHexCorrupted"),e.FLASH_MESSAGE_TYPES.INVALID)})}function a(O,D){e.localFirmwareLoaded=!1,D=typeof D=="object"?D:$('select[name="firmware_version"] option:selected').data("summary"),l(O,D),$("a.load_remote_file").removeClass("disabled"),$("a.load_remote_file").text(i18n.getMessage("firmwareFlasherButtonLoadOnline"))}function c(O){if(!O){$('select[name="board"]').empty().append('<option value="0">Offline</option>'),$('select[name="firmware_version"]').empty().append('<option value="0">Offline</option>');return}var D=$('select[name="board"]');D.empty(),D.append($(`<option value='0'>${i18n.getMessage("firmwareFlasherOptionLabelSelectBoard")}</option>`));var Y=$('select[name="firmware_version"]');Y.empty(),Y.append($(`<option value='0'>${i18n.getMessage("firmwareFlasherOptionLabelSelectFirmwareVersion")}</option>`));var z=[];if(Object.keys(O).sort().forEach(function(ee){var re=O[ee];re.forEach(function(le){if($.inArray(ee,z)==-1){z.push(ee);var J=$(`<option value='${le.target}'>${le.target}</option>`);D.append(J)}})}),ze.releases=O,We("rememberLastSelectedBoard")){const ee=We("selected_board"),re=O[ee];$('select[name="board"]').val(re?ee:0).trigger("change")}}function u(O,D){var Y={};const z=/^rotorflight_([\d]+[.][\d]+[.][\d]+((-[A-Za-z][\w]*)|(-[\d]+))?)_([A-Za-z][\w]*)[.]hex$/;O.forEach(function(ee){ee.prerelease&&D<2||ee.assets.forEach(function(re){var le=z.exec(re.name);if(!le||le[2]&&D<1||_e.lt(le[1],CONFIGURATOR.FW_VERSION_MIN_SUPPORTED)||_e.gt(le[1],CONFIGURATOR.FW_VERSION_MAX_SUPPORTED))return;const J=le[1],oe=le[5],ae=new Date(ee.published_at),de=("0"+ae.getDate()).slice(-2)+"-"+("0"+(ae.getMonth()+1)).slice(-2)+"-"+ae.getFullYear()+" "+("0"+ae.getHours()).slice(-2)+":"+("0"+ae.getMinutes()).slice(-2),ie=GUI.isBrowser?re.browser_download_url.replace("github.com","rotorflight-releases-proxy.josh-eea.workers.dev"):re.browser_download_url,te={releaseUrl:ee.html_url,name:J,version:J,url:ie,file:re.name,target:oe,date:de,notes:ee.body};Y[oe]===void 0&&(Y[oe]=[]),Y[oe].push(te)})}),g(Y)}function p(O){return _e.gte(O,"4.2.0")}function h(O){return Object.keys(O).some(function(D){return O[D].some(function(Y){return p(Y.version)})})}function g(O){var D=7200,Y=Math.floor(Date.now()/1e3);if(O&&h(O)){console.log("loaded some builds for later");const z="unifiedSourceCache";chrome.storage.local.get(z,function(ee){let re=ee[z];!re||!re.lastUpdate||Y-re.lastUpdate>D?(console.log("go get",t),$.get(t,function(le){let J={},oe={};oe.lastUpdate=Y,oe.data=le,J[z]=oe,chrome.storage.local.set(J),f(le,O)}).fail(()=>{console.log("failed to get new",t,"cached data",Math.floor((Y-re.lastUpdate)/60),"mins old"),f(re.data,O)})):(console.log("unified config cached data",Math.floor((Y-re.lastUpdate)/60),"mins old"),f(re.data,O))})}else c(O)}function f(O,D){if(!O)return;let Y={},z={},ee={};Object.keys(D).forEach(function(J){ee[J]={},Y[J]=D[J]}),O.forEach(function(J){const oe=/^([^-]{1,4})-(.*).config$/;let ae=J.name.match(oe);if(!ae)return;const de=ae[2],ie=ae[1];ee[de]={},z[de]=z[de]||{},z[de][ie]=J});var re=$('select[name="board"]'),le=$('select[name="firmware_version"]');if(re.empty().append($(`<option value='0'>${i18n.getMessage("firmwareFlasherOptionLabelSelectBoard")}</option>`)),le.empty().append($(`<option value='0'>${i18n.getMessage("firmwareFlasherOptionLabelSelectFirmwareVersion")}</option>`)),Object.keys(ee).sort().forEach(function(J){const oe=$(`<option value='${J}'>${J}</option>"`);re.append(oe)}),ze.releases=Y,ze.unifiedConfigs=z,We("rememberLastSelectedBoard")){const J=We("selected_board");if(J){const oe=ze.unifiedConfigs[J]||ze.releases[J];$('select[name="board"]').val(oe?J:0).trigger("change")}}}var d=[{tag:"firmwareFlasherOptionLabelBuildTypeRelease",loader:()=>e.releaseChecker.loadReleaseData(O=>u(O,0))},{tag:"firmwareFlasherOptionLabelBuildTypePreRelease",loader:()=>e.releaseChecker.loadReleaseData(O=>u(O,1))},{tag:"firmwareFlasherOptionLabelBuildTypeDevelopment",loader:()=>e.releaseChecker.loadReleaseData(O=>u(O,2))}],_=$('select[name="build_type"]');function m(){_.empty(),d.forEach(({tag:O,title:D},Y)=>{_.append($(`<option value='${Y}'>${O?i18n.getMessage(O):D}</option>`))}),_.val($('select[name="build_type"] option:first').val())}m(),i18n.localizePage(),_.change(function(){$("a.load_remote_file").addClass("disabled");var O=$(this).val();$('select[name="board"]').empty().append($(`<option value='0'>${i18n.getMessage("firmwareFlasherOptionLoading")}</option>`)),$('select[name="firmware_version"]').empty().append($(`<option value='0'>${i18n.getMessage("firmwareFlasherOptionLoading")}</option>`)),GUI.connect_lock||(ze.unifiedConfigs={},d[O].loader()),chrome.storage.local.set({selected_build_type:O})});function C(O,D,Y,z,ee,re){ee&&ee.forEach(function(le){let J=le.version;const oe={descriptor:le};if(Y){if(!p(le.version))return;oe.manufacturerId=Y,oe.duplicateName=z}else J=`${J}-legacy`,oe.isLegacy=!0;O[J]=oe}),re?.()}function R(O,D,Y){const z=function(re,le){return-_e.compareBuild(re,le)};O.empty();const ee=Object.keys(D);ee.length>0&&(O.append($(`<option value='0'>${i18n.getMessage("firmwareFlasherOptionLabelSelectFirmwareVersionFor")} ${Y}</option>`)),ee.sort(z).forEach(function(re){const le=D[re];if(!le.isLegacy&&!p(le.descriptor.version))return;let J;le.isLegacy&&Object.values(D).some(function(ae){return ae.descriptor.version===le.descriptor.version&&!ae.isLegacy})?J=i18n.getMessage("firmwareFlasherLegacyLabel",{target:le.descriptor.version}):!le.isLegacy&&Object.values(D).some(function(ae){return ae.descriptor.version===le.descriptor.version&&ae.manufacturerId!==le.manufacturerId&&!ae.isLegacy})?J=`${le.descriptor.version} (${le.manufacturerId})`:J=le.descriptor.version;var oe=$(`<option value='${re}'>${le.descriptor.date} - ${J}</option>`);FirmwareCache.has(le.descriptor)&&oe.addClass("cached"),oe.data("summary",le.descriptor),O.append(oe)}),O.prop("selectedIndex",1).change())}function S(O){let D;try{const Y=/.+\/ (STM32[^ ]*)/;D=O.match(Y)[1]}catch(Y){D=void 0,console.log("grabBuildNameFromConfig failed: ",Y.message)}return D}function F(O,D,Y){let z=Y;try{const ee=O.match(`${D} (.*)
`);ee&&(z=ee[1])}catch(ee){console.log("grabKeywordFromConfig failed: ",ee.message)}return z}function I(O,D,Y,z,ee,re,le){D===O?e.unifiedTarget={}:(e.unifiedTarget.config=Y,e.unifiedTarget.manufacturerId=z,e.unifiedTarget.fileName=ee,e.unifiedTarget.fileUrl=re,e.unifiedTarget.date=le,e.isConfigLocal=!1)}function T(){e.isConfigLocal=!1,e.unifiedTarget={},e.intel_hex=void 0,e.parsed_hex=void 0,e.localFirmwareLoaded=!1}$('select[name="board"]').select2(),$('select[name="board"]').change(function(){$("a.load_remote_file").addClass("disabled");var O=$(this).val();if(!GUI.connect_lock||e.boardDetectionInProgress){ze.selectedBoard!=O&&e.isConfigLocal&&(console.log("Board changed, unloading local config"),e.isConfigLocal=!1,e.unifiedTarget={}),We("rememberLastSelectedBoard")&&it({selected_board:O}),ze.selectedBoard=O,ze.bareBoard=void 0,console.log("board changed to",O),e.flashingMessage(i18n.getMessage("firmwareFlasherLoadFirmwareFile"),e.FLASH_MESSAGE_TYPES.NEUTRAL).flashProgress(0),$("div.git_info").slideUp(),$("div.release_info").slideUp(),e.localFirmwareLoaded||e.enableFlashing(!1);var D=$('select[name="firmware_version"]');if(O==0)T(),D.empty(),D.append($(`<option value='0'>${i18n.getMessage("firmwareFlasherOptionLabelSelectFirmwareVersion")}</option>`));else{D.empty(),D.append($(`<option value='0'>${i18n.getMessage("firmwareFlasherOptionLoading")}</option>`));const ee=[],re=function(){ze.releases[O]&&(ze.bareBoard=O,C(ee,O,void 0,!1,ze.releases[O])),R(D,ee,O)};if(ze.unifiedConfigs[O]){const le="unifiedConfigLast";var Y=3600,z=Math.floor(Date.now()/1e3);chrome.storage.local.get(le,function(J){let oe=J[le];const ae=ze.unifiedConfigs[O],de=Object.keys(ae),ie=de.length>1,te=function(fe){const Re=function(){fe<de.length-1?te(fe+1):re()},$e=de[fe],Ve=`${O}+${$e}`;if(!oe||!oe.targetId||oe.targetId!==Ve||!oe.lastUpdate||z-oe.lastUpdate>Y||!oe.unifiedTarget){const tt=ae[$e];$.get(tt.download_url,function(en){console.log("got unified config");let ot=G(en);if(ot!==null){const jt=S(ot);ze.bareBoard=jt,e.gitHubApi.getFileLastCommitInfo("rotorflight/rotorflight-targets","master",tt.path,function(Nn){ot=e.injectDefaultDesign(ot,"BTFL"),ot=e.injectTargetInfo(ot,tt.name,O,$e,Nn),I(O,jt,ot,$e,tt.name,tt.download_url,Nn.date);let hn={};hn[le]={unifiedTarget:e.unifiedTarget,targetId:Ve,lastUpdate:z},chrome.storage.local.set(hn),C(ee,O,$e,ie,ze.releases[jt],Re)})}else P(tt.download_url)}).fail(()=>{P(tt.download_url)})}else{console.log("We have the config cached for",Ve);const tt=oe.unifiedTarget,en=S(tt.config);ze.bareBoard=en,O===en?e.unifiedTarget={}:e.unifiedTarget=tt,C(ee,O,$e,ie,ze.releases[en],Re)}};te(0)})}else e.unifiedTarget={},re()}}});function P(O){e.unifiedTarget={},e.isConfigLocal=!1,GUI.log(i18n.getMessage("firmwareFlasherFailedToLoadUnifiedConfig",{remote_file:O}))}function y(){e.isConfigLocal&&!e.parsed_hex&&e.flashingMessage(i18n.getMessage("firmwareFlasherLoadedConfig"),e.FLASH_MESSAGE_TYPES.NEUTRAL),e.isConfigLocal&&e.parsed_hex&&!e.localFirmwareLoaded&&(e.enableFlashing(!0),e.flashingMessage(i18n.getMessage("firmwareFlasherFirmwareLocalLoaded",e.parsed_hex.bytes_total),e.FLASH_MESSAGE_TYPES.NEUTRAL)),e.localFirmwareLoaded&&(e.enableFlashing(!0),e.flashingMessage(i18n.getMessage("firmwareFlasherFirmwareLocalLoaded",e.parsed_hex.bytes_total),e.FLASH_MESSAGE_TYPES.NEUTRAL))}const L=[/^feature [-]?AIRMODE/i,/^feature [-]?ANTI/i,/^feature [-]?DISPLAY/i,/^feature [-]?DYNAMIC/i,/^feature [-]?ESC_SENSOR/i,/^feature [-]?GPS/i,/^feature [-]?LED_STRIP/i,/^feature [-]?MOTOR_STOP/i,/^feature [-]?OSD/i,/^feature [-]?RSSI/i,/^feature [-]?RX_PARALLEL/i,/^feature [-]?RX_SERIAL/i,/^feature [-]?RX_SPI/i,/^feature [-]?SOFTSERIAL/i,/^feature [-]?TELEMETRY/i,/^resource PWM/i,/^resource MOTOR [5-8]/i,/^serial [0-9]/i,/^set serialrx/i];function G(O){let D="",Y="BF";return console.log("Clean up Unified Config file:"),O.split(/[\r\n]+/).forEach(function(z,ee){if(ee==0&&z.match(/^# [A-Za-z]*flight/))z.match(/^# Rotorflight/)&&(Y="RF");else{if(z=z.replace(/#.*$/,"").replace(/[ \t]+$/,"").replace(/[ \t]+/," ").replace(/^[ ]*$/,""),z.length==0)return;if(Y!="RF"&&L.some(re=>z.match(re))){console.log(" ---"+z);return}}D+=z+`
`}),D}const U=$("div#port-picker #port");function M(O){var D={};if($("input.erase_chip").is(":checked")&&(D.erase_chip=!0),$("option:selected",U).data().isDFU)STM32DFU.connect(usbDevices,O,D);else if(String(U.val())!=="0"){const Y=String(U.val());$("input.updating").is(":checked")?D.no_reboot=!0:D.reboot_baud=parseInt($("div#port-picker #baud").val());let z=115200;$("input.flash_manual_baud").is(":checked")&&(z=parseInt($("#flash_manual_baud_rate").val())),STM32.connect(Y,z,O,D)}else console.log("Please select valid serial port"),GUI.log(i18n.getMessage("firmwareFlasherNoValidPort"))}$("input.erase_chip").prop("checked",!!We("erase_chip")).change(function(){it({erase_chip:$(this).is(":checked")})}).change(),chrome.storage.local.get("selected_build_type",function(O){_.val(O.selected_build_type||0).trigger("change")}),We("no_reboot_sequence")?($("input.updating").prop("checked",!0),$(".flash_on_connect_wrapper").show()):$("input.updating").prop("checked",!1),$("input.updating").change(function(){var O=$(this).is(":checked");O?$(".flash_on_connect_wrapper").show():($("input.flash_on_connect").prop("checked",!1).change(),$(".flash_on_connect_wrapper").hide()),it({no_reboot_sequence:O})}),$("input.updating").trigger("change"),$("input.flash_manual_baud").prop("checked",!!We("flash_manual_baud")).on("change",function(){var O=$(this).is(":checked");it({flash_manual_baud:O})}).trigger("change"),$("#flash_manual_baud_rate").val(We("flash_manual_baud_rate")).on("change",function(){var O=parseInt($(this).val());it({flash_manual_baud_rate:O})}).trigger("change"),$("a.load_file").on("click",async function(){e.enableFlashing(!1);const O=await sl({description:"Firmware/Target",extensions:[".hex",".config"]});if(O)if($("div.git_info").slideUp(),O.name.endsWith(".hex"))e.intel_hex=O.content,e.parsed_hex=await o(e.intel_hex),e.parsed_hex?(e.localFirmwareLoaded=!0,y()):e.flashingMessage(i18n.getMessage("firmwareFlasherHexCorrupted"),e.FLASH_MESSAGE_TYPES.INVALID);else{T();let D=G(O.content);if(D!==null){const Y=F(D,"manufacturer_id","NONE"),z=F(D,"board_name","NONE");D=e.injectDefaultDesign(D,"BTFL"),D=e.injectTargetInfo(D,O.name,z,Y,{commitHash:"unknown",date:O.lastModified?.toISOString()??new Date().toISOString()}),e.unifiedTarget.config=D,e.unifiedTarget.fileName=O.name,e.isConfigLocal=!0,y()}}}),$('select[name="firmware_version"]').change(function(O){$("div.release_info").slideUp(),e.localFirmwareLoaded||(e.enableFlashing(!1),e.flashingMessage(i18n.getMessage("firmwareFlasherLoadFirmwareFile"),e.FLASH_MESSAGE_TYPES.NEUTRAL),e.parsed_hex&&e.parsed_hex.bytes_total&&(console.log("throw out loaded hex"),e.intel_hex=void 0,e.parsed_hex=void 0));let D=$("option:selected",O.target).data("summary"),Y=FirmwareCache.has(D);O.target.value==="0"||Y?(Y&&FirmwareCache.get(D,z=>{console.info("Release found in cache: "+D.file),a(z.hexdata,D)}),$("a.load_remote_file").addClass("disabled")):$("a.load_remote_file").removeClass("disabled")}),$("a.load_remote_file").click(function(){if(e.enableFlashing(!1),e.localFirmwareLoaded=!1,$('select[name="firmware_version"]').val()=="0"){GUI.log(i18n.getMessage("firmwareFlasherNoFirmwareSelected"));return}function O(){$("span.progressLabel").attr("i18n","firmwareFlasherFailedToLoadOnlineFirmware").removeClass("i18n-replaced"),$("a.load_remote_file").removeClass("disabled"),$("a.load_remote_file").text(i18n.getMessage("firmwareFlasherButtonLoadOnline")),i18n.localizePage()}var D=$('select[name="firmware_version"] option:selected').data("summary");if(D){if(e.isConfigLocal&&FirmwareCache.has(D)){FirmwareCache.get(D,Y=>{console.info("Release found in cache: "+D.file),a(Y.hexdata,D)});return}$("a.load_remote_file").text(i18n.getMessage("firmwareFlasherButtonDownloading")),$("a.load_remote_file").addClass("disabled"),$.get(D.url,a).fail(O)}else $("span.progressLabel").attr("i18n","firmwareFlasherFailedToLoadOnlineFirmware").removeClass("i18n-replaced"),i18n.localizePage()});const N=$("a.exit_dfu");N.click(function(){if(!$(this).hasClass("disabled")&&!GUI.connect_lock)try{STM32DFU.connect(usbDevices,e.parsed_hex,{exitDfu:!0})}catch(O){console.log(`Exiting DFU failed: ${O.message}`)}});const w=$("a.detect-board");U.on("change",function(){GUI.connect_lock||($("option:selected",this).data().isDFU?(N.removeClass("disabled"),w.toggleClass("disabled",!0)):($("a.load_remote_file").removeClass("disabled"),$("a.load_file").removeClass("disabled"),w.toggleClass("disabled",!1),N.addClass("disabled")))});let x=function(){let O=!1,D=null,Y=null;function z(de,ie){if(!(ze.releases?Object.keys(ze.releases).length>0:!1)){GUI.log(i18n.getMessage("firmwareFlasherNoBoardsLoaded"));return}if(serial.connected||serial.connectionId){console.warn("Attempting to connect while there still is a connection",serial.connected,serial.connectionId,serial.openCanceled),serial.disconnect();return}ze.enableFlashing(!1),GUI.connect_lock=!0,e.boardDetectionInProgress=!0,GUI.log(i18n.getMessage("firmwareFlasherBoardDetectionInProgress")),Y=setTimeout(function(){GUI.log(i18n.getMessage("firmwareFlasherBoardDetectionFail")),re()},5e3),serial.connect(de,{bitrate:ie},J)}async function ee(){await MSP.promise(MSPCodes.MSP_BOARD_INFO),le()}function re(){serial.disconnect(oe),MSP.disconnect_cleanup(),ze.enableFlashing(!0),e.boardDetectionInProgress=!1,GUI.connect_lock=!1}function le(){let de=FC.CONFIG.boardName;if(de){if(clearTimeout(Y),de.includes(".")){const Re=de.replace(".","_");GUI.log(i18n.getMessage("dialogBoardDetectionMessageInvalidBoardNameContent",[de,Re])),ae(i18n.getMessage("dialogBoardDetectionMessageInvalidBoardNameTitle"),i18n.getMessage("dialogBoardDetectionMessageInvalidBoardNameContent",[de,Re]).concat("<br />",i18n.getMessage("dialogBoardDetectionMessageInvalidBoardNameRecommendation"))),de=Re}const ie=$('select[name="board"]'),te=$('select[name="board"] option'),fe=ie.val();te.each((Re,$e)=>{$($e).text()===de&&(O=!0)}),O&&de!==fe&&ie.val(de).trigger("change"),GUI.log(i18n.getMessage(O?"firmwareFlasherBoardDetectionSucceeded":"firmwareFlasherBoardDetectionBoardNotFound",{boardName:de})),re()}}function J(de){de?(GUI.log(i18n.getMessage("serialPortOpened",serial.connectionType==="serial"?[serial.connectionId]:[de.socketId])),serial.onReceive.addListener(function(ie){MSP.read(ie)}),D=new MspHelper,MSP.listen(D.process_data.bind(D)),ee()):(clearTimeout(Y),GUI.log(i18n.getMessage("firmwareFlasherBoardDetectionFail")+": "+i18n.getMessage("serialPortOpenFail")),re())}function oe(de){GUI.log(i18n.getMessage(de?"serialPortClosedOk":"serialPortClosedFail")),O||GUI.log(i18n.getMessage("firmwareFlasherBoardDetectionFail")),MSP.clearListeners()}function ae(de,ie){const te=$("#dialogBoardDetectionMessage")[0];function fe(){$("#dialogBoardDetectionMessageAcknowledge").off("click"),te.close(),$("#dialogBoardDetectionMessageTitle").html(""),$("#dialogBoardDetectionMessageContent").html("")}$("#dialogBoardDetectionMessageAcknowledge").on("click",function(){fe()}),$("#dialogBoardDetectionMessageTitle").html(de),$("#dialogBoardDetectionMessageContent").html(ie),te.showModal()}return{detect:z}}();w.on("click",()=>{if(w.toggleClass("disabled",!0),!GUI.connect_lock&&!$("option:selected",U).data().isDFU)if(String(U.val())!=="0"){const O=String(U.val());let D=115200;$("input.flash_manual_baud").is(":checked")&&(D=parseInt($("#flash_manual_baud_rate").val())),x.detect(O,D)}else GUI.log(i18n.getMessage("firmwareFlasher"))}),$("a.flash_firmware").click(function(){$(this).hasClass("disabled")||k()});function k(){if(N.addClass("disabled"),$("a.load_remote_file").addClass("disabled"),$("a.load_file").addClass("disabled"),w.toggleClass("disabled",!0),!GUI.connect_lock)if(e.parsed_hex)try{if(e.unifiedTarget.config&&!e.parsed_hex.configInserted){var O=new ConfigInserter;O.insertConfig(e.parsed_hex,e.unifiedTarget.config)?e.parsed_hex.configInserted=!0:(console.log("Firmware does not support custom defaults."),e.unifiedTarget={})}M(e.parsed_hex),GUI.saveDefaultTab("status")}catch(D){console.log(`Flashing failed: ${D.message}`)}else $("span.progressLabel").attr("i18n","firmwareFlasherFirmwareNotLoaded").removeClass("i18n-replaced"),i18n.localizePage()}$("input.flash_on_connect").change(function(){var O=$(this).is(":checked");if(O){var D=function(){PortHandler.port_detected("flash_detected_device",function(Y){var z=Y[0];GUI.connect_lock?GUI.log(i18n.getMessage("firmwareFlasherPreviousDevice",[z])):(GUI.log(i18n.getMessage("firmwareFlasherFlashTrigger",[z])),console.log("Detected: "+z+" - triggering flash on connect"),GUI.timeout_add("initialization_timeout",function(){$("a.flash_firmware").click()},100)),D()},!1,!0)};D()}else PortHandler.flush_callbacks()}).change(),$(document).keypress(function(O){O.which==13&&$("a.flash_firmware").click()}),e.flashingMessage(i18n.getMessage("firmwareFlasherLoadFirmwareFile"),e.FLASH_MESSAGE_TYPES.NEUTRAL),$("div#flashbutton a.flash_state").addClass("active"),$("div#flashbutton a.flash").addClass("active"),GUI.content_ready(n)}$("#content").load("/src/tabs/firmware_flasher.html",i)};ze.cleanup=function(n){PortHandler.flush_callbacks(),FirmwareCache.unload(),$(document).unbind("keypress"),$(document).off("click","span.progressLabel a"),$("div#flashbutton a.flash_state").removeClass("active"),$("div#flashbutton a.flash").removeClass("active"),n?.()};ze.enableFlashing=function(n){n?$("a.flash_firmware").removeClass("disabled"):$("a.flash_firmware").addClass("disabled")};ze.FLASH_MESSAGE_TYPES={NEUTRAL:"NEUTRAL",VALID:"VALID",INVALID:"INVALID",ACTION:"ACTION"};ze.flashingMessage=function(n,e){let t=this,r=$("span.progressLabel");switch(e){case t.FLASH_MESSAGE_TYPES.VALID:r.removeClass("invalid actionRequired").addClass("valid");break;case t.FLASH_MESSAGE_TYPES.INVALID:r.removeClass("valid actionRequired").addClass("invalid");break;case t.FLASH_MESSAGE_TYPES.ACTION:r.removeClass("valid invalid").addClass("actionRequired");break;case t.FLASH_MESSAGE_TYPES.NEUTRAL:default:r.removeClass("valid invalid actionRequired");break}return n!=null&&(r.html(n),$("span.progressLabel a.save_firmware").on("click",async function(){var i=$('select[name="firmware_version"] option:selected').data("summary");try{await al(t.intel_hex,{suggestedName:i.file,description:"Rotorflight Firmware (.hex)"})}catch(o){console.log("Error saving firmware file",o)}})),t};ze.flashProgress=function(n){return $(".progress").val(n),this};ze.injectDefaultDesign=function(n,e){const t=/board_design [A-Za-z0-9_+-]+\n/gm,r=/board_name [A-Za-z0-9_+-]+\n/gm,i=`board_design ${e}
`;if(!n.match(t)){let o=n.match(r);o&&(n=n.replace(r,o[0]+i))}return n};ze.injectTargetInfo=function(n,e,t,r,i){const o=/# config: manufacturer_id: .*\n/gm;n=n.replace(o,"");const s=`## Rotorflight Custom Defaults
# config: ${e}
# board: ${t}
# make: ${r}
# hash: ${i.commitHash}
# date: ${i.date}
##
`+n;return console.log(`Unified Config:
`+s),s};TABS[ze.tabName]=ze;const ba={tabName:"gps",isDirty:!1};ba.initialize=function(n){const e=this;r(t);function t(){$("#content").load("/src/tabs/gps.html",o)}function r(s){MSP.promise(MSPCodes.MSP_STATUS).then(()=>MSP.promise(MSPCodes.MSP_GPS_CONFIG)).then(s)}function i(s){Promise.resolve(!0).then(()=>MSP.promise(MSPCodes.MSP_SET_GPS_CONFIG,mspHelper.crunch(MSPCodes.MSP_SET_GPS_CONFIG))).then(()=>MSP.promise(MSPCodes.MSP_EEPROM_WRITE)).then(()=>{GUI.log(i18n.getMessage("eepromSaved")),MSP.send_message(MSPCodes.MSP_SET_REBOOT),GUI.log(i18n.getMessage("deviceRebooting")),reinitialiseConnection(s)})}function o(){$(".tab-gps").addClass("toolbar_hidden");let s=!1;const l=["NMEA","UBLOX","MSP"],a=["115200","57600","38400","19200","9600"],c=[i18n.getMessage("gpsSbasAutoDetect"),i18n.getMessage("gpsSbasEuropeanEGNOS"),i18n.getMessage("gpsSbasNorthAmericanWAAS"),i18n.getMessage("gpsSbasJapaneseMSAS"),i18n.getMessage("gpsSbasIndianGAGAN"),i18n.getMessage("gpsSbasNone")],u=$("select.gps_protocol"),p=$('input[name="gps_auto_baud"]'),h=$(".gps_auto_baud"),g=$('input[name="gps_auto_config"]'),f=$(".gps_auto_config"),d=$('input[name="gps_ublox_galileo"]'),_=$(".gps_ublox_galileo"),m=$("select.gps_ubx_sbas"),C=$(".gps_ubx_sbas"),R=$('input[name="gps_home_once"]'),S=$("select.gps_baudrate");for(let y=0;y<l.length;y++)u.append(`<option value="${y}">${l[y]}</option>`);u.change(function(){FC.GPS_CONFIG.provider=parseInt($(this).val()),g.change()}).val(FC.GPS_CONFIG.provider).change(),p.change(function(){const y=$(this).is(":checked");FC.GPS_CONFIG.auto_baud=y?1:0}).prop("checked",FC.GPS_CONFIG.auto_baud>0),g.change(function(){const y=$(this).is(":checked"),L=FC.GPS_CONFIG.provider===l.indexOf("UBLOX"),G=y&&L;_.toggle(G);const U=y&&L;C.toggle(U),FC.GPS_CONFIG.auto_config=y?1:0}).prop("checked",FC.GPS_CONFIG.auto_config>0).change(),h.show(),f.show(),d.change(function(){const y=$(this).is(":checked");FC.GPS_CONFIG.ublox_use_galileo=y?1:0}).prop("checked",FC.GPS_CONFIG.ublox_use_galileo>0).change();for(let y=0;y<c.length;y++)m.append(`<option value="${y}">${c[y]}</option>`);m.change(function(){FC.GPS_CONFIG.ublox_sbas=parseInt($(this).val())}).val(FC.GPS_CONFIG.ublox_sbas),R.change(function(){const y=$(this).is(":checked");FC.GPS_CONFIG.home_point_once=y?1:0}).prop("checked",FC.GPS_CONFIG.home_point_once>0).change();for(let y=0;y<a.length;y++)S.append(`<option value="${a[y]}">${a[y]}</option>`);S.prop("disabled",!0),S.parent().hide();const F=document.getElementById("map");i18n.localizePage(),e.isDirty=!1;function I(){e.isDirty||(e.isDirty=!0,$(".tab-gps").removeClass("toolbar_hidden"))}function T(){const y=FC.GPS_DATA.alt,L=FC.GPS_DATA.lat/1e7,G=FC.GPS_DATA.lon/1e7,U=`https://maps.google.com/?q=${L},${G}`;$(".gpsFix").html(FC.GPS_DATA.fix?i18n.getMessage("gpsFixYes"):i18n.getMessage("gpsFixNo")),$(".GPS_info td.alt").text(y+" m"),$(".GPS_info td.lat a").prop("href",U).text(L.toFixed(4)+" deg"),$(".GPS_info td.lon a").prop("href",U).text(G.toFixed(4)+" deg"),$(".GPS_info td.speed").text(FC.GPS_DATA.speed+" cm/s"),$(".GPS_info td.sats").text(FC.GPS_DATA.numSat),$(".GPS_info td.distToHome").text(FC.GPS_DATA.distanceToHome+" m");const M=$("div.GPS_signal_strength table tr:not(.titles)");for(let w=0;w<FC.GPS_DATA.chn.length;w++){const x=M.eq(w);$("td",x).eq(0).text(FC.GPS_DATA.svid[w]),$("td",x).eq(1).text(FC.GPS_DATA.quality[w]),$("td",x).eq(2).find("progress").val(FC.GPS_DATA.cno[w])}const N={action:"center",lat:L,lon:G};navigator.onLine?($("#connect").hide(),FC.GPS_DATA.fix?(s=!0,F.contentWindow.postMessage(N,"*"),$("#loadmap").show(),$("#waiting").hide()):s?(N.action="nofix",F.contentWindow.postMessage(N,"*")):($("#loadmap").hide(),$("#waiting").show())):(s=!1,$("#connect").show(),$("#waiting").hide(),$("#loadmap").hide())}function P(y){console.log(y?"Online Status: Connected":"Online Status: Disconnected"),$("#connect").toggle(!y),$("#waiting").toggle(y),$("#loadmap").toggle(y)}P(navigator.onLine),$("#check").on("click",function(){P(navigator.onLine)}),$("#zoom_in").click(function(){console.log("zoom in"),F.contentWindow.postMessage({action:"zoom_in"},"*")}),$("#zoom_out").click(function(){console.log("zoom out"),F.contentWindow.postMessage({action:"zoom_out"},"*")}),e.save=function(y){i(y)},e.revert=function(y){y?.()},$("a.save").click(function(){e.save(()=>GUI.tab_switch_reload())}),$("a.revert").click(function(){e.revert(()=>GUI.tab_switch_reload())}),$(".GPS_settings").change(function(){I()}),GUI.interval_add("gps_pull",function(){MSP.send_message(MSPCodes.MSP_RAW_GPS,!1,!1,()=>MSP.send_message(MSPCodes.MSP_COMP_GPS,!1,!1,()=>MSP.send_message(MSPCodes.MSP_GPS_SV_INFO,!1,!1,()=>T())))},75,!0),GUI.interval_add("status_pull",function(){MSP.send_message(MSPCodes.MSP_STATUS)},250,!0),GUI.content_ready(n)}};ba.cleanup=function(n){this.isDirty=!1,n?.()};TABS[ba.tabName]=ba;var MP=ne('<div class="container svelte-mhqooo"><div class="header svelte-mhqooo"><div class="fas fa-times-circle svelte-mhqooo"></div> <b class="svelte-mhqooo"> </b></div> <div class="svelte-mhqooo"><!></div></div>');function Um(n,e){we(e,!0);const[t,r]=Et(),i=()=>vt(St,"$i18n",t);var o=MP(),s=W(o),l=K(W(s),2),a=W(l),c=K(s,2),u=W(c);{var p=g=>{var f=Ct(),d=me(f);Ot(d,()=>e.children),Z(g,f)},h=(g,f)=>{{var d=_=>{var m=Ct(),C=me(m);fi(C,()=>i().t(e.message)),Z(_,m)};Ce(g,_=>{typeof e.message=="string"&&_(d)},f)}};Ce(u,g=>{e.children?g(p):g(h,!1)})}Ae(g=>Ee(a,g),[()=>i().t("errorTitle")]),Z(n,o),Ge(),r()}var NP=ne('<div class="container svelte-nruw4o"><div class="header svelte-nruw4o"><div class="fas fa-exclamation-triangle svelte-nruw4o"></div> <b class="svelte-nruw4o"> </b></div> <div class="svelte-nruw4o"><!></div></div>');function nf(n,e){we(e,!0);const[t,r]=Et(),i=()=>vt(St,"$i18n",t);var o=NP(),s=W(o),l=K(W(s),2),a=W(l),c=K(s,2),u=W(c);{var p=g=>{var f=Ct(),d=me(f);Ot(d,()=>e.children),Z(g,f)},h=(g,f)=>{{var d=_=>{var m=Ct(),C=me(m);fi(C,()=>i().t(e.message)),Z(_,m)};Ce(g,_=>{typeof e.message=="string"&&_(d)},f)}};Ce(u,g=>{e.children?g(p):g(h,!1)})}Ae(g=>Ee(a,g),[()=>i().t("warningTitle")]),Z(n,o),Ge(),r()}var xP=(n,e)=>e.onchange?.(n),yP=ne('<label class="container svelte-9w6eqp"><input type="checkbox" class="svelte-9w6eqp"/> <span></span></label>');function ut(n,e){we(e,!0);let t=ft(e,"checked",15),r=ft(e,"disabled",3,!1);var i=yP(),o=W(i);o.__change=[xP,e];var s=K(o,2);Ae(()=>{os(o,"id",e.id),o.disabled=r(),ii(s,1,Wo(["slider",r()&&"disabled"]),"svelte-9w6eqp")}),Pb(o,t),Z(n,i),Ge()}pn(["change"]);var wP=ne('<div class="container svelte-ekv4tu"><div class="toggle svelte-ekv4tu"><!></div> <div class="content svelte-ekv4tu"><!></div></div>');function GP(n,e){we(e,!0);let t=ft(e,"enabled",15);var r=wP(),i=W(r),o=W(i);ut(o,{get checked(){return t()},set checked(a){t(a)}});var s=K(i,2),l=W(s);Ot(l,()=>e.children??et),Z(n,r),Ge()}var LP=ne('<option class="svelte-1tymesw"> </option>'),$P=ne('<select class="svelte-1tymesw"><option class="svelte-1tymesw"> </option><option class="svelte-1tymesw"> </option><!></select>'),DP=ne("<!> <!>",1),kP=ne('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),UP=ne("<button> </button>"),BP=ne('<ul class="svelte-1tymesw"></ul>'),VP=ne(' <br class="svelte-1tymesw"/> <b class="svelte-1tymesw"> </b>',1),HP=ne("<!> <!>",1),XP=ne("<!> <!> <!> <!> <!> <!> <!> <!>",1),YP=ne("<!> <!> <!> <!>",1),zP=ne("<!> <!> <!>",1),WP=ne('<!> <button class="reset-btn svelte-1tymesw"> </button>',1),jP=ne('<div class="wrapper svelte-1tymesw"><div class="container svelte-1tymesw"><div><div class="title svelte-1tymesw"> </div> <!></div> <div class="content svelte-1tymesw"><!> <!></div></div></div>');function qP(n,e){we(e,!0);const[t,r]=Et(),i=()=>vt(St,"$i18n",t),o=(M,N=et,w=et,x=et)=>{var k=kP();const O=z=>{const ee=ue(()=>`notch-type-${w()}`);ge(z,{get id(){return b(ee)},get label(){return x()},children:(re,le)=>{var J=$P(),oe=W(J),ae=W(oe);oe.value=oe.__value=1;var de=K(oe),ie=W(de);de.value=de.__value=2;var te=K(de);{var fe=Re=>{var $e=LP(),Ve=W($e);$e.value=$e.__value=3,Ae(tt=>Ee(Ve,tt),[()=>i().t("gyroRpmFilterNotchTypeTriple")]),Z(Re,$e)};Ce(te,Re=>{_e.gte(e.FC.CONFIG.apiVersion,API_VERSION_12_8)&&Re(fe)})}Ae((Re,$e)=>{os(J,"id",`notch-type-${w()}`),J.disabled=!s().banks[b(a)][w()].enabled,Ee(ae,Re),Ee(ie,$e)},[()=>i().t("gyroRpmFilterNotchTypeSingle"),()=>i().t("gyroRpmFilterNotchTypeDouble")]),vr(J,()=>s().banks[b(a)][w()].type,Re=>s(s().banks[b(a)][w()].type=Re,!0)),Z(re,J)},$$slots:{default:!0}})},D=z=>{const ee=ue(()=>`notch-q-${w()}`);ge(z,{get id(){return b(ee)},get label(){return N()},children:(re,le)=>{const J=ue(()=>`notch-q-${w()}`),oe=ue(()=>!s().banks[b(a)][w()].enabled);Oe(re,{get id(){return b(J)},get disabled(){return b(oe)},min:"1.5",max:"10",step:"0.1",get value(){return s().banks[b(a)][w()].value},set value(ae){s(s().banks[b(a)][w()].value=ae,!0)}})},$$slots:{default:!0}})};var Y=me(k);cb(Y,()=>({"--color-switch":b(u)})),GP(Y.lastChild,{get enabled(){return s().banks[b(a)][w()].enabled},set enabled(z){s(s().banks[b(a)][w()].enabled=z,!0)},children:(z,ee)=>{var re=DP(),le=me(re);{var J=ae=>{O(ae)};Ce(le,ae=>{x()&&ae(J)})}var oe=K(le,2);D(oe),Z(z,re)},$$slots:{default:!0}}),Z(M,k)};let s=ft(e,"notches",15),l=ue(()=>_e.gte(e.FC.CONFIG.apiVersion,API_VERSION_12_8)),a=pe(0);const c=[{label:"titleRoll",color:"var(--color-roll)"},{label:"titlePitch",color:"var(--color-pitch)"},{label:"titleYaw",color:"var(--color-yaw)"}];let u=ue(()=>{if(s()?.banks.length>1)return c[b(a)].color}),p=ue(()=>{if(!s())return 0;const M=s().banks[b(a)];let N=0;for(const w of Object.values(M))w.enabled&&(N+=w.type);return N}),h=ue(()=>e.FC.MOTOR_CONFIG.main_rotor_gear_ratio[0]!=1||e.FC.MOTOR_CONFIG.main_rotor_gear_ratio[1]!=1),g=ue(()=>e.FC.MIXER_CONFIG.tail_rotor_mode>0&&(e.FC.MOTOR_CONFIG.tail_rotor_gear_ratio[0]!=1||e.FC.MOTOR_CONFIG.tail_rotor_gear_ratio[1]!=1));const f=16;var d=jP(),_=W(d),m=W(_);let C;var R=W(m),S=W(R),F=K(R,2);{var I=M=>{var N=BP();xt(N,22,()=>c,w=>w,(w,x,k)=>{var O=UP();O.__click=()=>ce(a,b(k),!0);let D,Y;var z=W(O);Ae((ee,re)=>{D=ii(O,1,"svelte-1tymesw",null,D,ee),Y=ha(O,"",Y,{background:x.color}),Ee(z,re)},[()=>({active:b(a)===b(k)}),()=>i().t(x.label)]),Z(w,O)}),Z(M,N)};Ce(F,M=>{s()&&b(l)&&M(I)})}var T=K(m,2),P=W(T);{var y=M=>{Um(M,{children:(N,w)=>{var x=VP(),k=me(x),O=K(k,3),D=W(O);Ae(Y=>{Ee(k,`${Y??""} `),Ee(D,`${b(p)??""} / 16`)},[()=>i().t("gyroRpmFilterNotchCountWarn")]),Z(N,x)},$$slots:{default:!0}})};Ce(P,M=>{b(p)>f&&M(y)})}var L=K(P,2);{var G=M=>{var N=zP(),w=me(N);{var x=D=>{Be(D,{label:"gyroRpmFilterMotorGroup",children:(Y,z)=>{var ee=HP(),re=me(ee);{var le=ae=>{o(ae,()=>"gyroRpmFilterMainMotorQ",()=>10)};Ce(re,ae=>{b(h)&&ae(le)})}var J=K(re,2);{var oe=ae=>{o(ae,()=>"gyroRpmFilterTailMotorQ",()=>20)};Ce(J,ae=>{b(g)&&ae(oe)})}Z(Y,ee)},$$slots:{default:!0}})};Ce(w,D=>{(b(h)||b(g))&&D(x)})}var k=K(w,2);Be(k,{label:"gyroRpmFilterMainRotorGroup",children:(D,Y)=>{var z=XP(),ee=me(z);o(ee,()=>"gyroRpmFilterQ1",()=>11,()=>"gyroRpmFilterH1");var re=K(ee,2);o(re,()=>"gyroRpmFilterQ2",()=>12,()=>"gyroRpmFilterH2");var le=K(re,2);o(le,()=>"gyroRpmFilterQ3",()=>13);var J=K(le,2);o(J,()=>"gyroRpmFilterQ4",()=>14);var oe=K(J,2);o(oe,()=>"gyroRpmFilterQ5",()=>15);var ae=K(oe,2);o(ae,()=>"gyroRpmFilterQ6",()=>16);var de=K(ae,2);o(de,()=>"gyroRpmFilterQ7",()=>17);var ie=K(de,2);o(ie,()=>"gyroRpmFilterQ8",()=>18),Z(D,z)},$$slots:{default:!0}});var O=K(k,2);Be(O,{label:"gyroRpmFilterTailRotorGroup",children:(D,Y)=>{var z=YP(),ee=me(z);o(ee,()=>"gyroRpmFilterQ1",()=>21,()=>"gyroRpmFilterH1");var re=K(ee,2);o(re,()=>"gyroRpmFilterQ2",()=>22,()=>"gyroRpmFilterH2");var le=K(re,2);o(le,()=>"gyroRpmFilterQ3",()=>23);var J=K(le,2);o(J,()=>"gyroRpmFilterQ4",()=>24),Z(D,z)},$$slots:{default:!0}}),Z(M,N)},U=M=>{var N=WP(),w=me(N);nf(w,{children:(O,D)=>{var Y=Ct(),z=me(Y);fi(z,()=>i().t("gyroRpmFilterCustomNote")),Z(O,Y)},$$slots:{default:!0}});var x=K(w,2);x.__click=function(...O){e.onResetNotches?.apply(this,O)};var k=W(x);Ae(O=>Ee(k,O),[()=>i().t("gyroRpmFilterNotchResetBtn")]),Z(M,N)};Ce(L,M=>{s()?M(G):M(U,!1)})}Ae(M=>{ii(m,1,Wo(["header",b(l)&&"multi-axis"]),"svelte-1tymesw"),C=ha(m,"",C,{"border-color":b(u)}),Ee(S,M)},[()=>i().t("gyroRpmFilterBanks")]),Z(n,d),Ge(),r()}pn(["click"]);var KP=ne("<!> <!> <!> <!>",1),QP=ne('<div class="svelte-gu3lip"><!></div>'),ZP=ne("<!> <!>",1);function JP(n,e){we(e,!0);let t=ft(e,"FC",15);Gt(n,{label:"gyroDynamicFilterHeading",summary:"gyroDynamicFilterHelp",children:(r,i)=>{Be(r,{children:(o,s)=>{var l=ZP(),a=me(l);ge(a,{id:"dyn-notch-enable",label:"genericEnable",children:(p,h)=>{ut(p,{id:"dyn-notch-enable",get checked(){return t().FEATURE_CONFIG.features.DYN_NOTCH},set checked(g){t(t().FEATURE_CONFIG.features.DYN_NOTCH=g,!0)}})},$$slots:{default:!0}});var c=K(a,2);{var u=p=>{var h=QP(),g=W(h);Be(g,{children:(f,d)=>{var _=KP(),m=me(_);ge(m,{id:"dyn-notch-count",label:"gyroDynamicNotchCount",tooltip:I=>{Te(I,{help:"gyroDynamicNotchCountHelp"})},children:(I,T)=>{Oe(I,{id:"dyn-notch-count",min:"0",max:"8",get value(){return t().FILTER_CONFIG.dyn_notch_count},set value(P){t(t().FILTER_CONFIG.dyn_notch_count=P,!0)}})},$$slots:{tooltip:!0,default:!0}});var C=K(m,2);ge(C,{id:"dyn-notch-q",label:"gyroDynamicNotchQ",tooltip:I=>{Te(I,{help:"gyroDynamicNotchQHelp"})},children:(I,T)=>{var P=()=>t().FILTER_CONFIG.dyn_notch_q/10,y=L=>t(t().FILTER_CONFIG.dyn_notch_q=L*10,!0);Oe(I,{id:"dyn-notch-q",min:"1",max:"10",step:"0.1",get value(){return P()},set value(L){y(L)}})},$$slots:{tooltip:!0,default:!0}});var R=K(C,2);ge(R,{id:"dyn-notch-min-hz",label:"gyroDynamicNotchMinHz",unit:"Hz",tooltip:I=>{Te(I,{help:"gyroDynamicNotchMinHzHelp"})},children:(I,T)=>{Oe(I,{id:"dyn-notch-min-hz",min:"10",max:"200",get value(){return t().FILTER_CONFIG.dyn_notch_min_hz},set value(P){t(t().FILTER_CONFIG.dyn_notch_min_hz=P,!0)}})},$$slots:{tooltip:!0,default:!0}});var S=K(R,2);ge(S,{id:"dyn-notch-max-hz",label:"gyroDynamicNotchMaxHz",unit:"Hz",tooltip:I=>{Te(I,{help:"gyroDynamicNotchMaxHzHelp"})},children:(I,T)=>{Oe(I,{id:"dyn-notch-max-hz",min:"100",max:"500",get value(){return t().FILTER_CONFIG.dyn_notch_max_hz},set value(P){t(t().FILTER_CONFIG.dyn_notch_max_hz=P,!0)}})},$$slots:{tooltip:!0,default:!0}}),Z(f,_)},$$slots:{default:!0}}),ke(3,h,()=>Ue),Z(p,h)};Ce(c,p=>{t().FEATURE_CONFIG.features.DYN_NOTCH&&p(u)})}Z(o,l)},$$slots:{default:!0}})},$$slots:{default:!0}}),Ge()}var eA=ne('<option class="svelte-gu3lip"> </option>'),tA=ne('<select id="gyro-lowpass-1-type" class="svelte-gu3lip"><!></select>'),nA=ne("<!> <!>",1),rA=ne('<div class="svelte-gu3lip"><!></div>'),iA=ne("<!> <!> <!> <!>",1),oA=ne('<div class="svelte-gu3lip"><!></div>'),sA=ne("<!> <!>",1),aA=ne('<select id="gyro-lowpass-2-type" class="svelte-gu3lip"><!></select>'),lA=ne("<!> <!>",1),cA=ne('<div class="svelte-gu3lip"><!></div>'),uA=ne("<!> <!>",1),dA=ne("<!> <!>",1);function fA(n,e){we(e,!0);const t=(f,d=et)=>{var _=Ct(),m=me(_);xt(m,17,()=>i,C=>C.id,(C,R)=>{var S=Ct(),F=me(S);{var I=T=>{var P=eA(),y=W(P),L={};Ae(()=>{Ee(y,b(R).name),L!==(L=b(R).id)&&(P.value=(P.__value=b(R).id)??"")}),Z(T,P)};Ce(F,T=>{(b(R).visible||b(R).id===d())&&T(I)})}Z(C,S)}),Z(f,_)};let r=ft(e,"FC",15);const i=[{id:0,name:"Disabled",visible:!1},{id:1,name:"1ˢᵗ order",visible:!0},{id:2,name:"2ⁿᵈ order",visible:!0},{id:3,name:"PT1",visible:!1},{id:4,name:"PT2",visible:!1},{id:5,name:"PT3",visible:!1},{id:6,name:"Order1",visible:!1},{id:7,name:"Butter",visible:!1},{id:8,name:"Bessel",visible:!1},{id:9,name:"Damped",visible:!1}],o=r().getFilterDefaults(),s={};let l=ue(()=>r().FILTER_CONFIG.gyro_lowpass_type>0),a=ue(()=>r().FILTER_CONFIG.gyro_lowpass_dyn_min_hz>0&&r().FILTER_CONFIG.gyro_lowpass_dyn_min_hz<r().FILTER_CONFIG.gyro_lowpass_dyn_max_hz),c=ue(()=>r().FILTER_CONFIG.gyro_lowpass2_type>0);function u(f){r(r().FILTER_CONFIG[f]=r().FILTER_CONFIG[f]||s[f]||o[f],!0)}function p(f){f?(u("gyro_lowpass_type"),u("gyro_lowpass_hz"),s.gyro_lowpass_dyn_enable&&(u("gyro_lowpass_dyn_min_hz"),u("gyro_lowpass_dyn_max_hz"))):(s.gyro_lowpass_type=r().FILTER_CONFIG.gyro_lowpass_type,s.gyro_lowpass_hz=r().FILTER_CONFIG.gyro_lowpass_hz,b(a)&&(s.gyro_lowpass_dyn_min_hz=r().FILTER_CONFIG.gyro_lowpass_dyn_min_hz,s.gyro_lowpass_dyn_max_hz=r().FILTER_CONFIG.gyro_lowpass_dyn_max_hz),r(r().FILTER_CONFIG.gyro_lowpass_type=0,!0),r(r().FILTER_CONFIG.gyro_lowpass_hz=0,!0),r(r().FILTER_CONFIG.gyro_lowpass_dyn_min_hz=0,!0),r(r().FILTER_CONFIG.gyro_lowpass_dyn_max_hz=0,!0))}function h(f){f?(u("gyro_lowpass_dyn_min_hz"),u("gyro_lowpass_dyn_max_hz")):(s.gyro_lowpass_dyn_min_hz=r().FILTER_CONFIG.gyro_lowpass_dyn_min_hz,s.gyro_lowpass_dyn_max_hz=r().FILTER_CONFIG.gyro_lowpass_dyn_max_hz,r(r().FILTER_CONFIG.gyro_lowpass_dyn_min_hz=0,!0),r(r().FILTER_CONFIG.gyro_lowpass_dyn_max_hz=0,!0)),s.gyro_lowpass_dyn_enable=f}function g(f){f?(u("gyro_lowpass2_type"),u("gyro_lowpass2_hz")):(s.gyro_lowpass2_type=r().FILTER_CONFIG.gyro_lowpass2_type,s.gyro_lowpass2_hz=r().FILTER_CONFIG.gyro_lowpass2_hz,r(r().FILTER_CONFIG.gyro_lowpass2_type=0,!0),r(r().FILTER_CONFIG.gyro_lowpass2_hz=0,!0))}Gt(n,{label:"gyroLowpassFilterHeading",summary:"gyroLowpassFilterHelp",children:(f,d)=>{var _=dA(),m=me(_);Be(m,{label:"gyroLowpassFilter1",children:(R,S)=>{var F=sA(),I=me(F);ge(I,{id:"lowpass-filter-1-enable",label:"genericEnable",children:(y,L)=>{var G=()=>b(l),U=p;ut(y,{id:"lowpass-filter-1-enable",get checked(){return G()},set checked(M){U(M)}})},$$slots:{default:!0}});var T=K(I,2);{var P=y=>{var L=oA(),G=W(L);Be(G,{children:(U,M)=>{var N=iA(),w=me(N);ge(w,{id:"gyro-lowpass-1-type",label:"gyroLowpassType",children:(Y,z)=>{var ee=tA(),re=W(ee);t(re,()=>r().FILTER_CONFIG.gyro_lowpass_type),vr(ee,()=>r().FILTER_CONFIG.gyro_lowpass_type,le=>r(r().FILTER_CONFIG.gyro_lowpass_type=le,!0)),Z(Y,ee)},$$slots:{default:!0}});var x=K(w,2);ge(x,{id:"gyro-lowpass-1-freq",label:"gyroLowpassFrequency",unit:"Hz",children:(Y,z)=>{Oe(Y,{id:"gyro-lowpass-1-freq",min:"0",max:"1000",get value(){return r().FILTER_CONFIG.gyro_lowpass_hz},set value(ee){r(r().FILTER_CONFIG.gyro_lowpass_hz=ee,!0)}})},$$slots:{default:!0}});var k=K(x,2);ge(k,{id:"gyro-lowpass-1-dyn",label:"gyroLowpassDynamicCutoff",children:(Y,z)=>{var ee=()=>b(a),re=h;ut(Y,{id:"gyro-lowpass-1-dyn",get checked(){return ee()},set checked(le){re(le)}})},$$slots:{default:!0}});var O=K(k,2);{var D=Y=>{var z=rA(),ee=W(z);Be(ee,{children:(re,le)=>{var J=nA(),oe=me(J);ge(oe,{id:"gyro-dyn-lowpass-min-freq",label:"gyroLowpassDynMinFrequency",unit:"Hz",children:(de,ie)=>{Oe(de,{id:"gyro-dyn-lowpass-min-freq",min:"0",max:"1000",get value(){return r().FILTER_CONFIG.gyro_lowpass_dyn_min_hz},set value(te){r(r().FILTER_CONFIG.gyro_lowpass_dyn_min_hz=te,!0)}})},$$slots:{default:!0}});var ae=K(oe,2);ge(ae,{id:"gyro-dyn-lowpass-max-freq",label:"gyroLowpassDynMaxFrequency",unit:"Hz",children:(de,ie)=>{Oe(de,{id:"gyro-dyn-lowpass-max-freq",min:"0",max:"1000",get value(){return r().FILTER_CONFIG.gyro_lowpass_dyn_max_hz},set value(te){r(r().FILTER_CONFIG.gyro_lowpass_dyn_max_hz=te,!0)}})},$$slots:{default:!0}}),Z(re,J)},$$slots:{default:!0}}),ke(3,z,()=>Ue),Z(Y,z)};Ce(O,Y=>{b(a)&&Y(D)})}Z(U,N)},$$slots:{default:!0}}),ke(3,L,()=>Ue),Z(y,L)};Ce(T,y=>{b(l)&&y(P)})}Z(R,F)},$$slots:{default:!0}});var C=K(m,2);Be(C,{label:"gyroLowpassFilter2",children:(R,S)=>{var F=uA(),I=me(F);ge(I,{id:"lowpass-filter-2-enable",label:"genericEnable",children:(y,L)=>{var G=()=>b(c),U=g;ut(y,{id:"lowpass-filter-2-enable",get checked(){return G()},set checked(M){U(M)}})},$$slots:{default:!0}});var T=K(I,2);{var P=y=>{var L=cA(),G=W(L);Be(G,{children:(U,M)=>{var N=lA(),w=me(N);ge(w,{id:"gyro-lowpass-2-type",label:"gyroLowpassType",children:(k,O)=>{var D=aA(),Y=W(D);t(Y,()=>r().FILTER_CONFIG.gyro_lowpass2_type),vr(D,()=>r().FILTER_CONFIG.gyro_lowpass2_type,z=>r(r().FILTER_CONFIG.gyro_lowpass2_type=z,!0)),Z(k,D)},$$slots:{default:!0}});var x=K(w,2);ge(x,{id:"gyro-lowpass-2-freq",label:"gyroLowpassFrequency",unit:"Hz",children:(k,O)=>{Oe(k,{id:"gyro-lowpass-2-freq",min:"0",max:"1000",get value(){return r().FILTER_CONFIG.gyro_lowpass2_hz},set value(D){r(r().FILTER_CONFIG.gyro_lowpass2_hz=D,!0)}})},$$slots:{default:!0}}),Z(U,N)},$$slots:{default:!0}}),ke(3,L,()=>Ue),Z(y,L)};Ce(T,y=>{b(c)&&y(P)})}Z(R,F)},$$slots:{default:!0}}),Z(f,_)},$$slots:{default:!0}}),Ge()}var _A=ne('<option class="svelte-fdi15x"> </option>'),pA=ne('<select id="rpm-filter-preset" class="svelte-fdi15x"></select>'),hA=ne("<!> <!>",1),gA=ne('<div class="svelte-fdi15x"><!></div>'),mA=ne("<!> <!>",1),CA=ne("<!> <!>",1),vA=ne('<div class="svelte-fdi15x"><!></div>'),EA=ne('<div class="warning-container svelte-fdi15x"><!></div> <!> <!>',1);function SA(n,e){we(e,!0);const[t,r]=Et(),i=()=>vt(St,"$i18n",t),o=["gyroRpmFilterPresetCustom","gyroRpmFilterPresetLow","gyroRpmFilterPresetMedium","gyroRpmFilterPresetHigh"];let s=ft(e,"FC",15),l=ft(e,"notches",15),a=ue(()=>s().FEATURE_CONFIG.features.RPM_FILTER),c=ue(()=>_e.gte(s().CONFIG.apiVersion,API_VERSION_12_8));Gt(n,{label:"gyroRpmFilterSettings",summary:"gyroRpmFilterHelp",children:(u,p)=>{var h=EA(),g=me(h),f=W(g);nf(f,{message:"gyroRpmFilterConfigNote"});var d=K(g,2);Be(d,{children:(C,R)=>{var S=mA(),F=me(S);ge(F,{id:"rpm-filter-enable",label:"genericEnable",children:(P,y)=>{ut(P,{id:"rpm-filter-enable",get checked(){return s().FEATURE_CONFIG.features.RPM_FILTER},set checked(L){s(s().FEATURE_CONFIG.features.RPM_FILTER=L,!0)}})},$$slots:{default:!0}});var I=K(F,2);{var T=P=>{var y=gA(),L=W(y);Be(L,{children:(G,U)=>{var M=hA(),N=me(M);ge(N,{id:"rpm-filter-preset",label:"gyroRpmFilterPreset",tooltip:k=>{const O=ue(()=>[{name:"genericDefault",value:i().t("gyroRpmFilterPresetMedium")}]);Te(k,{help:"gyroRpmFilterPresetHelp",get attrs(){return b(O)}})},children:(k,O)=>{var D=pA();xt(D,22,()=>o,Y=>Y,(Y,z,ee)=>{var re=_A(),le=W(re),J={};Ae(oe=>{Ee(le,oe),J!==(J=b(ee))&&(re.value=(re.__value=b(ee))??"")},[()=>i().t(z)]),Z(Y,re)}),vr(D,()=>s().FILTER_CONFIG.rpm_preset,Y=>s(s().FILTER_CONFIG.rpm_preset=Y,!0)),Z(k,D)},$$slots:{tooltip:!0,default:!0}});var w=K(N,2);ge(w,{id:"rpm-filter-min-freq",label:"gyroRpmFilterMinFreq",unit:"Hz",tooltip:k=>{Te(k,{help:"gyroRpmFilterMinFreqHelp",attrs:[{name:"genericDefault",value:"20Hz"}]})},children:(k,O)=>{Oe(k,{id:"rpm-filter-min-freq",min:"1",max:"100",get value(){return s().FILTER_CONFIG.rpm_min_hz},set value(D){s(s().FILTER_CONFIG.rpm_min_hz=D,!0)}})},$$slots:{tooltip:!0,default:!0}}),Z(G,M)},$$slots:{default:!0}}),ke(3,y,()=>Ue),Z(P,y)};Ce(I,P=>{b(a)&&b(c)&&P(T)})}Z(C,S)},$$slots:{default:!0}});var _=K(d,2);{var m=C=>{var R=vA(),S=W(R);Be(S,{label:"gyroRpmFilterMinRPMGroup",children:(F,I)=>{var T=CA(),P=me(T);ge(P,{id:"rpm-filter-rpm-limit-main",label:"gyroRpmFilterMainRotorMinRPM",tooltip:G=>{Te(G,{help:"gyroRpmFilterMinRPMGroupHelp",attrs:[{name:"genericDefault",value:"1000 RPM"}]})},children:(G,U)=>{Oe(G,{id:"rpm-filter-rpm-limit-main",min:"0",max:"10000",get value(){return l().rpmLimitMain},set value(M){l(l().rpmLimitMain=M,!0)}})},$$slots:{tooltip:!0,default:!0}});var y=K(P,2);ge(y,{id:"rpm-filter-rpm-limit-tail",label:"gyroRpmFilterTailRotorMinRPM",tooltip:G=>{Te(G,{help:"gyroRpmFilterMinRPMGroupHelp",attrs:[{name:"genericDefault",value:"2000 RPM"}]})},children:(G,U)=>{Oe(G,{id:"rpm-filter-rpm-limit-tail",min:"0",max:"10000",get value(){return l().rpmLimitTail},set value(M){l(l().rpmLimitTail=M,!0)}})},$$slots:{tooltip:!0,default:!0}}),Z(F,T)},$$slots:{default:!0}}),ke(3,R,()=>Ue),Z(C,R)};Ce(_,C=>{b(a)&&!b(c)&&C(m)})}Z(u,h)},$$slots:{default:!0}}),Ge(),r()}var RA=ne("<!> <!>",1),FA=ne('<div class="svelte-gu3lip"><!></div>'),IA=ne("<!> <!>",1),bA=ne("<!> <!>",1),TA=ne('<div class="svelte-gu3lip"><!></div>'),OA=ne("<!> <!>",1),PA=ne("<!> <!>",1);function AA(n,e){we(e,!0);let t=ft(e,"FC",15);const r=t().getFilterDefaults(),i={};let o=ue(()=>t().FILTER_CONFIG.gyro_notch_hz>0&&t().FILTER_CONFIG.gyro_notch_cutoff>0),s=ue(()=>t().FILTER_CONFIG.gyro_notch2_hz>0&&t().FILTER_CONFIG.gyro_notch2_cutoff>0);function l(u){t(t().FILTER_CONFIG[u]=t().FILTER_CONFIG[u]||i[u]||r[u],!0)}function a(u){u?(l("gyro_notch_hz"),l("gyro_notch_cutoff")):(i.gyro_notch_hz=t().FILTER_CONFIG.gyro_notch_hz,i.gyro_notch_cutoff=t().FILTER_CONFIG.gyro_notch_cutoff,t(t().FILTER_CONFIG.gyro_notch_hz=0,!0),t(t().FILTER_CONFIG.gyro_notch_cutoff=0,!0))}function c(u){u?(l("gyro_notch2_hz"),l("gyro_notch2_cutoff")):(i.gyro_notch2_hz=t().FILTER_CONFIG.gyro_notch2_hz,i.gyro_notch2_cutoff=t().FILTER_CONFIG.gyro_notch2_cutoff,t(t().FILTER_CONFIG.gyro_notch2_hz=0,!0),t(t().FILTER_CONFIG.gyro_notch2_cutoff=0,!0))}Gt(n,{label:"gyroNotchFilterHeading",summary:"gyroNotchFilterHelp",children:(u,p)=>{var h=PA(),g=me(h);Be(g,{label:"gyroNotchFilter1",children:(d,_)=>{var m=IA(),C=me(m);ge(C,{id:"notch-filter-1-enable",label:"genericEnable",children:(F,I)=>{var T=()=>b(o),P=a;ut(F,{id:"notch-filter-1-enable",get checked(){return T()},set checked(y){P(y)}})},$$slots:{default:!0}});var R=K(C,2);{var S=F=>{var I=FA(),T=W(I);Be(T,{children:(P,y)=>{var L=RA(),G=me(L);ge(G,{id:"notch-filter-1-center",label:"gyroNotchFilterFrequency",unit:"Hz",children:(M,N)=>{Oe(M,{id:"notch-filter-1-center",min:"0",max:"1000",get value(){return t().FILTER_CONFIG.gyro_notch_hz},set value(w){t(t().FILTER_CONFIG.gyro_notch_hz=w,!0)}})},$$slots:{default:!0}});var U=K(G,2);ge(U,{id:"notch-filter-1-cutoff",label:"gyroNotchFilterCutoff",unit:"Hz",children:(M,N)=>{Oe(M,{id:"notch-filter-1-cutoff",min:"0",max:"1000",get value(){return t().FILTER_CONFIG.gyro_notch_cutoff},set value(w){t(t().FILTER_CONFIG.gyro_notch_cutoff=w,!0)}})},$$slots:{default:!0}}),Z(P,L)},$$slots:{default:!0}}),ke(3,I,()=>Ue),Z(F,I)};Ce(R,F=>{b(o)&&F(S)})}Z(d,m)},$$slots:{default:!0}});var f=K(g,2);Be(f,{label:"gyroNotchFilter2",children:(d,_)=>{var m=OA(),C=me(m);ge(C,{id:"notch-filter-2-enable",label:"genericEnable",children:(F,I)=>{var T=()=>b(s),P=c;ut(F,{id:"notch-filter-2-enable",get checked(){return T()},set checked(y){P(y)}})},$$slots:{default:!0}});var R=K(C,2);{var S=F=>{var I=TA(),T=W(I);Be(T,{children:(P,y)=>{var L=bA(),G=me(L);ge(G,{id:"notch-filter-2-center",label:"gyroNotchFilterFrequency",unit:"Hz",children:(M,N)=>{Oe(M,{id:"notch-filter-2-center",min:"0",max:"1000",get value(){return t().FILTER_CONFIG.gyro_notch2_hz},set value(w){t(t().FILTER_CONFIG.gyro_notch2_hz=w,!0)}})},$$slots:{default:!0}});var U=K(G,2);ge(U,{id:"notch-filter-2-cutoff",label:"gyroNotchFilterCutoff",unit:"Hz",children:(M,N)=>{Oe(M,{id:"notch-filter-2-cutoff",min:"0",max:"1000",get value(){return t().FILTER_CONFIG.gyro_notch2_cutoff},set value(w){t(t().FILTER_CONFIG.gyro_notch2_cutoff=w,!0)}})},$$slots:{default:!0}}),Z(P,L)},$$slots:{default:!0}}),ke(3,I,()=>Ue),Z(F,I)};Ce(R,F=>{b(s)&&F(S)})}Z(d,m)},$$slots:{default:!0}}),Z(u,h)},$$slots:{default:!0}}),Ge()}const rf=[10,11,12,13,14,15,16,17,18],Bm=[20,21,22,23,24],Ta=[...rf,...Bm],Vm=[11,12,21,22],Hm=2.5,Oa=16,of=1,MA=2,Xm=15,Ym=100,In={SINGLE:1,DOUBLE:2,TRIPLE:3};function zm(n){return Math.trunc(100*of/n)}function Wm(n){return Math.trunc(100*MA/n)}function NA(n){if(!Array.isArray(n))return null;const e={};let t,r;for(let i=0;i<n.length;i++){const o=n[i];if(o.rpm_source===0)continue;if(e[o.rpm_source]||!Ta.includes(o.rpm_source)||o.notch_q<Xm||o.notch_q>Ym)return null;if(rf.includes(o.rpm_source)){if(!t)t=o.rpm_limit;else if(t!==o.rpm_limit)return null}else if(Bm.includes(o.rpm_source)){if(!r)r=o.rpm_limit;else if(r!==o.rpm_limit)return null}if(o.rpm_ratio===1e4){e[o.rpm_source]={enabled:!0,type:In.SINGLE,value:o.notch_q/10};continue}if(!Vm.includes(o.rpm_source))return null;const s=n[i+1];if(!s||s.rpm_source!==o.rpm_source||s.notch_q!==o.notch_q)return null;const l=Math.round(of*1e3/o.notch_q);if(o.rpm_ratio!==1e4-l||s.rpm_ratio!==1e4+l)return null;e[o.rpm_source]={enabled:!0,type:In.DOUBLE,value:o.notch_q/10},i++}t||(t=1e3),r||(r=2e3);for(const i of Ta)e[i]||(e[i]={enabled:!1,type:In.SINGLE,value:Hm});return{banks:[e],rpmLimitMain:t,rpmLimitTail:r}}function xA(n){const e=[];for(const t of Object.entries(n.banks[0])){const r=Number(t[0]),i=t[1];if(!i.enabled)continue;const o=rf.includes(r)?n.rpmLimitMain:n.rpmLimitTail;switch(i.type){case In.SINGLE:{e.push({rpm_source:r,rpm_ratio:1e4,rpm_limit:o,notch_q:i.value*10});break}case In.DOUBLE:{const s=Math.round(of*100/i.value);e.push({rpm_source:r,rpm_ratio:1e4-s,rpm_limit:o,notch_q:i.value*10},{rpm_source:r,rpm_ratio:1e4+s,rpm_limit:o,notch_q:i.value*10});break}}}for(let t=e.length;t<Oa;t++)e.push({rpm_source:0,rpm_ratio:0,rpm_limit:0,notch_q:0});return e}function yA(n){if(!Array.isArray(n)||n.length!==3)return null;const e=[{},{},{}];for(let t=0;t<n.length;t++){const r=n[t];for(let i=0;i<r.length;i++){const o=r[i];if(o.rpm_source!==0){if(e[t][o.rpm_source]||!Ta.includes(o.rpm_source)||o.notch_q<Xm||o.notch_q>Ym)return null;if(o.notch_center===0){let s=In.SINGLE;const l=r[i+1],a=r[i+2],c=Wm(o.notch_q/10);l&&a&&l.rpm_source===o.rpm_source&&l.notch_q===o.notch_q&&l.notch_center===-c&&a.rpm_source===o.rpm_source&&a.notch_q===o.notch_q&&a.notch_center===c&&(s=In.TRIPLE,i+=2),e[t][o.rpm_source]={enabled:!0,type:s,value:o.notch_q/10};continue}if(Vm.includes(o.rpm_source)&&o.notch_center===zm(o.notch_q/10)){const s=r[i+1];if(!s||s.rpm_source!==o.rpm_source||s.notch_q!==o.notch_q||s.notch_center!==-o.notch_center)return null;e[t][o.rpm_source]={enabled:!0,type:In.DOUBLE,value:o.notch_q/10},i++;continue}return null}}for(const i of Ta)e[t][i]||(e[t][i]={enabled:!1,type:In.SINGLE,value:Hm})}return{banks:e}}function wA(n){const e=[];for(const t of n.banks){const r=[];for(const[i,o]of Object.entries(t))if(o.enabled)switch(o.type){case In.SINGLE:{r.push({rpm_source:Number(i),notch_q:o.value*10,notch_center:0});break}case In.DOUBLE:{const s=zm(o.value);r.push({rpm_source:Number(i),notch_q:o.value*10,notch_center:s},{rpm_source:Number(i),notch_q:o.value*10,notch_center:-s});break}case In.TRIPLE:{const s=Wm(o.value);r.push({rpm_source:Number(i),notch_q:o.value*10,notch_center:0},{rpm_source:Number(i),notch_q:o.value*10,notch_center:-s},{rpm_source:Number(i),notch_q:o.value*10,notch_center:s});break}}for(let i=r.length;i<Oa;i++)r.push({rpm_source:0,notch_q:0,notch_center:0});e.push(r)}return e}function GA(){window.open(em("tabGyro"),"_system")}var LA=ne('<h1 class="svelte-1xo14v7"> </h1> <div class="grow svelte-1xo14v7"></div> <button class="help-btn svelte-1xo14v7">Help</button>',1),$A=ne('<button class="svelte-1xo14v7"> </button> <button class="svelte-1xo14v7"> </button>',1),DA=ne('<div class="svelte-1xo14v7"><!></div>'),kA=ne('<div class="content svelte-1xo14v7"><div class="svelte-1xo14v7"><!> <!> <!></div> <div class="svelte-1xo14v7"><!> <!></div></div>');function UA(n,e){we(e,!0);const[t,r]=Et(),i=()=>vt(St,"$i18n",t),o=T=>{var P=LA(),y=me(P),L=W(y),G=K(y,4);G.__click=[GA],Ae(U=>Ee(L,U),[()=>i().t("tabGyro")]),Z(T,P)},s=T=>{var P=$A(),y=me(P);y.__click=C;var L=W(y),G=K(y,2);G.__click=m;var U=W(G);Ae((M,N)=>{Ee(L,M),G.disabled=b(h),Ee(U,N)},[()=>i().t("buttonRevert"),()=>i().t("buttonSaveReboot")]),Z(T,P)};let l=pe(!0),a;function c(){return Qn({RPM_FILTER_CONFIG:V.RPM_FILTER_CONFIG,RPM_FILTER_CONFIG_V2:V.RPM_FILTER_CONFIG_V2,FILTER_CONFIG:V.FILTER_CONFIG,features:V.FEATURE_CONFIG.features.bitfield})}let u=ue(()=>a?cs(a,c()):[]),p=ue(()=>!b(l)&&b(u).length>0),h=ue(()=>{if(V.RPM_FILTER_CONFIG.length>Oa)return!0;for(const T of V.RPM_FILTER_CONFIG_V2)if(T.length>Oa)return!0;return!1}),g=pe(null),f=ue(()=>V.FEATURE_CONFIG.features.RPM_FILTER),d=ue(()=>_e.gte(V.CONFIG.apiVersion,API_VERSION_12_8)?b(f)&&V.FILTER_CONFIG.rpm_preset===0:b(f));function _(){_e.gte(V.CONFIG.apiVersion,API_VERSION_12_8)?ce(g,yA(Qn(V.RPM_FILTER_CONFIG_V2)),!0):ce(g,NA(Qn(V.RPM_FILTER_CONFIG)),!0)}di(async()=>{await MSP.promise(MSPCodes.MSP_STATUS),await MSP.promise(MSPCodes.MSP_FEATURE_CONFIG),await MSP.promise(MSPCodes.MSP_FILTER_CONFIG),await MSP.promise(MSPCodes.MSP_MOTOR_CONFIG),await MSP.promise(MSPCodes.MSP_MIXER_CONFIG),_e.gte(V.CONFIG.apiVersion,API_VERSION_12_8)?await mspHelper.requestRpmFilterBanks():await MSP.promise(MSPCodes.MSP_RPM_FILTER),_(),a=c(),ce(l,!1)});async function m(){await MSP.promise(MSPCodes.MSP_SET_FEATURE_CONFIG,mspHelper.crunch(MSPCodes.MSP_SET_FEATURE_CONFIG)),await MSP.promise(MSPCodes.MSP_SET_FILTER_CONFIG,mspHelper.crunch(MSPCodes.MSP_SET_FILTER_CONFIG)),_e.gte(V.CONFIG.apiVersion,API_VERSION_12_8)?await mspHelper.sendRPMFiltersV2():await mspHelper.sendRPMFilters(),await MSP.promise(MSPCodes.MSP_EEPROM_WRITE),GUI.log(i().t("eepromSaved")),MSP.send_message(MSPCodes.MSP_SET_REBOOT),GUI.log(i().t("deviceRebooting")),reinitialiseConnection()}bn(()=>{if(b(g))if(_e.gte(V.CONFIG.apiVersion,API_VERSION_12_8)){const T=wA(b(g));V.RPM_FILTER_CONFIG_V2=T}else{const T=xA(b(g));V.RPM_FILTER_CONFIG=T}});function C(){Object.assign(V.RPM_FILTER_CONFIG,a.RPM_FILTER_CONFIG),Object.assign(V.RPM_FILTER_CONFIG_V2,a.RPM_FILTER_CONFIG_V2),Object.assign(V.FILTER_CONFIG,a.FILTER_CONFIG),V.FEATURE_CONFIG.features.bitfield=a.features,_()}function R(){V.RPM_FILTER_CONFIG=[],V.RPM_FILTER_CONFIG_V2=[[],[],[]],_()}function S(){return b(u).length>0}const F=ue(()=>b(p)&&s);zd(n,{get header(){return o},get loading(){return b(l)},get toolbar(){return b(F)},children:(T,P)=>{var y=kA(),L=W(y),G=W(L);fA(G,{get FC(){return V}});var U=K(G,2);AA(U,{get FC(){return V}});var M=K(U,2);JP(M,{get FC(){return V}});var N=K(L,2),w=W(N);SA(w,{get FC(){return V},get notches(){return b(g)}});var x=K(w,2);{var k=O=>{var D=DA(),Y=W(D);qP(Y,{get FC(){return V},get notches(){return b(g)},onResetNotches:R}),ke(3,D,()=>Ue),Z(O,D)};Ce(x,O=>{b(d)&&O(k)})}Z(T,y)},$$slots:{default:!0}});var I=Ge({onSave:m,onRevert:C,isDirty:S});return r(),I}pn(["click"]);const Gh={tabName:"gyro",svelteComponent:null,get isDirty(){return this.svelteComponent?.isDirty()},initialize(n){const e=document.querySelector("#content");e.innerHTML="",this.svelteComponent=Rr(UA,{target:e}),GUI.content_ready(n)},cleanup(n){this.svelteComponent&&(ni(this.svelteComponent),this.svelteComponent=null),n?.()},save(n){this.svelteComponent?this.svelteComponent.onSave().finally(n):n?.()},revert(n){this.svelteComponent?.onRevert(),n?.()}};TABS[Gh.tabName]=Gh;const Pa={tabName:"help"};Pa.initialize=function(n){$("#content").load("/src/tabs/help.html",function(){i18n.localizePage(),GUI.content_ready(n)})};Pa.cleanup=function(n){n?.()};TABS[Pa.tabName]=Pa;const Aa={tabName:"landing"};Aa.initialize=function(n){$("#content").load("/src/tabs/landing.html",function(){function e(i){t=$(".languageSwitcher"),t.find("a").each(function(){const o=$(this),s=o.attr("lang");i==s?(o.removeClass("selected_language"),o.addClass("selected_language")):o.removeClass("selected_language")})}let t=$(".languageSwitcher");t.html(' <span i18n="language_choice_message"></span>'),t.append(' <a href="#" i18n="language_default_pretty" lang="DEFAULT"></a>'),i18n.getLanguagesAvailables().forEach(function(i){t.append(' <a href="#" lang="'+i+'" i18n="language_'+i+'"></a>')}),t.find("a").each(function(){let i=$(this);i.click(function(){i=$(this);const o=i.attr("lang");o&&i18n.selectedLanguage!=o&&(i18n.changeLanguage(o),e(o))})}),e(i18n.selectedLanguage),i18n.localizePage(),GUI.content_ready(n)})};Aa.cleanup=function(n){n?.()};TABS[Aa.tabName]=Aa;const Ma={tabName:"led_strip",isDirty:!1,wireMode:!1,directions:["n","e","s","w","u","d"]};Ma.initialize=function(n){const e=this;t(i);function t(x){Promise.resolve(!0).then(()=>MSP.promise(MSPCodes.MSP_STATUS)).then(()=>MSP.promise(MSPCodes.MSP_LED_STRIP_CONFIG)).then(()=>MSP.promise(MSPCodes.MSP_LED_STRIP_MODECOLOR)).then(()=>MSP.promise(MSPCodes.MSP_LED_COLORS)).then(()=>MSP.promise(MSPCodes.MSP_LED_STRIP_SETTINGS)).then(x)}function r(x){mspHelper.sendLedStripConfig(()=>mspHelper.sendLedStripColors(()=>mspHelper.sendLedStripModeColors(()=>mspHelper.sendLedStripSettings(()=>MSP.send_message(MSPCodes.MSP_EEPROM_WRITE,!1,!1,()=>{GUI.log(i18n.getMessage("eepromSaved")),x?.()})))))}function i(){$("#content").load("/src/tabs/led_strip.html",c)}e.wireMode=!1;let o=null,s=null;const l=".function-";e.functions=["i","w","f","a","t","r","c","g","s","b","l","o","n"],e.baseFuncs=["c","f","a","l","s","g","r"],e.overlays=["t","o","b","v","i","w","k","d"];function a(){const x=[];return $(".mainGrid .gPoint .wire").each(function(){const k=parseInt($(this).html());k>=0&&x.push(k)}),x.sort(function(k,O){return k-O}),x}function c(){i18n.localizePage(),$(".tab-led-strip").addClass("toolbar_hidden"),e.isDirty=!1;function x(){e.isDirty||(e.isDirty=!0,$(".tab-led-strip").removeClass("toolbar_hidden"))}$(':input[type="number"]').change(function(){var J=parseInt($(this).attr("max")),oe=parseInt($(this).attr("min"));$(this).val()>J?$(this).val(J):$(this).val()<oe&&$(this).val(oe)});const k=[];let O=0;for(let J=0;J<256;J++)k[O++]='<div class="gPoint"><div class="indicators"><span class="north"></span><span class="south"></span><span class="west"></span><span class="east"></span><span class="up">U</span><span class="down">D</span></div><span class="wire"></span><span class="overlay-t"> </span><span class="overlay-o"> </span><span class="overlay-b"> </span><span class="overlay-v"> </span><span class="overlay-i"> </span><span class="overlay-w"> </span><span class="overlay-color"> </span></div>';$(".mainGrid").html(k.join("")),$(".tempOutput").click(function(){$(this).select()}),$(".auxSelect").show(),$(".labelSelect").hide();const D=7,Y=0;$(".auxSelect").val(M(D,Y)),$(".auxSelect").on("change",function(){N(D,Y,$(".auxSelect").val())}),$(".landingBlinkOverlay").css("visibility","hidden"),$(".vtxOverlay").show(),$(".funcClear").click(function(){$(".gPoint").each(function(){$(this).is(".ui-selected")&&(z(this),$(this).find(".wire").html(""))}),$(".controls button").removeClass("btnOn"),g(),x()}),$(".funcClearAll").click(function(){$(".gPoint").each(function(){z(this)}),$(".gPoint .wire").html(""),$(".controls button").removeClass("btnOn"),g(),x()});function z(J){const oe=[];e.baseFuncs.forEach(function(ae){oe.push("function-"+ae)}),e.overlays.forEach(function(ae){oe.push("function-"+ae)}),e.directions.forEach(function(ae){oe.push("dir-"+ae)}),$(J).removeClass(oe.join(" "))}$(".directions").on("click","button",function(){const J=this;$(".ui-selected").length>0&&(e.directions.forEach(function(oe){$(J).is(".dir-"+oe)&&($(J).is(".btnOn")?($(J).removeClass("btnOn"),$(".ui-selected").removeClass("dir-"+oe)):($(J).addClass("btnOn"),$(".ui-selected").addClass("dir-"+oe)))}),w(),g())}),$(".mode_colors").on("click","button",function(){const J=this;FC.LED_MODE_COLORS.forEach(function(oe){if($(J).is(".mode_color-"+oe.mode+"-"+oe.direction))if($(J).is(".btnOn"))$(J).removeClass("btnOn"),$(".ui-selected").removeClass("mode_color-"+oe.mode+"-"+oe.direction),s=null;else{$(J).addClass("btnOn"),s={mode:oe.mode,direction:oe.direction};for(let ae=0;ae<16;ae++){const de=".color-"+ae;ae==M(oe.mode,oe.direction)?($(de).addClass("btnOn"),o=ae,G(ae)):$(de).removeClass("btnOn")}}}),$(".mode_colors").each(function(){$(this).children().each(function(){$(this).is($(J))||$(this).is(".btnOn")&&$(this).removeClass("btnOn")})}),g()});const ee=$("div.colorDefineSliders input");ee.eq(0).on("input change",function(){y($(this).val(),0)}),ee.eq(1).on("input change",function(){y($(this).val(),1)}),ee.eq(2).on("input change",function(){y($(this).val(),2)});for(let J=0;J<3;J++)y(ee.eq(J).val(),J);const re=$(".colorDefineSliders");$(".colors").on("click","button",function(){const J=this,oe=$(this).parent().find("button");for(let ae=0;ae<16;ae++)oe.removeClass("btnOn"),s==null&&$(".ui-selected").removeClass("color-"+ae),$(J).is(".color-"+ae)&&(o=ae,s==null&&$(".ui-selected").addClass("color-"+ae));G(o),$(this).addClass("btnOn"),s&&N(s.mode,s.direction,o),L(),$(".colors").children().each(function(){d($(this))}),$(".overlay-color").each(function(){d($(this))}),$(".mode_colors").each(function(){f($(this))}),$(".special_colors").each(function(){f($(this))}),g(),mspHelper.sendLedStripConfig()}),$(".colors").on("contextmenu","button",function(){if(s)return;const J=this;$(this).parent().find("button").removeClass("btnAltOn");for(let ae=0;ae<16;ae++)$(".ui-selected").removeClass("altcolor-"+ae),$(J).is(".color-"+ae)&&(o=ae,$(".ui-selected").addClass("altcolor-"+ae));return $(this).addClass("btnAltOn"),g(),mspHelper.sendLedStripConfig(),!1}),$(".colors").on("dblclick","button",function(){const J=$(this).position(),oe=re.width(),ae=$(this).width();$(this).offset().left+oe/2+ae+14>$(window).width()?(re.css("left","auto"),re.css("right",0)):(re.css("left",J.left-oe/2+ae),re.css("right","auto")),re.css("top",J.top+26),re.show()}),$(".colors").children().on({mouseleave:function(){re.is(":hover")||re.hide()}}),$(".funcWire").click(function(){$(this).toggleClass("btnOn"),e.wireMode=$(this).hasClass("btnOn"),$(".mainGrid").toggleClass("gridWire")}),$(".funcWireClearSelect").click(function(){$(".ui-selected").each(function(){const J=$(this).find(".wire");J.html()!==""&&J.html(""),g()}),x()}),$(".funcWireClear").click(function(){$(".gPoint .wire").html(""),g(),x()}),$(".mainGrid").selectable({filter:" > div",stop:function(){const J=[];w();let oe;$(".ui-selected").each(function(){const de=a();let ie=0;for(;ie<de.length&&de[ie]==ie;ie++);e.wireMode&&$(this).find(".wire").html()==""&&ie<FC.LED_STRIP.length&&$(this).find(".wire").html(ie),$(this).find(".wire").text()!=""&&(oe=this,e.directions.forEach(function(te){const fe=".dir-"+te;$(oe).is(fe)&&J.push(fe)}),e.baseFuncs.forEach(function(te){const fe=".function-"+te;$(oe).is(fe)}),e.overlays.forEach(function(te){const fe=".function-"+te;$(oe).is(fe)}))});const ae=oe;if($("select.functionSelect").val(""),e.baseFuncs.forEach(function(de){const ie="function-"+de;$("select.functionSelect").is("."+ie)&&$("select.functionSelect").removeClass(ie)}),o=0,ae){for(let fe=0;fe<16;fe++){const Re=".color-"+fe;$(ae).is(Re)?($(Re).addClass("btnOn"),o=fe):$(Re).removeClass("btnOn");const $e=".altcolor-"+fe;$(ae).is($e)?$(Re).addClass("btnAltOn"):$(Re).removeClass("btnAltOn")}e.overlays.forEach(function(fe){const Re=$(".checkbox").find(`input.function-${fe}`),$e=$(ae).is(l+fe);Re.is(":checked")!==$e&&(Re.prop("checked",$e),Re.change())}),e.baseFuncs.forEach(function(fe){$(ae).is(l+fe)&&($("select.functionSelect").val("function-"+fe),$("select.functionSelect").addClass("function-"+fe))});const de=$(ae).attr("class").split(" ").filter(fe=>fe.startsWith("blinkpattern-"));if(de.length>0){const fe=de[0].replace("blinkpattern-","");for(let Re=0;Re<16;++Re){const $e=fe&1<<Re;$(`#blinkbit-${Re}`).prop("checked",$e)}}const ie=$(".checkbox").find("input.function-b").is(":checked");$("#blinkbits").toggle(ie);const te=$(ae).attr("class").split(" ").filter(fe=>fe.startsWith("blinkpause-"));if(te.length>0){const fe=te[0].replace("blinkpause-","");$("#blinkPause").val(fe)}}g(),G(o),F(),$(".directions button").removeClass("btnOn"),J.forEach(function(de){$(de).addClass("btnOn")})}}),$(".functionSelect").on("change",function(){w(),I(),L(),F(),g(),mspHelper.sendLedStripConfig()}),$(".modeSelect").on("change",function(){const J=this,oe=Number($(J).val());$(".mode_colors").find("button").each(function(){for(let ae=0;ae<6;ae++)for(let de=0;de<6;de++)$(this).hasClass("mode_color-"+ae+"-"+de)&&($(this).removeClass("mode_color-"+ae+"-"+de),$(this).addClass("mode_color-"+oe+"-"+de))}),$(".mode_colors").each(function(){f($(this))})});function le(J,oe){return $(J).first().is(":checked")?$(".ui-selected").find(".wire").each(function(){if($(this).text()!=""){const ae=$(this).parent();e.functions.forEach(function(de){if(ae.is(l+de))switch(oe){case"t":case"o":case"s":_("function-"+de)&&ae.addClass("function-"+oe);break;case"b":case"n":C("function-"+de)&&ae.addClass("function-"+oe);break;case"i":case"k":case"d":m("function-"+de)&&ae.addClass("function-"+oe);break;case"w":m("function-"+de)&&R("function-"+de)&&ae.addClass("function-"+oe);break;case"v":m("function-"+de)&&S("function-"+de)&&ae.addClass("function-"+oe);break}})}}):$(".ui-selected").removeClass("function-"+oe),$(J).is(":checked")}if($(".checkbox").change(function(J){if(J.originalEvent){const oe=$(this).find("input");$(".ui-selected").length>0&&(e.overlays.forEach(function(ae){if($(oe).is(l+ae)){const de=le(oe,ae),ie=$(".checkbox .function-n"),te=$(".checkbox .function-b");de&&(ae=="b"&&ie.is(":checked")?(ie.prop("checked",!1),ie.change(),le(ie,"n")):ae=="n"&&te.is(":checked")&&(te.prop("checked",!1),te.change(),le(te,"b"))),ae==="b"&&$("#blinkbits").toggle(te.is(":checked"))}}),w(),g(),F(),mspHelper.sendLedStripConfig())}}),$(".blinkbit").change(function(J){if(J.originalEvent&&$(".ui-selected").length>0){let oe=$(".ui-selected").attr("class").split(" ").filter(ae=>ae.startsWith("blinkpattern-"));if(oe.length>0){$(".ui-selected").removeClass(oe);let ae=oe[0].replace("blinkpattern-","");const ie=1<<$(this).attr("id").replace("blinkbit-","");ae^=ie,oe=`blinkpattern-${ae}`,$(".ui-selected").addClass(oe),g(),mspHelper.sendLedStripConfig()}}}),$("#blinkPause").change(function(J){if(J.originalEvent&&$(".ui-selected").length>0){let oe=$(".ui-selected").attr("class").split(" ").filter(ae=>ae.startsWith("blinkpause-"));oe.length>0&&($(".ui-selected").removeClass(oe),oe=`blinkpause-${$(this).val()}`,$(".ui-selected").addClass(oe),g(),mspHelper.sendLedStripConfig())}}),$("#ledStripProfile").val(FC.LED_STRIP_CONFIG.ledstrip_profile),$("#ledStripProfile").change(function(){FC.LED_STRIP_CONFIG.ledstrip_profile=$("#ledStripProfile").val(),mspHelper.sendLedStripSettings()}),$("#globalBlinkRate").val(p(FC.LED_STRIP_CONFIG.ledstrip_blink_period_ms)),$("#globalBlinkRate").change(function(){FC.LED_STRIP_CONFIG.ledstrip_blink_period_ms=u($("#globalBlinkRate").val()),mspHelper.sendLedStripSettings()}),$("#globalFlickerRate").val(FC.LED_STRIP_CONFIG.ledstrip_flicker_rate),$("#globalFlickerRate").change(function(){FC.LED_STRIP_CONFIG.ledstrip_flicker_rate=$("#globalFlickerRate").val(),mspHelper.sendLedStripSettings()}),$("#globalFadeRate").val(FC.LED_STRIP_CONFIG.ledstrip_fade_rate),$("#globalFadeRate").change(function(){FC.LED_STRIP_CONFIG.ledstrip_fade_rate=$("#globalFadeRate").val(),mspHelper.sendLedStripSettings()}),$("#globalBrightness").val(FC.LED_STRIP_CONFIG.ledstrip_brightness),$("#globalBrightness").change(function(){FC.LED_STRIP_CONFIG.ledstrip_brightness=$("#globalBrightness").val(),mspHelper.sendLedStripSettings()}),$(".mainGrid").disableSelection(),$(".gPoint").each(function(){const J=$(this).index()+1,oe=Math.ceil(J/16)-1;let ae=J/16%1*16-1;ae<0&&(ae=15);const de=h(ae,oe);if(!de)return;const ie=de.index,te=de.led;if(!(te.functions[0]=="c"&&te.functions.length==1&&te.directions.length==0&&te.color==0&&te.x==0&&te.y==0)){$(this).find(".wire").html(ie);for(let fe=0;fe<te.functions.length;fe++)$(this).addClass(`function-${te.functions[fe]}`);for(let fe=0;fe<te.directions.length;fe++)$(this).addClass(`dir-${te.directions[fe]}`);$(this).addClass(`color-${te.color}`),$(this).addClass(`blinkpattern-${te.blinkPattern}`),$(this).addClass(`blinkpause-${te.blinkPause}`),$(this).addClass(`altcolor-${te.altColor}`)}}),re.hide(),I(),L(),F(),g(),$(window).width()<575){const J=$(".tab_title").width()/496;$(".mainGrid, .gridSections").css("zoom",J)}e.save=function(J){r(J)},e.revert=function(J){J?.()},$("a.save").click(function(){e.save(()=>GUI.tab_switch_reload())}),$("a.revert").on("click",function(){e.revert(()=>GUI.tab_switch_reload())}),$(".controls").change(function(){x()}),GUI.content_ready(n)}function u(x){let k=Math.round(15e3/x);return k<50?k=50:k>500&&(k=500),k}function p(x){let k=Math.round(15e3/x);return k<30?k=30:k>300&&(k=300),k}function h(x,k){for(let O=0;O<FC.LED_STRIP.length;O++){const D=FC.LED_STRIP[O];if(D.x==x&&D.y==k)return{index:O,led:D}}}function g(){const x=FC.LED_STRIP.length;FC.LED_STRIP=[],$(".gPoint").each(function(){if($(this).is('[class*="function"]')){const Y=$(this).index()+1,z=Math.ceil(Y/16)-1;let ee=Y/16%1*16-1;ee<0&&(ee=15);const re=$(this).find(".wire").html();let le="",J="",oe=0,ae=0,de=0,ie=0;const te=this;let fe=$(this).attr("class").match(/(^|\s)color-([0-9]+)(\s|$)/);if(fe&&(oe=fe[2]),fe=$(this).attr("class").match(/(^|\s)blinkpattern-([0-9]+)(\s|$)/),fe&&(ae=fe[2]),fe=$(this).attr("class").match(/(^|\s)blinkpause-([0-9]+)(\s|$)/),fe&&(de=fe[2]),fe=$(this).attr("class").match(/(^|\s)altcolor-([0-9]+)(\s|$)/),fe&&(ie=fe[2]),e.baseFuncs.forEach(function(Re){$(te).is(l+Re)&&(le+=Re)}),e.overlays.forEach(function(Re){$(te).is(l+Re)&&(le+=Re)}),e.directions.forEach(function(Re){$(te).is(".dir-"+Re)&&(J+=Re)}),re!=""){const Re={x:ee,y:z,directions:J,functions:le,color:oe,blinkPattern:ae,blinkPause:de,altColor:ie};FC.LED_STRIP[re]=Re}}});const k={x:0,y:0,directions:"",functions:""};for(let Y=0;Y<x;Y++)FC.LED_STRIP[Y]||(FC.LED_STRIP[Y]=k);const O=a(),D=FC.LED_STRIP.length-O.length;$(".wires-remaining div").html(D)}function f(x){x.find('[class*="mode_color"]').each(function(){let k=0,O=0;const D=$(this).attr("class").match(/(^|\s)mode_color-([0-9]+)-([0-9]+)(\s|$)/);D&&(k=Number(D[2]),O=Number(D[3]),$(this).css("background-color",U(FC.LED_COLORS[M(k,O)])))})}function d(x){if(x.is('[class*="color"]')){let k=0;const O=x.attr("class").match(/(^|\s)color-([0-9]+)(\s|$)/);O&&(k=O[2],x.css("background-color",U(FC.LED_COLORS[k])))}}function _(x){switch(x){case"function-c":case"function-a":case"function-f":return!0}return!1}function m(x){switch(x){case"":case"function-c":case"function-a":case"function-f":case"function-s":case"function-l":case"function-r":case"function-o":case"function-g":return!0}return!1}function C(x){switch(x){case"function-c":case"function-a":case"function-f":return!0}return!1}function R(x){switch(x){case"function-l":case"function-s":case"function-g":return!1;case"function-r":case"function-b":break;default:return!0}}function S(x){switch(x){case"function-v":case"function-c":case"function-a":case"function-f":return!0;default:return!1}}function F(){const x=$("select.functionSelect").val();switch($("select.functionSelect").addClass(x),$(".extra_functions20").show(),$(".mode_colors").show(),$(".overlays").hide(),$(".modifiers").hide(),$(".blinkers").hide(),$(".warningOverlay").hide(),$(".vtxOverlay").hide(),m(x)&&$(".overlays").show(),_(x)&&$(".modifiers").show(),C(x)&&$(".blinkers").show(),R(x)&&$(".warningOverlay").show(),S(x)&&$(".vtxOverlay").show(),$(".mode_colors").hide(),x==="function-f"&&$(".mode_colors").show(),$(".special_colors").show(),$(".mode_color-6-0").hide(),$(".mode_color-6-1").hide(),$(".mode_color-6-2").hide(),$(".mode_color-6-3").hide(),$(".mode_color-6-4").hide(),$(".mode_color-6-5").hide(),$(".mode_color-6-6").hide(),$(".mode_color-6-7").hide(),x){case"":case"function-f":case"function-l":$(".special_colors").hide();break;case"function-g":$(".mode_color-6-5").show(),$(".mode_color-6-6").show(),$(".mode_color-6-7").show();break;case"function-b":$(".mode_color-6-4").show();break;case"function-a":$(".mode_color-6-0").show(),$(".mode_color-6-1").show();break;case"function-r":default:$(".special_colors").hide();break}}function I(){const x=$("select.functionSelect").val();e.baseFuncs.forEach(function(k){x=="function-"+k?($("select.functionSelect").addClass("function-"+k),$(".ui-selected").find(".wire").each(function(){$(this).text()!=""&&$(this).parent().addClass("function-"+k)}),T(k)):($("select.functionSelect").removeClass("function-"+k),$(".ui-selected").removeClass("function-"+k)),x==""&&T(x)})}function T(x){(x=="r"||x=="")&&(P(x,"o"),P(x,"b"),P(x,"n"),P(x,"t")),(x=="l"||x=="g"||x=="s")&&(P(x,"w"),P(x,"v"),P(x,"t"),P(x,"o"),P(x,"b"),P(x,"n"))}function P(x,k){$("input.function-"+k).prop("checked",!1),$("input.function-"+k).change(),$(".ui-selected").each(function(){(x===""||$(this).is(l+x))&&$(this).removeClass("function-"+k)})}function y(x,k){let O=!1;x=Number(x);const D=".color-"+o;if($(D).hasClass("btnOn"))switch(k){case 0:FC.LED_COLORS[o].h!=x&&(FC.LED_COLORS[o].h=x,$(".colorDefineSliderValue.Hvalue").text(FC.LED_COLORS[o].h),O=!0);break;case 1:FC.LED_COLORS[o].s!=x&&(FC.LED_COLORS[o].s=x,$(".colorDefineSliderValue.Svalue").text(FC.LED_COLORS[o].s),O=!0);break;case 2:FC.LED_COLORS[o].v!=x&&(FC.LED_COLORS[o].v=x,$(".colorDefineSliderValue.Vvalue").text(FC.LED_COLORS[o].v),O=!0);break}$(".colors").children().each(function(){d($(this))}),$(".overlay-color").each(function(){d($(this))}),$(".mode_colors").each(function(){f($(this))}),$(".special_colors").each(function(){f($(this))}),O&&(g(),mspHelper.sendLedStripColors())}function L(){$(".gPoint").each(function(){if($(this).is(".function-c")||$(this).is(".function-r")||$(this).is(".function-b")){$(this).find(".overlay-color").show();for(let x=0;x<16;x++){const k="color-"+x;$(this).is("."+k)?($(this).find(".overlay-color").addClass(k),$(this).find(".overlay-color").css("background-color",U(FC.LED_COLORS[x]))):$(this).find(".overlay-color").is("."+k)&&$(this).find(".overlay-color").removeClass(k)}}else $(this).find(".overlay-color").hide()})}function G(x){const k=$("div.colorDefineSliders input");let O=!1;FC.LED_COLORS[x]&&(FC.LED_COLORS[x].h!=Number(k.eq(0).val())&&(k.eq(0).val(FC.LED_COLORS[x].h),$(".colorDefineSliderValue.Hvalue").text(FC.LED_COLORS[x].h),O=!0),FC.LED_COLORS[x].s!=Number(k.eq(1).val())&&(k.eq(1).val(FC.LED_COLORS[x].s),$(".colorDefineSliderValue.Svalue").text(FC.LED_COLORS[x].s),O=!0),FC.LED_COLORS[x].v!=Number(k.eq(2).val())&&(k.eq(2).val(FC.LED_COLORS[x].v),$(".colorDefineSliderValue.Vvalue").text(FC.LED_COLORS[x].v),O=!0),O&&k.trigger("input"))}function U(x){if(x==null)return"";let k={h:Number(x.h),s:Number(x.s),v:Number(x.v)};if(k.s==0&&k.v==0)return"";k={h:k.h,s:1-k.s/255,v:k.v/255};const O={h:0,s:0};return O.h=k.h,O.l=(2-k.s)*k.v/2,O.s=O.l&&O.l<1?k.s*k.v/(O.l<.5?O.l*2:2-O.l*2):O.s,`hsl(${O.h},${O.s*100}%,${O.l*100}%)`}function M(x,k){for(const O of FC.LED_MODE_COLORS)if(O.mode===x&&O.direction===k)return O.color;return""}function N(x,k,O){for(const D of FC.LED_MODE_COLORS)if(D.mode===x&&D.direction===k)return D.color=O,1;return 0}function w(){s=null,$(".mode_colors").each(function(){$(this).children().each(function(){$(this).is(".btnOn")&&$(this).removeClass("btnOn")})})}};Ma.cleanup=function(n){this.isDirty=!1,n?.()};TABS[Ma.tabName]=Ma;const Na={tabName:"mixer",isDirty:!1,needSave:!1,needReboot:!1,customConfig:!1,MIXER_CONFIG_dirty:!1,MIXER_INPUT1_dirty:!1,MIXER_INPUT2_dirty:!1,MIXER_INPUT3_dirty:!1,MIXER_INPUT4_dirty:!1,MIXER_RULES_dirty:!1,overrideMixer:[{class:"mixerMainRotor",axis:1,min:-18,max:18,step:.1,fixed:1,scale:.012,sliderstep:1,pipstep:1,pipfix:0,pipval:[-18,-15,-12,-9,-6,-3,0,3,6,9,12,15,18]},{class:"mixerMainRotor",axis:2,min:-18,max:18,step:.1,fixed:1,scale:.012,sliderstep:1,pipstep:1,pipfix:0,pipval:[-18,-15,-12,-9,-6,-3,0,3,6,9,12,15,18]},{class:"mixerMainRotor",axis:4,min:-18,max:18,step:.1,fixed:1,scale:.012,sliderstep:1,pipstep:1,pipfix:0,pipval:[-18,-15,-12,-9,-6,-3,0,3,6,9,12,15,18]},{class:"mixerTailRotor",axis:3,min:-60,max:60,step:1,fixed:0,scale:.024,sliderstep:1,pipstep:5,pipfix:0,pipval:[-60,-50,-40,-30,-20,-10,0,10,20,30,40,50,60]},{class:"mixerTailMotor",axis:3,min:-125,max:125,step:1,fixed:0,scale:.1,sliderstep:1,pipstep:5,pipfix:0,pipval:[-125,-100,-75,-50,-25,0,25,50,75,100,125]}]};Na.initialize=function(n){const e=this;function t(){e.isDirty||(e.isDirty=!0,$(".tab-mixer").removeClass("toolbar_hidden")),$(".save_btn").toggle(!e.needReboot),$(".reboot_btn").toggle(!!e.needReboot)}i(r);function r(){$("#content").load("/src/tabs/mixer.html",a)}function i(c){MSP.promise(MSPCodes.MSP_STATUS).then(()=>MSP.promise(MSPCodes.MSP_FEATURE_CONFIG)).then(()=>MSP.promise(MSPCodes.MSP_MIXER_CONFIG)).then(()=>MSP.promise(MSPCodes.MSP_MIXER_INPUTS)).then(()=>MSP.promise(MSPCodes.MSP_MIXER_RULES)).then(()=>MSP.promise(MSPCodes.MSP_MIXER_OVERRIDE)).then(c)}function o(c){function u(){e.MIXER_CONFIG_dirty?MSP.send_message(MSPCodes.MSP_SET_MIXER_CONFIG,mspHelper.crunch(MSPCodes.MSP_SET_MIXER_CONFIG),!1,p):p()}function p(){e.MIXER_INPUT1_dirty?mspHelper.sendMixerInput(1,h):h()}function h(){e.MIXER_INPUT2_dirty?mspHelper.sendMixerInput(2,g):g()}function g(){e.MIXER_INPUT3_dirty?mspHelper.sendMixerInput(3,f):f()}function f(){e.MIXER_INPUT4_dirty?mspHelper.sendMixerInput(4,d):d()}function d(){e.MIXER_RULES_dirty?mspHelper.sendMixerRules(_):_()}function _(){e.needSave?MSP.send_message(MSPCodes.MSP_EEPROM_WRITE,!1,!1,m):C()}function m(){GUI.log(i18n.getMessage("eepromSaved")),e.needSave=!1,C()}function C(){e.MIXER_CONFIG_dirty=!1,e.MIXER_INPUT1_dirty=!1,e.MIXER_INPUT2_dirty=!1,e.MIXER_INPUT3_dirty=!1,e.MIXER_INPUT4_dirty=!1,e.MIXER_RULES_dirty=!1,e.isDirty=e.needReboot||e.needSave,e.needReboot?(MSP.send_message(MSPCodes.MSP_SET_REBOOT),GUI.log(i18n.getMessage("deviceRebooting")),reinitialiseConnection(c)):c?.()}u()}function s(c){const u=$("#tab-mixer-templates .mixerOverrideTemplate tr").clone(),p=u.find(".mixerOverrideSlider").get(0),h=u.find(".mixerOverrideEnable input"),g=u.find(".mixerPassthroughEnable input"),f=u.find(".mixerOverrideInput input"),d=c.axis;u.addClass(c.class),u.addClass("mixerOverrideActive"),u.find(".mixerOverrideName").text(i18n.getMessage(Mixer.inputNames[d]));const _=i18n.getMessage("mixerOverrideSliderLeftLabel"+d),m=i18n.getMessage("mixerOverrideSliderRightLabel"+d);u.find(".mixerOverrideSliderLeftLabel").text(_),u.find(".mixerOverrideSliderRightLabel").text(m),f.attr("min",c.min),f.attr("max",c.max),f.attr("step",c.step),Gr(p,{range:{min:c.min,max:c.max},start:0,step:c.sliderstep,behaviour:"snap-drag",pips:{mode:"values",values:c.pipval,density:100/((c.max-c.min)/c.pipstep),stepped:!0,format:ei({decimals:c.pipfix})}});function C(P){P?p.noUiSlider.enable():p.noUiSlider.disable()}p.noUiSlider.on("slide",function(P){f.val(parseFloat(P[0]).toFixed(c.fixed))}),p.noUiSlider.on("change",function(){f.trigger("change")});function R(){const P=h.prop("checked"),y=g.prop("checked");let L=Mixer.OVERRIDE_OFF;P&&(y?L=Mixer.OVERRIDE_PASSTHROUGH:L=Math.round(parseFloat(getNumberInput(f))/c.scale)),console.log("mixerOverride axis "+d+" value "+L),FC.MIXER_OVERRIDE[d]=L,mspHelper.sendMixerOverride(d)}f.on("change",function(){const P=parseFloat(getNumberInput($(this)));p.noUiSlider.set(P,!0,!0),R()}),h.on("change",function(){const P=$(this).prop("checked"),y=g.prop("checked"),L=P&&!y;f.val(0),p.noUiSlider.set(0),f.prop("disabled",!L),C(L),!P&&g.prop("checked")&&g.prop("checked",!1).change(),R()}),g.on("change",function(){const P=h.prop("checked"),y=$(this).prop("checked"),L=P&&!y;y&&!h.prop("checked")&&h.prop("checked",!0).change(),f.prop("disabled",!L),C(L),R()});let S=FC.MIXER_OVERRIDE[d];const F=Mixer.overrideEnabled(S);FC.CONFIG.mixerOverrideEnabled|=F;const I=Mixer.passthroughEnabled(S);FC.CONFIG.mixerPassthroughEnabled|=I;const T=F&&!I;S*=c.scale,S=(T?S:0).toFixed(c.fixed),f.val(S),p.noUiSlider.set(S),f.prop("disabled",!T),h.prop("checked",F),g.prop("checked",I),C(T),$(".mixerOverrideTable tbody").append(u)}function l(){$(".tab-mixer .note").hide(),$(".tab-mixer .mixerMotorisedTailCalibrationNote .note").show(),$(".tab-mixer .mixerMotorisedTailCalibrationNote").hide(),e.origMixerConfig=Mixer.cloneConfig(FC.MIXER_CONFIG),e.origMixerInputs=Mixer.cloneInputs(FC.MIXER_INPUTS),e.origMixerRules=Mixer.cloneRules(FC.MIXER_RULES),e.isDirty=!1,e.needSave=!1,e.needReboot=!1,e.MIXER_CONFIG_dirty=!1,e.MIXER_INPUT1_dirty=!1,e.MIXER_INPUT2_dirty=!1,e.MIXER_INPUT3_dirty=!1,e.MIXER_INPUT4_dirty=!1,e.MIXER_RULES_dirty=!1,e.overrideMixer.forEach(function(P){s(P)});const c=$("#mixerOverrideEnableSwitch");c.prop("checked",FC.CONFIG.mixerOverrideEnabled);const u=$("#mixerPassthroughEnableSwitch");u.prop("checked",FC.CONFIG.mixerPassthroughEnabled),_e.lt(FC.CONFIG.apiVersion,API_VERSION_12_8)&&$(".mixerPassthroughVisible").hide(),c.change(function(){const P=c.prop("checked");FC.CONFIG.mixerOverrideEnabled=P,P||u.prop("checked",!1).change(),$(".mixerOverrideAxis").toggle(!!P),$(".mixerOverrideActive .mixerOverrideEnable input").prop("checked",P).change()}),$(".mixerOverrideAxis").toggle(!!FC.CONFIG.mixerOverrideEnabled),u.change(function(){const P=u.prop("checked");FC.CONFIG.mixerPassthroughEnabled=P,P&&c.prop("checked",!0).change(),$(".mixerOverrideActive .mixerPassthroughEnable input").prop("checked",P).change()}),e.customConfig=!1,e.customConfig|=FC.MIXER_INPUTS[1].rate!=FC.MIXER_INPUTS[2].rate&&FC.MIXER_INPUTS[1].rate!=-FC.MIXER_INPUTS[2].rate,e.customConfig|=FC.MIXER_INPUTS[1].max!=FC.MIXER_INPUTS[2].max,e.customConfig|=FC.MIXER_INPUTS[1].min!=FC.MIXER_INPUTS[2].min,e.customConfig|=FC.MIXER_INPUTS[1].max!=-FC.MIXER_INPUTS[1].min,e.customConfig|=FC.MIXER_INPUTS[2].max!=-FC.MIXER_INPUTS[2].min,e.customConfig|=FC.MIXER_INPUTS[4].max!=-FC.MIXER_INPUTS[4].min,e.customConfig&&($(".mixerCustomNote").show(),$(".tab-mixer .configuration input,select").prop("disabled",!0)),e.customRules=!Mixer.isNullMixer(FC.MIXER_RULES),e.customRules&&$(".mixerRulesNote").show();const p=FC.MIXER_INPUTS[1].rate<0?-1:1,h=FC.MIXER_INPUTS[2].rate<0?-1:1,g=FC.MIXER_INPUTS[4].rate<0?-1:1,f=Math.abs(FC.MIXER_INPUTS[4].rate)*.1,d=Math.abs(FC.MIXER_INPUTS[1].rate)*.1,_=FC.MIXER_INPUTS[4].max*12/1e3,m=FC.MIXER_INPUTS[2].max*12/1e3,C=FC.MIXER_CONFIG.blade_pitch_limit*12/1e3,R=FC.MIXER_INPUTS[3].rate<0?-1:1,S=Math.abs(FC.MIXER_INPUTS[3].rate)*.1,F=$("#mixerSwashType");Mixer.swashTypes.forEach(function(P,y){F.append($(`<option value="${y}">`+i18n.getMessage(P)+"</option>"))}),F.val(FC.MIXER_CONFIG.swash_type),$("#mixerAileronDirection").val(p).change(),$("#mixerElevatorDirection").val(h).change(),$("#mixerCollectiveDirection").val(g).change(),$("#mixerMainRotorDirection").val(FC.MIXER_CONFIG.main_rotor_dir),$("#mixerSwashPhase").val(FC.MIXER_CONFIG.swash_phase*.1).change(),$("#mixerSwashRollTrim").val(FC.MIXER_CONFIG.swash_trim[0]*.1).change(),$("#mixerSwashPitchTrim").val(FC.MIXER_CONFIG.swash_trim[1]*.1).change(),$("#mixerSwashCollectiveTrim").val(FC.MIXER_CONFIG.swash_trim[2]*.1).change(),$("#mixerCyclicCalibration").val(d).change(),$("#mixerCollectiveCalibration").val(f).change(),$("#mixerCollectiveGeoCorrection").val(FC.MIXER_CONFIG.coll_geo_correction/5).change(),$("#mixerCollectiveLimit").val(_).change(),$("#mixerCyclicLimit").val(m).change(),$("#mixerTotalPitchLimit").val(C).change(),_e.gte(FC.CONFIG.apiVersion,API_VERSION_12_8)?($("#mixerCollectiveTiltCorrectionPos").val(FC.MIXER_CONFIG.coll_tilt_correction_pos).change(),$("#mixerCollectiveTiltCorrectionNeg").val(FC.MIXER_CONFIG.coll_tilt_correction_neg).change()):$(".mixerCollectiveTiltCorrection").hide();function I(P,y){FC.MIXER_CONFIG.tail_rotor_mode=P,$("#mixerTailRotorMode").val(P);const L=P>0,G=Mixer.overrideEnabled(FC.MIXER_OVERRIDE[3]);if($(".mixerTailMotor").toggle(L),$(".mixerTailRotor").toggle(!L),$(".mixerTailRotor .mixerOverrideEnable input").prop("checked",G&&!L),$(".mixerTailMotor .mixerOverrideEnable input").prop("checked",G&&L),L){const U=FC.MIXER_INPUTS[3].min*-.1,M=FC.MIXER_INPUTS[3].max*.1;$("#mixerTailMotorMinYaw").val(U.toFixed(1)),$("#mixerTailMotorMaxYaw").val(M.toFixed(1)),$("#mixerTailMotorCenterTrim").val((FC.MIXER_CONFIG.tail_center_trim*.1).toFixed(1)),$(".mixerOverrideAxis .mixerTailMotor").addClass("mixerOverrideActive"),$(".mixerOverrideAxis .mixerTailRotor").removeClass("mixerOverrideActive"),y&&($(".mixerTailMotor .mixerOverrideEnable input").change(),$("#mixerTailRotorCalibration").val(100).change())}else{const U=FC.MIXER_INPUTS[3].min*-24/1e3,M=FC.MIXER_INPUTS[3].max*24/1e3;$("#mixerTailRotorMinYaw").val(U.toFixed(1)),$("#mixerTailRotorMaxYaw").val(M.toFixed(1)),$("#mixerTailRotorCenterTrim").val((FC.MIXER_CONFIG.tail_center_trim*24/1e3).toFixed(1)),$(".mixerOverrideAxis .mixerTailRotor").addClass("mixerOverrideActive"),$(".mixerOverrideAxis .mixerTailMotor").removeClass("mixerOverrideActive"),y&&($(".mixerTailRotor .mixerOverrideEnable input").change(),$("#mixerTailRotorCalibration").val(25).change())}$(".mixerBidirNote").toggle(P==2),T()}function T(){const y=FC.MIXER_CONFIG.tail_rotor_mode>0&&getFloatValue("#mixerTailRotorCalibration")!==100;$(".tab-mixer .mixerMotorisedTailCalibrationNote").toggle(y)}$("#mixerTailRotorMode").change(function(){const P=parseInt($(this).val());I(P,!0)}),I(FC.MIXER_CONFIG.tail_rotor_mode,!1),$("#mixerTailRotorDirection").val(R).change(),$("#mixerTailRotorCalibration").on("change",T).val(S).change(),$("#mixerTailMotorIdle").val(FC.MIXER_CONFIG.tail_motor_idle/10).change(),$(".tab-mixer .mixerReboot").change(function(){$(".tab-mixer .mixerRebootNote").show(),$("select",this).addClass("attention"),e.needReboot=!0}),$(".tab-mixer .mixerConfig").change(function(){FC.MIXER_CONFIG.swash_type=getIntegerValue("#mixerSwashType"),FC.MIXER_CONFIG.swash_phase=getIntegerValue("#mixerSwashPhase",10),FC.MIXER_CONFIG.main_rotor_dir=parseInt($("#mixerMainRotorDirection").val()),FC.MIXER_CONFIG.blade_pitch_limit=getIntegerValue("#mixerTotalPitchLimit",1e3/12),FC.MIXER_CONFIG.swash_trim[0]=getIntegerValue("#mixerSwashRollTrim",10),FC.MIXER_CONFIG.swash_trim[1]=getIntegerValue("#mixerSwashPitchTrim",10),FC.MIXER_CONFIG.swash_trim[2]=getIntegerValue("#mixerSwashCollectiveTrim",10),FC.MIXER_CONFIG.tail_rotor_mode=getIntegerValue("#mixerTailRotorMode"),FC.MIXER_CONFIG.tail_motor_idle=getIntegerValue("#mixerTailMotorIdle",10),FC.MIXER_CONFIG.coll_geo_correction=getIntegerValue("#mixerCollectiveGeoCorrection",5),FC.MIXER_CONFIG.coll_tilt_correction_pos=getIntegerValue("#mixerCollectiveTiltCorrectionPos"),FC.MIXER_CONFIG.coll_tilt_correction_neg=getIntegerValue("#mixerCollectiveTiltCorrectionNeg"),FC.MIXER_CONFIG.tail_rotor_mode>0?FC.MIXER_CONFIG.tail_center_trim=getIntegerValue("#mixerTailMotorCenterTrim",10):FC.MIXER_CONFIG.tail_center_trim=getIntegerValue("#mixerTailRotorCenterTrim",1e3/24),e.MIXER_CONFIG_dirty=!0,e.needSave=!0,t(),MSP.send_message(MSPCodes.MSP_SET_MIXER_CONFIG,mspHelper.crunch(MSPCodes.MSP_SET_MIXER_CONFIG))}),$(".tab-mixer .mixerInput1").change(function(){const P=getIntegerValue("#mixerAileronDirection"),y=getIntegerValue("#mixerCyclicCalibration",10),L=getIntegerValue("#mixerCyclicLimit",1e3/12);FC.MIXER_INPUTS[1].rate=y*P,FC.MIXER_INPUTS[1].min=-L,FC.MIXER_INPUTS[1].max=L,e.MIXER_INPUT1_dirty=!0,e.needSave=!0,t(),mspHelper.sendMixerInput(1)}),$(".tab-mixer .mixerInput2").change(function(){const P=getIntegerValue("#mixerElevatorDirection"),y=getIntegerValue("#mixerCyclicCalibration",10),L=getIntegerValue("#mixerCyclicLimit",1e3/12);FC.MIXER_INPUTS[2].rate=y*P,FC.MIXER_INPUTS[2].min=-L,FC.MIXER_INPUTS[2].max=L,e.MIXER_INPUT2_dirty=!0,e.needSave=!0,t(),mspHelper.sendMixerInput(2)}),$(".tab-mixer .mixerInput3").change(function(){const P=getIntegerValue("#mixerTailRotorDirection"),y=getIntegerValue("#mixerTailRotorCalibration",10);let L=0,G=0;FC.MIXER_CONFIG.tail_rotor_mode>0?(L=getIntegerValue("#mixerTailMotorMinYaw",-10),G=getIntegerValue("#mixerTailMotorMaxYaw",10)):(L=getIntegerValue("#mixerTailRotorMinYaw",-1e3/24),G=getIntegerValue("#mixerTailRotorMaxYaw",1e3/24)),FC.MIXER_INPUTS[3].rate=y*P,FC.MIXER_INPUTS[3].min=L,FC.MIXER_INPUTS[3].max=G,e.MIXER_INPUT3_dirty=!0,e.needSave=!0,t(),mspHelper.sendMixerInput(3)}),$(".tab-mixer .mixerInput4").change(function(){const P=getIntegerValue("#mixerCollectiveDirection"),y=getIntegerValue("#mixerCollectiveCalibration",10),L=getIntegerValue("#mixerCollectiveLimit",1e3/12);FC.MIXER_INPUTS[4].rate=y*P,FC.MIXER_INPUTS[4].min=-L,FC.MIXER_INPUTS[4].max=L,e.MIXER_INPUT4_dirty=!0,e.needSave=!0,t(),mspHelper.sendMixerInput(4)})}function a(){i18n.localizePage(),l(),$(".tab-mixer").addClass("toolbar_hidden"),e.save=function(c){o(c)},e.revert=function(c){FC.MIXER_CONFIG=e.origMixerConfig,FC.MIXER_INPUTS=e.origMixerInputs,e.needSave=!1,e.needReboot=!1,o(c)},$("a.save").click(function(){e.save(()=>GUI.tab_switch_reload())}),$("a.reboot").click(function(){e.save(()=>GUI.tab_switch_reload())}),$("a.revert").click(function(){e.revert(()=>GUI.tab_switch_reload())}),GUI.content_ready(n)}};Na.cleanup=function(n){this.isDirty=!1,n?.()};TABS[Na.tabName]=Na;class BA{#e=pe(!1);get overrideEnabled(){return b(this.#e)}set overrideEnabled(e){ce(this.#e,e,!0)}#i=ue(()=>["PWM","ONESHOT125","ONESHOT42","MULTISHOT","BRUSHED","DSHOT150","DSHOT300","DSHOT600","PROSHOT",..._e.gte(V.CONFIG.apiVersion,Dn)?["CASTLE"]:[],"DISABLED"]);get throttleProtocols(){return b(this.#i)}set throttleProtocols(e){ce(this.#i,e)}#s=ue(()=>["Disabled","BLHeli32","Hobbywing Platinum V4 / FlyFun V5","Hobbywing Platinum V5","Scorpion","Kontronik","OMPHobby","ZTW","APD","OpenYGE","FLYROTOR","Graupner",..._e.gte(V.CONFIG.apiVersion,Dn)?["XDFLY"]:[]]);get telemetryProtocols(){return b(this.#s)}set telemetryProtocols(e){ce(this.#s,e)}#r=ue(()=>this.throttleProtocols[V.MOTOR_CONFIG.motor_pwm_protocol]!=="DISABLED");get throttleEnabled(){return b(this.#r)}set throttleEnabled(e){ce(this.#r,e)}#o=ue(()=>this.throttleProtocols[V.MOTOR_CONFIG.motor_pwm_protocol].startsWith("DSHOT"));get isDshot(){return b(this.#o)}set isDshot(e){ce(this.#o,e)}#n=ue(()=>this.throttleProtocols[V.MOTOR_CONFIG.motor_pwm_protocol]==="CASTLE");get isCastleLink(){return b(this.#n)}set isCastleLink(e){ce(this.#n,e)}#t=ue(()=>V.ESC_SENSOR_CONFIG.protocol>0);get hasTelemPort(){return b(this.#t)}set hasTelemPort(e){ce(this.#t,e)}#u=ue(()=>this.hasTelemPort||this.isCastleLink);get telemEnabled(){return b(this.#u)}set telemEnabled(e){ce(this.#u,e)}fixConfig(){V.FEATURE_CONFIG.features.ESC_SENSOR=this.telemEnabled,this.isCastleLink&&(V.ESC_SENSOR_CONFIG.protocol=0)}}const nt=new BA;var VA=ne('<option class="svelte-gu3lip"> </option>'),HA=ne('<select id="esc-protocol" class="svelte-gu3lip"></select>'),XA=ne("<!> <!> <!> <!>",1),YA=ne('<div class="svelte-gu3lip"><!></div>'),zA=ne('<div class="svelte-gu3lip"><!></div>'),WA=ne("<!> <!> <!>",1);function jA(n,e){we(e,!0);let t=ue(()=>V.MOTOR_CONFIG.motor_pwm_protocol),r=ue(()=>nt.throttleEnabled&&V.CONFIG.motorCount>0);Gt(n,{label:"motorsSectionLabelThrottle",children:(i,o)=>{Be(i,{children:(s,l)=>{var a=WA(),c=me(a);ge(c,{id:"esc-protocol",label:"motorsEscProtocol",tooltip:d=>{Te(d,{help:"motorsEscProtocolHelp"})},children:(d,_)=>{var m=HA();xt(m,22,()=>nt.throttleProtocols,C=>C,(C,R,S)=>{var F=VA(),I=W(F),T={};Ae(()=>{Ee(I,R),T!==(T=b(S))&&(F.value=(F.__value=b(S))??"")}),Z(C,F)}),vr(m,()=>V.MOTOR_CONFIG.motor_pwm_protocol,C=>V.MOTOR_CONFIG.motor_pwm_protocol=C),Z(d,m)},$$slots:{tooltip:!0,default:!0}});var u=K(c,2);{var p=f=>{var d=YA(),_=W(d);Be(_,{children:(m,C)=>{var R=XA(),S=me(R);ge(S,{id:"pwm-freq",label:"motorsUnsyncedPWMFreq",unit:"Hz",tooltip:y=>{Te(y,{help:"motorsUnsyncedPWMFreqHelp",attrs:[{name:"genericDefault",value:"250Hz"},{name:"genericRange",value:"0Hz - 250Hz"}]})},children:(y,L)=>{Oe(y,{id:"pwm-freq",min:"0",max:"250",step:"10",get value(){return V.MOTOR_CONFIG.motor_pwm_rate},set value(G){V.MOTOR_CONFIG.motor_pwm_rate=G}})},$$slots:{tooltip:!0,default:!0}});var F=K(S,2);ge(F,{id:"throttle-off-pwm",label:"motorsThrottleMinimumCommand",unit:"μs",tooltip:y=>{Te(y,{help:"motorsThrottleMinimumCommandHelp",attrs:[{name:"genericDefault",value:"1000μs"},{name:"genericRange",value:"50μs - 2250μs"}]})},children:(y,L)=>{Oe(y,{id:"throttle-off-pwm",min:"50",max:"2250",get value(){return V.MOTOR_CONFIG.mincommand},set value(G){V.MOTOR_CONFIG.mincommand=G}})},$$slots:{tooltip:!0,default:!0}});var I=K(F,2);ge(I,{id:"throttle-min-pwm",label:"motorsThrottleMinimum",unit:"μs",tooltip:y=>{Te(y,{help:"motorsThrottleMinimumHelp",attrs:[{name:"genericDefault",value:"1070μs"},{name:"genericRange",value:"50μs - 2250μs"}]})},children:(y,L)=>{Oe(y,{id:"throttle-min-pwm",min:"50",max:"2250",get value(){return V.MOTOR_CONFIG.minthrottle},set value(G){V.MOTOR_CONFIG.minthrottle=G}})},$$slots:{tooltip:!0,default:!0}});var T=K(I,2);ge(T,{id:"throttle-max-pwm",label:"motorsThrottleMaximum",unit:"μs",tooltip:y=>{Te(y,{help:"motorsThrottleMaximumHelp",attrs:[{name:"genericDefault",value:"2000μs"},{name:"genericRange",value:"50μs - 2250μs"}]})},children:(y,L)=>{Oe(y,{id:"throttle-max-pwm",min:"50",max:"2250",get value(){return V.MOTOR_CONFIG.maxthrottle},set value(G){V.MOTOR_CONFIG.maxthrottle=G}})},$$slots:{tooltip:!0,default:!0}}),Z(m,R)},$$slots:{default:!0}}),ke(3,d,()=>Ue),Z(f,d)};Ce(u,f=>{b(r)&&!nt.isDshot&&f(p)})}var h=K(u,2);{var g=f=>{var d=zA(),_=W(d);ge(_,{id:"throttle-unsynced-pwm",label:"motorsUnsyncedPwm",tooltip:C=>{Te(C,{help:"motorsUnsyncedPwmHelp"})},children:(C,R)=>{ut(C,{id:"throttle-unsynced-pwm",get checked(){return V.ESC_SENSOR_CONFIG.use_unsynced_pwm},set checked(S){V.ESC_SENSOR_CONFIG.use_unsynced_pwm=S}})},$$slots:{tooltip:!0,default:!0}}),ke(3,d,()=>Ue),Z(f,d)};Ce(h,f=>{b(r)&&!nt.isDshot&&b(t)!==0&&!nt.isCastleLink&&f(g)})}Z(s,a)},$$slots:{default:!0}})},$$slots:{default:!0}}),Ge()}MI();var at=Md(()=>V),qA=ne('<div class="svelte-ppt9vv"><!></div>'),KA=ne('<div class="ratio-container svelte-ppt9vv"><span class="ratio svelte-ppt9vv"> </span> <!> <span class="ratio-separator svelte-ppt9vv">:</span> <!></div>'),QA=ne('<div class="ratio-container svelte-ppt9vv"><span class="ratio svelte-ppt9vv"> </span> <!> <span class="ratio-separator svelte-ppt9vv">:</span> <!></div>'),ZA=ne("<!> <!> <!> <!> <!>",1);function JA(n,e){we(e,!1),Ad(),Gt(n,{label:"motorsSectionLabelRPM",children:(t,r)=>{Be(t,{children:(i,o)=>{var s=ZA(),l=me(s);ge(l,{id:"rpm-sensor",label:"motorsRPMSensor",tooltip:f=>{Te(f,{help:"motorsRPMSensorHelp"})},children:(f,d)=>{ut(f,{id:"rpm-sensor",get checked(){return at().FEATURE_CONFIG.features.FREQ_SENSOR},set checked(_){at(at().FEATURE_CONFIG.features.FREQ_SENSOR=_)},$$legacy:!0})},$$slots:{tooltip:!0,default:!0}});var a=K(l,2);{var c=g=>{var f=qA(),d=W(f);ge(d,{id:"dshot-bidir",label:"motorsDshotBidir",tooltip:m=>{Te(m,{help:"motorsDshotBidirHelp"})},children:(m,C)=>{ut(m,{id:"dshot-bidir",get checked(){return at().MOTOR_CONFIG.use_dshot_telemetry},set checked(R){at(at().MOTOR_CONFIG.use_dshot_telemetry=R)},$$legacy:!0})},$$slots:{tooltip:!0,default:!0}}),ke(3,f,()=>Ue),Z(g,f)};Ce(a,g=>{nt.isDshot&&g(c)})}var u=K(a,2);ge(u,{label:"motorsMainRotorGearRatio",tooltip:f=>{Te(f,{help:"motorsMainRotorGearRatioHelp"})},children:(f,d)=>{var _=KA(),m=W(_),C=W(m),R=K(m,2);Oe(R,{min:"1",max:"50000",get value(){return at().MOTOR_CONFIG.main_rotor_gear_ratio[0]},set value(F){at(at().MOTOR_CONFIG.main_rotor_gear_ratio[0]=F)},$$legacy:!0});var S=K(R,4);Oe(S,{min:"1",max:"50000",get value(){return at().MOTOR_CONFIG.main_rotor_gear_ratio[1]},set value(F){at(at().MOTOR_CONFIG.main_rotor_gear_ratio[1]=F)},$$legacy:!0}),Ae(F=>Ee(C,`1:${F??""}`),[()=>(at().MOTOR_CONFIG.main_rotor_gear_ratio[1]/at().MOTOR_CONFIG.main_rotor_gear_ratio[0]).toFixed(2)],ca),Z(f,_)},$$slots:{tooltip:!0,default:!0}});var p=K(u,2);ge(p,{label:"motorsTailRotorGearRatio",tooltip:f=>{Te(f,{help:"motorsTailRotorGearRatioHelp"})},children:(f,d)=>{var _=QA(),m=W(_),C=W(m),R=K(m,2);Oe(R,{min:"1",max:"50000",get value(){return at().MOTOR_CONFIG.tail_rotor_gear_ratio[0]},set value(F){at(at().MOTOR_CONFIG.tail_rotor_gear_ratio[0]=F)},$$legacy:!0});var S=K(R,4);Oe(S,{min:"1",max:"50000",get value(){return at().MOTOR_CONFIG.tail_rotor_gear_ratio[1]},set value(F){at(at().MOTOR_CONFIG.tail_rotor_gear_ratio[1]=F)},$$legacy:!0}),Ae(F=>Ee(C,`1:${F??""}`),[()=>(at().MOTOR_CONFIG.tail_rotor_gear_ratio[1]/at().MOTOR_CONFIG.tail_rotor_gear_ratio[0]).toFixed(2)],ca),Z(f,_)},$$slots:{tooltip:!0,default:!0}});var h=K(p,2);xt(h,1,()=>({length:at().CONFIG.motorCount}),is,(g,f,d)=>{{const _=m=>{Te(m,{help:"motorsMotorPolesHelp"})};ge(g,{id:`motor-poles-${d+1}`,label:`motorsMotorPoles${d+1}Long`,tooltip:_,children:(m,C)=>{Oe(m,{id:`motor-poles-${d+1}`,min:"2",max:"255",step:"2",get value(){return at().MOTOR_CONFIG.motor_poles[d]},set value(R){at(at().MOTOR_CONFIG.motor_poles[d]=R)},$$legacy:!0})},$$slots:{tooltip:!0,default:!0}})}}),Z(i,s)},$$slots:{default:!0}})},$$slots:{default:!0}}),Ge()}var Rt=Md(()=>V),eM=ne('<option class="svelte-gu3lip"> </option>'),tM=ne('<select id="esc-telemetry-protocol" class="svelte-gu3lip"></select>'),nM=ne('<div class="svelte-gu3lip"><!></div>'),rM=ne("<!> <!>",1),iM=ne('<div class="svelte-gu3lip"><!></div>'),oM=ne("<!> <!> <!>",1),sM=ne('<div class="svelte-gu3lip"><!></div>'),aM=ne("<!> <!> <!>",1);function lM(n,e){we(e,!1),Ad(),Gt(n,{label:"motorsEscTelemetry",children:(t,r)=>{var i=aM(),o=me(i);{var s=p=>{var h=nM(),g=W(h);Be(g,{children:(f,d)=>{ge(f,{id:"esc-telemetry-protocol",label:"motorsEscTelemetryProtocol",tooltip:m=>{Te(m,{help:"motorsEscTelemetryProtocolHelp"})},children:(m,C)=>{var R=tM();Ae(()=>{Rt(),QI(()=>{})}),xt(R,7,()=>nt.telemetryProtocols,S=>S,(S,F,I)=>{var T=eM(),P=W(T),y={};Ae(()=>{Ee(P,b(F)),y!==(y=b(I))&&(T.value=(T.__value=b(I))??"")}),Z(S,T)}),vr(R,()=>Rt().ESC_SENSOR_CONFIG.protocol,S=>Rt(Rt().ESC_SENSOR_CONFIG.protocol=S)),Z(m,R)},$$slots:{tooltip:!0,default:!0}})},$$slots:{default:!0}}),ke(3,h,()=>Ue),Z(p,h)};Ce(o,p=>{nt.isCastleLink||p(s)})}var l=K(o,2);{var a=p=>{var h=iM(),g=W(h);Be(g,{label:"motorsSectionSignaling",children:(f,d)=>{var _=rM(),m=me(_);ge(m,{id:"esc-telemetry-half-duplex",label:"motorsEscTelemetryHalfDuplex",tooltip:F=>{Te(F,{help:"motorsEscTelemetryHalfDuplexHelp"})},children:(F,I)=>{ut(F,{id:"esc-telemetry-half-duplex",get checked(){return Rt().ESC_SENSOR_CONFIG.half_duplex},set checked(T){Rt(Rt().ESC_SENSOR_CONFIG.half_duplex=T)},$$legacy:!0})},$$slots:{tooltip:!0,default:!0}});var C=K(m,2);{var R=S=>{ge(S,{id:"esc-telemetry-pinswap",label:"motorsEscTelemetryPinswap",tooltip:I=>{Te(I,{help:"motorsEscTelemetryPinswapHelp"})},children:(I,T)=>{ut(I,{id:"esc-telemetry-pinswap",get checked(){return Rt().ESC_SENSOR_CONFIG.pinswap},set checked(P){Rt(Rt().ESC_SENSOR_CONFIG.pinswap=P)},$$legacy:!0})},$$slots:{tooltip:!0,default:!0}})};Ce(C,S=>{_e.gte(Rt().CONFIG.apiVersion,cn)&&S(R)})}Z(f,_)},$$slots:{default:!0}}),ke(3,h,()=>Ue),Z(p,h)};Ce(l,p=>{nt.telemEnabled&&nt.hasTelemPort&&p(a)})}var c=K(l,2);{var u=p=>{var h=sM(),g=W(h);Be(g,{label:"motorsSectionSensorCorrection",children:(f,d)=>{var _=oM(),m=me(_);ge(m,{id:"voltage-correction",label:"motorsVoltageCorrection",unit:"%",tooltip:F=>{Te(F,{help:"motorsVoltageCorrectionHelp",attrs:[{name:"genericDefault",value:"0%"},{name:"genericRange",value:"-50% - 125%"}]})},children:(F,I)=>{Oe(F,{id:"voltage-correction",min:"-50",max:"125",get value(){return Rt().ESC_SENSOR_CONFIG.voltage_correction},set value(T){Rt(Rt().ESC_SENSOR_CONFIG.voltage_correction=T)},$$legacy:!0})},$$slots:{tooltip:!0,default:!0}});var C=K(m,2);ge(C,{id:"current-correction",label:"motorsCurrentCorrection",unit:"%",tooltip:F=>{Te(F,{help:"motorsCurrentCorrectionHelp",attrs:[{name:"genericDefault",value:"0%"},{name:"genericRange",value:"-50% - 125%"}]})},children:(F,I)=>{Oe(F,{id:"current-correction",min:"-50",max:"125",get value(){return Rt().ESC_SENSOR_CONFIG.current_correction},set value(T){Rt(Rt().ESC_SENSOR_CONFIG.current_correction=T)},$$legacy:!0})},$$slots:{tooltip:!0,default:!0}});var R=K(C,2);ge(R,{id:"consumption-correction",label:"motorsConsumptionCorrection",unit:"%",tooltip:F=>{Te(F,{help:"motorsConsumptionCorrectionHelp",attrs:[{name:"genericDefault",value:"0%"},{name:"genericRange",value:"-50% - 125%"}]})},children:(F,I)=>{Oe(F,{id:"consumption-correction",min:"-50",max:"125",get value(){return Rt().ESC_SENSOR_CONFIG.consumption_correction},set value(T){Rt(Rt().ESC_SENSOR_CONFIG.consumption_correction=T)},$$legacy:!0})},$$slots:{tooltip:!0,default:!0}}),Z(f,_)},$$slots:{default:!0}}),ke(3,h,()=>Ue),Z(p,h)};Ce(c,p=>{nt.telemEnabled&&_e.gte(Rt().CONFIG.apiVersion,Dn)&&p(u)})}Z(t,i)},$$slots:{default:!0}}),Ge()}var cM=ne('<div class="container svelte-19cq9sm"><div class="header svelte-19cq9sm"><div class="fas fa-sticky-note svelte-19cq9sm"></div> <b class="svelte-19cq9sm"> </b></div> <div class="svelte-19cq9sm"><!></div></div>');function uM(n,e){we(e,!0);const[t,r]=Et(),i=()=>vt(St,"$i18n",t);var o=cM(),s=W(o),l=K(W(s),2),a=W(l),c=K(s,2),u=W(c);{var p=g=>{var f=Ct(),d=me(f);Ot(d,()=>e.children),Z(g,f)},h=(g,f)=>{{var d=_=>{var m=Ct(),C=me(m);fi(C,()=>i().t(e.message)),Z(_,m)};Ce(g,_=>{typeof e.message=="string"&&_(d)},f)}};Ce(u,g=>{e.children?g(p):g(h,!1)})}Ae(g=>Ee(a,g),[()=>i().t("noteTitle")]),Z(n,o),Ge(),r()}var dM=ne('<div class="svelte-gu3lip"><!></div>'),fM=ne('<option class="svelte-gu3lip"> </option>'),_M=ne('<select id="gov-mode" class="svelte-gu3lip"></select>'),pM=ne("<!> <!> <!> <!>",1),hM=ne('<div class="svelte-gu3lip"><!></div>'),gM=ne("<!> <!>",1),mM=ne("<!> <!> <!> <!> <!>",1),CM=ne("<!> <!>",1),vM=ne("<!> <!> <!> <!>",1),EM=ne('<div class="svelte-gu3lip"><!></div> <div class="svelte-gu3lip"><!></div> <div class="svelte-gu3lip"><!></div>',1),SM=ne("<!> <!> <!>",1);function RM(n,e){we(e,!0);const t=["OFF","PASSTHROUGH","STANDARD","MODE1","MODE2"],r={};for(const o of["gov_startup_time","gov_spoolup_time","gov_tracking_time","gov_recovery_time","gov_autorotation_bailout_time","gov_autorotation_timeout","gov_autorotation_min_entry_time","gov_zero_throttle_timeout","gov_lost_headspeed_timeout"])Object.defineProperty(r,o,{get(){return V.GOVERNOR[o]/10},set(s){V.GOVERNOR[o]=s*10}});let i=ue(()=>V.FEATURE_CONFIG.features.GOVERNOR&&V.GOVERNOR.gov_mode>0);Gt(n,{label:"govFeatures",children:(o,s)=>{var l=SM(),a=me(l);{var c=g=>{var f=dM(),d=W(f);uM(d,{message:"govConfigurationNote"}),ke(3,f,()=>Ue),Z(g,f)};Ce(a,g=>{b(i)&&g(c)})}var u=K(a,2);Be(u,{children:(g,f)=>{var d=gM(),_=me(d);ge(_,{id:"gov-mode",label:"govMode",tooltip:S=>{Te(S,{help:"govModeHelp"})},children:(S,F)=>{var I=_M();xt(I,22,()=>t,T=>T,(T,P,y)=>{var L=fM(),G=W(L),U={};Ae(()=>{Ee(G,P),U!==(U=b(y))&&(L.value=(L.__value=b(y))??"")}),Z(T,L)}),vr(I,()=>V.FEATURE_CONFIG.features.GOVERNOR?V.GOVERNOR.gov_mode:0,T=>{V.GOVERNOR.gov_mode=T,V.FEATURE_CONFIG.features.GOVERNOR=T>0}),Z(S,I)},$$slots:{tooltip:!0,default:!0}});var m=K(_,2);{var C=R=>{var S=hM(),F=W(S);Be(F,{children:(I,T)=>{var P=pM(),y=me(P);ge(y,{id:"gov-handover-throttle",label:"govHandoverThrottle",unit:"%",tooltip:w=>{Te(w,{help:"govHandoverThrottleHelp",attrs:[{name:"genericDefault",value:"20%"},{name:"genericRange",value:"10% - 50%"}]})},children:(w,x)=>{Oe(w,{id:"gov-handover-throttle",min:"10",max:"50",get value(){return V.GOVERNOR.gov_handover_throttle},set value(k){V.GOVERNOR.gov_handover_throttle=k}})},$$slots:{tooltip:!0,default:!0}});var L=K(y,2);{var G=N=>{ge(N,{id:"gov-spoolup-min-throttle",label:"govSpoolupMinThrottle",unit:"%",tooltip:x=>{Te(x,{help:"govSpoolupMinThrottleHelp",attrs:[{name:"genericDefault",value:"5%"},{name:"genericRange",value:"0% - 50%"}]})},children:(x,k)=>{Oe(x,{id:"gov-spoolup-min-throttle",min:"0",max:"50",get value(){return V.GOVERNOR.gov_spoolup_min_throttle},set value(O){V.GOVERNOR.gov_spoolup_min_throttle=O}})},$$slots:{tooltip:!0,default:!0}})};Ce(L,N=>{_e.gte(V.CONFIG.apiVersion,Dn)&&N(G)})}var U=K(L,2);ge(U,{id:"gov-zero-throttle-timeout",label:"govZeroThrottleTimeout",unit:"s",tooltip:w=>{Te(w,{help:"govZeroThrottleTimeoutHelp",attrs:[{name:"genericDefault",value:"3s"},{name:"genericRange",value:"0s - 10s"}]})},children:(w,x)=>{Oe(w,{id:"gov-zero-throttle-timeout",min:"0",max:"10",step:"0.1",get value(){return r.gov_zero_throttle_timeout},set value(k){r.gov_zero_throttle_timeout=k}})},$$slots:{tooltip:!0,default:!0}});var M=K(U,2);ge(M,{id:"gov-lost-headspeed-timeout",label:"govLostHeadspeedTimeout",unit:"s",tooltip:w=>{Te(w,{help:"govLostHeadspeedTimeoutHelp",attrs:[{name:"genericDefault",value:"1s"},{name:"genericRange",value:"0s - 10s"}]})},children:(w,x)=>{Oe(w,{id:"gov-lost-headspeed-timeout",min:"0",max:"10",step:"0.1",get value(){return r.gov_lost_headspeed_timeout},set value(k){r.gov_lost_headspeed_timeout=k}})},$$slots:{tooltip:!0,default:!0}}),Z(I,P)},$$slots:{default:!0}}),ke(3,S,()=>Ue),Z(R,S)};Ce(m,R=>{b(i)&&R(C)})}Z(g,d)},$$slots:{default:!0}});var p=K(u,2);{var h=g=>{var f=EM(),d=me(f),_=W(d);Be(_,{label:"govSectionRampTime",children:(F,I)=>{var T=mM(),P=me(T);ge(P,{id:"gov-startup-time",label:"govStartupTime",unit:"s",tooltip:N=>{Te(N,{help:"govStartupTimeHelp",attrs:[{name:"genericDefault",value:"20s"},{name:"genericRange",value:"0s - 60s"}]})},children:(N,w)=>{Oe(N,{id:"gov-startup-time",min:"0",max:"60",step:"0.1",get value(){return r.gov_startup_time},set value(x){r.gov_startup_time=x}})},$$slots:{tooltip:!0,default:!0}});var y=K(P,2);ge(y,{id:"gov-spoolup-time",label:"govSpoolupTime",unit:"s",tooltip:N=>{Te(N,{help:"govSpoolupTimeHelp",attrs:[{name:"genericDefault",value:"10s"},{name:"genericRange",value:"0s - 60s"}]})},children:(N,w)=>{Oe(N,{id:"gov-spoolup-time",min:"0",max:"60",step:"0.1",get value(){return r.gov_spoolup_time},set value(x){r.gov_spoolup_time=x}})},$$slots:{tooltip:!0,default:!0}});var L=K(y,2);ge(L,{id:"gov-tracking-time",label:"govTrackingTime",unit:"s",tooltip:N=>{Te(N,{help:"govTrackingTimeHelp",attrs:[{name:"genericDefault",value:"2s"},{name:"genericRange",value:"0s - 10s"}]})},children:(N,w)=>{Oe(N,{id:"gov-tracking-time",min:"0",max:"10",step:"0.1",get value(){return r.gov_tracking_time},set value(x){r.gov_tracking_time=x}})},$$slots:{tooltip:!0,default:!0}});var G=K(L,2);ge(G,{id:"gov-recovery-time",label:"govRecoveryTime",unit:"s",tooltip:N=>{Te(N,{help:"govRecoveryTimeHelp",attrs:[{name:"genericDefault",value:"2s"},{name:"genericRange",value:"0s - 10s"}]})},children:(N,w)=>{Oe(N,{id:"gov-recovery-time",min:"0",max:"10",step:"0.1",get value(){return r.gov_recovery_time},set value(x){r.gov_recovery_time=x}})},$$slots:{tooltip:!0,default:!0}});var U=K(G,2);ge(U,{id:"gov-auto-bailout-time",label:"govAutoBailoutTime",unit:"s",tooltip:N=>{Te(N,{help:"govAutoBailoutTimeHelp",attrs:[{name:"genericDefault",value:"0s"},{name:"genericRange",value:"0s - 10s"}]})},children:(N,w)=>{Oe(N,{id:"gov-auto-bailout-time",min:"0",max:"10",step:"0.1",get value(){return r.gov_autorotation_bailout_time},set value(x){r.gov_autorotation_bailout_time=x}})},$$slots:{tooltip:!0,default:!0}}),Z(F,T)},$$slots:{default:!0}});var m=K(d,2),C=W(m);Be(C,{label:"govSectionAutorotation",children:(F,I)=>{var T=CM(),P=me(T);ge(P,{id:"gov-auto-timeout",label:"govAutoTimeout",unit:"s",tooltip:G=>{Te(G,{help:"govAutoTimeoutHelp",attrs:[{name:"genericDefault",value:"0s"},{name:"genericRange",value:"0s - 60s"}]})},children:(G,U)=>{Oe(G,{id:"gov-auto-timeout",type:"number",min:"0",max:"60",step:"0.1",get value(){return r.gov_autorotation_timeout},set value(M){r.gov_autorotation_timeout=M}})},$$slots:{tooltip:!0,default:!0}});var y=K(P,2);ge(y,{id:"gov-auto-min-entry-time",label:"govAutoMinEntryTime",unit:"s",tooltip:G=>{Te(G,{help:"govAutoMinEntryTimeHelp",attrs:[{name:"genericDefault",value:"5s"},{name:"genericRange",value:"0s - 60s"}]})},children:(G,U)=>{Oe(G,{id:"gov-auto-min-entry-time",min:"0",max:"60",step:"0.1",get value(){return r.gov_autorotation_min_entry_time},set value(M){r.gov_autorotation_min_entry_time=M}})},$$slots:{tooltip:!0,default:!0}}),Z(F,T)},$$slots:{default:!0}});var R=K(m,2),S=W(R);Be(S,{label:"govSectionFilters",children:(F,I)=>{var T=vM(),P=me(T);ge(P,{id:"gov-headspeed-filter",label:"govHeadspeedFilterHz",unit:"Hz",tooltip:M=>{Te(M,{help:"govHeadspeedFilterHzHelp",attrs:[{name:"genericDefault",value:"10Hz"},{name:"genericRange",value:"0Hz - 250Hz"}]})},children:(M,N)=>{Oe(M,{id:"gov-headspeed-filter",min:"0",max:"250",get value(){return V.GOVERNOR.gov_rpm_filter},set value(w){V.GOVERNOR.gov_rpm_filter=w}})},$$slots:{tooltip:!0,default:!0}});var y=K(P,2);ge(y,{id:"gov-voltage-filter",label:"govVoltageFilterHz",unit:"Hz",tooltip:M=>{Te(M,{help:"govVoltageFilterHzHelp",attrs:[{name:"genericDefault",value:"5Hz"},{name:"genericRange",value:"0Hz - 250Hz"}]})},children:(M,N)=>{Oe(M,{id:"gov-voltage-filter",min:"0",max:"250",get value(){return V.GOVERNOR.gov_pwr_filter},set value(w){V.GOVERNOR.gov_pwr_filter=w}})},$$slots:{tooltip:!0,default:!0}});var L=K(y,2);ge(L,{id:"gov-tta-filter",label:"govTTAFilterHz",unit:"Hz",tooltip:M=>{Te(M,{help:"govTTAFilterHzHelp",attrs:[{name:"genericDefault",value:"0Hz"},{name:"genericRange",value:"0Hz - 250Hz"}]})},children:(M,N)=>{Oe(M,{id:"gov-tta-filter",min:"0",max:"250",get value(){return V.GOVERNOR.gov_tta_filter},set value(w){V.GOVERNOR.gov_tta_filter=w}})},$$slots:{tooltip:!0,default:!0}});var G=K(L,2);ge(G,{id:"gov-ff-filter",label:"govFFFilterHz",unit:"Hz",tooltip:M=>{Te(M,{help:"govFFFilterHzHelp",attrs:[{name:"genericDefault",value:"10Hz"},{name:"genericRange",value:"0Hz - 250Hz"}]})},children:(M,N)=>{Oe(M,{id:"gov-ff-filter",min:"0",max:"250",get value(){return V.GOVERNOR.gov_ff_filter},set value(w){V.GOVERNOR.gov_ff_filter=w}})},$$slots:{tooltip:!0,default:!0}}),Z(F,T)},$$slots:{default:!0}}),ke(3,d,()=>Ue),ke(3,m,()=>Ue),ke(3,R,()=>Ue),Z(g,f)};Ce(p,g=>{b(i)&&g(h)})}Z(o,l)},$$slots:{default:!0}}),Ge()}var FM=ne('<div class="svelte-1rb9oyy"><div class="top-container svelte-1rb9oyy"><div class="title grow svelte-1rb9oyy"> </div> <div class="svelte-1rb9oyy"> </div></div> <div class="meter svelte-1rb9oyy"><div class="left-label svelte-1rb9oyy"> </div> <div class="right-label svelte-1rb9oyy"> </div> <div class="fill svelte-1rb9oyy"></div></div></div>');function ur(n,e){we(e,!0);var t=FM(),r=W(t),i=W(r),o=W(i),s=K(i,2),l=W(s),a=K(r,2),c=W(a),u=W(c),p=K(c,2),h=W(p),g=K(p,2);let f;Ae(d=>{Ee(o,e.title),Ee(l,e.max),Ee(u,e.leftLabel),Ee(h,e.rightLabel),f=ha(g,"",f,{width:d})},[()=>`${(e.value??0).clamp(0,100)}%`]),Z(n,t),Ge()}var IM=ne('<div class="svelte-gu3lip"></div>');function bM(n,e){we(e,!0);let t=ft(e,"value",15),r,i;bn(()=>{i?.set(t())}),di(()=>{i=Gr(r,{...e.opts,cssPrefix:"svelte-slide-"}),i.on("slide",l=>{t(Number(l[0])),e.onchange?.(t())}),i.set(t())}),Ka(()=>{i.destroy()});function o(l){i?.updateOptions(l)}var s=IM();return Hi(s,l=>r=l,()=>r),Z(n,s),Ge({update:o})}var TM=ne('<span class="svelte-v5x5aa">-</span> <span class="svelte-v5x5aa"> </span>',1),OM=ne('<div class="header svelte-v5x5aa"><span class="svelte-v5x5aa"> </span> <!></div>'),PM=ne('<div class="svelte-v5x5aa"><div class="slider-container svelte-v5x5aa"><!></div></div>'),AM=ne('<div class="svelte-v5x5aa"><div class="bar svelte-v5x5aa"><!></div></div>'),MM=ne('<div class="svelte-v5x5aa"><div class="bar svelte-v5x5aa"><!></div> <div class="bar svelte-v5x5aa"><!></div> <div class="bar svelte-v5x5aa"><!></div> <div class="bar svelte-v5x5aa"><!></div></div>'),NM=ne('<div class="svelte-v5x5aa"><div class="bar svelte-v5x5aa"><!></div></div>'),xM=ne('<!> <div class="svelte-v5x5aa"><!> <div class="bar svelte-v5x5aa"><!></div> <!> <!></div>',1);function yM(n,e){we(e,!0);const[t,r]=Et(),i=()=>vt(St,"$i18n",t);let o=pe(void 0),s=pe(0),l=ue(()=>b(s)<=480),a=ue(()=>b(l)?10:5),c=ue(()=>{const L=[],G=b(l)?20:10;for(let U=0;U<=100;U+=G)L.push(U);return L}),u=ue(()=>({range:{min:0,max:100},connect:[!0,!1],start:0,step:1,behaviour:"snap-drag",pips:{mode:"values",values:b(c),density:b(a),stepped:!0}}));bn(()=>{b(o)?.update(b(u))});let p=ue(()=>{const L=V.MOTOR_DATA[e.index];return L<0?(L+1e3)/10:L>0?(L-1e3)/10:0}),h=ue(()=>V.MOTOR_TELEMETRY_DATA.rpm[e.index]??0),g=ue(()=>V.MOTOR_TELEMETRY_DATA.voltage[e.index]/1e3),f=ue(()=>V.MOTOR_TELEMETRY_DATA.current[e.index]/1e3),d=ue(()=>V.MOTOR_TELEMETRY_DATA.temperature[e.index]/10),_=ue(()=>V.MOTOR_TELEMETRY_DATA.temperature2[e.index]/10),m=ue(()=>V.MOTOR_TELEMETRY_DATA.invalidPercent[e.index]/100),C=pe(5e3),R=pe(10),S=pe(10),F=pe(100),I=pe(100);bn(()=>{b(h)>b(C)&&ce(C,Math.ceil((b(h)+1e3)/1e3)*1e3),b(g)>b(R)&&ce(R,Math.ceil((b(g)+1)/1)*1),b(f)>b(S)&&ce(S,Math.ceil((b(f)+1)/1)*1),b(d)>b(F)&&ce(F,Math.ceil((b(d)+1)/1)*1),b(_)>b(I)&&ce(I,Math.ceil((b(_)+1)/1)*1)});let T;function P(){T||(T=setTimeout(()=>{T=null,mspHelper.sendMotorOverride(e.index)},50))}let y;bn(()=>{nt.overrideEnabled?_e.gte(V.CONFIG.apiVersion,lo)&&!y&&(y=setInterval(()=>{mspHelper.sendMotorOverride(e.index)},250)):(clearInterval(y),y=null,clearTimeout(T),T=null)}),Ka(()=>{clearInterval(y),clearTimeout(T),T=null}),Gt(n,{header:G=>{var U=OM(),M=W(U),N=W(M),w=K(M,2);{var x=k=>{var O=TM(),D=K(me(O),2),Y=W(D);Ae(()=>Ee(Y,`${V.MOTOR_OVERRIDE[e.index]*.1}%`)),Z(k,O)};Ce(w,k=>{nt.overrideEnabled&&k(x)})}Ae(()=>Ee(N,`Motor #${e.index+1}`)),Z(G,U)},children:(G,U)=>{var M=xM(),N=me(M);{var w=ie=>{var te=PM(),fe=W(te),Re=W(fe),$e=()=>V.MOTOR_OVERRIDE[e.index]*.1,Ve=tt=>V.MOTOR_OVERRIDE[e.index]=tt*10;Hi(bM(Re,{get value(){return $e()},set value(tt){Ve(tt)},onchange:P,get opts(){return b(u)}}),tt=>ce(o,tt,!0),()=>b(o)),ke(3,te,()=>Ue),Z(ie,te)};Ce(N,ie=>{nt.overrideEnabled&&ie(w)})}var x=K(N,2),k=W(x);{var O=ie=>{var te=AM(),fe=W(te),Re=W(fe);const $e=ue(()=>i().t("motorThrottle")),Ve=ue(()=>`${b(p)}%`);ur(Re,{get title(){return b($e)},rightLabel:"100%",get leftLabel(){return b(Ve)},get value(){return b(p)}}),ke(3,te,()=>Ue),Z(ie,te)};Ce(k,ie=>{nt.overrideEnabled&&ie(O)})}var D=K(k,2),Y=W(D);const z=ue(()=>i().t("motorRPM")),ee=ue(()=>`${b(C).toLocaleString()} RPM`),re=ue(()=>`${b(h).toLocaleString()} RPM`),le=ue(()=>100*b(h)/b(C));ur(Y,{get title(){return b(z)},get rightLabel(){return b(ee)},get leftLabel(){return b(re)},get value(){return b(le)}});var J=K(D,2);{var oe=ie=>{var te=MM(),fe=W(te),Re=W(fe);const $e=ue(()=>i().t("motorVoltage")),Ve=ue(()=>`${b(R)} V`),tt=ue(()=>`${b(g).toFixed(2)} V`),en=ue(()=>100*b(g)/b(R));ur(Re,{get title(){return b($e)},get rightLabel(){return b(Ve)},get leftLabel(){return b(tt)},get value(){return b(en)}});var ot=K(fe,2),jt=W(ot);const Nn=ue(()=>i().t("motorCurrent")),hn=ue(()=>`${b(S)} A`),Br=ue(()=>`${b(f).toFixed(2)} A`),pi=ue(()=>100*b(f)/b(S));ur(jt,{get title(){return b(Nn)},get rightLabel(){return b(hn)},get leftLabel(){return b(Br)},get value(){return b(pi)}});var Xn=K(ot,2),Yn=W(Xn);const xn=ue(()=>i().t("motorTemperature",{number:1})),yn=ue(()=>`${b(F)} °C`),Vr=ue(()=>`${b(d).toFixed(1)} °C`),zn=ue(()=>100*b(d)/b(F));ur(Yn,{get title(){return b(xn)},get rightLabel(){return b(yn)},get leftLabel(){return b(Vr)},get value(){return b(zn)}});var Hr=K(Xn,2),Xr=W(Hr);const hi=ue(()=>i().t("motorTemperature",{number:2})),or=ue(()=>`${b(I)} °C`),sr=ue(()=>`${b(_).toFixed(1)} °C`),tn=ue(()=>100*b(_)/b(I));ur(Xr,{get title(){return b(hi)},get rightLabel(){return b(or)},get leftLabel(){return b(sr)},get value(){return b(tn)}}),ke(3,te,()=>Ue),Z(ie,te)};Ce(J,ie=>{nt.telemEnabled&&ie(oe)})}var ae=K(J,2);{var de=ie=>{var te=NM(),fe=W(te),Re=W(fe);const $e=ue(()=>i().t("motorDshotError")),Ve=ue(()=>`${b(m).toFixed(2)}%`);ur(Re,{get title(){return b($e)},rightLabel:"100%",get leftLabel(){return b(Ve)},get value(){return b(m)}}),ke(3,te,()=>Ue),Z(ie,te)};Ce(ae,ie=>{V.MOTOR_CONFIG.use_dshot_telemetry&&ie(de)})}Z(G,M)},$$slots:{header:!0,default:!0}}),Dg("innerWidth",L=>ce(s,L,!0)),Ge(),r()}var wM=ne("<!> <!>",1),GM=ne('<div class="container svelte-1gaw79u"><!></div>');function LM(n,e){we(e,!0);const[t,r]=Et(),i=()=>vt(St,"$i18n",t);let o=ue(()=>V.MOTOR_CONFIG.main_rotor_gear_ratio[0]/V.MOTOR_CONFIG.main_rotor_gear_ratio[1]),s=ue(()=>{const g=V.MOTOR_CONFIG.tail_rotor_gear_ratio[0]/V.MOTOR_CONFIG.tail_rotor_gear_ratio[1];return V.MIXER_CONFIG.tail_rotor_mode===0?b(o)/g:g});const l=0;let a=ue(()=>V.MIXER_CONFIG.tail_rotor_mode===0?0:1),c=ue(()=>Math.round(V.MOTOR_TELEMETRY_DATA.rpm[l]*b(o))),u=ue(()=>Math.round(V.MOTOR_TELEMETRY_DATA.rpm[b(a)]*b(s))),p=pe(1e3),h=pe(5e3);bn(()=>{b(c)>b(p)&&ce(p,Math.ceil((b(c)+1e3)/1e3)*1e3),b(u)>b(h)&&ce(h,Math.ceil((b(u)+1e3)/1e3)*1e3)}),Gt(n,{label:"motorRotorSpeeds",children:(g,f)=>{var d=GM(),_=W(d);{var m=C=>{var R=wM(),S=me(R);const F=ue(()=>i().t("motorMainRotorSpeed")),I=ue(()=>`${b(p).toLocaleString()} RPM`),T=ue(()=>`${b(c).toLocaleString()} RPM`),P=ue(()=>100*(b(c)/b(p)));ur(S,{get title(){return b(F)},get rightLabel(){return b(I)},get leftLabel(){return b(T)},get value(){return b(P)}});var y=K(S,2);{var L=G=>{const U=ue(()=>i().t("motorTailRotorSpeed")),M=ue(()=>`${b(h).toLocaleString()} RPM`),N=ue(()=>`${b(u).toLocaleString()} RPM`),w=ue(()=>100*(b(u)/b(h)));ur(G,{get title(){return b(U)},get rightLabel(){return b(M)},get leftLabel(){return b(N)},get value(){return b(w)}})};Ce(y,G=>{(V.MIXER_CONFIG.tail_rotor_mode===0||V.CONFIG.motorCount>1)&&G(L)})}Z(C,R)};Ce(_,C=>{V.CONFIG.motorCount>0&&C(m)})}Z(g,d)},$$slots:{default:!0}}),Ge(),r()}var zs=Md(()=>nt),$M=ne("<!> <!>",1);function DM(n,e){we(e,!1);async function t(){zs().overrideEnabled||await mspHelper.resetMotorOverrides()}Ad(),Gt(n,{label:"motorOverrideTitle",children:(r,i)=>{var o=$M(),s=me(o);nf(s,{message:"motorOverrideNote"});var l=K(s,2);Be(l,{children:(a,c)=>{ge(a,{id:"motor-override-enable",label:"genericEnable",children:(u,p)=>{ut(u,{id:"motor-override-enable",onchange:t,get checked(){return zs().overrideEnabled},set checked(h){zs(zs().overrideEnabled=h)},$$legacy:!0})},$$slots:{default:!0}})},$$slots:{default:!0}}),Z(r,o)},$$slots:{default:!0}}),Ge()}function kM(){window.open(getTabHelpURL("tabMotors"),"_system")}var UM=ne('<h1 class="svelte-1hbu6jl"> </h1> <div class="grow svelte-1hbu6jl"></div> <button class="help-btn svelte-1hbu6jl">Help</button>',1),BM=ne('<button class="svelte-1hbu6jl"> </button> <button class="svelte-1hbu6jl"> </button>',1),VM=ne('<div class="svelte-1hbu6jl"><!></div> <div class="svelte-1hbu6jl"><!></div> <div class="svelte-1hbu6jl"><!></div>',1),HM=ne('<div class="svelte-1hbu6jl"><!></div>'),XM=ne('<div class="svelte-1hbu6jl"><!></div>'),YM=ne('<!> <div class="svelte-1hbu6jl"><!></div> <!>',1),zM=ne('<div class="content svelte-1hbu6jl"><div class="svelte-1hbu6jl"><!> <!></div> <div class="svelte-1hbu6jl"><!></div></div>');function WM(n,e){we(e,!0);const[t,r]=Et(),i=()=>vt(St,"$i18n",t),o=S=>{var F=UM(),I=me(F),T=W(I),P=K(I,4);P.__click=[kM],Ae(y=>Ee(T,y),[()=>i().t("tabMotors")]),Z(S,F)},s=S=>{var F=BM(),I=me(F);I.__click=_;var T=W(I),P=K(I,2);P.__click=d;var y=W(P);Ae((L,G)=>{I.disabled=nt.overrideEnabled,Ee(T,L),P.disabled=nt.overrideEnabled,Ee(y,G)},[()=>i().t("buttonRevert"),()=>i().t("buttonSaveReboot")]),Z(S,F)};let l=pe(!0),a,c,u=ue(()=>nt.throttleEnabled&&V.CONFIG.motorCount>0),p=ue(()=>V.FEATURE_CONFIG.features.FREQ_SENSOR||V.FEATURE_CONFIG.features.ESC_SENSOR||nt.isDshot&&V.MOTOR_CONFIG.use_dshot_telemetry);function h(){return Qn({MOTOR_CONFIG:V.MOTOR_CONFIG,GOVERNOR:V.GOVERNOR,ESC_SENSOR_CONFIG:V.ESC_SENSOR_CONFIG,features:V.FEATURE_CONFIG.features.bitfield})}let g=ue(()=>a?cs(a,h()):[]),f=ue(()=>!b(l)&&b(g).length>0);di(async()=>{await mspHelper.resetMotorOverrides(),await MSP.promise(lt.MSP_STATUS),await MSP.promise(lt.MSP_FEATURE_CONFIG),await MSP.promise(lt.MSP_MIXER_CONFIG),await MSP.promise(lt.MSP_MOTOR_CONFIG),await MSP.promise(lt.MSP_MOTOR_OVERRIDE),await MSP.promise(lt.MSP_GOVERNOR_CONFIG),await MSP.promise(lt.MSP_ESC_SENSOR_CONFIG),await MSP.promise(lt.MSP_MOTOR),await MSP.promise(lt.MSP_MOTOR_TELEMETRY),await MSP.promise(lt.MSP_BATTERY_STATE),a=h(),ce(l,!1),c=setInterval(async()=>{await MSP.promise(lt.MSP_MOTOR),await MSP.promise(lt.MSP_MOTOR_TELEMETRY),await MSP.promise(lt.MSP_BATTERY_STATE)},50)}),Ka(()=>{clearInterval(c)}),bn(()=>{nt.fixConfig()});async function d(){nt.overrideEnabled=!1,await mspHelper.resetMotorOverrides();function S(F){return MSP.promise(F,mspHelper.crunch(F))}await mspHelper.sendRxFailConfig(),await S(lt.MSP_SET_FEATURE_CONFIG),await S(lt.MSP_SET_MOTOR_CONFIG),await S(lt.MSP_SET_GOVERNOR_CONFIG),await S(lt.MSP_SET_ESC_SENSOR_CONFIG),await MSP.promise(lt.MSP_EEPROM_WRITE),GUI.log(i().t("eepromSaved")),MSP.send_message(lt.MSP_SET_REBOOT),GUI.log(i().t("deviceRebooting")),rl()}async function _(){nt.overrideEnabled=!1,await mspHelper.resetMotorOverrides(),Object.assign(V.MOTOR_CONFIG,a.MOTOR_CONFIG),Object.assign(V.GOVERNOR,a.GOVERNOR),Object.assign(V.ESC_SENSOR_CONFIG,a.ESC_SENSOR_CONFIG),V.FEATURE_CONFIG.features.bitfield=a.features}function m(){return b(g).length>0&&!nt.overrideEnabled}const C=ue(()=>b(f)&&s);zd(n,{get header(){return o},get loading(){return b(l)},get toolbar(){return b(C)},children:(S,F)=>{var I=zM(),T=W(I),P=W(T);jA(P,{});var y=K(P,2);{var L=N=>{var w=VM(),x=me(w),k=W(x);lM(k,{});var O=K(x,2),D=W(O);JA(D,{});var Y=K(O,2),z=W(Y);RM(z,{}),ke(3,x,()=>Ue),ke(3,O,()=>Ue),ke(3,Y,()=>Ue),Z(N,w)};Ce(y,N=>{b(u)&&N(L)})}var G=K(T,2),U=W(G);{var M=N=>{var w=YM(),x=me(w);{var k=z=>{var ee=HM(),re=W(ee);LM(re,{}),ke(7,ee,()=>Ue),Z(z,ee)};Ce(x,z=>{b(p)&&z(k)})}var O=K(x,2),D=W(O);DM(D,{});var Y=K(O,2);xt(Y,17,()=>({length:V.CONFIG.motorCount}),is,(z,ee,re)=>{var le=XM(),J=W(le);yM(J,{index:re}),ke(7,le,()=>Ue),Z(z,le)}),ke(3,O,()=>Ue),Z(N,w)};Ce(U,N=>{b(u)&&N(M)})}Z(S,I)},$$slots:{default:!0}});var R=Ge({onSave:d,onRevert:_,isDirty:m});return r(),R}pn(["click"]);const Lh={tabName:"motors",svelteComponent:null,get isDirty(){return this.svelteComponent?.isDirty()},initialize(n){const e=document.querySelector("#content");e.innerHTML="",this.svelteComponent=Rr(WM,{target:e}),GUI.content_ready(n)},cleanup(n){(async()=>{try{nt.overrideEnabled&&(nt.overrideEnabled=!1,await mspHelper.resetMotorOverrides())}finally{this.svelteComponent&&(ni(this.svelteComponent),this.svelteComponent=null),n?.()}})()},save(n){this.svelteComponent?this.svelteComponent.onSave().finally(n):n?.()},revert(n){this.svelteComponent?this.svelteComponent.onRevert().finally(n):n?.()}};TABS[Lh.tabName]=Lh;const Nt={tabName:"options"};Nt.initialize=function(n){$("#content").load("/src/tabs/options.html",function(){i18n.localizePage(),Nt.initRememberLastTab(),Nt.initCheckForConfiguratorUnstableVersions(),Nt.initCliAutoComplete(),Nt.initAutoConnectConnectionTimeout(),Nt.initCordovaForceComputerUI(),Nt.initDarkTheme(),Nt.rememberLastSelectedBoard(),GUI.content_ready(n)})};Nt.cleanup=function(n){n?.()};Nt.initRememberLastTab=function(){$("div.rememberLastTab input").prop("checked",!!We("rememberLastTab")).change(function(){it({rememberLastTab:$(this).is(":checked")})}).change()};Nt.rememberLastSelectedBoard=function(){$("div.rememberLastSelectedBoard input").prop("checked",!!We("rememberLastSelectedBoard")).change(function(){it({rememberLastSelectedBoard:$(this).is(":checked")})}).change()};Nt.initCheckForConfiguratorUnstableVersions=function(){We("checkForConfiguratorUnstableVersions")&&$("div.checkForConfiguratorUnstableVersions input").prop("checked",!0),$("div.checkForConfiguratorUnstableVersions input").change(function(){const n=$(this).is(":checked");it({checkForConfiguratorUnstableVersions:n}),checkForConfiguratorUpdates()})};Nt.initCliAutoComplete=function(){$("div.cliAutoComplete input").prop("checked",CliAutoComplete.configEnabled).change(function(){const n=$(this).is(":checked");it({cliAutoComplete:n}),CliAutoComplete.setEnabled(n)}).change()};Nt.initAutoConnectConnectionTimeout=function(){const n=We("connectionTimeout");n&&$("#connectionTimeoutSelect").val(n),$("#connectionTimeoutSelect").on("change",function(){const e=parseInt($(this).val());it({connectionTimeout:e})})};Nt.initCordovaForceComputerUI=function(){GUI.isCordova()&&cordovaUI.canChangeUI?(We("cordovaForceComputerUI")&&$("div.cordovaForceComputerUI input").prop("checked",!0),$("div.cordovaForceComputerUI input").change(function(){const n=$(this).is(":checked");it({cordovaForceComputerUI:n}),typeof cordovaUI.set=="function"&&cordovaUI.set()})):$("div.cordovaForceComputerUI").hide()};Nt.initDarkTheme=function(){$("#darkThemeSelect").val(DarkTheme.configEnabled).change(function(){const n=parseInt($(this).val());it({darkTheme:n}),setDarkTheme(n)}).change()};TABS[Nt.tabName]=Nt;class jm{get fullPath(){return this.presetData.fullPath}sourceMetadata=null;presetData=null;cliStringsArr=[];renderedCliArr=[];optionsValues=null;completeWarning="";constructor(e,t){this.sourceMetadata=e,this.presetData=t}get viewLink(){return this.sourceMetadata.viewUrl+this.presetData.fullPath}}class qm{#e;#i;#s;#r={parentDiv:null,divWrapper:null,title:null,star:null,category:null,author:null,keywords:null,sourceRepository:null,sourceRepositoryRow:null,versions:null,status:null};#o={onLoaded:null};#n;#t=!1;#u;#c;#l;#_;#f;#a="";constructor(e,t,r,i,o,s,l,a){this.#r.parentDiv=e,this.#o.onLoaded=l,this.#s=`preset_panel_${t.hash}`,i&&(this.#s+="_clickable"),this.#i=t,this.#e=r,this.#n=o,this.#t=i,this.#f=a,this.#_=s,this.#r.parentDiv.append(`<div class="${this.#s}"></div>`),this.#r.divWrapper=$(`.${this.#s}`),this.#r.divWrapper.toggle(!1),this.#u=!1,this.#c=!1,this.#l=!1,this.#a=this.#e.metadata.viewUrl+this.#i.fullPath}#g(){this.#r.title=this.#r.divWrapper.find(".preset_panel_title"),this.#r.star=this.#r.divWrapper.find(".preset_panel_star"),this.#r.category=this.#r.divWrapper.find(".preset_panel_category"),this.#r.author=this.#r.divWrapper.find(".preset_panel_author_text"),this.#r.keywords=this.#r.divWrapper.find(".preset_panel_keywords_text"),this.#r.sourceRepository=this.#r.divWrapper.find(".preset_panel_source_text"),this.#r.sourceRepositoryRow=this.#r.divWrapper.find(".preset_panel_source_row"),this.#r.versions=this.#r.divWrapper.find(".preset_panel_versions_text"),this.#r.boards=this.#r.divWrapper.find(".preset_panel_boards_text"),this.#r.boardsRow=this.#r.divWrapper.find(".preset_panel_boards_row"),this.#r.status=this.#r.divWrapper.find(".preset_panel_status")}#d(){let e=!1;this.#t&&this.#l&&!this.#c?this.#r.divWrapper.css({"background-color":"var(--darkAccent)"}):this.#r.divWrapper.css({"background-color":"var(--backgroundColor)"}),this.#c||this.#l&&this.#t?(this.#r.star.css({"background-color":"var(--darkAccent)"}),e=!0):(this.#r.divWrapper.css({"background-color":"var(--backgroundColor)"}),this.#r.star.css({"background-color":"var(--backgroundColor)"})),this.#f.find(this.#a)?this.#r.star.css("background-image","url('../../../images/icons/star_rf_blue.svg')"):e?this.#r.star.css("background-image","url('../../../images/icons/star_rf_blue_stroke.svg')"):this.#r.star.css("background-image","url('../../../images/icons/star_transparent.svg')")}load(){return new Promise(e=>{this.#r.divWrapper.load("./tabs/presets/preset_panel.html",()=>{this.#p(),e()})})}subscribeClick(e,t){this.#r.divWrapper.on("click",()=>{this.#u||this.showPresetDetails(e,t),this.#u=!1})}showPresetDetails(e,t,r=null,i=null){let o=!0;r===null&&(r=new jm(this.#e.metadata,this.#i),o=!1),e.showPreset(this.#e,r,this.#n).then(s=>{s&&(this.setPicked(!0),o||t.push(r)),this.#d(),i?.()})}setPicked(e){this.#t&&(e?this.#r.divWrapper.css({border:"2px solid green"}):this.#r.divWrapper.css({border:"1px solid var(--subtleAccent)"}))}#p(){this.#g(),this.#r.category.text(this.#i.category),this.#r.title.text(this.#i.title),this.#r.title.prop("title",this.#i.title),this.#r.author.text(this.#i.author),this.#r.versions.text(this.#i.firmware_version?.join(", ")),this.#i.board_name?.length>0?(this.#r.boards.text(this.#i.board_name.join(", ")),this.#r.boardsRow.toggle(!0)):this.#r.boardsRow.toggle(!1),this.#r.sourceRepository.text(this.#e.metadata.name),this.#r.sourceRepositoryRow.toggle(this.#n),this.#r.keywords.text(this.#i.keywords?.join("; ")),this.#r.keywords.prop("title",this.#i.keywords?.join("; ")),this.#r.status.text(this.#i.status),this.setPicked(this.#_),this.#m(),this.#r.divWrapper.on("mouseenter",()=>{this.#l=!0,this.#d()}),this.#r.divWrapper.on("mouseleave",()=>{this.#l=!1,this.#d()}),this.#r.star.on("mouseenter",()=>{this.#c=!0,this.#d()}),this.#r.star.on("mouseleave",()=>{this.#c=!1,this.#d()}),i18n.localizePage(),this.#r.divWrapper.toggle(!0),typeof this.#o.onLoaded=="function"&&this.#o.onLoaded()}#m(){this.#d(),this.#r.star.on("click",()=>{this.#u=!0,this.#h()})}#h(){this.#f.find(this.#a)?this.#f.remove(this.#a):this.#f.add(this.#a),this.#d()}remove(){this.#r.divWrapper.remove()}}/*! @license DOMPurify 3.2.6 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.2.6/LICENSE */const{entries:Km,setPrototypeOf:$h,isFrozen:jM,getPrototypeOf:qM,getOwnPropertyDescriptor:KM}=Object;let{freeze:Yt,seal:An,create:Qm}=Object,{apply:ud,construct:dd}=typeof Reflect<"u"&&Reflect;Yt||(Yt=function(e){return e});An||(An=function(e){return e});ud||(ud=function(e,t,r){return e.apply(t,r)});dd||(dd=function(e,t){return new e(...t)});const Ws=zt(Array.prototype.forEach),QM=zt(Array.prototype.lastIndexOf),Dh=zt(Array.prototype.pop),bo=zt(Array.prototype.push),ZM=zt(Array.prototype.splice),na=zt(String.prototype.toLowerCase),Au=zt(String.prototype.toString),kh=zt(String.prototype.match),To=zt(String.prototype.replace),JM=zt(String.prototype.indexOf),eN=zt(String.prototype.trim),Ln=zt(Object.prototype.hasOwnProperty),Ut=zt(RegExp.prototype.test),Oo=tN(TypeError);function zt(n){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];return ud(n,e,r)}}function tN(n){return function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return dd(n,t)}}function He(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:na;$h&&$h(n,null);let r=e.length;for(;r--;){let i=e[r];if(typeof i=="string"){const o=t(i);o!==i&&(jM(e)||(e[r]=o),i=o)}n[i]=!0}return n}function nN(n){for(let e=0;e<n.length;e++)Ln(n,e)||(n[e]=null);return n}function lr(n){const e=Qm(null);for(const[t,r]of Km(n))Ln(n,t)&&(Array.isArray(r)?e[t]=nN(r):r&&typeof r=="object"&&r.constructor===Object?e[t]=lr(r):e[t]=r);return e}function Po(n,e){for(;n!==null;){const r=KM(n,e);if(r){if(r.get)return zt(r.get);if(typeof r.value=="function")return zt(r.value)}n=qM(n)}function t(){return null}return t}const Uh=Yt(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Mu=Yt(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Nu=Yt(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),rN=Yt(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),xu=Yt(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),iN=Yt(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),Bh=Yt(["#text"]),Vh=Yt(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),yu=Yt(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),Hh=Yt(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),js=Yt(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),oN=An(/\{\{[\w\W]*|[\w\W]*\}\}/gm),sN=An(/<%[\w\W]*|[\w\W]*%>/gm),aN=An(/\$\{[\w\W]*/gm),lN=An(/^data-[\-\w.\u00B7-\uFFFF]+$/),cN=An(/^aria-[\-\w]+$/),Zm=An(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),uN=An(/^(?:\w+script|data):/i),dN=An(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Jm=An(/^html$/i),fN=An(/^[a-z][.\w]*(-[.\w]+)+$/i);var Xh=Object.freeze({__proto__:null,ARIA_ATTR:cN,ATTR_WHITESPACE:dN,CUSTOM_ELEMENT:fN,DATA_ATTR:lN,DOCTYPE_NAME:Jm,ERB_EXPR:sN,IS_ALLOWED_URI:Zm,IS_SCRIPT_OR_DATA:uN,MUSTACHE_EXPR:oN,TMPLIT_EXPR:aN});const Ao={element:1,text:3,progressingInstruction:7,comment:8,document:9},_N=function(){return typeof window>"u"?null:window},pN=function(e,t){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let r=null;const i="data-tt-policy-suffix";t&&t.hasAttribute(i)&&(r=t.getAttribute(i));const o="dompurify"+(r?"#"+r:"");try{return e.createPolicy(o,{createHTML(s){return s},createScriptURL(s){return s}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}},Yh=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function eC(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:_N();const e=be=>eC(be);if(e.version="3.2.6",e.removed=[],!n||!n.document||n.document.nodeType!==Ao.document||!n.Element)return e.isSupported=!1,e;let{document:t}=n;const r=t,i=r.currentScript,{DocumentFragment:o,HTMLTemplateElement:s,Node:l,Element:a,NodeFilter:c,NamedNodeMap:u=n.NamedNodeMap||n.MozNamedAttrMap,HTMLFormElement:p,DOMParser:h,trustedTypes:g}=n,f=a.prototype,d=Po(f,"cloneNode"),_=Po(f,"remove"),m=Po(f,"nextSibling"),C=Po(f,"childNodes"),R=Po(f,"parentNode");if(typeof s=="function"){const be=t.createElement("template");be.content&&be.content.ownerDocument&&(t=be.content.ownerDocument)}let S,F="";const{implementation:I,createNodeIterator:T,createDocumentFragment:P,getElementsByTagName:y}=t,{importNode:L}=r;let G=Yh();e.isSupported=typeof Km=="function"&&typeof R=="function"&&I&&I.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:U,ERB_EXPR:M,TMPLIT_EXPR:N,DATA_ATTR:w,ARIA_ATTR:x,IS_SCRIPT_OR_DATA:k,ATTR_WHITESPACE:O,CUSTOM_ELEMENT:D}=Xh;let{IS_ALLOWED_URI:Y}=Xh,z=null;const ee=He({},[...Uh,...Mu,...Nu,...xu,...Bh]);let re=null;const le=He({},[...Vh,...yu,...Hh,...js]);let J=Object.seal(Qm(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),oe=null,ae=null,de=!0,ie=!0,te=!1,fe=!0,Re=!1,$e=!0,Ve=!1,tt=!1,en=!1,ot=!1,jt=!1,Nn=!1,hn=!0,Br=!1;const pi="user-content-";let Xn=!0,Yn=!1,xn={},yn=null;const Vr=He({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let zn=null;const Hr=He({},["audio","video","img","source","image","track"]);let Xr=null;const hi=He({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),or="http://www.w3.org/1998/Math/MathML",sr="http://www.w3.org/2000/svg",tn="http://www.w3.org/1999/xhtml";let br=tn,uo=!1,fo=null;const gs=He({},[or,sr,tn],Au);let gi=He({},["mi","mo","mn","ms","mtext"]),Yr=He({},["annotation-xml"]);const pl=He({},["title","style","font","a","script"]);let zr=null;const hl=["application/xhtml+xml","text/html"],_o="text/html";let Ft=null,Tr=null;const mi=t.createElement("form"),po=function(j){return j instanceof RegExp||j instanceof Function},Ci=function(){let j=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(Tr&&Tr===j)){if((!j||typeof j!="object")&&(j={}),j=lr(j),zr=hl.indexOf(j.PARSER_MEDIA_TYPE)===-1?_o:j.PARSER_MEDIA_TYPE,Ft=zr==="application/xhtml+xml"?Au:na,z=Ln(j,"ALLOWED_TAGS")?He({},j.ALLOWED_TAGS,Ft):ee,re=Ln(j,"ALLOWED_ATTR")?He({},j.ALLOWED_ATTR,Ft):le,fo=Ln(j,"ALLOWED_NAMESPACES")?He({},j.ALLOWED_NAMESPACES,Au):gs,Xr=Ln(j,"ADD_URI_SAFE_ATTR")?He(lr(hi),j.ADD_URI_SAFE_ATTR,Ft):hi,zn=Ln(j,"ADD_DATA_URI_TAGS")?He(lr(Hr),j.ADD_DATA_URI_TAGS,Ft):Hr,yn=Ln(j,"FORBID_CONTENTS")?He({},j.FORBID_CONTENTS,Ft):Vr,oe=Ln(j,"FORBID_TAGS")?He({},j.FORBID_TAGS,Ft):lr({}),ae=Ln(j,"FORBID_ATTR")?He({},j.FORBID_ATTR,Ft):lr({}),xn=Ln(j,"USE_PROFILES")?j.USE_PROFILES:!1,de=j.ALLOW_ARIA_ATTR!==!1,ie=j.ALLOW_DATA_ATTR!==!1,te=j.ALLOW_UNKNOWN_PROTOCOLS||!1,fe=j.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Re=j.SAFE_FOR_TEMPLATES||!1,$e=j.SAFE_FOR_XML!==!1,Ve=j.WHOLE_DOCUMENT||!1,ot=j.RETURN_DOM||!1,jt=j.RETURN_DOM_FRAGMENT||!1,Nn=j.RETURN_TRUSTED_TYPE||!1,en=j.FORCE_BODY||!1,hn=j.SANITIZE_DOM!==!1,Br=j.SANITIZE_NAMED_PROPS||!1,Xn=j.KEEP_CONTENT!==!1,Yn=j.IN_PLACE||!1,Y=j.ALLOWED_URI_REGEXP||Zm,br=j.NAMESPACE||tn,gi=j.MATHML_TEXT_INTEGRATION_POINTS||gi,Yr=j.HTML_INTEGRATION_POINTS||Yr,J=j.CUSTOM_ELEMENT_HANDLING||{},j.CUSTOM_ELEMENT_HANDLING&&po(j.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(J.tagNameCheck=j.CUSTOM_ELEMENT_HANDLING.tagNameCheck),j.CUSTOM_ELEMENT_HANDLING&&po(j.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(J.attributeNameCheck=j.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),j.CUSTOM_ELEMENT_HANDLING&&typeof j.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(J.allowCustomizedBuiltInElements=j.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Re&&(ie=!1),jt&&(ot=!0),xn&&(z=He({},Bh),re=[],xn.html===!0&&(He(z,Uh),He(re,Vh)),xn.svg===!0&&(He(z,Mu),He(re,yu),He(re,js)),xn.svgFilters===!0&&(He(z,Nu),He(re,yu),He(re,js)),xn.mathMl===!0&&(He(z,xu),He(re,Hh),He(re,js))),j.ADD_TAGS&&(z===ee&&(z=lr(z)),He(z,j.ADD_TAGS,Ft)),j.ADD_ATTR&&(re===le&&(re=lr(re)),He(re,j.ADD_ATTR,Ft)),j.ADD_URI_SAFE_ATTR&&He(Xr,j.ADD_URI_SAFE_ATTR,Ft),j.FORBID_CONTENTS&&(yn===Vr&&(yn=lr(yn)),He(yn,j.FORBID_CONTENTS,Ft)),Xn&&(z["#text"]=!0),Ve&&He(z,["html","head","body"]),z.table&&(He(z,["tbody"]),delete oe.tbody),j.TRUSTED_TYPES_POLICY){if(typeof j.TRUSTED_TYPES_POLICY.createHTML!="function")throw Oo('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof j.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Oo('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');S=j.TRUSTED_TYPES_POLICY,F=S.createHTML("")}else S===void 0&&(S=pN(g,i)),S!==null&&typeof F=="string"&&(F=S.createHTML(""));Yt&&Yt(j),Tr=j}},ho=He({},[...Mu,...Nu,...rN]),ms=He({},[...xu,...iN]),Cs=function(j){let he=R(j);(!he||!he.tagName)&&(he={namespaceURI:br,tagName:"template"});const Ie=na(j.tagName),st=na(he.tagName);return fo[j.namespaceURI]?j.namespaceURI===sr?he.namespaceURI===tn?Ie==="svg":he.namespaceURI===or?Ie==="svg"&&(st==="annotation-xml"||gi[st]):!!ho[Ie]:j.namespaceURI===or?he.namespaceURI===tn?Ie==="math":he.namespaceURI===sr?Ie==="math"&&Yr[st]:!!ms[Ie]:j.namespaceURI===tn?he.namespaceURI===sr&&!Yr[st]||he.namespaceURI===or&&!gi[st]?!1:!ms[Ie]&&(pl[Ie]||!ho[Ie]):!!(zr==="application/xhtml+xml"&&fo[j.namespaceURI]):!1},nn=function(j){bo(e.removed,{element:j});try{R(j).removeChild(j)}catch{_(j)}},Or=function(j,he){try{bo(e.removed,{attribute:he.getAttributeNode(j),from:he})}catch{bo(e.removed,{attribute:null,from:he})}if(he.removeAttribute(j),j==="is")if(ot||jt)try{nn(he)}catch{}else try{he.setAttribute(j,"")}catch{}},vi=function(j){let he=null,Ie=null;if(en)j="<remove></remove>"+j;else{const gt=kh(j,/^[\r\n\t ]+/);Ie=gt&&gt[0]}zr==="application/xhtml+xml"&&br===tn&&(j='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+j+"</body></html>");const st=S?S.createHTML(j):j;if(br===tn)try{he=new h().parseFromString(st,zr)}catch{}if(!he||!he.documentElement){he=I.createDocument(br,"template",null);try{he.documentElement.innerHTML=uo?F:st}catch{}}const At=he.body||he.documentElement;return j&&Ie&&At.insertBefore(t.createTextNode(Ie),At.childNodes[0]||null),br===tn?y.call(he,Ve?"html":"body")[0]:Ve?he.documentElement:At},vs=function(j){return T.call(j.ownerDocument||j,j,c.SHOW_ELEMENT|c.SHOW_COMMENT|c.SHOW_TEXT|c.SHOW_PROCESSING_INSTRUCTION|c.SHOW_CDATA_SECTION,null)},Ei=function(j){return j instanceof p&&(typeof j.nodeName!="string"||typeof j.textContent!="string"||typeof j.removeChild!="function"||!(j.attributes instanceof u)||typeof j.removeAttribute!="function"||typeof j.setAttribute!="function"||typeof j.namespaceURI!="string"||typeof j.insertBefore!="function"||typeof j.hasChildNodes!="function")},Si=function(j){return typeof l=="function"&&j instanceof l};function gn(be,j,he){Ws(be,Ie=>{Ie.call(e,j,he,Tr)})}const Ri=function(j){let he=null;if(gn(G.beforeSanitizeElements,j,null),Ei(j))return nn(j),!0;const Ie=Ft(j.nodeName);if(gn(G.uponSanitizeElement,j,{tagName:Ie,allowedTags:z}),$e&&j.hasChildNodes()&&!Si(j.firstElementChild)&&Ut(/<[/\w!]/g,j.innerHTML)&&Ut(/<[/\w!]/g,j.textContent)||j.nodeType===Ao.progressingInstruction||$e&&j.nodeType===Ao.comment&&Ut(/<[/\w]/g,j.data))return nn(j),!0;if(!z[Ie]||oe[Ie]){if(!oe[Ie]&&Ss(Ie)&&(J.tagNameCheck instanceof RegExp&&Ut(J.tagNameCheck,Ie)||J.tagNameCheck instanceof Function&&J.tagNameCheck(Ie)))return!1;if(Xn&&!yn[Ie]){const st=R(j)||j.parentNode,At=C(j)||j.childNodes;if(At&&st){const gt=At.length;for(let Lt=gt-1;Lt>=0;--Lt){const mn=d(At[Lt],!0);mn.__removalCount=(j.__removalCount||0)+1,st.insertBefore(mn,m(j))}}}return nn(j),!0}return j instanceof a&&!Cs(j)||(Ie==="noscript"||Ie==="noembed"||Ie==="noframes")&&Ut(/<\/no(script|embed|frames)/i,j.innerHTML)?(nn(j),!0):(Re&&j.nodeType===Ao.text&&(he=j.textContent,Ws([U,M,N],st=>{he=To(he,st," ")}),j.textContent!==he&&(bo(e.removed,{element:j.cloneNode()}),j.textContent=he)),gn(G.afterSanitizeElements,j,null),!1)},Es=function(j,he,Ie){if(hn&&(he==="id"||he==="name")&&(Ie in t||Ie in mi))return!1;if(!(ie&&!ae[he]&&Ut(w,he))){if(!(de&&Ut(x,he))){if(!re[he]||ae[he]){if(!(Ss(j)&&(J.tagNameCheck instanceof RegExp&&Ut(J.tagNameCheck,j)||J.tagNameCheck instanceof Function&&J.tagNameCheck(j))&&(J.attributeNameCheck instanceof RegExp&&Ut(J.attributeNameCheck,he)||J.attributeNameCheck instanceof Function&&J.attributeNameCheck(he))||he==="is"&&J.allowCustomizedBuiltInElements&&(J.tagNameCheck instanceof RegExp&&Ut(J.tagNameCheck,Ie)||J.tagNameCheck instanceof Function&&J.tagNameCheck(Ie))))return!1}else if(!Xr[he]){if(!Ut(Y,To(Ie,O,""))){if(!((he==="src"||he==="xlink:href"||he==="href")&&j!=="script"&&JM(Ie,"data:")===0&&zn[j])){if(!(te&&!Ut(k,To(Ie,O,"")))){if(Ie)return!1}}}}}}return!0},Ss=function(j){return j!=="annotation-xml"&&kh(j,D)},Wn=function(j){gn(G.beforeSanitizeAttributes,j,null);const{attributes:he}=j;if(!he||Ei(j))return;const Ie={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:re,forceKeepAttr:void 0};let st=he.length;for(;st--;){const At=he[st],{name:gt,namespaceURI:Lt,value:mn}=At,Wr=Ft(gt),go=mn;let Mt=gt==="value"?go:eN(go);if(Ie.attrName=Wr,Ie.attrValue=Mt,Ie.keepAttr=!0,Ie.forceKeepAttr=void 0,gn(G.uponSanitizeAttribute,j,Ie),Mt=Ie.attrValue,Br&&(Wr==="id"||Wr==="name")&&(Or(gt,j),Mt=pi+Mt),$e&&Ut(/((--!?|])>)|<\/(style|title)/i,Mt)){Or(gt,j);continue}if(Ie.forceKeepAttr)continue;if(!Ie.keepAttr){Or(gt,j);continue}if(!fe&&Ut(/\/>/i,Mt)){Or(gt,j);continue}Re&&Ws([U,M,N],Fi=>{Mt=To(Mt,Fi," ")});const ar=Ft(j.nodeName);if(!Es(ar,Wr,Mt)){Or(gt,j);continue}if(S&&typeof g=="object"&&typeof g.getAttributeType=="function"&&!Lt)switch(g.getAttributeType(ar,Wr)){case"TrustedHTML":{Mt=S.createHTML(Mt);break}case"TrustedScriptURL":{Mt=S.createScriptURL(Mt);break}}if(Mt!==go)try{Lt?j.setAttributeNS(Lt,gt,Mt):j.setAttribute(gt,Mt),Ei(j)?nn(j):Dh(e.removed)}catch{Or(gt,j)}}gn(G.afterSanitizeAttributes,j,null)},gl=function be(j){let he=null;const Ie=vs(j);for(gn(G.beforeSanitizeShadowDOM,j,null);he=Ie.nextNode();)gn(G.uponSanitizeShadowNode,he,null),Ri(he),Wn(he),he.content instanceof o&&be(he.content);gn(G.afterSanitizeShadowDOM,j,null)};return e.sanitize=function(be){let j=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},he=null,Ie=null,st=null,At=null;if(uo=!be,uo&&(be="<!-->"),typeof be!="string"&&!Si(be))if(typeof be.toString=="function"){if(be=be.toString(),typeof be!="string")throw Oo("dirty is not a string, aborting")}else throw Oo("toString is not a function");if(!e.isSupported)return be;if(tt||Ci(j),e.removed=[],typeof be=="string"&&(Yn=!1),Yn){if(be.nodeName){const mn=Ft(be.nodeName);if(!z[mn]||oe[mn])throw Oo("root node is forbidden and cannot be sanitized in-place")}}else if(be instanceof l)he=vi("<!---->"),Ie=he.ownerDocument.importNode(be,!0),Ie.nodeType===Ao.element&&Ie.nodeName==="BODY"||Ie.nodeName==="HTML"?he=Ie:he.appendChild(Ie);else{if(!ot&&!Re&&!Ve&&be.indexOf("<")===-1)return S&&Nn?S.createHTML(be):be;if(he=vi(be),!he)return ot?null:Nn?F:""}he&&en&&nn(he.firstChild);const gt=vs(Yn?be:he);for(;st=gt.nextNode();)Ri(st),Wn(st),st.content instanceof o&&gl(st.content);if(Yn)return be;if(ot){if(jt)for(At=P.call(he.ownerDocument);he.firstChild;)At.appendChild(he.firstChild);else At=he;return(re.shadowroot||re.shadowrootmode)&&(At=L.call(r,At,!0)),At}let Lt=Ve?he.outerHTML:he.innerHTML;return Ve&&z["!doctype"]&&he.ownerDocument&&he.ownerDocument.doctype&&he.ownerDocument.doctype.name&&Ut(Jm,he.ownerDocument.doctype.name)&&(Lt="<!DOCTYPE "+he.ownerDocument.doctype.name+`>
`+Lt),Re&&Ws([U,M,N],mn=>{Lt=To(Lt,mn," ")}),S&&Nn?S.createHTML(Lt):Lt},e.setConfig=function(){let be=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Ci(be),tt=!0},e.clearConfig=function(){Tr=null,tt=!1},e.isValidAttribute=function(be,j,he){Tr||Ci({});const Ie=Ft(be),st=Ft(j);return Es(Ie,st,he)},e.addHook=function(be,j){typeof j=="function"&&bo(G[be],j)},e.removeHook=function(be,j){if(j!==void 0){const he=QM(G[be],j);return he===-1?void 0:ZM(G[be],he,1)[0]}return Dh(G[be])},e.removeHooks=function(be){G[be]=[]},e.removeAllHooks=function(){G=Yh()},e}var hN=eC();const wu=":";class gN{#e={dialog:null,buttonApply:null,buttonCancel:null,loading:null,error:null,properties:null,titlePanel:null,descriptionText:null,descriptionHtml:null,cliText:null,githubLink:null,discussionLink:null,optionsSelect:null,optionsSelectPanel:null,buttonShowCLI:null,buttonHideCLI:null};#i;#s;#r=!1;#o;#n;#t;#u;#c;#l;constructor(e,t,r){this.#e.dialog=e,this.#i=t,this.#l=r}initialize(){return new Promise(e=>{this.#e.dialog.load("./tabs/presets/preset_dialog.html",()=>{this.#_(),e()})})}showPreset(e,t,r){return this.#o=e,this.#n=t,this.#t=r,this.#p(!0),this.#e.dialog[0].showModal(),this.#u=!1,this.#c=!1,this.#o.retriever.loadPreset(this.#n).then(()=>{this.#a(),this.#p(!1)}).catch(i=>{console.error(i);const o=i18n.getMessage("presetsLoadError");this.#m(o)}),new Promise(i=>this.#s=i)}#_(){i18n.localizePage(),this.#e.buttonApply=$("#preset_dialog_applybtn"),this.#e.buttonCancel=$("#preset_dialog_closebtn"),this.#e.loading=$("#preset_dialog_loading"),this.#e.error=$("#preset_dialog_error"),this.#e.properties=$("#preset_dialog_properties"),this.#e.titlePanel=$(".preset_dialog_title_panel"),this.#e.descriptionText=$("#preset_dialog_text_description"),this.#e.descriptionHtml=$("#preset_dialog_html_description"),this.#e.cliText=$("#preset_dialog_text_cli"),this.#e.githubLink=this.#e.dialog.find("#presets_open_online"),this.#e.discussionLink=this.#e.dialog.find("#presets_open_discussion"),this.#e.optionsSelect=$("#preset_options_select"),this.#e.optionsSelectPanel=$("#preset_options_panel"),this.#e.buttonShowCLI=$("#presets_cli_show"),this.#e.buttonHideCLI=$("#presets_cli_hide"),this.#e.buttonApply.on("click",()=>this.#T()),this.#e.buttonCancel.on("click",()=>this.#f()),this.#e.buttonShowCLI.on("click",()=>this.#h(!0)),this.#e.buttonHideCLI.on("click",()=>this.#h(!1)),this.#e.dialog.on("close",()=>this.#A())}#f(){this.#e.dialog[0].close()}#a(){this.#g(),this.#e.githubLink.attr("href",this.#n.viewLink),this.#n.presetData.discussion?(this.#e.discussionLink.toggle(!0),this.#e.discussionLink.attr("href",this.#n.presetData.discussion)):this.#e.discussionLink.toggle(!1),this.#e.titlePanel.empty(),new qm(this.#e.titlePanel,this.#n.presetData,this.#o,!1,this.#t,!1,()=>this.#p(!1),this.#l).load(),this.#b(),this.#d(),this.#h(!1)}#g(){let e=this.#n.presetData.description?.join(`
`);switch(this.#n.presetData.parser){case"MARKED":this.#r=!0,e=Ze.parse(e),e=hN.sanitize(e),this.#e.descriptionHtml.html(e),GUI.addLinksTargetBlank(this.#e.descriptionHtml);break;default:this.#r=!1,this.#e.descriptionText.text(e);break}}#d(){this.#n.optionsValues=this.#e.optionsSelect.multipleSelect("getSelects","value"),this.#n.renderedCliArr=this.#o.retriever.parser.renderPreset(this.#n.cliStringsArr,this.#n.optionsValues),this.#e.cliText.text(this.#n.renderedCliArr.join(`
`))}#p(e){this.#e.properties.toggle(!e),this.#e.loading.toggle(e),this.#e.error.toggle(!1),e?this.#e.buttonApply.toggleClass("disabled",!0):this.#e.buttonApply.toggleClass("disabled",!1)}#m(e){this.#e.error.toggle(!0),this.#e.error.text(e),this.#e.properties.toggle(!1),this.#e.loading.toggle(!1),this.#e.buttonApply.toggleClass("disabled",!0)}#h(e){this.#e.descriptionText.toggle(!e&&!this.#r),this.#e.descriptionHtml.toggle(!e&&this.#r),this.#e.cliText.toggle(e),this.#e.buttonShowCLI.toggle(!e),this.#e.buttonHideCLI.toggle(e)}#C(){let e=[];this.#n.presetData.options.forEach(t=>{t.options?e.push(this.#F(t)):e.push(this.#S(t))}),this.#e.optionsSelect.multipleSelect({placeholder:i18n.getMessage("presetOptionsPlaceholder"),formatSelectAll(){return i18n.getMessage("dropDownSelectAll")},formatAllSelected(){return i18n.getMessage("dropDownAll")},onClick:()=>this.#R(),onCheckAll:()=>this.#R(),onUncheckAll:()=>this.#R(),onOpen:()=>this.#v(),onBeforeClick:t=>this.#E(t),hideOptgroupCheckboxes:!0,singleRadio:!0,multiple:!0,selectAll:!1,data:e,minimumCountSelected:128}),this.#n.optionsValues!==null&&this.#e.optionsSelect.multipleSelect("setSelects",this.#n.optionsValues)}#v(){this.#u=!0}#E(e){const t=e._key,r=t.indexOf("_"),i=t.lastIndexOf("_"),o=t.slice(r+1,i),s=this.#n.presetData.options[o];if(s.isExclusive){const l=this.#e.optionsSelect.multipleSelect("getSelects");let a=[];l.forEach(c=>{c.includes(wu)?c.split(wu)[0]!=s.name&&a.push(c):a.push(c)}),this.#e.optionsSelect.multipleSelect("setSelects",a)}}#S(e){return{text:e.name,value:e.name,visible:!0,selected:e.checked}}#F(e){let t={type:"optgroup",label:e.name,value:e.name,visible:!0,children:[]};return e.options.forEach(r=>{t.children.push({text:r.name,value:e.name+wu+r.name,visible:!0,selected:r.checked})}),t}#R(){this.#d()}#I(){this.#e.optionsSelect.multipleSelect("destroy")}#b(){const e=this.#n.presetData.options.length!==0;this.#e.optionsSelect.empty(),this.#e.optionsSelectPanel.toggle(e),e&&this.#C(),this.#e.optionsSelect.multipleSelect("refresh")}#T(){this.#n.presetData.force_options_review&&!this.#u?alert(i18n.getMessage("presetsReviewOptionsWarning")):this.#n.completeWarning?confirm(GUI.escapeHtml(this.#n.completeWarning))&&this.#P():this.#P()}#O(){this.#i?.(),this.#c=!0,this.#f()}#P(){let e=!1;for(const t of this.#n.presetData.firmware_version)if(FC.CONFIG.flightControllerVersion.startsWith(t)){e=!0;break}e?this.#O():confirm(i18n.getMessage("presetsWarningWrongVersionConfirmation",[this.#n.presetData.firmware_version,FC.CONFIG.flightControllerVersion]))&&this.#O()}#A(){this.#I(),this.#s?.(this.#c)}}class ki{static containsBranchName(e){return e.includes("/tree/")}static isUrlGithubRepo(e){return e.trim().toLowerCase().startsWith("https://github.com/")}static getBranchName(e){const t=/https:\/\/github\.com\/[^/]+\/[^/]+\/tree\/([^/]+)/,r=e.match(t);return r?r[1]:null}}const tC=/^#\$[ ]+?INCLUDE:[ ]+?(?<filePath>\S+$)/;class mN{#e;#i=null;get index(){return this.#i}#s;get parser(){return this.#s}constructor(e){this.#e=e.trim()}async retrieveIndex(){try{const t=await(await fetch(`${this.#e}index.json`,{cache:"no-cache"})).json();console.log("Loaded index from: "+this.#e+"index.json"),this.#i=t,this.#s=new EN(this.#i.settings)}catch(e){throw console.log("error while trying to fetch index.json: "+e),e}}#r(e,t,r){for(let i=0;i<e.length;i++){const o=tC.exec(e[i]);if(o!==null){t.push(i);const s=this.#c(this.#e+o.groups.filePath);r.push(s.then(l=>{let a=l.split(`
`);a=a.map(u=>u.trim());let c=[];for(let u of a)(!u.startsWith(this.#i.settings.MetapropertyDirective)||u.slice(this.#i.settings.MetapropertyDirective.length).trim().toLowerCase().startsWith(this.#i.settings.OptionsDirectives.OPTION_DIRECTIVE))&&c.push(u);return c}))}}}#o(e){let t=0;for(;t<e.length;)Array.isArray(e[t])?e.splice(t,1,...e[t]):t++;return e}async#n(e){if(this.#s.isIncludeFound(e)){const t=[],r=[];this.#r(e,t,r);const i=await Promise.all(r);for(let o=0;o<i.length;o++)e[t[o]]=i[o];e=this.#o(e),e=e.map(o=>o.trim()+`
`),e=this.#n(e)}return e}async loadPreset(e){let r=(await this.#c(this.#e+e.presetData.fullPath)).split(`
`).map(i=>i.trim());r.unshift(`# Preset: ${e.presetData.title}`),await this.#n(r),this.#s.populatePresetProperties(e,r),e.cliStringsArr=r,await this.#t(e)}async#t(e){e.completeWarning="",e.presetData.warning&&(e.completeWarning+=e.presetData.warning),e.presetData.disclaimer&&(e.completeWarning+=(e.completeWarning?`
`:"")+e.presetData.disclaimer);const t=[].concat(...[e.presetData.include_warning,e.presetData.include_disclaimer].filter(Array.isArray)),r=await this.#u(t);e.completeWarning+=(e.completeWarning?`
`:"")+r}async#u(e){const t=[];return e?.forEach(i=>{t.push(this.#c(this.#e+i))}),(await Promise.all(t)).join(`
`)}#c(e){return new Promise((t,r)=>{console.log("Fetching file from URL: "+e),fetch(e,{cache:"no-cache"}).then(i=>i.text()).then(i=>t(i)).catch(i=>{console.error(i),r(i)})})}}let CN=class{constructor(e,t,r){this.name=e,this.optionGroupName=t,this.checked=r}name;optionGroupName;checked};class vN{constructor(e,t,r){this.name=e,this.options=t,this.isExclusive=r}name;options;isExclusive}class EN{#e;constructor(e){this.#e=e}populatePresetProperties(e,t){const r=["description","discussion","warning","disclaimer","include_warning","include_disclaimer","discussion","force_options_review","parser"],i={};e.presetData.options=[],r.forEach(o=>{i[o]=this.#e.presetsFileMetadata[o],e.presetData[o]=void 0}),e.currentOptionGroup=void 0;for(const o of t)this.#t(o)&&this.#i(e,o,i);delete e.currentOptionGroup}#i(e,t,r){t=this.#u(t);const i=t.toLowerCase();let o=!1;for(const s in r){const l=`${s.toLowerCase()}:`;i.startsWith(l)&&(t=t.slice(l.length).trim(),this.#s(e,t,s),o=!0)}!o&&i.startsWith(this.#e.OptionsDirectives.OPTION_DIRECTIVE)&&this.#c(e,t)}#s(e,t,r){switch(this.#e.presetsFileMetadata[r].type){case this.#e.MetadataTypes.STRING_ARRAY:this.#o(e,t,r);break;case this.#e.MetadataTypes.STRING:this.#n(e,t,r);break;case this.#e.MetadataTypes.FILE_PATH:this.#n(e,t,r);break;case this.#e.MetadataTypes.FILE_PATH_ARRAY:this.#o(e,t,r);break;case this.#e.MetadataTypes.BOOLEAN:this.#r(e,t,r);break;case this.#e.MetadataTypes.PARSER:this.#n(e,t,r);break;default:console.err(`Parsing preset: unknown property type '${this.#e.presetsFileMetadata[r].type}' for the property '${r}'`)}}#r(e,t,r){const i=["true","yes"],o=t.toLowerCase();let s=!1;i.includes(o)&&(s=!0),e.presetData[r]=s}#o(e,t,r){e.presetData[r]||(e.presetData[r]=[]),e.presetData[r].push(t)}#n(e,t,r){e.presetData[r]=t}#t(e){return e.trim().startsWith(this.#e.MetapropertyDirective)}#u(e){return e.trim().slice(this.#e.MetapropertyDirective.length).trim()}#c(e,t){let r="";if(e.currentOptionGroup&&(r=e.currentOptionGroup.name),this.#m(t)){const i=this.#f(t,r);e.currentOptionGroup?e.currentOptionGroup.options.push(i):e.presetData.options.push(i)}else if(this.#d(t)){const i=new vN(this.#_(t),[],this.#a(t));e.currentOptionGroup=i,e.presetData.options.push(i)}else this.#p(t)&&(e.currentOptionGroup=void 0)}#l(e){const t=e.slice(this.#e.OptionsDirectives.BEGIN_OPTION_DIRECTIVE.length).trim(),r=new RegExp(this.#C(`${this.#e.OptionsDirectives.OPTION_CHECKED}:`),"gi"),i=new RegExp(this.#C(`${this.#e.OptionsDirectives.OPTION_UNCHECKED}:`),"gi");let o=t.replace(r,"");return o=o.replace(i,"").trim(),o}#_(e){let t=e.slice(this.#e.OptionsDirectives.BEGIN_OPTION_GROUP_DIRECTIVE.length+1).trim();return this.#a(e)&&(t=t.slice(this.#e.OptionsDirectives.EXCLUSIVE_OPTION_GROUP.length).trim()),t}#f(e,t){const r=e.slice(this.#e.OptionsDirectives.BEGIN_OPTION_DIRECTIVE.length).trim(),i=r.toLowerCase(),o=this.#g(i),s=new RegExp(this.#C(this.#e.OptionsDirectives.OPTION_CHECKED),"gi"),l=new RegExp(this.#C(this.#e.OptionsDirectives.OPTION_UNCHECKED),"gi");let a=r.replace(s,"");return a=a.replace(l,"").trim(),new CN(a.slice(1).trim(),t,o)}#a(e){return e.toLowerCase().includes(this.#e.OptionsDirectives.EXCLUSIVE_OPTION_GROUP)}#g(e){return e.includes(this.#e.OptionsDirectives.OPTION_CHECKED)}#d(e){return e.toLowerCase().startsWith(this.#e.OptionsDirectives.BEGIN_OPTION_GROUP_DIRECTIVE)}#p(e){return e.toLowerCase().startsWith(this.#e.OptionsDirectives.END_OPTION_GROUP_DIRECTIVE)}#m(e){return e.toLowerCase().startsWith(this.#e.OptionsDirectives.BEGIN_OPTION_DIRECTIVE)}#h(e){return e.toLowerCase().startsWith(this.#e.OptionsDirectives.END_OPTION_DIRECTIVE)}#C(e){return e.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}renderPreset(e,t){let r=[],i=!1,o=!1,s="";const l=t.map(a=>a.toLowerCase());return e.forEach(a=>{if(this.#t(a)){const c=this.#u(a);if(this.#d(c))o=!0,s=this.#_(c).toLowerCase();else if(this.#p(c))o=!1,i=!1,s="";else if(this.#m(c)){o=!0;let u=this.#l(c).toLowerCase();s!=""&&(u=s.toLowerCase()+":"+u),l.includes(u)&&(i=!0)}else this.#h(c)&&(s==""&&(o=!1),i=!1)}else(o&&i||!o)&&r.push(a)}),r=this.#v(r),r}#v(e){const t=[];let r=!1;return e.forEach(i=>{(i!==""||!r)&&t.push(i),i===""?r=!0:r=!1}),t}isIncludeFound(e){for(const t of e)if(tC.exec(t)!==null)return!0;return!1}}class Gu{name="New Source";url="";branch="";official=!1;active;constructor(e,t,r=""){this.name=e,this.url=t,this.branch=r}get trimmedUrl(){let e=this.url.trim();return e.endsWith("/")||(e+="/"),e}get trimmedBranch(){let e=this.branch;return e.startsWith("/")&&(e=e.slice(1)),e.endsWith("/")&&(e=e.slice(0,-1)),e}get rawUrl(){return ki.isUrlGithubRepo(this.url)?`https://raw.githubusercontent.com${this.trimmedUrl.slice(18)}${this.trimmedBranch}/`:this.trimmedUrl}get viewUrl(){return ki.isUrlGithubRepo(this.url)?`${this.trimmedUrl}blob/${this.trimmedBranch}/`:this.trimmedUrl}}class SN{#e;get rawUrl(){return this.#e.rawUrl}#i=void 0;#s=null;#r=!1;#o="";#n={parentDiv:null,divWrapper:null,divInnerPanel:null,divNoEditing:null,divEditing:null,editName:null,editUrl:null,editGitHubBranch:null,buttonSave:null,buttonReset:null,buttonActivate:null,buttonDeactivate:null,buttonDelete:null,divGithubBranch:null,divNoEditingName:null,divSelectedIndicator:null};#t={sourceChanged:null};constructor(e,t,r){this.#n.parentDiv=e,this.#e=t,this.#o=r}get metadata(){return this.#e}get retriever(){return this.#s}set active(e){this.#e.active=e,this.#n.divSelectedIndicator.toggle(e),this.#e.official||(this.#n.buttonActivate.toggle(!e),this.#n.buttonDeactivate.toggle(e)),e||(this.#s=null)}async loadData(){console.log("Loading source data"),this.active=!0,this.#s=new mN(this.rawUrl),await this.#s.retrieveIndex()}async loadPanel(){this.#n.parentDiv.append(`<div id="${this.#o}"></div>`),this.#n.divWrapper=$(`#${this.#o}`),this.#n.divWrapper.toggle(!1),console.log("loading the source panel "+this.#o),await new Promise(e=>{console.log("Loading source panel HTML "+this.#o),this.#n.divWrapper.load("./tabs/presets/source_panel.html",e)}),this.#p(),this.selected=!1,this.metadataEdited=!1,this.#e.official||this.#e.active?this.active=!0:this.active=!1,i18n.localizePage(),this.#n.divWrapper.toggle(!0)}get index(){return this.#s.index}set sourceChangedCallback(e){this.#t.sourceChanged=e}set selected(e){this.#i!==e&&(this.#n.divNoEditing.toggle(!e),this.#n.divEditing.toggle(e),this.#f(),this.#n.divNoEditingName.text(this.#e.name),this.#n.divInnerPanel.toggleClass("presets_source_panel_not_selected",!e),this.#n.divInnerPanel.toggleClass("presets_source_panel_selected",e),e?this.#n.divInnerPanel.off("click"):this.#n.divInnerPanel.on("click",()=>this.#u()),this.#i=e)}set metadataEdited(e){this.#r=e,this.#r?(this.#n.buttonSave.removeClass("disabled"),this.#n.buttonReset.removeClass("disabled"),this.#n.buttonActivate.addClass("disabled"),this.#n.buttonDeactivate.addClass("disabled")):(this.#n.buttonSave.addClass("disabled"),this.#n.buttonReset.addClass("disabled"),this.#n.buttonActivate.removeClass("disabled"),this.#n.buttonDeactivate.removeClass("disabled"))}#u(){this.selected=!0,this.#t.onSelected?.(this)}#c(){const e=ki.isUrlGithubRepo(this.#n.editUrl.val());this.#n.divGithubBranch.toggle(e)}#l(){this.#c(),ki.containsBranchName(this.#n.editUrl.val())&&(this.#n.editGitHubBranch.val(ki.getBranchName(this.#n.editUrl.val())),this.#n.editUrl.val(this.#n.editUrl.val().split("/tree/")[0])),this.metadataEdited=!0}#_(){this.#e.name=this.#n.editName.val(),this.#e.url=this.#n.editUrl.val(),this.#e.branch=this.#n.editGitHubBranch.val(),this.metadataEdited=!1,this.#t.onSave?.(this)}#f(){this.#n.editName.val(this.#e.name),this.#n.editUrl.val(this.#e.url),this.#n.editGitHubBranch.val(this.#e.branch),this.#c(),this.metadataEdited=!1}#a(){this.#n.divWrapper.remove(),this.#t.sourceChanged?.({remove:!0})}async#g(){this.#_(),this.active=!0,this.#t.sourceChanged?.()}#d(){this.#_(),this.active=!1,this.#t.sourceChanged?.()}#p(){this.#n.divInnerPanel=this.#n.divWrapper.find(".presets_source_panel"),this.#n.divNoEditing=this.#n.divWrapper.find(".presets_source_panel_no_editing"),this.#n.divEditing=this.#n.divWrapper.find(".presets_source_panel_editing"),this.#n.editName=this.#n.divWrapper.find(".presets_source_panel_editing_name_field"),this.#n.editUrl=this.#n.divWrapper.find(".presets_source_panel_editing_url_field"),this.#n.editGitHubBranch=this.#n.divWrapper.find(".presets_source_panel_editing_branch_field"),this.#n.buttonSave=this.#n.divWrapper.find(".presets_source_panel_save"),this.#n.buttonReset=this.#n.divWrapper.find(".presets_source_panel_reset"),this.#n.buttonActivate=this.#n.divWrapper.find(".presets_source_panel_activate"),this.#n.buttonDeactivate=this.#n.divWrapper.find(".presets_source_panel_deactivate"),this.#n.buttonDelete=this.#n.divWrapper.find(".presets_source_panel_delete"),this.#n.divGithubBranch=this.#n.divWrapper.find(".presets_source_panel_editing_github_branch"),this.#n.divNoEditingName=this.#n.divWrapper.find(".presets_source_panel_no_editing_name"),this.#n.divSelectedIndicator=this.#n.divWrapper.find(".presets_source_panel_no_editing_selected"),this.#n.buttonSave.on("click",()=>this.#_()),this.#n.buttonReset.on("click",()=>this.#f()),this.#n.buttonDelete.on("click",()=>this.#a()),this.#n.buttonActivate.on("click",()=>this.#g()),this.#n.buttonDeactivate.on("click",()=>this.#d()),this.#n.editName.on("input",()=>this.#l()),this.#n.editUrl.on("input",()=>this.#l()),this.#n.editGitHubBranch.on("input",()=>this.#l());const e=ki.isUrlGithubRepo(this.#n.editUrl.val());this.#n.divGithubBranch.toggle(e),this.#e.official&&(this.#n.buttonSave.toggle(!1),this.#n.buttonReset.toggle(!1),this.#n.buttonDelete.toggle(!1),this.#n.buttonActivate.toggle(!1),this.#n.buttonDeactivate.toggle(!1),this.#n.editName.prop("disabled",!0),this.#n.editUrl.prop("disabled",!0),this.#n.editGitHubBranch.prop("disabled",!0))}}class RN{#e=0;#i={dialog:null,divSourcesPanel:null,buttonAddNew:null,buttonClose:null};#s=[];#r=null;constructor(e){this.#i.dialog=$(e)}async load(){await new Promise(e=>{this.#i.dialog.load("./tabs/presets/sources_dialog.html",e)}),this.#c(),await this.#n()}show(){return this.#i.dialog[0].showModal(),new Promise(e=>this.#r=e)}collectActiveSources(){let e=[];for(let t=0;t<this.#s.length;t++)this.#s[t].metadata.active&&e.push(this.#s[t]);return e}#o(e=!1){let t=[];for(let r=0;r<this.#s.length;r++)!e&&this.#s[r].metadata.official||t.push(this.#s[r].metadata);return t}get isThirdPartyActive(){return this.#o().filter(e=>e.active&&!e.official).length>0}async#n(){await this.#l(this.#u());for(const e of We("PresetsSourcesMetadata")??[]){const t=new Gu(e.name,e.url,e.branch);t.official=e.official,t.active=e.active,await this.#l(t)}}#t(){it({PresetsSourcesMetadata:this.#o()})}#u(){const e=new Gu("Rotorflight Official Presets","https://github.com/rotorflight/rotorflight-presets","presets-v1");return e.official=!0,e.active=!0,e}#c(){this.#i.buttonAddNew=$("#presets_sources_dialog_add_new"),this.#i.buttonClose=$("#presets_sources_dialog_close"),this.#i.divSourcesPanel=$(".presets_sources_dialog_sources"),this.#i.buttonClose.on("click",()=>this.#i.dialog[0].close()),this.#i.buttonAddNew.on("click",()=>this.#_()),this.#i.dialog.on("close",()=>this.#r?.()),i18n.localizePage()}async#l(e,t=!1){const r=new SN(this.#i.divSourcesPanel,e,`source_panel_${this.#e}`);this.#e++,e.official||(r.sourceChangedCallback=i=>{i?.remove&&this.#s.splice(this.#s.indexOf(r),1),this.#t()}),await r.loadPanel(),r.selected=t,this.#s.push(r)}#_(){const e=new Gu(i18n.getMessage("presetsSourcesDialogDefaultSourceName"),"","");this.#l(e,!0).then(()=>{this.#i.divSourcesPanel.stop(),this.#i.divSourcesPanel.animate({scrollTop:`${this.#i.divSourcesPanel.prop("scrollHeight")}px`}),this.#t()})}}const FN=50;class IN{viewURL="";lastPickDate=0;constructor(e){this.viewURL=e,this.lastPickDate=Date.now()}}class bN{#e;constructor(){this.#e=[],this.#r()}#i(){this.#e.sort((e,t)=>e.lastPickDate-t.lastPickDate)}#s(){this.#e.splice(FN+1,this.#e.length)}#r(){this.#e=We("TrackedPresets")??[]}#o(){it({TrackedPresets:this.#e})}add(e){let t=this.find(e);return t||(t=new IN(e),this.#e.push(t),console.log("Added preset to the tracked list: "+e)),t.lastPickDate=Date.now(),this.#i(),this.#s(),this.#o(),t}remove(e){const t=this.#e.findIndex(r=>r.viewURL===e);t>=0&&(this.#e.splice(t,1),this.#i(),this.#s(),this.#o())}find(e){return this.#e.find(t=>t.viewURL===e)}}var TN=(n,e)=>e.onEditPresetInstance(e.presetInstance,e.onEditPresetComplete),ON=(n,e)=>e.onDeletePresetInstance(e.index),PN=ne('<div class="preset_review_panel svelte-1wdsbir"><div><div class="header svelte-1wdsbir"><span class="title svelte-1wdsbir"> </span> <button class="button regular-button svelte-1wdsbir"> </button> <button class="button regular-button svelte-1wdsbir"> </button></div> <div><strong> </strong> </div> <div><strong> </strong> </div> <div><strong> </strong><br/> </div></div></div>');function AN(n,e){we(e,!0);const[t,r]=Et(),i=()=>vt(St,"$i18n",t);var o=PN(),s=W(o),l=W(s),a=W(l),c=W(a),u=K(a,2);u.__click=[TN,e];var p=W(u),h=K(u,2);h.__click=[ON,e];var g=W(h),f=K(l,2),d=W(f),_=W(d),m=K(d),C=K(f,2),R=W(C),S=W(R),F=K(R),I=K(C,2),T=W(I),P=W(T),y=K(T,2,!0);Ae((L,G,U,M,N)=>{Ee(c,e.presetInstance.presetData.title),Ee(p,L),Ee(g,G),Ee(_,U),Ee(m,` ${e.presetInstance.presetData.author??""}`),Ee(S,M),Ee(F,` ${e.presetInstance.presetData.category??""}`),Ee(P,N),Ee(y,e.presetInstance.optionsValues)},[()=>i().t("presetEdit"),()=>i().t("presetsSourcesDialogDeleteSource"),()=>i().t("presetAuthor"),()=>i().t("presetCategory"),()=>i().t("presetSelectedOptions")]),Z(n,o),Ge(),r()}pn(["click"]);var MN=ne('<div id="review_presets_dialog_content_wrapper" class="svelte-1y6y7do"><div class="review_presets_dialog_title_panel tab_title svelte-1y6y7do"> </div> <div class="review_presets_dialog_scrollable svelte-1y6y7do"><div class="note"> </div> <div class="review_presets_dialog_presets"></div></div> <div class="content_toolbar"><div class="btn"><button class="regular-button" target="_blank" rel="noopener noreferrer"> </button> <button class="regular-button" target="_blank" rel="noopener noreferrer"> </button></div></div></div>'),NN=ne('<dialog id="presets_review_dialog" class="svelte-1y6y7do"><!></dialog>');function xN(n,e){we(e,!0);const[t,r]=Et(),i=()=>vt(St,"$i18n",t);let o=pe(Rn(e.presetInstances.length));function s(u){e.presetInstances.splice(u,1),ce(o,e.presetInstances.length,!0),e.presetInstances.length===0&&e.onCancelButtonClicked()}function l(){ce(o,e.presetInstances.length+Date.now())}var a=NN(),c=W(a);lb(c,()=>b(o),u=>{var p=MN(),h=W(p),g=W(h),f=K(h,2),d=W(f),_=W(d),m=K(d,2);xt(m,21,()=>e.presetInstances,is,(P,y,L)=>{AN(P,{get presetInstance(){return b(y)},index:L,onDeletePresetInstance:s,get onEditPresetInstance(){return e.onEditPresetInstance},onEditPresetComplete:l})});var C=K(f,2),R=W(C),S=W(R);S.__click=function(...P){e.onApplyButtonClicked?.apply(this,P)};var F=W(S),I=K(S,2);I.__click=function(...P){e.onCancelButtonClicked?.apply(this,P)};var T=W(I);Ae((P,y,L,G)=>{Ee(g,P),Ee(_,y),Ee(F,L),Ee(T,G)},[()=>i().t("reviewPresetsDialogTitle"),()=>i().t("presetsReviewBeforeApply"),()=>i().t("presetsButtonReviewCLI"),()=>i().t("close")]),Z(u,p)}),Go("close",a,function(...u){e.onCancelButtonClicked?.apply(this,u)}),Z(n,a),Ge(),r()}pn(["click"]);const yN="diff all",wN="dump all";class GN{activePresetsSources=[];#e=null;presetsPanels=[];majorVersion=1;#i=null;#s=null;#r=null;#o=[];#n;#t={divGlobalLoading:null,divGlobalLoadingError:null,divCli:null,divMainContent:null,selectCategory:null,selectKeyword:null,selectAuthor:null,selectFirmwareVersion:null,selectStatus:null,inputTextFilter:null,divPresetList:null,buttonReview:null,buttonReset:null,reloadButton:null,contentWrapper:null,dialogCli:null,buttonCliExit:null,buttonCliSave:null,progressDialogProgressBar:null,dialogCliWarning:null,buttonBackupDiffAll:null,buttonBackupDumpAll:null,buttonBackupLoad:null,buttonPresetSources:null,warningNotOfficialSource:null,warningFailedToLoadRepositories:null,warningBackup:null,buttonHideBackupWarning:null,listNoFound:null,listTooManyFound:null};initialize(e){this.#e=new hm(this),this.#e.setProgressCallback(r=>this.onApplyProgressChange(r)),this.#i=new bN;const t=this;$("#content").load("/src/tabs/presets/presets.html",()=>t.onHtmlLoad(e)),GUI.active_tab!=="presets"&&(GUI.active_tab="presets")}#u(){this.#t.divGlobalLoading=$("#presets_global_loading"),this.#t.divGlobalLoadingError=$("#presets_global_loading_error"),this.#t.divCli=$("#presets_cli"),this.#t.divMainContent=$("#presets_main_content"),this.#t.selectCategory=$("#presets_filter_category"),this.#t.selectKeyword=$("#presets_filter_keyword"),this.#t.selectAuthor=$("#presets_filter_author"),this.#t.selectFirmwareVersion=$("#presets_filter_firmware_version"),this.#t.selectStatus=$("#presets_filter_status"),this.#t.inputTextFilter=$("#presets_filter_text"),this.#t.divPresetList=$("#presets_list"),this.#t.buttonReview=$("#presets_review_button"),this.#t.buttonReset=$("#presets_reset_button"),this.#t.reloadButton=$("#presets_reload"),this.#t.contentWrapper=$("#presets_content_wrapper"),this.#t.dialogCli=$("#presets_cli_dialog"),this.#t.buttonCliExit=$("#presets_cli_exit_button"),this.#t.buttonCliSave=$("#presets_cli_save_button"),this.#t.progressDialogProgressBar=$(".presets_apply_progress_dialog_progress_bar"),this.#t.dialogCliWarning=$(".presets_cli_errors_dialog_warning"),this.#t.buttonBackupDiffAll=$(".backup_diff_all"),this.#t.buttonBackupDumpAll=$(".backup_dump_all"),this.#t.buttonBackupLoad=$(".backup_load"),this.#t.buttonPresetSources=$(".presets_sources_show"),this.#t.warningNotOfficialSource=$(".presets_warning_not_official_source"),this.#t.warningFailedToLoadRepositories=$(".presets_failed_to_load_repositories"),this.#t.warningBackup=$(".presets_warning_backup"),this.#t.buttonHideBackupWarning=$(".presets_warning_backup_button_hide"),this.#t.listNoFound=$("#presets_list_no_found"),this.#t.listTooManyFound=$("#presets_list_too_many_found")}getPickedPresetsCli(){let e=[];return this.#o.forEach(t=>{e.push(...t.renderedCliArr)}),e=e.filter(t=>t.trim()!==""),e}onApplyProgressChange(e){this.#t.progressDialogProgressBar.val(e)}applyCommandsList(e){e.forEach(t=>{this.#e.sendLine(t)})}async onReviewClick(e=!1){const t=this,r=$("#snippetpreviewcontent textarea#preview");async function i(){try{await t.activateCli(),t.#t.progressDialogProgressBar.show(),t.#t.progressDialogProgressBar.val(0),t.setupCliDialogAndShow(i18n.getMessage("presetsApplyingPresets"));const l=r.val();t.snippetPreviewWindow.close();const a=t.#e.errorsCount;await t.#e.executeCommands(l),t.#t.progressDialogProgressBar.hide(),t.#e.errorsCount!==a?s(!0):s(!1)}catch(l){console.error("Error in executeSnippet:",l)}}function o(l,a=!1){t.snippetPreviewWindow||(t.snippetPreviewWindow=new jBox("Modal",{id:"snippetPreviewWindow",width:"auto",height:"auto",closeButton:"title",animation:!1,isolateScroll:!1,title:i18n.getMessage("presetsCliConfirmationDialogTitle"),content:$("#snippetpreviewcontent"),onCreated:()=>$("#snippetpreviewcontent a.confirm").on("click",()=>i()),onClose:()=>{a&&t.#c()}})),r.val(l.join(`
`)),t.snippetPreviewWindow.open()}function s(l){l&&$("#presets_cli_command_input").toggle(!0),t.#t.buttonCliSave.off("click"),t.#t.buttonCliSave.on("click",()=>{t.#e.subscribeResponseCallback(()=>{t.#e.unsubscribeResponseCallback(),t.#e.inBatchMode&&l&&t.#e.sendLine("save")}),t.#e.sendLine("save"),t.#t.dialogCli[0].close()}),t.#t.buttonCliSave.show(),t.#t.buttonCliExit.off("click"),t.#t.buttonCliExit.on("click",()=>{t.#t.dialogCli[0].close()}),t.#t.buttonCliExit.show(),t.#t.dialogCli.on("close",()=>{t.#e.sendLine("exit"),t.disconnectCliMakeSure(),t.#t.dialogCliWarning.hide(),t.#t.buttonCliSave.hide(),t.#t.buttonCliExit.hide(),t.#t.dialogCli.off("close"),t.#t.buttonCliSave.off("click"),t.#t.buttonCliExit.off("click")})}this.#n&&(ni(this.#n),this.#n=void 0),e?o(this.getPickedPresetsCli(),!0):(this.#n=Rr(xN,{target:document.querySelector("#svelte_components"),props:{presetInstances:this.#o,onEditPresetInstance:(l,a)=>{this.#p(this.#h(null,l.presetData.hash)).then(()=>{this.freezeSearch=!0,this.presetsPanels[0].showPresetDetails(t.#s,t.#o,l,()=>{a(),this.freezeSearch=!1,this.#a()})})},onCancelButtonClicked:()=>{ni(this.#n),this.#a(),this.#o.length==0&&this.enableSaveCancelButtons(!1)},onApplyButtonClicked:()=>{ni(this.#n),t.markPickedPresetsAsFavorites(),o(this.getPickedPresetsCli())}}}),$("#presets_review_dialog")[0].showModal())}disconnectCliMakeSure(){GUI.timeout_add("disconnect",function(){$("div.connect_controls a.connect").trigger("click")},500)}markPickedPresetsAsFavorites(){for(const e of this.#o)e.source!==void 0&&this.#i.add(e.viewLink)}setupCliDialogAndShow(e){const t=$("#presets_cli_dialog_title");return t.html(e),t.show(),$("#presets_cli_command_input").toggle(!1),this.#t.dialogCli[0].showModal(),this.#t.dialogCli[0]}#c(){this.#o=[],this.#a(),this.enableSaveCancelButtons(!1)}setupMenuButtons(){this.#t.buttonReview.on("click",()=>this.onReviewClick()),this.#t.buttonReset.on("click",()=>{this.#c()}),this.#t.buttonBackupDiffAll.on("click",()=>this.onSaveBackupClick("diff")),this.#t.buttonBackupDumpAll.on("click",()=>this.onSaveBackupClick("dump")),this.#t.buttonBackupLoad.on("click",()=>this.onBackupLoadClick()),this.#t.buttonPresetSources.on("click",()=>this.onPresetSourcesShowClick()),this.#t.buttonHideBackupWarning.on("click",()=>this.onButtonHideBackupWarningClick()),this.#t.buttonReview.toggleClass("disabled",!1),this.#t.buttonReset.toggleClass("disabled",!1),this.#t.reloadButton.on("click",()=>this.reload()),this.enableSaveCancelButtons(!1)}enableSaveCancelButtons(e){this.#t.buttonReview.toggleClass("disabled",!e),this.#t.buttonReset.toggleClass("disabled",!e),this.#t.buttonBackupLoad.toggleClass("disabled",e),this.#t.buttonBackupDiffAll.toggleClass("disabled",e),this.#t.buttonBackupDumpAll.toggleClass("disabled",e),this.#t.buttonPresetSources.toggleClass("disabled",e)}onButtonHideBackupWarningClick(){this.#t.warningBackup.toggle(!1),it({showPresetsWarningBackup:!1})}setupBackupWarning(){this.#t.warningBackup.toggle(We("showPresetsWarningBackup")??!0)}onPresetSourcesShowClick(){this.#r.show().then(()=>{this.reload()})}async handleBackupDialogSaveClick(e){const t="backup_"+e,r="txt";try{await al(this.#e.outputHistory,{suggestedName:generateFilename(t,r),description:`${r.toUpperCase()} files`}),this.#t.dialogCli[0].close()}catch(i){console.error("Failed to save backup",i),alert(i18n.getMessage("backupFailedToSave")),this.#t.dialogCli[0].close()}}async onSaveBackupClick(e){let t="";switch(e){case"diff":t=i18n.getMessage("backupDiffAll");break;case"dump":t=i18n.getMessage("backupDumpAll");break}this.setupCliDialogAndShow(t),this.#t.buttonCliSave.off("click"),this.#t.buttonCliSave.on("click",this.handleBackupDialogSaveClick.bind(this,e)),this.#t.buttonCliSave.toggleClass("disabled",!0),this.#t.buttonCliSave.show(),this.#t.buttonCliExit.off("click"),this.#t.buttonCliExit.on("click",()=>{this.#t.dialogCli[0].close()}),this.#t.buttonCliExit.toggleClass("disabled",!0),this.#t.buttonCliExit.show(),await this.activateCli(),await this.performBackup(e),this.#t.buttonCliSave.toggleClass("disabled",!1),this.#t.buttonCliExit.toggleClass("disabled",!1),this.#t.dialogCli.on("close",()=>{this.#e.sendLine("exit"),this.disconnectCliMakeSure(),this.#t.dialogCliWarning.hide(),this.#t.buttonCliSave.hide(),this.#t.buttonCliExit.hide(),this.#t.dialogCli.off("close"),this.#t.buttonCliSave.off("click"),this.#t.buttonCliExit.off("click")})}performBackup(e){const t=this;let r=performance.now();const i="PRESETS_BACKUP_INTERVAL";switch(this.#e.subscribeResponseCallback(()=>{r=performance.now()}),e){case"diff":this.#e.sendLine(yN);break;case"dump":this.#e.sendLine(wN);break;default:return}return new Promise(o=>{GUI.interval_add(i,()=>{performance.now()-r>500&&(GUI.interval_remove(i),o(t.#e.outputHistory))},500,!1)})}async onBackupLoadClick(){try{const e=await sl({description:"Backup Files",extensions:[".txt",".config"]});if(!e)return;const t=new jm;t.renderedCliArr=e.content.split(`
`),this.#o.push(t),this.onReviewClick(!0)}catch(e){console.error("Failed to load config",e)}}async onHtmlLoad(e){i18n.localizePage(),this.adaptPhones(),this.#u(),this.setupMenuButtons(),this.setupBackupWarning(),this.#t.inputTextFilter.attr("placeholder",i18n.getMessage("presetsSearchPlaceholder")),this.#s=new gN($("#presets_detailed_dialog"),()=>{this.enableSaveCancelButtons(!0)},this.#i),this.#r=new RN("#presets_sources_dialog"),await this.#s.initialize(),await this.#r.load(),await this.tryLoadPresets(),GUI.content_ready(e)}activateCli(){return new Promise(e=>{CONFIGURATOR.cliEngineActive=!0,CONFIGURATOR.cliTab="presets",this.#e.setUi($("#presets_cli_dialog .window"),$("#presets_cli_dialog .window .wrapper"),$("#presets_cli_command_input")),this.#e.enterCliMode();const t=setInterval(()=>{CONFIGURATOR.cliEngineActive&&(clearInterval(t),GUI.timeout_add("presets_enter_cli_mode_done",()=>{e()},500))},500)})}async reload(){this.resetInitialValues(),await this.tryLoadPresets()}async tryLoadPresets(){const e=this.#r.collectActiveSources();this.activePresetsSources=[];for(let r=0;r<e.length;r++)this.activePresetsSources.push(e[r]);this.#t.divMainContent.toggle(!1),this.#t.divGlobalLoadingError.toggle(!1),this.#t.divGlobalLoading.toggle(!0),this.#t.warningNotOfficialSource.toggle(this.#r.isThirdPartyActive);const t=[];for(let r=0;r<this.activePresetsSources.length;r++)try{await this.activePresetsSources[r].loadData()}catch(i){console.error(i),t.push(this.activePresetsSources[r])}try{this.#t.warningFailedToLoadRepositories.toggle(t.length>0),this.#t.warningFailedToLoadRepositories.html(i18n.getMessage("presetsFailedToLoadRepositories",{repos:t.map(r=>r.metadata.name).join(", ")})),this.activePresetsSources=this.activePresetsSources.filter(r=>!t.includes(r)),this.#l(),this.#t.divGlobalLoading.toggle(!1),this.#t.divMainContent.toggle(!0)}catch(r){this.#t.divGlobalLoading.toggle(!1),this.#t.divGlobalLoadingError.toggle(!0),console.error(r)}}multipleSelectComponentScrollFix(){return new Promise(e=>{GUI.timeout_add("hack_fix_multipleselect_scroll",()=>{this.#t.selectCategory.multipleSelect("refresh"),this.#t.selectKeyword.multipleSelect("refresh"),this.#t.selectAuthor.multipleSelect("refresh"),this.#t.selectFirmwareVersion.multipleSelect("refresh"),this.#t.selectStatus.multipleSelect("refresh"),e()},100)})}#l(){function e(t,r){return[...t.map(r).reduce((s,l)=>new Set([...s,...l]),new Set)].sort((s,l)=>s.localeCompare(l,void 0,{sensitivity:"base"}))}this.freezeSearch=!0,this.#f(this.#t.selectCategory,e(this.activePresetsSources,t=>t.index.uniqueValues.category),3),this.#f(this.#t.selectKeyword,e(this.activePresetsSources,t=>t.index.uniqueValues.keywords),3),this.#f(this.#t.selectAuthor,e(this.activePresetsSources,t=>t.index.uniqueValues.author),1),this.#f(this.#t.selectFirmwareVersion,e(this.activePresetsSources,t=>t.index.uniqueValues.firmware_version),2),this.#f(this.#t.selectStatus,e(this.activePresetsSources,t=>t.index.settings.PresetStatusEnum),2),this.multipleSelectComponentScrollFix().then(()=>{this.#_(),this.#t.inputTextFilter.on("input",()=>this.#a()),this.freezeSearch=!1,this.#a()})}#_(){const e=V.CONFIG.flightControllerVersion,t=[];for(const r of this.activePresetsSources)for(const i of r.index.uniqueValues.firmware_version)e.startsWith(i)&&t.push(i);this.#t.selectFirmwareVersion.multipleSelect("setSelects",t)}#f(e,t,r){e.multipleSelect("destroy"),e.multipleSelect({data:t,showClear:!0,minimumCountSelected:r,placeholder:i18n.getMessage("dropDownFilterDisabled"),onClick:()=>{this.#a()},onCheckAll:()=>{this.#a()},onUncheckAll:()=>{this.#a()},formatSelectAll(){return i18n.getMessage("dropDownSelectAll")},formatAllSelected(){return i18n.getMessage("dropDownAll")}})}async#a(){if(!this.freezeSearch){this.freezeSearch=!0;const e={categories:this.#t.selectCategory.multipleSelect("getSelects","text"),keywords:this.#t.selectKeyword.multipleSelect("getSelects","text"),authors:this.#t.selectAuthor.multipleSelect("getSelects","text"),firmwareVersions:this.#t.selectFirmwareVersion.multipleSelect("getSelects","text"),status:this.#t.selectStatus.multipleSelect("getSelects","text"),searchString:this.#t.inputTextFilter.val().trim()};this.#g(),e.authors=e.authors.map(t=>t.toLowerCase()),await this.#p(this.#h(e)),this.freezeSearch=!1}}#g(){this.#d(this.#t.selectCategory),this.#d(this.#t.selectKeyword),this.#d(this.#t.selectAuthor),this.#d(this.#t.selectFirmwareVersion),this.#d(this.#t.selectStatus)}#d(e){const r=e.multipleSelect("getSelects","text").length!==0;e.parent().find($(".ms-choice")).toggleClass("presets_filter_select_nonempty",r)}async#p(e){this.presetsPanels.forEach(r=>{r.remove()}),this.presetsPanels=[];const t=60;this.#t.listTooManyFound.toggle(e.length>t),e.length=Math.min(e.length,t),this.#t.listNoFound.toggle(e.length===0);for(let r=0;r<e.length;r++){const i=e[r],o=new qm(this.#t.divPresetList,i[0],i[1],!0,!0,this.#m(i[0],i[1]),null,this.#i);await o.load(),this.presetsPanels.push(o),o.subscribeClick(this.#s,this.#o)}this.#t.listTooManyFound.appendTo(this.#t.divPresetList)}#m(e,t){let r=!1;return this.#o.forEach(i=>{i.presetData.hash===e.hash&&i.sourceMetadata.rawUrl===t.rawUrl&&(r=!0)}),r}#h(e,t=""){console.log("Searching presets with parameters: ",e);const r=[],i=[],o=new Set;for(const s of this.activePresetsSources)for(const l of s.index.presets)(this.#T(l,e)||this.#m(l,s)||t!=""&&t==l.hash)&&!o.has(l.hash)&&(r.push([l,s]),i[l.hash]=s.metadata.viewUrl+l.fullPath,o.add(l.hash));return console.log("Presets found: ",r),r.sort((s,l)=>this.#C(i,s[0],l[0])),r}#C(e,t,r){const i=this.#i.find(e[t.hash]),o=this.#i.find(e[r.hash]);return i&&o?o-i:i||o?i?-1:1:t.priority>r.priority?-1:1}#v(e,t){return t.status.length===0||t.status.includes(e.status)}#E(e,t){return!(t.categories.length!==0&&(e.category===void 0||!t.categories.includes(e.category)))}#S(e){if(e.board_name===void 0||V.CONFIG.boardName=="")return!0;let t=!1;return e.board_name.forEach(r=>{V.CONFIG.boardName===r&&(t=!0)}),t}#F(e,t){return!(t.keywords.length!==0&&(!Array.isArray(e.keywords)||t.keywords.filter(i=>e.keywords.includes(i)).length===0))}#R(e,t){return!(t.authors.length!==0&&(e.author===void 0||!t.authors.includes(e.author.toLowerCase())))}#I(e,t){return!(t.firmwareVersions.length!==0&&(!Array.isArray(e.firmware_version)||t.firmwareVersions.filter(i=>e.firmware_version.includes(i)).length===0))}#b(e,t){if(t.searchString){const r=e.keywords.join(" "),i=e.firmware_version.join(" "),o=[e.description,r,e.title,e.author,i,e.category].join(`
`).toLowerCase().replace("''",'"'),s=t.searchString.toLowerCase().replace("''",'"').split(" ");for(const l of s)if(!o.includes(l))return!1}return!0}#T(e,t){return!(t==null||e.hidden||!this.#v(e,t)||!this.#E(e,t)||!this.#F(e,t)||!this.#R(e,t)||!this.#I(e,t)||!this.#b(e,t)||!this.#S(e))}adaptPhones(){GUI.isCordova()&&UI_PHONES.initToolbar()}read(e){this.#e.readSerial(e)}cleanup(e){if(this.resetInitialValues(),!(CONFIGURATOR.connectionValid&&CONFIGURATOR.cliEngineActive&&CONFIGURATOR.cliEngineValid)){e&&e();return}TABS.presets.#e.close(()=>{e&&e()})}resetInitialValues(){CONFIGURATOR.cliEngineActive=!1,CONFIGURATOR.cliEngineValid=!1,CONFIGURATOR.cliTab="",this.activePresetsSources=[],this.#o=[]}}TABS.presets=new GN;const xa={tabName:"power",isDirty:!1,needReboot:!1,voltageMeterCount:0,currentMeterCount:0,BATTER_CONFIG_COPY:null,VOLTAGE_METER_CONFIGS_COPY:null,CURRENT_METER_CONFIGS_COPY:null,batteryMeterTypes:["None","Adc","Esc"],currentMeterTypes:["None","Adc","Esc"]};xa.initialize=function(n){const e=this;GUI.calibrationManager&&GUI.calibrationManager.destroy(),GUI.calibrationManagerConfirmation&&GUI.calibrationManagerConfirmation.destroy(),r(t);function t(){$("#content").load("/src/tabs/power.html",c)}function r(u){Promise.resolve(!0).then(()=>MSP.promise(MSPCodes.MSP_STATUS)).then(()=>MSP.promise(MSPCodes.MSP_BATTERY_STATE)).then(()=>MSP.promise(MSPCodes.MSP_VOLTAGE_METERS)).then(()=>MSP.promise(MSPCodes.MSP_CURRENT_METERS)).then(()=>MSP.promise(MSPCodes.MSP_BATTERY_CONFIG)).then(()=>MSP.promise(MSPCodes.MSP_VOLTAGE_METER_CONFIG)).then(()=>MSP.promise(MSPCodes.MSP_CURRENT_METER_CONFIG)).then(u)}function i(u){MSP.send_message(MSPCodes.MSP_SET_BATTERY_CONFIG,mspHelper.crunch(MSPCodes.MSP_SET_BATTERY_CONFIG),!1,()=>{mspHelper.sendVoltageConfig(()=>{mspHelper.sendCurrentConfig(u)})})}function o(u){i(()=>{MSP.send_message(MSPCodes.MSP_EEPROM_WRITE,!1,!1,()=>{GUI.log(i18n.getMessage("eepromSaved")),e.needReboot?(MSP.send_message(MSPCodes.MSP_SET_REBOOT),GUI.log(i18n.getMessage("deviceRebooting")),reinitialiseConnection(u)):u?.()})})}function s(){FC.BATTERY_CONFIG=e.BATTER_CONFIG_COPY,FC.VOLTAGE_METER_CONFIGS=e.VOLTAGE_METER_CONFIGS_COPY,FC.CURRENT_METER_CONFIGS=e.CURRENT_METER_CONFIGS_COPY}function l(){$(".tab-power .boxVoltageConfiguration").toggle(FC.VOLTAGE_METERS.length>0);const u=$(".tab-power .voltage-meters");u.empty();const p=$("#tab-power-templates .voltage-meters .voltage-meter"),h=$("#tab-power-templates .voltage-configuration");for(let _=0;_<FC.VOLTAGE_METERS.length;_++){const m=FC.VOLTAGE_METERS[_].id,C=p.clone(),R=C.find(".configuration");C.attr("id",`voltage-meter-${m}`),C.find(".label").text(i18n.getMessage("powerVoltageId"+m));for(let S=0;S<FC.VOLTAGE_METER_CONFIGS.length;S++)if(FC.VOLTAGE_METER_CONFIGS[S].sensorType==1&&FC.VOLTAGE_METER_CONFIGS[S].id==m){const F=h.clone();F.find('input[name="vbatscale"]').val(FC.VOLTAGE_METER_CONFIGS[S].vbatscale).change(function(){FC.VOLTAGE_METER_CONFIGS[S].vbatscale=getIntegerValue(this),mspHelper.sendVoltageMeterConfig(S)}),F.find('input[name="vbatresdivval"]').val(FC.VOLTAGE_METER_CONFIGS[S].vbatresdivval).change(function(){FC.VOLTAGE_METER_CONFIGS[S].vbatresdivval=getIntegerValue(this),mspHelper.sendVoltageMeterConfig(S)}),R.append(F)}u.append(C)}$(".tab-power .boxAmperageConfiguration").toggle(FC.CURRENT_METERS.length>0);const g=$(".tab-power .amperage-meters");g.empty();const f=$("#tab-power-templates .amperage-meters .amperage-meter"),d=$("#tab-power-templates .amperage-configuration");for(let _=0;_<FC.CURRENT_METERS.length;_++){const m=FC.CURRENT_METERS[_].id,C=f.clone(),R=C.find(".configuration");C.attr("id",`amperage-meter-${m}`),C.find(".label").text(i18n.getMessage("powerAmperageId"+m));for(let S=0;S<FC.CURRENT_METER_CONFIGS.length;S++){if(FC.CURRENT_METER_CONFIGS[S].sensorType==1&&FC.CURRENT_METER_CONFIGS[S].id==m){const F=d.clone();F.find('input[name="amperagescale"]').val(FC.CURRENT_METER_CONFIGS[S].scale).change(function(){FC.CURRENT_METER_CONFIGS[S].scale=getIntegerValue(this),mspHelper.sendCurrentMeterConfig(S)}),F.find('input[name="amperageoffset"]').val(FC.CURRENT_METER_CONFIGS[S].offset).change(function(){FC.CURRENT_METER_CONFIGS[S].offset=getIntegerValue(this),mspHelper.sendCurrentMeterConfig(S)}),R.append(F)}g.append(C)}}$(".calibration").toggle(FC.BATTERY_CONFIG.voltageMeterSource==1||FC.BATTERY_CONFIG.currentMeterSource==1)}function a(){$("#calibrationmanagercontent").hide(),$("#calibrationmanagerconfirmcontent").hide();const u=$("#tab-power-templates .battery-state .battery-state"),p=$(".tab-power .battery-state"),h=u.clone();p.append(h.children());const g=$("#tab-power-templates .battery-configuration"),f=$(".tab-power .battery .configuration"),d=g.clone();f.append(d),d.find('input[name="mincellvoltage"]').val(FC.BATTERY_CONFIG.vbatmincellvoltage).change().change(function(){FC.BATTERY_CONFIG.vbatmincellvoltage=getFloatValue(this)}),d.find('input[name="fullcellvoltage"]').val(FC.BATTERY_CONFIG.vbatfullcellvoltage).change().change(function(){FC.BATTERY_CONFIG.vbatfullcellvoltage=getFloatValue(this)}),d.find('input[name="maxcellvoltage"]').val(FC.BATTERY_CONFIG.vbatmaxcellvoltage).change().change(function(){FC.BATTERY_CONFIG.vbatmaxcellvoltage=getFloatValue(this)}),d.find('input[name="warningcellvoltage"]').val(FC.BATTERY_CONFIG.vbatwarningcellvoltage).change().change(function(){FC.BATTERY_CONFIG.vbatwarningcellvoltage=getFloatValue(this)}),d.find('input[name="capacity"]').val(FC.BATTERY_CONFIG.capacity).change().change(function(){FC.BATTERY_CONFIG.capacity=getIntegerValue(this)}),d.find('input[name="cellcount"]').val(FC.BATTERY_CONFIG.cellCount).change().change(function(){FC.BATTERY_CONFIG.cellCount=getIntegerValue(this)});const _=d.find("select.batterymetersource"),m=d.find("select.currentmetersource");e.batteryMeterTypes.forEach((U,M)=>{const N=i18n.getMessage("powerBatteryVoltageMeterType"+U);_.append(`<option value="${M}">${N}</option>`)}),e.currentMeterTypes.forEach((U,M)=>{const N=i18n.getMessage("powerBatteryCurrentMeterType"+U);m.append(`<option value="${M}">${N}</option>`)}),l();let C=!1;_.val(FC.BATTERY_CONFIG.voltageMeterSource).change().change(function(){FC.BATTERY_CONFIG.voltageMeterSource=parseInt($(this).val()),C=!0,G(!0)}),m.val(FC.BATTERY_CONFIG.currentMeterSource).change().change(function(){FC.BATTERY_CONFIG.currentMeterSource=parseInt($(this).val()),C=!0,G(!0)});function R(){MSP.send_message(MSPCodes.MSP_VOLTAGE_METERS,!1,!1,function(){FC.VOLTAGE_METERS.length!=e.voltageMeterCount&&(e.voltageMeterCount=FC.VOLTAGE_METERS.length,l());for(let U=0;U<FC.VOLTAGE_METERS.length;U++){const M=FC.VOLTAGE_METERS[U].id,N=FC.VOLTAGE_METERS[U].voltage,w=N<4?3:2,x=i18n.getMessage("powerVoltageValue",[N.toFixed(w)]);$(`#voltage-meter-${M} .value`).text(x)}}),MSP.send_message(MSPCodes.MSP_CURRENT_METERS,!1,!1,function(){FC.CURRENT_METERS.length!=e.currentMeterCount&&(e.currentMeterCount=FC.CURRENT_METERS.length,l());for(let U=0;U<FC.CURRENT_METERS.length;U++){const M=FC.CURRENT_METERS[U].id,N=FC.CURRENT_METERS[U].amperage,w=i18n.getMessage("powerAmperageValue",[N.toFixed(2)]);$(`#amperage-meter-${M} .value`).text(w)}}),MSP.send_message(MSPCodes.MSP_BATTERY_STATE,!1,!1,function(){$("#battery-connection-state .value").text(FC.BATTERY_STATE.cellCount>0?i18n.getMessage("powerBatteryConnectedValueYes",[FC.BATTERY_STATE.cellCount]):i18n.getMessage("powerBatteryConnectedValueNo")),$("#battery-voltage .value").text(i18n.getMessage("powerVoltageValue",[FC.BATTERY_STATE.voltage])),$("#battery-amperage .value").text(i18n.getMessage("powerAmperageValue",[FC.BATTERY_STATE.amperage])),$("#battery-mah-drawn .value").text(i18n.getMessage("powerMahValue",[FC.BATTERY_STATE.mAhDrawn])),$("#battery-charge-level .value").text(i18n.getMessage("powerChargeLevel",[FC.BATTERY_STATE.chargeLevel]))})}GUI.calibrationManager=new jBox("Modal",{width:400,height:250,closeButton:"title",animation:!1,attach:$("#calibrationmanager"),title:i18n.getMessage("powerCalibrationManagerTitle"),content:$("#calibrationmanagercontent"),onCloseComplete:function(){GUI.calibrationManager.close()}}),GUI.calibrationManagerConfirmation=new jBox("Modal",{width:400,height:250,closeButton:"title",animation:!1,attach:$("#calibrate"),title:i18n.getMessage("powerCalibrationManagerConfirmationTitle"),content:$("#calibrationmanagerconfirmcontent"),onCloseComplete:function(){GUI.calibrationManager.close()}});let S=!1,F=!1,I=0,T=0;$('input[name="vbatcalibration"]').val(0),$('input[name="amperagecalibration"]').val(0),$("a.calibrationmanager").click(function(){S=!1,F=!1,FC.BATTERY_CONFIG.voltageMeterSource==1&&FC.BATTERY_STATE.voltage>.1?$(".vbatcalibration").show():$(".vbatcalibration").hide(),FC.BATTERY_CONFIG.currentMeterSource==1&&FC.BATTERY_STATE.amperage>.1?$(".amperagecalibration").show():$(".amperagecalibration").hide(),FC.BATTERY_STATE.cellCount==0?($(".vbatcalibration").hide(),$(".amperagecalibration").hide(),$(".calibrate").hide(),$(".nocalib").show()):($(".calibrate").show(),$(".nocalib").hide()),C?($(".srcchange").show(),$(".vbatcalibration").hide(),$(".amperagecalibration").hide(),$(".calibrate").hide(),$(".nocalib").hide()):$(".srcchange").hide()}),$("a.calibrate").click(function(){if(FC.BATTERY_CONFIG.voltageMeterSource==1){const U=parseFloat($('input[name="vbatcalibration"]').val());U!=0&&(I=Math.round(FC.VOLTAGE_METER_CONFIGS[0].vbatscale*(U/FC.VOLTAGE_METERS[0].voltage)),I>=1&&I<=65535&&(S=!0))}if(FC.BATTERY_CONFIG.currentMeterSource==1){const U=parseFloat($('input[name="amperagecalibration"]').val()),M=FC.CURRENT_METER_CONFIGS[0].offset/1e3;U!=0&&FC.CURRENT_METERS[0].amperage!=M&&U!=M&&(T=Math.round(FC.CURRENT_METER_CONFIGS[0].scale*((FC.CURRENT_METERS[0].amperage-M)/(U-M))),T>-16e3&&T<16e3&&T!=0&&(F=!0))}S||F?($(".vbatcalibration").toggle(S),$(".amperagecalibration").toggle(F),$('output[name="vbatnewscale"').val(I),$('output[name="amperagenewscale"').val(T),$("a.applycalibration").click(function(){GUI.calibrationManagerConfirmation.close(),$('input[name="vbatscale-10').val(I).change(),$('input[name="amperagescale-10"').val(T).change()}),$("a.discardcalibration").click(function(){GUI.calibrationManagerConfirmation.close()})):GUI.calibrationManagerConfirmation.close()});const P=$(".content_toolbar .save_btn"),y=$(".content_toolbar .reboot_btn"),L=$(".content_toolbar .revert_btn");e.isDirty=!1,e.needReboot=!1;function G(U=!1){e.isDirty=!0,e.needReboot|=U,e.needReboot?(P.hide(),y.show()):(P.show(),y.hide()),L.show()}P.hide(),y.hide(),L.hide(),e.save=function(U){o(U)},e.revert=function(U){s(),i(U)},$("a.save").click(function(){e.save(()=>GUI.tab_switch_reload())}),$("a.reboot").click(function(){e.save(()=>GUI.tab_switch_reload())}),$("a.revert").click(function(){e.revert(()=>GUI.tab_switch_reload())}),$(".content_wrapper").change(function(){G()}),GUI.interval_add("data_pull_slow",R,200,!0)}function c(){e.BATTER_CONFIG_COPY=deep_copy(FC.BATTERY_CONFIG),e.VOLTAGE_METER_CONFIGS_COPY=deep_copy(FC.VOLTAGE_METER_CONFIGS),e.CURRENT_METER_CONFIGS_COPY=deep_copy(FC.CURRENT_METER_CONFIGS),a(),i18n.localizePage(),GUI.content_ready(n)}};xa.cleanup=function(n){GUI.calibrationManager?.destroy(),GUI.calibrationManagerConfirmation?.destroy(),this.isDirty=!1,n?.()};TABS[xa.tabName]=xa;const ya={tabName:"privacy_policy"};ya.initialize=function(n){const e="/src/tabs/privacy_policy.html";$("#content").html('<div id="tab-static"><div id="tab-static-contents"></div>'),$("#tab-static-contents").load(e,function(){i18n.localizePage(),GUI.content_ready(n)})};ya.cleanup=function(n){n?.()};TABS[ya.tabName]=ya;const wa={tabName:"profiles",isDirty:!1,isChanged:!1,activeSubtab:null,savedProfile:null,currentProfile:null,isGovEnabled:!1,isGovActive:!1,isPIDDefault:!1,tabNames:["profile1","profile2","profile3","profile4","profile5","profile6"],axisNames:["ROLL","PITCH","YAW"],gainNames:["P","I","D","F","B"],defaultGains:[[10,50,0,50,0],[10,50,0,50,0],[50,50,0,0,0]]};wa.initialize=function(n){const e=this;r(t);function t(){$("#content").load("/src/tabs/profiles.html",c)}function r(u){Promise.resolve(!0).then(()=>MSP.promise(MSPCodes.MSP_STATUS)).then(()=>MSP.promise(MSPCodes.MSP_FEATURE_CONFIG)).then(()=>MSP.promise(MSPCodes.MSP_PID_TUNING)).then(()=>MSP.promise(MSPCodes.MSP_PID_PROFILE)).then(()=>MSP.promise(MSPCodes.MSP_RESCUE_PROFILE)).then(()=>MSP.promise(MSPCodes.MSP_GOVERNOR_PROFILE)).then(()=>MSP.promise(MSPCodes.MSP_GOVERNOR_CONFIG)).then(()=>MSP.promise(MSPCodes.MSP_SENSOR_CONFIG)).then(u)}function i(u){Promise.resolve(!0).then(()=>MSP.promise(MSPCodes.MSP_SET_PID_TUNING,mspHelper.crunch(MSPCodes.MSP_SET_PID_TUNING))).then(()=>MSP.promise(MSPCodes.MSP_SET_PID_PROFILE,mspHelper.crunch(MSPCodes.MSP_SET_PID_PROFILE))).then(()=>MSP.promise(MSPCodes.MSP_SET_RESCUE_PROFILE,mspHelper.crunch(MSPCodes.MSP_SET_RESCUE_PROFILE))).then(()=>MSP.promise(MSPCodes.MSP_SET_GOVERNOR_PROFILE,mspHelper.crunch(MSPCodes.MSP_SET_GOVERNOR_PROFILE))).then(()=>MSP.promise(MSPCodes.MSP_SET_GOVERNOR_CONFIG,mspHelper.crunch(MSPCodes.MSP_SET_GOVERNOR_CONFIG))).then(()=>MSP.promise(MSPCodes.MSP_EEPROM_WRITE)).then(()=>{e.savedProfile=e.currentProfile,GUI.log(i18n.getMessage("eepromSaved")),u?.()})}function o(u){MSP.promise(MSPCodes.MSP_SELECT_SETTING,[e.savedProfile]).then(()=>{GUI.log(i18n.getMessage("profilesActivateProfile",[e.savedProfile+1])),u?.()})}function s(u){$(".tab-profiles .profilesPIDWarningText").html(i18n.getMessage(u)),$(".tab-profiles .profilesPIDWarning").show()}function l(){e.currentProfile=FC.CONFIG.profile,e.savedProfile==null&&(e.savedProfile=e.currentProfile),e.activeSubtab=e.tabNames[e.currentProfile],$(".tab-profiles .tab-container .tab").removeClass("active"),$(".tab-profiles .tab-container ."+e.activeSubtab).addClass("active"),$(".tab-profiles .note").hide(),e.isPIDDefault=!0,e.axisNames.forEach(function(m,C){e.gainNames.forEach(function(R,S){const F=$(`.tab-profiles .${m} input[name="${R}"]`),I=FC.PIDS[C][S];e.isPIDDefault&=I==e.defaultGains[C][S],F.val(I)})}),FC.PID_PROFILE.pid_mode==0?(s("profilesPIDModeZeroWarning"),$(".tab-profiles .pid_config").hide()):FC.PID_PROFILE.pid_mode==1?s("profilesPIDModeOneWarning"):FC.PID_PROFILE.pid_mode==2?s("profilesPIDModeTwoWarning"):FC.PID_PROFILE.pid_mode==3||(FC.PID_PROFILE.pid_mode==4?s("profilesPIDModeFourWarning"):FC.PID_PROFILE.pid_mode>4&&(s("profilesPIDModeCustomWarning"),$(".tab-profiles .pid_config").hide())),$(".tab-profiles .HSI").toggle(FC.PID_PROFILE.pid_mode>=3),$('.tab-profiles input[id="gyroCutoffRoll"]').val(FC.PID_PROFILE.gyroCutoffRoll).change(),$('.tab-profiles input[id="gyroCutoffPitch"]').val(FC.PID_PROFILE.gyroCutoffPitch).change(),$('.tab-profiles input[id="gyroCutoffYaw"]').val(FC.PID_PROFILE.gyroCutoffYaw).change(),$('.tab-profiles input[id="dtermCutoffRoll"]').val(FC.PID_PROFILE.dtermCutoffRoll).change(),$('.tab-profiles input[id="dtermCutoffPitch"]').val(FC.PID_PROFILE.dtermCutoffPitch).change(),$('.tab-profiles input[id="dtermCutoffYaw"]').val(FC.PID_PROFILE.dtermCutoffYaw).change(),$('.tab-profiles input[id="btermCutoffRoll"]').val(FC.PID_PROFILE.btermCutoffRoll).change(),$('.tab-profiles input[id="btermCutoffPitch"]').val(FC.PID_PROFILE.btermCutoffPitch).change(),$('.tab-profiles input[id="btermCutoffYaw"]').val(FC.PID_PROFILE.btermCutoffYaw).change(),$('.tab-profiles input[id="errorLimitRoll"]').val(FC.PID_PROFILE.errorLimitRoll).change(),$('.tab-profiles input[id="errorLimitPitch"]').val(FC.PID_PROFILE.errorLimitPitch).change(),$('.tab-profiles input[id="errorLimitYaw"]').val(FC.PID_PROFILE.errorLimitYaw).change(),$('.tab-profiles input[id="offsetLimitRoll"]').val(FC.PID_PROFILE.offsetLimitRoll).change(),$('.tab-profiles input[id="offsetLimitPitch"]').val(FC.PID_PROFILE.offsetLimitPitch).change(),$('.tab-profiles input[id="offsetGainRoll"]').val(FC.PIDS[0][5]).change(),$('.tab-profiles input[id="offsetGainPitch"]').val(FC.PIDS[1][5]).change(),$('.tab-profiles input[id="errorRotation"]').prop("checked",FC.PID_PROFILE.error_rotation!==0).closest("tr").toggle(_e.lt(FC.CONFIG.apiVersion,lo)),$('.tab-profiles input[id="errorDecayTimeGround"]').val(FC.PID_PROFILE.error_decay_time_ground/10),$('.tab-profiles input[id="errorDecayTimeCyclic"]').val(FC.PID_PROFILE.error_decay_time_cyclic/10),$('.tab-profiles input[id="errorDecayLimitCyclic"]').val(FC.PID_PROFILE.error_decay_limit_cyclic);const u=$('.tab-profiles input[id="errorDecayGround"]');u.change(function(){const m=$(this).is(":checked");$(".tab-profiles .errorDecayGround .suboption").toggle(m)}),u.prop("checked",FC.PID_PROFILE.error_decay_time_ground>0).change(),$('.tab-profiles input[id="itermRelaxCutoffRoll"]').val(FC.PID_PROFILE.itermRelaxCutoffRoll),$('.tab-profiles input[id="itermRelaxCutoffPitch"]').val(FC.PID_PROFILE.itermRelaxCutoffPitch),$('.tab-profiles input[id="itermRelaxCutoffYaw"]').val(FC.PID_PROFILE.itermRelaxCutoffYaw);const p=$('.tab-profiles input[id="itermRelax"]'),h=$('.tab-profiles select[id="itermRelaxType"]');p.change(function(){const m=p.is(":checked");$(".tab-profiles .itermRelax .suboption").toggle(m),$(".tab-profiles .itermRelax .subhelp").toggle(m),h.change()}),p.prop("checked",FC.PID_PROFILE.itermRelaxType>0).change(),h.change(function(){const C=p.is(":checked")?h.val():0;$(".tab-profiles .itermRelaxYawOption").toggle(C>1)}),h.val(FC.PID_PROFILE.itermRelaxType<2?1:2).change(),$('.tab-profiles input[id="yawStopGainCW"]').val(FC.PID_PROFILE.yawStopGainCW),$('.tab-profiles input[id="yawStopGainCCW"]').val(FC.PID_PROFILE.yawStopGainCCW),$('.tab-profiles input[id="yawPrecompCutoff"]').val(FC.PID_PROFILE.yawPrecompCutoff),$('.tab-profiles input[id="yawFFCyclicGain"]').val(FC.PID_PROFILE.yawFFCyclicGain),$('.tab-profiles input[id="yawFFCollectiveGain"]').val(FC.PID_PROFILE.yawFFCollectiveGain),$('.tab-profiles input[id="yawFFImpulseGain"]').val(FC.PID_PROFILE.yawFFImpulseGain),$('.tab-profiles input[id="yawFFImpulseDecay"]').val(FC.PID_PROFILE.yawFFImpulseDecay),$('.tab-profiles input[id="yaw_inertia_precomp_gain"]').val(FC.PID_PROFILE.yaw_inertia_precomp_gain),$('.tab-profiles input[id="yaw_inertia_precomp_cutoff"]').val(FC.PID_PROFILE.yaw_inertia_precomp_cutoff/10),$('.tab-profiles input[id="pitchFFCollectiveGain"]').val(FC.PID_PROFILE.pitchFFCollectiveGain);const g=$('.tab-profiles input[id="pitchFFCollective"]');g.change(function(){const m=$(this).is(":checked");$(".tab-profiles .pitchFFCollective .suboption").toggle(m),$(".tab-profiles .pitchFFCollective .subhelp").toggle(m)}),g.prop("checked",FC.PID_PROFILE.pitchFFCollectiveGain>0).change(),$('.tab-profiles input[id="cyclicCrossCouplingGain"]').val(FC.PID_PROFILE.cyclicCrossCouplingGain),$('.tab-profiles input[id="cyclicCrossCouplingRatio"]').val(FC.PID_PROFILE.cyclicCrossCouplingRatio),_e.gte(FC.CONFIG.apiVersion,cn)?$('.tab-profiles input[id="cyclicCrossCouplingCutoff"]').val((FC.PID_PROFILE.cyclicCrossCouplingCutoff/10).toFixed(1)):$('.tab-profiles input[id="cyclicCrossCouplingCutoff"]').val(FC.PID_PROFILE.cyclicCrossCouplingCutoff);const f=$('.tab-profiles input[id="cyclicCrossCoupling"]');f.change(function(){const m=$(this).is(":checked");$(".tab-profiles .cyclicCrossCoupling .suboption").toggle(m),$(".tab-profiles .cyclicCrossCoupling .subhelp").toggle(m)}),f.prop("checked",FC.PID_PROFILE.cyclicCrossCouplingGain>0).change(),$('.tab-profiles input[id="acroTrainerGain"]').val(FC.PID_PROFILE.acroTrainerGain).trigger("input"),$('.tab-profiles input[id="acroTrainerLimit"]').val(FC.PID_PROFILE.acroTrainerLimit).trigger("input"),$('.tab-profiles input[id="angleModeGain"]').val(FC.PID_PROFILE.levelAngleStrength),$('.tab-profiles input[id="angleModeLimit"]').val(FC.PID_PROFILE.levelAngleLimit),$('.tab-profiles input[id="horizonModeGain"]').val(FC.PID_PROFILE.horizonLevelStrength);const d=$('.tab-profiles input[id="rescueEnable"]');d.change(function(){const m=$(this).is(":checked");$(".tab-profiles .rescueMode .suboption").toggle(m),$(".tab-profiles .rescueMode .subhelp").toggle(m),$(".tab-profiles .rescueAltHold").toggle(m&&FC.PID_PROFILE.rescueMode>1)}),d.prop("checked",FC.PID_PROFILE.rescueMode>0).change();const _=$('.tab-profiles input[id="rescueAltHold"]');_.change(function(){const m=$(this).is(":checked");$(".tab-profiles .rescueAltHold .suboption").toggle(m),$(".tab-profiles .rescueAltHold .subhelp").toggle(m)}),_.prop("checked",FC.PID_PROFILE.rescueMode>1).change(),$('.tab-profiles select[id="rescueFlipMode"]').val(FC.PID_PROFILE.rescueFlipMode),$('.tab-profiles input[id="rescuePullupCollective"]').val(FC.PID_PROFILE.rescuePullupCollective/10).change(),$('.tab-profiles input[id="rescueClimbCollective"]').val(FC.PID_PROFILE.rescueClimbCollective/10).change(),$('.tab-profiles input[id="rescueHoverCollective"]').val(FC.PID_PROFILE.rescueHoverCollective/10).change(),$('.tab-profiles input[id="rescuePullupTime"]').val(FC.PID_PROFILE.rescuePullupTime/10).change(),$('.tab-profiles input[id="rescueClimbTime"]').val(FC.PID_PROFILE.rescueClimbTime/10).change(),$('.tab-profiles input[id="rescueFlipTime"]').val(FC.PID_PROFILE.rescueFlipTime/10).change(),$('.tab-profiles input[id="rescueExitTime"]').val(FC.PID_PROFILE.rescueExitTime/10).change(),$('.tab-profiles input[id="rescueFlipGain"]').val(FC.PID_PROFILE.rescueFlipGain),$('.tab-profiles input[id="rescueLevelGain"]').val(FC.PID_PROFILE.rescueLevelGain),$('.tab-profiles input[id="rescueMaxRate"]').val(FC.PID_PROFILE.rescueMaxRate),$('.tab-profiles input[id="rescueMaxAccel"]').val(FC.PID_PROFILE.rescueMaxAccel),$('.tab-profiles input[id="rescueHoverAltitude"]').val(FC.PID_PROFILE.rescueHoverAltitude/100).change(),$('.tab-profiles input[id="rescueAltitudePGain"]').val(FC.PID_PROFILE.rescueAltitudePGain),$('.tab-profiles input[id="rescueAltitudeIGain"]').val(FC.PID_PROFILE.rescueAltitudeIGain),$('.tab-profiles input[id="rescueAltitudeDGain"]').val(FC.PID_PROFILE.rescueAltitudeDGain),$('.tab-profiles input[id="rescueMaxCollective"]').val(FC.PID_PROFILE.rescueMaxCollective/10).change(),e.isGovActive=FC.FEATURE_CONFIG.features.isEnabled("GOVERNOR")&&FC.GOVERNOR.gov_mode>1,e.isGovEnabled=FC.FEATURE_CONFIG.features.isEnabled("GOVERNOR")&&FC.GOVERNOR.gov_mode>0,$('.tab-profiles input[id="govHeadspeed"]').val(FC.GOVERNOR.gov_headspeed),$('.tab-profiles input[id="govMaxThrottle"]').val(FC.GOVERNOR.gov_max_throttle),$('.tab-profiles input[id="govMinThrottle"]').val(FC.GOVERNOR.gov_min_throttle),$('.tab-profiles input[id="govMasterGain"]').val(FC.GOVERNOR.gov_gain),$('.tab-profiles input[id="govPGain"]').val(FC.GOVERNOR.gov_p_gain),$('.tab-profiles input[id="govIGain"]').val(FC.GOVERNOR.gov_i_gain),$('.tab-profiles input[id="govDGain"]').val(FC.GOVERNOR.gov_d_gain),$('.tab-profiles input[id="govFGain"]').val(FC.GOVERNOR.gov_f_gain),$('.tab-profiles input[id="govTTAGain"]').val(FC.GOVERNOR.gov_tta_gain),$('.tab-profiles input[id="govTTALimit"]').val(FC.GOVERNOR.gov_tta_limit),$('.tab-profiles input[id="govYawPrecomp"]').val(FC.GOVERNOR.gov_yaw_ff_weight),$('.tab-profiles input[id="govCyclicPrecomp"]').val(FC.GOVERNOR.gov_cyclic_ff_weight),$('.tab-profiles input[id="govCollectivePrecomp"]').val(FC.GOVERNOR.gov_collective_ff_weight),$(".tab-profiles .govTTAGain").toggle(e.isGovEnabled),$(".tab-profiles .govTTALimit").toggle(e.isGovEnabled),$(".tab-profiles .gov_settings").toggle(e.isGovEnabled),$(".tab-profiles .gov_settings .govActive").toggle(e.isGovActive)}function a(){e.axisNames.forEach(function(h,g){e.gainNames.forEach(function(f,d){const _=$(`.tab-profiles .${h} input[name="${f}"]`),m=parseInt(_.val());FC.PIDS[g][d]=m})}),FC.PID_PROFILE.gyroCutoffRoll=$('.tab-profiles input[id="gyroCutoffRoll"]').val(),FC.PID_PROFILE.gyroCutoffPitch=$('.tab-profiles input[id="gyroCutoffPitch"]').val(),FC.PID_PROFILE.gyroCutoffYaw=$('.tab-profiles input[id="gyroCutoffYaw"]').val(),FC.PID_PROFILE.dtermCutoffRoll=$('.tab-profiles input[id="dtermCutoffRoll"]').val(),FC.PID_PROFILE.dtermCutoffPitch=$('.tab-profiles input[id="dtermCutoffPitch"]').val(),FC.PID_PROFILE.dtermCutoffYaw=$('.tab-profiles input[id="dtermCutoffYaw"]').val(),FC.PID_PROFILE.btermCutoffRoll=$('.tab-profiles input[id="btermCutoffRoll"]').val(),FC.PID_PROFILE.btermCutoffPitch=$('.tab-profiles input[id="btermCutoffPitch"]').val(),FC.PID_PROFILE.btermCutoffYaw=$('.tab-profiles input[id="btermCutoffYaw"]').val(),FC.PID_PROFILE.errorLimitRoll=$('.tab-profiles input[id="errorLimitRoll"]').val(),FC.PID_PROFILE.errorLimitPitch=$('.tab-profiles input[id="errorLimitPitch"]').val(),FC.PID_PROFILE.errorLimitYaw=$('.tab-profiles input[id="errorLimitYaw"]').val(),FC.PID_PROFILE.offsetLimitRoll=$('.tab-profiles input[id="offsetLimitRoll"]').val(),FC.PID_PROFILE.offsetLimitPitch=$('.tab-profiles input[id="offsetLimitPitch"]').val(),FC.PIDS[0][5]=$('.tab-profiles input[id="offsetGainRoll"]').val(),FC.PIDS[1][5]=$('.tab-profiles input[id="offsetGainPitch"]').val(),FC.PID_PROFILE.error_decay_time_ground=$('.tab-profiles input[id="errorDecayGround"]').is(":checked")?$('.tab-profiles input[id="errorDecayTimeGround"]').val()*10:0,FC.PID_PROFILE.error_decay_time_cyclic=$('.tab-profiles input[id="errorDecayTimeCyclic"]').val()*10,FC.PID_PROFILE.error_decay_limit_cyclic=$('.tab-profiles input[id="errorDecayLimitCyclic"]').val(),FC.PID_PROFILE.error_rotation=$('.tab-profiles input[id="errorRotation"]').is(":checked")?1:0,FC.PID_PROFILE.itermRelaxType=$('.tab-profiles input[id="itermRelax"]').is(":checked")?$('.tab-profiles select[id="itermRelaxType"]').val():0,FC.PID_PROFILE.itermRelaxCutoffRoll=parseInt($('.tab-profiles input[id="itermRelaxCutoffRoll"]').val()),FC.PID_PROFILE.itermRelaxCutoffPitch=parseInt($('.tab-profiles input[id="itermRelaxCutoffPitch"]').val()),FC.PID_PROFILE.itermRelaxCutoffYaw=parseInt($('.tab-profiles input[id="itermRelaxCutoffYaw"]').val()),FC.PID_PROFILE.yawStopGainCW=$('.tab-profiles input[id="yawStopGainCW"]').val(),FC.PID_PROFILE.yawStopGainCCW=$('.tab-profiles input[id="yawStopGainCCW"]').val(),FC.PID_PROFILE.yawPrecompCutoff=$('.tab-profiles input[id="yawPrecompCutoff"]').val(),FC.PID_PROFILE.yawFFCyclicGain=$('.tab-profiles input[id="yawFFCyclicGain"]').val(),FC.PID_PROFILE.yawFFCollectiveGain=$('.tab-profiles input[id="yawFFCollectiveGain"]').val(),FC.PID_PROFILE.yawFFImpulseGain=$('.tab-profiles input[id="yawFFImpulseGain"]').val(),FC.PID_PROFILE.yawFFImpulseDecay=$('.tab-profiles input[id="yawFFImpulseDecay"]').val(),FC.PID_PROFILE.yaw_inertia_precomp_gain=$('.tab-profiles input[id="yaw_inertia_precomp_gain"]').val(),FC.PID_PROFILE.yaw_inertia_precomp_cutoff=$('.tab-profiles input[id="yaw_inertia_precomp_cutoff"]').val()*10,FC.PID_PROFILE.pitchFFCollectiveGain=$('.tab-profiles input[id="pitchFFCollective"]').is(":checked")?parseInt($('.tab-profiles input[id="pitchFFCollectiveGain"]').val()):0,FC.PID_PROFILE.cyclicCrossCouplingGain=$('.tab-profiles input[id="cyclicCrossCoupling"]').is(":checked")?parseInt($('.tab-profiles input[id="cyclicCrossCouplingGain"]').val()):0,FC.PID_PROFILE.cyclicCrossCouplingRatio=parseInt($('.tab-profiles input[id="cyclicCrossCouplingRatio"]').val()),FC.PID_PROFILE.cyclicCrossCouplingCutoff=parseFloat($('.tab-profiles input[id="cyclicCrossCouplingCutoff"]').val()),_e.gte(FC.CONFIG.apiVersion,cn)&&(FC.PID_PROFILE.cyclicCrossCouplingCutoff*=10),FC.PID_PROFILE.acroTrainerGain=parseInt($('.tab-profiles input[id="acroTrainerGain"]').val()),FC.PID_PROFILE.acroTrainerLimit=parseInt($('.tab-profiles input[id="acroTrainerLimit"]').val()),FC.PID_PROFILE.levelAngleStrength=parseInt($('.tab-profiles input[id="angleModeGain"]').val()),FC.PID_PROFILE.levelAngleLimit=parseInt($('.tab-profiles input[id="angleModeLimit"]').val()),FC.PID_PROFILE.horizonLevelStrength=parseInt($('.tab-profiles input[id="horizonModeGain"]').val());const u=$('.tab-profiles input[id="rescueEnable"]').is(":checked"),p=$('.tab-profiles input[id="rescueAltHold"]').is(":checked");FC.PID_PROFILE.rescueMode=u?p?2:1:0,FC.PID_PROFILE.rescueFlipMode=$('.tab-profiles select[id="rescueFlipMode"]').val(),FC.PID_PROFILE.rescuePullupCollective=$('.tab-profiles input[id="rescuePullupCollective"]').val()*10,FC.PID_PROFILE.rescueClimbCollective=$('.tab-profiles input[id="rescueClimbCollective"]').val()*10,FC.PID_PROFILE.rescueHoverCollective=$('.tab-profiles input[id="rescueHoverCollective"]').val()*10,FC.PID_PROFILE.rescueMaxRate=$('.tab-profiles input[id="rescueMaxRate"]').val(),FC.PID_PROFILE.rescueMaxAccel=$('.tab-profiles input[id="rescueMaxAccel"]').val(),FC.PID_PROFILE.rescueFlipGain=$('.tab-profiles input[id="rescueFlipGain"]').val(),FC.PID_PROFILE.rescueLevelGain=$('.tab-profiles input[id="rescueLevelGain"]').val(),FC.PID_PROFILE.rescuePullupTime=$('.tab-profiles input[id="rescuePullupTime"]').val()*10,FC.PID_PROFILE.rescueClimbTime=$('.tab-profiles input[id="rescueClimbTime"]').val()*10,FC.PID_PROFILE.rescueFlipTime=$('.tab-profiles input[id="rescueFlipTime"]').val()*10,FC.PID_PROFILE.rescueExitTime=$('.tab-profiles input[id="rescueExitTime"]').val()*10,FC.PID_PROFILE.rescueHoverAltitude=$('.tab-profiles input[id="rescueHoverAltitude"]').val()*100,FC.PID_PROFILE.rescueAltitudePGain=$('.tab-profiles input[id="rescueAltitudePGain"]').val(),FC.PID_PROFILE.rescueAltitudeIGain=$('.tab-profiles input[id="rescueAltitudeIGain"]').val(),FC.PID_PROFILE.rescueAltitudeDGain=$('.tab-profiles input[id="rescueAltitudeDGain"]').val(),FC.PID_PROFILE.rescueMaxCollective=$('.tab-profiles input[id="rescueMaxCollective"]').val()*10,e.isGovEnabled&&(FC.GOVERNOR.gov_tta_gain=parseInt($('.tab-profiles input[id="govTTAGain"]').val()),FC.GOVERNOR.gov_tta_limit=parseInt($('.tab-profiles input[id="govTTALimit"]').val())),e.isGovActive&&(FC.GOVERNOR.gov_headspeed=parseInt($('.tab-profiles input[id="govHeadspeed"]').val()),FC.GOVERNOR.gov_min_throttle=parseInt($('.tab-profiles input[id="govMinThrottle"]').val()),FC.GOVERNOR.gov_gain=parseInt($('.tab-profiles input[id="govMasterGain"]').val()),FC.GOVERNOR.gov_p_gain=parseInt($('.tab-profiles input[id="govPGain"]').val()),FC.GOVERNOR.gov_i_gain=parseInt($('.tab-profiles input[id="govIGain"]').val()),FC.GOVERNOR.gov_d_gain=parseInt($('.tab-profiles input[id="govDGain"]').val()),FC.GOVERNOR.gov_f_gain=parseInt($('.tab-profiles input[id="govFGain"]').val()),FC.GOVERNOR.gov_yaw_ff_weight=parseInt($('.tab-profiles input[id="govYawPrecomp"]').val()),FC.GOVERNOR.gov_cyclic_ff_weight=parseInt($('.tab-profiles input[id="govCyclicPrecomp"]').val()),FC.GOVERNOR.gov_collective_ff_weight=parseInt($('.tab-profiles input[id="govCollectivePrecomp"]').val())),e.isGovEnabled&&(FC.GOVERNOR.gov_max_throttle=parseInt($('.tab-profiles input[id="govMaxThrottle"]').val()))}function c(){i18n.localizePage(),l(),$(".tab-profiles").addClass("toolbar_hidden"),e.isDirty=!1,e.isChanged=!1;function u(){e.isChanged||(e.isDirty=!0,e.isChanged=!0,$(".tab-profiles").removeClass("toolbar_hidden"),$("#copyProfile").addClass("disabled"))}function p(){e.isDirty||(e.isDirty=!0,$(".tab-profiles").removeClass("toolbar_hidden"))}function h(C){FC.CONFIG.profile=C,MSP.promise(MSPCodes.MSP_SELECT_SETTING,[C]).then(function(){GUI.log(i18n.getMessage("profilesActivateProfile",[C+1])),GUI.tab_switch_reload(()=>p())})}e.tabNames.forEach(function(C,R){$(".tab-profiles .tab-container ."+C).on("click",function(){R!=e.currentProfile&&(e.isDirty=e.isChanged,GUI.tab_switch_allowed(()=>h(R)))}),$(".tab-profiles .tab-container ."+C).toggle(R<FC.CONFIG.numProfiles)});const g=$(".dialogResetProfile")[0];$("#resetProfile").click(function(){g.showModal()}),$(".dialogResetProfile-cancelbtn").click(function(){g.close()}),$(".dialogResetProfile-confirmbtn").click(function(){MSP.send_message(MSPCodes.MSP_SET_RESET_CURR_PID,!1,!1,function(){GUI.log(i18n.getMessage("profilesResetProfile")),MSP.send_message(MSPCodes.MSP_EEPROM_WRITE,!1,!1,function(){GUI.log(i18n.getMessage("eepromSaved")),g.close(),GUI.tab_switch_reload()})})});const f=$(".dialogCopyProfile")[0],d=$(".selectProfile");$.each(e.tabNames,function(C){if(C!=FC.CONFIG.profile){const R=C+1;d.append(new Option(i18n.getMessage(`profilesSubTab${R}`),C))}}),$("#copyProfile").click(function(){e.isChanged||f.showModal()}),$(".dialogCopyProfile-cancelbtn").click(function(){f.close()}),$(".dialogCopyProfile-confirmbtn").click(function(){FC.COPY_PROFILE.type=0,FC.COPY_PROFILE.dstProfile=parseInt(d.val()),FC.COPY_PROFILE.srcProfile=FC.CONFIG.profile,MSP.send_message(MSPCodes.MSP_COPY_PROFILE,mspHelper.crunch(MSPCodes.MSP_COPY_PROFILE),!1,function(){MSP.send_message(MSPCodes.MSP_EEPROM_WRITE,!1,!1,function(){GUI.log(i18n.getMessage("eepromSaved")),f.close()})})});const _=$(".dialogProfileChange")[0];$(".dialogProfileChangeConfirmBtn").click(function(){_.close(),GUI.tab_switch_reload(),GUI.log(i18n.getMessage("profilesActivateProfile",[FC.CONFIG.profile+1]))}),e.save=function(C){a(),i(C)},e.revert=function(C){e.currentProfile!=e.savedProfile?o(C):C?.()},$("a.save").click(function(){e.save(()=>GUI.tab_switch_reload())}),$("a.revert").click(function(){e.revert(()=>GUI.tab_switch_reload())}),$(".tab-area").change(function(){u()}),$('.tab-profiles input[id="govHeadspeed"]').change(function(){const C=parseInt($(this).val());!e.isPIDDefault&&C!=FC.GOVERNOR.gov_headspeed&&$(".tab-profiles .gov_settings .note").show()}),_e.gte(FC.CONFIG.apiVersion,cn)&&$('.tab-profiles input[id="cyclicCrossCouplingCutoff"]').attr({step:.1,min:.1,max:25}),_e.lt(FC.CONFIG.apiVersion,cn)&&($(".tab-profiles tr.govMinThrottle").hide(),e.isGovActive&&$(".tab-profiles tr.govMaxThrottle").addClass("border")),_e.gte(FC.CONFIG.apiVersion,Dn)?($(".tab-profiles tr.yawFFImpulseGain").hide(),$(".tab-profiles tr.yawFFImpulseDecay").hide(),$(".tab-profiles tr.yaw_inertia_precomp_gain").show(),$(".tab-profiles tr.yaw_inertia_precomp_cutoff").show()):($(".tab-profiles tr.yawFFImpulseGain").show(),$(".tab-profiles tr.yawFFImpulseDecay").show(),$(".tab-profiles tr.yaw_inertia_precomp_gain").hide(),$(".tab-profiles tr.yaw_inertia_precomp_cutoff").hide());function m(){MSP.send_message(MSPCodes.MSP_STATUS,!1,!1,function(){e.currentProfile!=FC.CONFIG.profile&&!_.hasAttribute("open")&&(e.isChanged?_.showModal():(GUI.tab_switch_reload(),GUI.log(i18n.getMessage("profilesActivateProfile",[FC.CONFIG.profile+1]))))})}GUI.interval_add("status_pull",m,250,!0),GUI.content_ready(n)}};wa.cleanup=function(n){this.isDirty=!1,n?.()};TABS[wa.tabName]=wa;const Mn={tabName:"rates",isDirty:!1,isChanged:!1,activeSubtab:null,savedRateProfile:null,currentRateProfile:null,currentRatesType:null,previousRatesType:null,RATES_TYPE:{NONE:0,BETAFLIGHT:1,RACEFLIGHT:2,KISS:3,ACTUAL:4,QUICKRATES:5},RATES_TYPE_NAMES:["None","Betaflight","Raceflight","KISS","Actual","QuickRates"],RATES_TYPE_IMAGES:["none.svg","betaflight.svg","raceflight.svg","kiss.svg","actual.svg","quickrates.svg"],TAB_NAMES:["rateProfile1","rateProfile2","rateProfile3","rateProfile4","rateProfile5","rateProfile6"],RATE_PROFILE_MASK:128,rcChannels:[0,0,0,0],oldChannels:[0,0,0,0]};Mn.initialize=function(n){const e=this;r(t);function t(){$("#content").load("/src/tabs/rates.html",p)}function r(h){Promise.resolve(!0).then(()=>MSP.promise(MSPCodes.MSP_STATUS)).then(()=>MSP.promise(MSPCodes.MSP_RC_TUNING)).then(()=>MSP.promise(MSPCodes.MSP_RC_CONFIG)).then(()=>MSP.promise(MSPCodes.MSP_MIXER_CONFIG)).then(h)}function i(h){Promise.resolve(!0).then(()=>MSP.promise(MSPCodes.MSP_SET_RC_TUNING,mspHelper.crunch(MSPCodes.MSP_SET_RC_TUNING))).then(()=>MSP.promise(MSPCodes.MSP_EEPROM_WRITE)).then(()=>{e.savedRateProfile=e.currentRateProfile,GUI.log(i18n.getMessage("eepromSaved")),h?.()})}function o(h){MSP.promise(MSPCodes.MSP_SELECT_SETTING,[e.savedRateProfile+e.RATE_PROFILE_MASK]).then(()=>{GUI.log(i18n.getMessage("rateSetupActivateProfile",[e.savedRateProfile+1])),h?.()})}function s(){e.currentRatesType=FC.RC_TUNING.rates_type,e.previousRatesType=FC.RC_TUNING.rates_type,e.currentRateProfile=FC.CONFIG.rateProfile,e.savedRateProfile==null&&(e.savedRateProfile=e.currentRateProfile),e.activeSubtab=e.TAB_NAMES[e.currentRateProfile],$(".tab-rates .tab-container .tab").removeClass("active"),$(".tab-rates .tab-container ."+e.activeSubtab).addClass("active");const h=$('.rates_type select[id="ratesType"]');e.RATES_TYPE_NAMES.forEach(function(g,f){h.append(`<option value="${f}">${g}</option>`)}),h.val(e.currentRatesType),e.changeRatesLogo(),e.initRatesSystem()}function l(){FC.RC_TUNING.rates_type=parseInt($('.rates_type select[id="ratesType"]').val()),FC.RC_TUNING.roll_response_time=getIntegerValue('.tab-rates input[name="roll_response"]'),FC.RC_TUNING.pitch_response_time=getIntegerValue('.tab-rates input[name="pitch_response"]'),FC.RC_TUNING.yaw_response_time=getIntegerValue('.tab-rates input[name="yaw_response"]'),FC.RC_TUNING.collective_response_time=getIntegerValue('.tab-rates input[name="coll_response"]'),FC.RC_TUNING.roll_accel_limit=getIntegerValue('.tab-rates input[name="roll_accel"]',.1),FC.RC_TUNING.pitch_accel_limit=getIntegerValue('.tab-rates input[name="pitch_accel"]',.1),FC.RC_TUNING.yaw_accel_limit=getIntegerValue('.tab-rates input[name="yaw_accel"]',.1),FC.RC_TUNING.collective_accel_limit=getIntegerValue('.tab-rates input[name="coll_accel"]',.1),FC.RC_TUNING.roll_setpoint_boost_gain=getIntegerValue("#setpoint-boost-gain-roll"),FC.RC_TUNING.pitch_setpoint_boost_gain=getIntegerValue("#setpoint-boost-gain-pitch"),FC.RC_TUNING.yaw_setpoint_boost_gain=getIntegerValue("#setpoint-boost-gain-yaw"),FC.RC_TUNING.collective_setpoint_boost_gain=getIntegerValue("#setpoint-boost-gain-collective"),FC.RC_TUNING.roll_setpoint_boost_cutoff=getIntegerValue("#setpoint-boost-cutoff-roll"),FC.RC_TUNING.pitch_setpoint_boost_cutoff=getIntegerValue("#setpoint-boost-cutoff-pitch"),FC.RC_TUNING.yaw_setpoint_boost_cutoff=getIntegerValue("#setpoint-boost-cutoff-yaw"),FC.RC_TUNING.collective_setpoint_boost_cutoff=getIntegerValue("#setpoint-boost-cutoff-collective"),FC.RC_TUNING.yaw_dynamic_ceiling_gain=getIntegerValue("#yaw-dynamic-ceiling-gain"),FC.RC_TUNING.yaw_dynamic_deadband_gain=getIntegerValue("#yaw-dynamic-deadband-gain"),FC.RC_TUNING.yaw_dynamic_deadband_filter=getIntegerValue("#yaw-dynamic-deadband-filter",10);const h=$('.rates_setup input[name="roll_pitch_rate"]'),g=$('.rates_setup input[name="pitch_rate"]'),f=$('.rates_setup input[name="roll_rate"]'),d=$('.rates_setup input[name="yaw_rate"]'),_=$('.rates_setup input[name="collective_rate"]'),m=$('.rates_setup input[name="rc_rate_pitch"]'),C=$('.rates_setup input[name="rc_rate"]'),R=$('.rates_setup input[name="rc_rate_yaw"]'),S=$('.rates_setup input[name="rc_rate_collective"]'),F=$('.rates_setup input[name="rc_pitch_expo"]'),I=$('.rates_setup input[name="rc_expo"]'),T=$('.rates_setup input[name="rc_yaw_expo"]'),P=$('.rates_setup input[name="rc_collective_expo"]');switch(FC.RC_TUNING.roll_pitch_rate=getFloatValue(h),FC.RC_TUNING.RC_RATE=getFloatValue(C),FC.RC_TUNING.roll_rate=getFloatValue(f),FC.RC_TUNING.pitch_rate=getFloatValue(g),FC.RC_TUNING.yaw_rate=getFloatValue(d),FC.RC_TUNING.collective_rate=getFloatValue(_),FC.RC_TUNING.RC_EXPO=getFloatValue(I),FC.RC_TUNING.RC_YAW_EXPO=getFloatValue(T),FC.RC_TUNING.rcYawRate=getFloatValue(R),FC.RC_TUNING.rcPitchRate=getFloatValue(m),FC.RC_TUNING.RC_PITCH_EXPO=getFloatValue(F),FC.RC_TUNING.rcCollectiveRate=getFloatValue(S),FC.RC_TUNING.RC_COLLECTIVE_EXPO=getFloatValue(P),e.currentRatesType){case e.RATES_TYPE.RACEFLIGHT:FC.RC_TUNING.pitch_rate/=100,FC.RC_TUNING.roll_rate/=100,FC.RC_TUNING.yaw_rate/=100,FC.RC_TUNING.collective_rate/=100,FC.RC_TUNING.rcPitchRate/=1e3,FC.RC_TUNING.RC_RATE/=1e3,FC.RC_TUNING.rcYawRate/=1e3,FC.RC_TUNING.rcCollectiveRate/=25,FC.RC_TUNING.RC_PITCH_EXPO/=100,FC.RC_TUNING.RC_EXPO/=100,FC.RC_TUNING.RC_YAW_EXPO/=100,FC.RC_TUNING.RC_COLLECTIVE_EXPO/=100;break;case e.RATES_TYPE.ACTUAL:FC.RC_TUNING.pitch_rate/=1e3,FC.RC_TUNING.roll_rate/=1e3,FC.RC_TUNING.yaw_rate/=1e3,FC.RC_TUNING.collective_rate/=25,FC.RC_TUNING.rcPitchRate/=1e3,FC.RC_TUNING.RC_RATE/=1e3,FC.RC_TUNING.rcYawRate/=1e3,FC.RC_TUNING.rcCollectiveRate/=25;break;case e.RATES_TYPE.QUICKRATES:FC.RC_TUNING.pitch_rate/=1e3,FC.RC_TUNING.roll_rate/=1e3,FC.RC_TUNING.yaw_rate/=1e3,FC.RC_TUNING.collective_rate/=480;break}}function a(h,g,f){h.strokeStyle="#000000",h.lineWidth=4,h.beginPath(),h.moveTo(0,f/2),h.lineTo(g,f/2),h.stroke(),h.beginPath(),h.moveTo(g/2,0),h.lineTo(g/2,f),h.stroke()}e.rateCurve=new RateCurve2;function c(h,g,f,d,_,m,C,R){const S=e.rateCurve.getMaxAngularVel(e.currentRatesType,h,g,f,d,_,m);return C.text(R?e.convertToCollective(S):S.toFixed(0)),S}function u(h,g,f,d,_,m,C,R,S,F){F.save(),F.strokeStyle=R,F.translate(0,S),e.rateCurve.draw(e.currentRatesType,h,g,f,d,_,m,C,F),F.restore()}function p(){i18n.localizePage(),s(),$(".tab-rates").addClass("toolbar_hidden"),e.isDirty=!1,e.isChanged=!1;function h(){e.isChanged||(e.isDirty=!0,e.isChanged=!0,$(".tab-rates").removeClass("toolbar_hidden"),$("#copyProfile").addClass("disabled"))}function g(){e.isDirty||(e.isDirty=!0,$(".tab-rates").removeClass("toolbar_hidden"))}function f(L){FC.CONFIG.rateProfile=L,MSP.promise(MSPCodes.MSP_SELECT_SETTING,[L+e.RATE_PROFILE_MASK]).then(function(){GUI.log(i18n.getMessage("rateSetupActivateProfile",[L+1])),GUI.tab_switch_reload(()=>g())})}e.TAB_NAMES.forEach(function(L,G){$(".tab-rates .tab-container ."+L).on("click",function(){G!=e.currentRateProfile&&(e.isDirty=e.isChanged,GUI.tab_switch_allowed(()=>f(G)))})}),$(".rateDynamic .group.setpoint-boost, .rateDynamic .group.yaw-deadband").toggle(_e.gte(FC.CONFIG.apiVersion,API_VERSION_12_8));const d=$(".rate_curve canvas#rate_curve_layer0").get(0),_=d.getContext("2d");let m=!0,C;e.maxAngularVelRollElement=$(".rates_setup .maxAngularVelRoll"),e.maxAngularVelPitchElement=$(".rates_setup .maxAngularVelPitch"),e.maxAngularVelYawElement=$(".rates_setup .maxAngularVelYaw"),e.maxCollectiveAngleElement=$(".rates_setup .maxCollectiveAngle"),d.width=1e3,d.height=1e3;function R(L){if(L){const G=$(L.target);let U=getFloatValue(G);e.currentRates.hasOwnProperty(G.attr("name"))&&(e.currentRates[G.attr("name")]=U,m=!0),G.attr("id")==="ratesType"&&(e.changeRatesType(U),m=!0)}else m=!0;if(m){const G=d.height,U=d.width,M=_.canvas.width/_.canvas.clientWidth;_.clearRect(0,0,U,G),C=Math.max(c(e.currentRates.roll_rate,e.currentRates.rc_rate,e.currentRates.rc_expo,e.currentRates.superexpo,e.currentRates.deadband,e.currentRates.roll_rate_limit,e.maxAngularVelRollElement),c(e.currentRates.pitch_rate,e.currentRates.rc_rate_pitch,e.currentRates.rc_pitch_expo,e.currentRates.superexpo,e.currentRates.deadband,e.currentRates.pitch_rate_limit,e.maxAngularVelPitchElement),c(e.currentRates.yaw_rate,e.currentRates.rc_rate_yaw,e.currentRates.rc_yaw_expo,e.currentRates.superexpo,e.currentRates.yawDeadband,e.currentRates.yaw_rate_limit,e.maxAngularVelYawElement)),C=e.rateCurve.setMaxAngularVel(C),a(_,U,G),_.lineWidth=2*M,u(e.currentRates.roll_rate,e.currentRates.rc_rate,e.currentRates.rc_expo,e.currentRates.superexpo,e.currentRates.deadband,e.currentRates.roll_rate_limit,C,"#ff0000",-6,_),u(e.currentRates.pitch_rate,e.currentRates.rc_rate_pitch,e.currentRates.rc_pitch_expo,e.currentRates.superexpo,e.currentRates.deadband,e.currentRates.pitch_rate_limit,C,"#00ff00",-2,_),u(e.currentRates.yaw_rate,e.currentRates.rc_rate_yaw,e.currentRates.rc_yaw_expo,e.currentRates.superexpo,e.currentRates.yawDeadband,e.currentRates.yaw_rate_limit,C,"#0000ff",2,_),e.maxCollectiveAngle=c(e.currentRates.collective_rate,e.currentRates.rc_rate_collective,e.currentRates.rc_collective_expo,e.currentRates.superexpo,0,e.currentRates.collective_rate_limit,e.maxCollectiveAngleElement,!0),u(e.currentRates.collective_rate,e.currentRates.rc_rate_collective,e.currentRates.rc_collective_expo,e.currentRates.superexpo,0,e.currentRates.collective_rate_limit,e.maxCollectiveAngle,"#ffbb00",6,_),e.updateRatesLabels(),m=!1}}$(".rates_change").on("input change",R).trigger("input");const S=$(".dialogResetProfile")[0];$("#resetProfile").click(function(){S.showModal()}),$(".dialogResetProfile-cancelbtn").click(function(){S.close()}),$(".dialogResetProfile-confirmbtn").click(function(){S.close(),e.previousRatesType=null,e.changeRatesLogo(),e.initRatesSystem(),h()});const F=$(".dialogCopyProfile")[0],I=$(".selectRateProfile");$.each(e.TAB_NAMES,function(L){if(L!=e.currentRateProfile){const G=L+1;I.append(new Option(i18n.getMessage(`rateSetupSubTab${G}`),L))}}),$("#copyProfile").click(function(){e.isChanged||F.showModal()}),$(".dialogCopyProfile-cancelbtn").click(function(){F.close()}),$(".dialogCopyProfile-confirmbtn").click(function(){FC.COPY_PROFILE.type=1,FC.COPY_PROFILE.dstProfile=parseInt(I.val()),FC.COPY_PROFILE.srcProfile=FC.CONFIG.rateProfile,MSP.send_message(MSPCodes.MSP_COPY_PROFILE,mspHelper.crunch(MSPCodes.MSP_COPY_PROFILE),!1,function(){MSP.send_message(MSPCodes.MSP_EEPROM_WRITE,!1,!1,function(){GUI.log(i18n.getMessage("eepromSaved")),F.close()})})});const T=$(".dialogProfileChange")[0];$(".dialogProfileChangeConfirmBtn").click(function(){T.close(),GUI.tab_switch_reload(),GUI.log(i18n.getMessage("rateSetupActivateProfile",[FC.CONFIG.rateProfile+1]))}),e.save=function(L){l(),i(L)},e.revert=function(L){e.currentRateProfile!=e.savedRateProfile?o(L):L?.()},$("a.save").click(function(){e.save(()=>GUI.tab_switch_reload())}),$("a.revert").click(function(){e.revert(()=>GUI.tab_switch_reload())}),$(".subtab-rates").change(function(){h()}),e.initRatesPreview(),e.renderModel();function P(){MSP.send_message(MSPCodes.MSP_STATUS,!1,!1,function(){e.currentRateProfile!=FC.CONFIG.rateProfile&&!T.hasAttribute("open")&&(e.isChanged?T.showModal():(GUI.tab_switch_reload(),GUI.log(i18n.getMessage("rateSetupActivateProfile",[FC.CONFIG.rateProfile+1]))))})}function y(){MSP.send_message(MSPCodes.MSP_RC_COMMAND,!1,!1,function(){e.rcChannels[0]=1500+FC.RC_COMMAND[0],e.rcChannels[1]=1500+FC.RC_COMMAND[1],e.rcChannels[2]=1500+FC.RC_COMMAND[2],e.rcChannels[3]=1500+FC.RC_COMMAND[3]})}GUI.interval_add("receiver_pull",y,100,!0),GUI.interval_add("status_pull",P,250,!0),GUI.content_ready(n)}};Mn.convertToCollective=function(n){const e=this;switch(e.currentRatesType){case e.RATES_TYPE.NONE:case e.RATES_TYPE.BETAFLIGHT:case e.RATES_TYPE.KISS:case e.RATES_TYPE.QUICKRATES:n/=40;break;case e.RATES_TYPE.RACEFLIGHT:case e.RATES_TYPE.ACTUAL:}return n.toFixed(1)};Mn.initRatesPreview=function(){this.keepRendering=!0;try{this.model=new ir($(".rates_preview"),$(".rates_preview canvas")),$(".rates_preview .webgl-error").hide(),$(".tab-rates .tab-container .tab").on("click",$.proxy(this.model.resize,this.model)),$(window).on("resize",$.proxy(this.model.resize,this.model))}catch(n){console.log("Error initialising model",n),$(".rates_preview .webgl-error").show()}$(".tab-rates .tab-container .tab").on("click",$.proxy(this.updateRatesLabels,this)),$(window).on("resize",$.proxy(this.updateRatesLabels,this))};Mn.renderModel=function(){const n=this;if(n.keepRendering&&requestAnimationFrame(n.renderModel.bind(n)),n.clock||(n.clock=new rg),n.rcChannels[0]&&n.rcChannels[1]&&n.rcChannels[2]){const e=n.clock.getDelta(),t=e*n.rateCurve.rcCommandRawToDegreesPerSecond(n.rcChannels[0],n.currentRatesType,n.currentRates.roll_rate,n.currentRates.rc_rate,n.currentRates.rc_expo,n.currentRates.superexpo,n.currentRates.deadband,n.currentRates.roll_rate_limit),r=e*n.rateCurve.rcCommandRawToDegreesPerSecond(n.rcChannels[1],n.currentRatesType,n.currentRates.pitch_rate,n.currentRates.rc_rate_pitch,n.currentRates.rc_pitch_expo,n.currentRates.superexpo,n.currentRates.deadband,n.currentRates.pitch_rate_limit),i=e*n.rateCurve.rcCommandRawToDegreesPerSecond(n.rcChannels[2],n.currentRatesType,n.currentRates.yaw_rate,n.currentRates.rc_rate_yaw,n.currentRates.rc_yaw_expo,n.currentRates.superexpo,n.currentRates.yawDeadband,n.currentRates.yaw_rate_limit);n.model?.rotateBy(-degToRad(r),-degToRad(i),-degToRad(t)),n.checkChannels()&&n.updateRatesLabels()}};Mn.cleanup=function(n){const e=this;e.model&&($(window).off("resize",$.proxy(e.model.resize,e.model)),e.model.dispose()),$(window).off("resize",$.proxy(this.updateRatesLabels,this)),e.keepRendering=!1,e.isDirty=!1,n?.()};Mn.checkChannels=function(){const n=this;let e=!1;for(let t=0;t<n.oldChannels.length;t++)n.oldChannels[t]!==n.rcChannels[t]&&(n.oldChannels[t]=n.rcChannels[t],e=!0);return e};Mn.updateRatesLabels=function(){const n=this;if(n.rateCurve.maxAngularVel){const e=function(o,s,l,a,c,u){o.fillStyle=u||"#000000",o.textAlign=c||"center",o.fillText(s,l,a)},t=function(o,s,l,a,c,u,p){const d=parseInt(o.font),_=o.measureText(s).width*1.2,m=d*1.5,C=a;o.fillStyle=u.color||"#ffffff",o.strokeStyle=u.border||"#000000",l*=o.canvas.clientWidth/o.canvas.clientHeight,l+=(c=="right"?-(_+125):0)+(c=="left"?125:0),a-=m/2,a<0?a=0:a>o.height&&(a=o.height);for(let S=0;S<p.length;S++)(l>=p[S].left&&l<=p[S].right||l+_>=p[S].left&&l+_<=p[S].right)&&(a>=p[S].top&&a<=p[S].bottom||a+m>=p[S].top&&a+m<=p[S].bottom)&&(a<=(p[S].bottom-p[S].top)/2&&p[S].top-m>0?a=p[S].top-m:a=p[S].bottom);p.push({left:l,right:l+_,top:a-5,bottom:a+m+5});const R=(m-2*10)/6;o.beginPath(),o.moveTo(l+10,a),o.lineTo(l+_-10,a),o.quadraticCurveTo(l+_,a,l+_,a+10),c==="right"&&(o.lineTo(l+_,a+10+R),o.lineTo(l+_+125,C),o.lineTo(l+_,a+m-10-R)),o.lineTo(l+_,a+m-10),o.quadraticCurveTo(l+_,a+m,l+_-10,a+m),o.lineTo(l+10,a+m),o.quadraticCurveTo(l,a+m,l,a+m-10),c==="left"&&(o.lineTo(l,a+m-10-R),o.lineTo(l-125,C),o.lineTo(l,a+10-R)),o.lineTo(l,a+10),o.quadraticCurveTo(l,a,l+10,a),o.closePath(),o.fill(),o.stroke(),e(o,s,l+_/2,a+(m+d)/2-4,"center",u.text)},r={roll:{color:"rgba(255,128,128,0.4)",border:"rgba(255,128,128,0.6)",text:"#000000"},pitch:{color:"rgba(128,255,128,0.4)",border:"rgba(128,255,128,0.6)",text:"#000000"},yaw:{color:"rgba(128,128,255,0.4)",border:"rgba(128,128,255,0.6)",text:"#000000"},collective:{color:"rgba(255,187,0,0.4)",border:"rgba(255,187,0,0.6)",text:"#000000"}},i=$(".rate_curve canvas#rate_curve_layer1").get(0);if(i){i.width=1e3,i.height=1e3;const o=i.getContext("2d");o.save();const s=n.maxAngularVelRollElement.text(),l=n.maxAngularVelPitchElement.text(),a=n.maxAngularVelYawElement.text(),c=n.maxCollectiveAngleElement.text(),u=i.height,p=i.width,h=n.rateCurve.maxAngularVel,g=400/o.canvas.clientHeight,f=u/2/h,d=o.canvas.width/o.canvas.clientWidth,_=o.canvas.clientHeight/o.canvas.clientWidth;let m=[],C=[];o.clearRect(0,0,p,u),g<=1?o.font="24pt Verdana, Arial, sans-serif":o.font=24*g+"pt Verdana, Arial, sans-serif";const R=n.rcChannels[0]&&n.rcChannels[1]&&n.rcChannels[2]&&n.rcChannels[3];R?(m.push(n.rateCurve.drawStickPosition(n.rcChannels[0],n.currentRatesType,n.currentRates.roll_rate,n.currentRates.rc_rate,n.currentRates.rc_expo,n.currentRates.superexpo,n.currentRates.deadband,n.currentRates.roll_rate_limit,h,o,"#FF8080")),m.push(n.rateCurve.drawStickPosition(n.rcChannels[1],n.currentRatesType,n.currentRates.pitch_rate,n.currentRates.rc_rate_pitch,n.currentRates.rc_pitch_expo,n.currentRates.superexpo,n.currentRates.deadband,n.currentRates.pitch_rate_limit,h,o,"#80FF80")),m.push(n.rateCurve.drawStickPosition(n.rcChannels[2],n.currentRatesType,n.currentRates.yaw_rate,n.currentRates.rc_rate_yaw,n.currentRates.rc_yaw_expo,n.currentRates.superexpo,n.currentRates.yawDeadband,n.currentRates.yaw_rate_limit,h,o,"#8080FF")),m.push(n.rateCurve.drawStickPosition(n.rcChannels[3],n.currentRatesType,n.currentRates.collective_rate,n.currentRates.rc_rate_collective,n.currentRates.rc_collective_expo,n.currentRates.superexpo,0,n.currentRates.collective_rate_limit,n.maxCollectiveAngle,o,"#FFBB00"))):m=[],o.lineWidth=d,o.scale(_,1),e(o,h.toFixed(0)+"°/s",(p/2-10)/_,parseInt(o.font)*1.2,"right"),C=[];const S=[{value:s,balloon:function(){t(o,s+"°/s",p,f*(h-parseInt(s)),"right",r.roll,C)}},{value:l,balloon:function(){t(o,l+"°/s",p,f*(h-parseInt(l)),"right",r.pitch,C)}},{value:a,balloon:function(){t(o,a+"°/s",p,f*(h-parseInt(a)),"right",r.yaw,C)}},{value:1e4,balloon:function(){t(o,c+"°",p,0,"right",r.collective,C)}}];S.sort(function(F,I){return I.value-F.value}),R&&S.push({value:m[3],balloon:function(){t(o,n.convertToCollective(m[3])+"°",10,50,"none",r.collective,C)}},{value:m[0],balloon:function(){t(o,m[0].toFixed(0)+"°/s",10,150,"none",r.roll,C)}},{value:m[1],balloon:function(){t(o,m[1].toFixed(0)+"°/s",10,250,"none",r.pitch,C)}},{value:m[2],balloon:function(){t(o,m[2].toFixed(0)+"°/s",10,350,"none",r.yaw,C)}});for(const F of S)F.balloon();o.restore()}}};Mn.changeRatesType=function(n){const e=this,t=$(".dialogRatesType")[0];t.hasAttribute("open")||(t.showModal(),$(".dialogRatesType-cancelbtn").click(function(){$('.rates_type select[id="ratesType"]').val(e.currentRatesType),e.previousRatesType=e.currentRatesType,t.close()}),$(".dialogRatesType-confirmbtn").click(function(){e.currentRatesType=n,e.changeRatesLogo(),e.initRatesSystem(),t.close()}))};Mn.initRatesSystem=function(){const n=this;let e,t,r,i,o,s,l,a,c,u,p,h,g,f,d,_,m,C,R,S,F,I,T,P,y,L,G;const U=0,M=0,N=0;switch(n.currentRatesType){case n.RATES_TYPE.RACEFLIGHT:y="rateSetupRcRateRaceflight",L="rateSetupRateRaceflight",G="rateSetupRcExpoRaceflight",s=0,e=240,t=400,r=1e3,i=10,o=10,p=0,l=0,a=0,c=255,u=1,S=1,_=12.5,m=25,C=0,R=.1,P=0,F=0,I=255,T=1,d=0,h=0,g=100,f=1;break;case n.RATES_TYPE.KISS:y="rateSetupRcRate",L="rateSetupRcRateRaceflight",G="rateSetupRcExpoKISS",s=2,e=1.2,t=2,r=2.55,i=.01,o=.01,p=2,l=0,a=0,c=.99,u=.01,S=2,_=2.5,m=2.55,C=.01,R=.01,P=2,F=0,I=.99,T=.01,d=2,h=0,g=1,f=.01;break;case n.RATES_TYPE.ACTUAL:y="rateSetupRcRateActual",L="rateSetupRateQuickRates",G="rateSetupRcExpoRaceflight",s=0,e=180,t=180,r=1e3,i=10,o=10,p=0,l=240,a=400,c=1e3,u=10,S=1,_=12.5,m=25,C=0,R=.5,P=1,F=12.5,I=25,T=.5,d=2,h=0,g=1,f=.01;break;case n.RATES_TYPE.QUICKRATES:y="rateSetupRcRate",L="rateSetupRateQuickRates",G="rateSetupRcExpoRaceflight",s=2,e=1.2,t=2,r=2.55,i=.01,o=.01,p=0,l=240,a=400,c=1e3,u=10,S=2,_=2.5,m=2.55,C=.01,R=.01,P=0,F=500,I=1e3,T=10,d=2,h=0,g=1,f=.01;break;case n.RATES_TYPE.BETAFLIGHT:y="rateSetupRcRate",L="rateSetupRate",G="rateSetupRcExpo",s=2,e=1.2,t=2,r=2.55,i=.01,o=.01,p=2,l=0,a=0,c=.99,u=.01,S=2,_=2.03,m=2.2,C=.01,R=.01,P=2,F=.01,I=.99,T=.01,d=2,h=0,g=1,f=.01;break;default:y="rateSetupRcRate",L="rateSetupRate",G="rateSetupRcExpo",s=0,e=0,t=0,r=0,i=0,o=0,p=0,l=0,a=0,c=0,u=0,S=0,_=0,m=0,C=0,R=0,P=0,F=0,I=0,T=0,d=0,h=0,g=0,f=0;break}switch(n.currentRates={roll_rate:FC.RC_TUNING.roll_rate,pitch_rate:FC.RC_TUNING.pitch_rate,yaw_rate:FC.RC_TUNING.yaw_rate,collective_rate:FC.RC_TUNING.collective_rate,rc_rate:FC.RC_TUNING.RC_RATE,rc_rate_yaw:FC.RC_TUNING.rcYawRate,rc_expo:FC.RC_TUNING.RC_EXPO,rc_yaw_expo:FC.RC_TUNING.RC_YAW_EXPO,rc_rate_pitch:FC.RC_TUNING.rcPitchRate,rc_pitch_expo:FC.RC_TUNING.RC_PITCH_EXPO,rc_rate_collective:FC.RC_TUNING.rcCollectiveRate,rc_collective_expo:FC.RC_TUNING.RC_COLLECTIVE_EXPO,roll_rate_limit:FC.RC_TUNING.roll_rate_limit,pitch_rate_limit:FC.RC_TUNING.pitch_rate_limit,yaw_rate_limit:FC.RC_TUNING.yaw_rate_limit,collective_rate_limit:FC.RC_TUNING.collective_rate_limit,deadband:0,yawDeadband:0,superexpo:!0,roll_response_time:FC.RC_TUNING.roll_response_time,pitch_response_time:FC.RC_TUNING.pitch_response_time,yaw_response_time:FC.RC_TUNING.yaw_response_time,collective_response_time:FC.RC_TUNING.collective_response_time,roll_accel_limit:FC.RC_TUNING.roll_accel_limit,pitch_accel_limit:FC.RC_TUNING.pitch_accel_limit,yaw_accel_limit:FC.RC_TUNING.yaw_accel_limit,collective_accel_limit:FC.RC_TUNING.collective_accel_limit,roll_setpoint_boost_gain:FC.RC_TUNING.roll_setpoint_boost_gain,roll_setpoint_boost_cutoff:FC.RC_TUNING.roll_setpoint_boost_cutoff,pitch_setpoint_boost_gain:FC.RC_TUNING.pitch_setpoint_boost_gain,pitch_setpoint_boost_cutoff:FC.RC_TUNING.pitch_setpoint_boost_cutoff,yaw_setpoint_boost_gain:FC.RC_TUNING.yaw_setpoint_boost_gain,yaw_setpoint_boost_cutoff:FC.RC_TUNING.yaw_setpoint_boost_cutoff,collective_setpoint_boost_gain:FC.RC_TUNING.collective_setpoint_boost_gain,collective_setpoint_boost_cutoff:FC.RC_TUNING.collective_setpoint_boost_cutoff,yaw_dynamic_ceiling_gain:FC.RC_TUNING.yaw_dynamic_ceiling_gain,yaw_dynamic_deadband_gain:FC.RC_TUNING.yaw_dynamic_deadband_gain,yaw_dynamic_deadband_filter:FC.RC_TUNING.yaw_dynamic_deadband_filter},n.currentRatesType){case n.RATES_TYPE.RACEFLIGHT:n.currentRates.roll_rate*=100,n.currentRates.pitch_rate*=100,n.currentRates.yaw_rate*=100,n.currentRates.collective_rate*=100,n.currentRates.rc_rate*=1e3,n.currentRates.rc_rate_yaw*=1e3,n.currentRates.rc_rate_collective*=25,n.currentRates.rc_rate_pitch*=1e3,n.currentRates.rc_expo*=100,n.currentRates.rc_yaw_expo*=100,n.currentRates.rc_collective_expo*=100,n.currentRates.rc_pitch_expo*=100;break;case n.RATES_TYPE.ACTUAL:n.currentRates.roll_rate*=1e3,n.currentRates.pitch_rate*=1e3,n.currentRates.yaw_rate*=1e3,n.currentRates.collective_rate*=25,n.currentRates.rc_rate*=1e3,n.currentRates.rc_rate_yaw*=1e3,n.currentRates.rc_rate_collective*=25,n.currentRates.rc_rate_pitch*=1e3;break;case n.RATES_TYPE.QUICKRATES:n.currentRates.roll_rate*=1e3,n.currentRates.pitch_rate*=1e3,n.currentRates.yaw_rate*=1e3,n.currentRates.collective_rate*=480;break}n.currentRatesType!==n.previousRatesType&&(n.currentRates.roll_rate=l,n.currentRates.pitch_rate=l,n.currentRates.yaw_rate=a,n.currentRates.collective_rate=F,n.currentRates.rc_rate=e,n.currentRates.rc_rate_yaw=t,n.currentRates.rc_rate_pitch=e,n.currentRates.rc_rate_collective=_,n.currentRates.rc_expo=h,n.currentRates.rc_yaw_expo=h,n.currentRates.rc_pitch_expo=h,n.currentRates.rc_collective_expo=h,n.currentRates.roll_response_time=0,n.currentRates.pitch_response_time=0,n.currentRates.yaw_response_time=0,n.currentRates.collective_response_time=0,n.currentRates.roll_accel_limit=0,n.currentRates.pitch_accel_limit=0,n.currentRates.yaw_accel_limit=0,n.currentRates.collective_accel_limit=0,n.currentRates.roll_setpoint_boost_gain=0,n.currentRates.roll_setpoint_boost_cutoff=15,n.currentRates.pitch_setpoint_boost_gain=0,n.currentRates.pitch_setpoint_boost_cutoff=15,n.currentRates.yaw_setpoint_boost_gain=0,n.currentRates.yaw_setpoint_boost_cutoff=90,n.currentRates.collective_setpoint_boost_gain=0,n.currentRates.collective_setpoint_boost_cutoff=15,n.currentRates.yaw_dynamic_ceiling_gain=30,n.currentRates.yaw_dynamic_deadband_gain=30,n.currentRates.yaw_dynamic_deadband_filter=60);const w=$(".rates_setup .rates_titlebar .rc_rate"),x=$(".rates_setup .rates_titlebar .rate"),k=$(".rates_setup .rates_titlebar .rc_expo");w.text(i18n.getMessage(y)),x.text(i18n.getMessage(L)),k.text(i18n.getMessage(G));const O=$('.rates_setup input[name="pitch_rate"]'),D=$('.rates_setup input[name="roll_rate"]'),Y=$('.rates_setup input[name="yaw_rate"]'),z=$('.rates_setup input[name="collective_rate"]'),ee=$('.rates_setup input[name="rc_rate_pitch"]'),re=$('.rates_setup input[name="rc_rate"]'),le=$('.rates_setup input[name="rc_rate_yaw"]'),J=$('.rates_setup input[name="rc_rate_collective"]'),oe=$('.rates_setup input[name="rc_expo"]'),ae=$('.rates_setup input[name="rc_pitch_expo"]'),de=$('.rates_setup input[name="rc_yaw_expo"]'),ie=$('.rates_setup input[name="rc_collective_expo"]');O.val(n.currentRates.pitch_rate.toFixed(p)),D.val(n.currentRates.roll_rate.toFixed(p)),Y.val(n.currentRates.yaw_rate.toFixed(p)),z.val(n.currentRates.collective_rate.toFixed(P)),ee.val(n.currentRates.rc_rate_pitch.toFixed(s)),re.val(n.currentRates.rc_rate.toFixed(s)),le.val(n.currentRates.rc_rate_yaw.toFixed(s)),J.val(n.currentRates.rc_rate_collective.toFixed(S)),ae.val(n.currentRates.rc_pitch_expo.toFixed(d)),oe.val(n.currentRates.rc_expo.toFixed(d)),de.val(n.currentRates.rc_yaw_expo.toFixed(d)),ie.val(n.currentRates.rc_collective_expo.toFixed(d));const te=$('.rates_setup input[class="rc_rate_input"]'),fe=$('.rates_setup input[class="rate_input"]'),Re=$('.rates_setup input[class="expo_input"]');te.attr({max:r,min:i,step:o}).change(),fe.attr({max:c,min:U,step:u}).change(),Re.attr({max:g,min:M,step:f}).change(),$('.rates_setup input[class="rc_collective_input"]').attr({max:m,min:C,step:R}).change(),$('.rates_setup input[class="collective_input"]').attr({max:I,min:N,step:T}).change(),n.previousRatesType=n.currentRatesType,$('.tab-rates input[name="roll_response"]').val(n.currentRates.roll_response_time),$('.tab-rates input[name="pitch_response"]').val(n.currentRates.pitch_response_time),$('.tab-rates input[name="yaw_response"]').val(n.currentRates.yaw_response_time),$('.tab-rates input[name="coll_response"]').val(n.currentRates.collective_response_time),$('.tab-rates input[name="roll_accel"]').val(n.currentRates.roll_accel_limit*10),$('.tab-rates input[name="pitch_accel"]').val(n.currentRates.pitch_accel_limit*10),$('.tab-rates input[name="yaw_accel"]').val(n.currentRates.yaw_accel_limit*10),$('.tab-rates input[name="coll_accel"]').val(n.currentRates.collective_accel_limit*10),$("#setpoint-boost-gain-roll").val(n.currentRates.roll_setpoint_boost_gain),$("#setpoint-boost-gain-pitch").val(n.currentRates.pitch_setpoint_boost_gain),$("#setpoint-boost-gain-yaw").val(n.currentRates.yaw_setpoint_boost_gain),$("#setpoint-boost-gain-collective").val(n.currentRates.collective_setpoint_boost_gain),$("#setpoint-boost-cutoff-roll").val(n.currentRates.roll_setpoint_boost_cutoff),$("#setpoint-boost-cutoff-pitch").val(n.currentRates.pitch_setpoint_boost_cutoff),$("#setpoint-boost-cutoff-yaw").val(n.currentRates.yaw_setpoint_boost_cutoff),$("#setpoint-boost-cutoff-collective").val(n.currentRates.collective_setpoint_boost_cutoff),$("#yaw-dynamic-ceiling-gain").val(n.currentRates.yaw_dynamic_ceiling_gain),$("#yaw-dynamic-deadband-gain").val(n.currentRates.yaw_dynamic_deadband_gain),$("#yaw-dynamic-deadband-filter").val((n.currentRates.yaw_dynamic_deadband_filter/10).toFixed(1))};Mn.changeRatesLogo=function(){const n=this,e=n.RATES_TYPE_IMAGES[n.currentRatesType];$('.rates_type img[id="ratesLogo"]').attr("src","/images/rate_logos/"+e)};TABS[Mn.tabName]=Mn;var LN=ne("<!> <!> <!> <!> <!> <!> <!>",1);function $N(n,e){we(e,!0);let t=ft(e,"FC",15);Gt(n,{label:"receiverSettings",children:(r,i)=>{Be(r,{children:(o,s)=>{var l=LN(),a=me(l);ge(a,{id:"receiver-stick-center",label:"receiverStickCenter",tooltip:_=>{Te(_,{help:"receiverHelpStickCenter"})},children:(_,m)=>{Oe(_,{id:"receiver-stick-center",min:"1400",max:"1600",get value(){return t().RC_CONFIG.rc_center},set value(C){t(t().RC_CONFIG.rc_center=C,!0)}})},$$slots:{tooltip:!0,default:!0}});var c=K(a,2);ge(c,{id:"receiver-stick-deflection",label:"receiverStickDeflection",tooltip:_=>{Te(_,{help:"receiverHelpStickDeflection"})},children:(_,m)=>{Oe(_,{id:"receiver-stick-deflection",min:"200",max:"700",get value(){return t().RC_CONFIG.rc_deflection},set value(C){t(t().RC_CONFIG.rc_deflection=C,!0)}})},$$slots:{tooltip:!0,default:!0}});var u=K(c,2);ge(u,{id:"receiver-arm-throttle",label:"receiverArmingThrottle",tooltip:_=>{Te(_,{help:"receiverHelpArmingThrottle"})},children:(_,m)=>{Oe(_,{id:"receiver-arm-throttle",min:"850",max:"1500",get value(){return t().RC_CONFIG.rc_arm_throttle},set value(C){t(t().RC_CONFIG.rc_arm_throttle=C,!0)}})},$$slots:{tooltip:!0,default:!0}});var p=K(u,2);ge(p,{id:"receiver-zero-throttle",label:"receiverZeroThrottle",tooltip:_=>{Te(_,{help:"receiverHelpZeroThrottle"})},children:(_,m)=>{Oe(_,{id:"receiver-zero-throttle",min:"850",max:"1500",get value(){return t().RC_CONFIG.rc_min_throttle},set value(C){t(t().RC_CONFIG.rc_min_throttle=C,!0)}})},$$slots:{tooltip:!0,default:!0}});var h=K(p,2);ge(h,{id:"receiver-full-throttle",label:"receiverFullThrottle",tooltip:_=>{Te(_,{help:"receiverHelpFullThrottle"})},children:(_,m)=>{Oe(_,{id:"receiver-full-throttle",min:"1500",max:"2150",get value(){return t().RC_CONFIG.rc_max_throttle},set value(C){t(t().RC_CONFIG.rc_max_throttle=C,!0)}})},$$slots:{tooltip:!0,default:!0}});var g=K(h,2);ge(g,{id:"receiver-cyclic-deadband",label:"receiverCyclicDeadband",tooltip:_=>{Te(_,{help:"receiverHelpCyclicDeadband"})},children:(_,m)=>{var C=Ct(),R=me(C);{var S=I=>{Oe(I,{id:"receiver-cyclic-deadband",min:"0",max:"100",get value(){return t().RC_CONFIG.rc_deadband},set value(T){t(t().RC_CONFIG.rc_deadband=T,!0)}})},F=I=>{Oe(I,{id:"receiver-cyclic-deadband",min:"0",max:"32",get value(){return t().RC_CONFIG.rc_deadband},set value(T){t(t().RC_CONFIG.rc_deadband=T,!0)}})};Ce(R,I=>{_e.gte(t().CONFIG.apiVersion,lo)?I(S):I(F,!1)})}Z(_,C)},$$slots:{tooltip:!0,default:!0}});var f=K(g,2);ge(f,{id:"receiver-yaw-deadband",label:"receiverYawDeadband",tooltip:_=>{Te(_,{help:"receiverHelpYawDeadband"})},children:(_,m)=>{Oe(_,{id:"receiver-yaw-deadband",min:"0",max:"100",get value(){return t().RC_CONFIG.rc_yaw_deadband},set value(C){t(t().RC_CONFIG.rc_yaw_deadband=C,!0)}})},$$slots:{tooltip:!0,default:!0}}),Z(o,l)},$$slots:{default:!0}})},$$slots:{default:!0}}),Ge()}function DN(){return[{sensors:[{name:"FLIGHT_MODE"},{name:"BATTERY"},{name:"ATTITUDE"},{name:"ALTITUDE"},{name:"GPS"},..._e.gte(FC.CONFIG.apiVersion,lo)?[{name:"RPM"},{name:"TEMP"}]:[]]}]}const kN=[{title:"BATTERY",sensors:[{name:"BATTERY_VOLTAGE"},{name:"BATTERY_CURRENT"},{name:"BATTERY_CONSUMPTION"},{name:"BATTERY_CHARGE_LEVEL"},{name:"BATTERY_CELL_COUNT"},{name:"BATTERY_CELL_VOLTAGE"}]},{title:"VOLTAGE",sensors:[{name:"ESC_VOLTAGE"},{name:"BEC_VOLTAGE"},{name:"BUS_VOLTAGE"},{name:"MCU_VOLTAGE"}]},{title:"CURRENT",sensors:[{name:"ESC_CURRENT"},{name:"BEC_CURRENT"},{name:"BUS_CURRENT"},{name:"MCU_CURRENT"}]},{title:"TEMPERATURE",sensors:[{name:"ESC_TEMP"},{name:"BEC_TEMP"},{name:"MCU_TEMP"}]},{title:"ESC1",sensors:[{name:"ESC1_VOLTAGE"},{name:"ESC1_CURRENT"},{name:"ESC1_CAPACITY"},{name:"ESC1_ERPM"},{name:"ESC1_POWER"},{name:"ESC1_THROTTLE"},{name:"ESC1_TEMP1"},{name:"ESC1_TEMP2"},{name:"ESC1_BEC_VOLTAGE"},{name:"ESC1_BEC_CURRENT"},{name:"ESC1_STATUS"},{name:"ESC1_MODEL"}]},{title:"ESC2",sensors:[{name:"ESC2_VOLTAGE"},{name:"ESC2_CURRENT"},{name:"ESC2_CAPACITY"},{name:"ESC2_ERPM"},{name:"ESC2_TEMP1"},{name:"ESC2_MODEL"}]},{title:"RPM",sensors:[{name:"HEADSPEED"},{name:"TAILSPEED"}]},{title:"BARO",sensors:[{name:"ALTITUDE"},{name:"VARIOMETER"}]},{title:"GYRO",sensors:[{name:"HEADING"},{name:"ATTITUDE",conflicts:["ATTITUDE_PITCH","ATTITUDE_ROLL","ATTITUDE_YAW"]},{name:"ATTITUDE_PITCH",conflicts:["ATTITUDE"]},{name:"ATTITUDE_ROLL",conflicts:["ATTITUDE"]},{name:"ATTITUDE_YAW",conflicts:["ATTITUDE"]},{name:"ACCEL",conflicts:["ACCEL_X","ACCEL_Y","ACCEL_Z"]},{name:"ACCEL_X",conflicts:["ACCEL"]},{name:"ACCEL_Y",conflicts:["ACCEL"]},{name:"ACCEL_Z",conflicts:["ACCEL"]}]},{title:"GPS",sensors:[{name:"GPS_SATS"},{name:"GPS_PDOP"},{name:"GPS_COORD"},{name:"GPS_ALTITUDE"},{name:"GPS_HEADING"},{name:"GPS_GROUNDSPEED"},{name:"GPS_HOME_DISTANCE"},{name:"GPS_HOME_DIRECTION"}]},{title:"STATUS",sensors:[{name:"MODEL_ID"},{name:"FLIGHT_MODE"},{name:"ARMING_FLAGS"},{name:"ARMING_DISABLE_FLAGS"},{name:"RESCUE_STATE"},{name:"GOVERNOR_STATE"},{name:"ADJFUNC"}]},{title:"PROFILE",sensors:[{name:"PID_PROFILE"},{name:"RATES_PROFILE"},{name:"LED_PROFILE"}]},{title:"CONTROL",sensors:[{name:"CONTROL",conflicts:["PITCH_CONTROL","ROLL_CONTROL","YAW_CONTROL","COLLECTIVE_CONTROL"]},{name:"PITCH_CONTROL",conflicts:["CONTROL"]},{name:"ROLL_CONTROL",conflicts:["CONTROL"]},{name:"YAW_CONTROL",conflicts:["CONTROL"]},{name:"COLLECTIVE_CONTROL",conflicts:["CONTROL"]},{name:"THROTTLE_CONTROL"}]},{title:"SYSTEM",sensors:[{name:"HEARTBEAT"},{name:"CPU_LOAD"},{name:"SYS_LOAD"},{name:"RT_LOAD"}]},{title:"DEBUG",sensors:[{name:"DEBUG_0"},{name:"DEBUG_1"},{name:"DEBUG_2"},{name:"DEBUG_3"},{name:"DEBUG_4"},{name:"DEBUG_5"},{name:"DEBUG_6"},{name:"DEBUG_7"}]}],UN=[{title:"BATTERY",sensors:[{name:"BATTERY_VOLTAGE"},{name:"BATTERY_CURRENT"},{name:"BATTERY_CONSUMPTION"},{name:"BATTERY_CHARGE_LEVEL"},{name:"BATTERY_CELL_COUNT"},{name:"BATTERY_CELL_VOLTAGE"},{name:"BATTERY_CELL_VOLTAGES"}]},{title:"VOLTAGE",sensors:[{name:"ESC_VOLTAGE"},{name:"BEC_VOLTAGE"},{name:"BUS_VOLTAGE"},{name:"MCU_VOLTAGE"}]},{title:"CURRENT",sensors:[{name:"ESC_CURRENT"},{name:"BEC_CURRENT"}]},{title:"TEMPERATURE",sensors:[{name:"ESC_TEMP"},{name:"BEC_TEMP"},{name:"MCU_TEMP"}]},{title:"ESC1",sensors:[{name:"ESC1_VOLTAGE"},{name:"ESC1_CURRENT"},{name:"ESC1_CAPACITY"},{name:"ESC1_ERPM"},{name:"ESC1_POWER"},{name:"ESC1_THROTTLE"},{name:"ESC1_TEMP1"},{name:"ESC1_TEMP2"},{name:"ESC1_BEC_VOLTAGE"},{name:"ESC1_BEC_CURRENT"},{name:"ESC1_STATUS"},{name:"ESC1_MODEL"}]},{title:"ESC2",sensors:[{name:"ESC2_VOLTAGE"},{name:"ESC2_CURRENT"},{name:"ESC2_CAPACITY"},{name:"ESC2_ERPM"},{name:"ESC2_TEMP1"},{name:"ESC2_MODEL"}]},{title:"RPM",sensors:[{name:"HEADSPEED"},{name:"TAILSPEED"}]},{title:"BARO",sensors:[{name:"ALTITUDE"},{name:"VARIOMETER"}]},{title:"GYRO",sensors:[{name:"HEADING"},{name:"ATTITUDE"},{name:"ACCEL_X"},{name:"ACCEL_Y"},{name:"ACCEL_Z"}]},{title:"GPS",sensors:[{name:"GPS_SATS"},{name:"GPS_COORD"},{name:"GPS_ALTITUDE"},{name:"GPS_HEADING"},{name:"GPS_GROUNDSPEED"}]},{title:"STATUS",sensors:[{name:"MODEL_ID"},{name:"FLIGHT_MODE"},{name:"ARMING_FLAGS"},{name:"ARMING_DISABLE_FLAGS"},{name:"RESCUE_STATE"},{name:"GOVERNOR_STATE"},{name:"ADJFUNC"}]},{title:"PROFILE",sensors:[{name:"PID_PROFILE"},{name:"RATES_PROFILE"}]},{title:"CONTROL",sensors:[{name:"PITCH_CONTROL"},{name:"ROLL_CONTROL"},{name:"YAW_CONTROL"},{name:"COLLECTIVE_CONTROL"},{name:"THROTTLE_CONTROL"}]},{title:"SYSTEM",sensors:[{name:"HEARTBEAT"},{name:"CPU_LOAD"},{name:"SYS_LOAD"},{name:"RT_LOAD"}]},{title:"DEBUG",sensors:[{name:"DEBUG_0"},{name:"DEBUG_1"},{name:"DEBUG_2"},{name:"DEBUG_3"},{name:"DEBUG_4"},{name:"DEBUG_5"},{name:"DEBUG_6"},{name:"DEBUG_7"}]}],BN=[{sensors:[{name:"BATTERY_VOLTAGE"},{name:"BATTERY_CHARGE_LEVEL"},{name:"ATTITUDE_YAW"},{name:"ALTITUDE"},{name:"VARIOMETER"},{name:"GPS_COORD"},{name:"GPS_GROUNDSPEED"}]}],VN=[{sensors:[{name:"BATTERY_VOLTAGE"},{name:"BATTERY_CURRENT"},{name:"BATTERY_CHARGE_LEVEL"},{name:"ALTITUDE"},{name:"VARIOMETER"},{name:"GPS_GROUNDSPEED"},{name:"GPS_COORD"},{name:"ATTITUDE_YAW"},{name:"ACCEL_X"},{name:"ACCEL_Y"},{name:"ACCEL_Z"}]}],rt=pm("TOGGLE","BITFIELD","ORDERED_LIST","UNORDERED_LIST");function zh(){return V.TELEMETRY_CONFIG.crsf_telemetry_mode?{proto:"crsf",type:rt.ORDERED_LIST,sensors:kN}:_e.gte(V.CONFIG.apiVersion,Dn)?{proto:"crsf",type:rt.UNORDERED_LIST,sensors:DN()}:{proto:"crsf",type:rt.BITFIELD,mask:1062799}}function cr(){return _e.gte(V.CONFIG.apiVersion,Dn)?{proto:"smartport",type:rt.ORDERED_LIST,sensors:UN}:_e.gte(V.CONFIG.apiVersion,cn)?{proto:"smartport",type:rt.BITFIELD,mask:4294967295}:{proto:"smartport",type:rt.BITFIELD,mask:8388607}}const Ui=[{name:"None",id:0},{name:"PWM",id:0,feature:"RX_PARALLEL_PWM",hide:!0},{name:"CUSTOM",id:11,feature:"RX_SERIAL",telemetry:{type:rt.TOGGLE},hide:!0},{name:"TBS CRSF",id:9,feature:"RX_SERIAL",get telemetry(){return zh()}},{name:"Futaba S.BUS",id:2,feature:"RX_SERIAL"},{name:"Futaba S.BUS2",id:15,feature:"RX_SERIAL",telemetry:{type:rt.TOGGLE},get hide(){return _e.lt(V.CONFIG.apiVersion,cn)}},{name:"FrSky F.PORT",id:12,feature:"RX_SERIAL",get telemetry(){return cr()}},{name:"FrSky F.PORT2",id:16,feature:"RX_SERIAL",get telemetry(){return cr()},get hide(){return _e.lt(V.CONFIG.apiVersion,cn)}},{name:"FrSky FBUS",id:17,feature:"RX_SERIAL",get telemetry(){return cr()},get hide(){return _e.lt(V.CONFIG.apiVersion,cn)}},{name:"Spektrum DSM/1024",id:0,feature:"RX_SERIAL"},{name:"Spektrum DSM/2048",id:1,feature:"RX_SERIAL"},{name:"Spektrum DSM/SRXL",id:10,feature:"RX_SERIAL",telemetry:{type:rt.TOGGLE}},{name:"Spektrum DSM/SRXL2",id:13,feature:"RX_SERIAL",telemetry:{type:rt.TOGGLE}},{name:"ImmersionRC GHOST",id:14,feature:"RX_SERIAL",get telemetry(){return _e.gte(V.CONFIG.apiVersion,Dn)?{proto:"ghst",type:rt.UNORDERED_LIST,sensors:BN}:{proto:"ghst",type:rt.BITFIELD,mask:13831}}},{name:"Graupner SUMD",id:3,feature:"RX_SERIAL"},{name:"Graupner SUMH",id:4,feature:"RX_SERIAL"},{name:"Flysky IBUS",id:7,feature:"RX_SERIAL",telemetry:{type:rt.TOGGLE}},{name:"JR XBUS Mode A",id:18,feature:"RX_SERIAL",get hide(){return _e.lt(V.CONFIG.apiVersion,Dn)}},{name:"JR XBUS Mode B",id:5,feature:"RX_SERIAL"},{name:"JR XBUS/RJ01",id:6,feature:"RX_SERIAL"},{name:"Jeti EXBUS",id:8,feature:"RX_SERIAL",telemetry:{type:rt.TOGGLE}},{name:"CPPM",id:0,feature:"RX_PPM"},{name:"MSP",id:0,feature:"RX_MSP"},{name:"SPI/CX10",id:4,feature:"RX_SPI",hide:!0},{name:"SPI/CX10A",id:5,feature:"RX_SPI",hide:!0},{name:"SPI/ELRS",id:19,feature:"RX_SPI",get telemetry(){return zh()},hide:!0},{name:"SPI/FRSKY D",id:8,feature:"RX_SPI",get telemetry(){return cr()},hide:!0},{name:"SPI/FRSKY X",id:9,feature:"RX_SPI",get telemetry(){return cr()},hide:!0},{name:"SPI/FRSKY X LBT",id:15,feature:"RX_SPI",get telemetry(){return cr()},hide:!0},{name:"SPI/FRSKY X V2",id:17,feature:"RX_SPI",get telemetry(){return cr()},hide:!0},{name:"SPI/FRSKY X LBT V2",id:18,feature:"RX_SPI",get telemetry(){return cr()},hide:!0},{name:"SPI/FLYSKY",id:10,feature:"RX_SPI",hide:!0},{name:"SPI/FLYSKY 2A",id:11,feature:"RX_SPI",hide:!0},{name:"SPI/H8_3D",id:6,feature:"RX_SPI",hide:!0},{name:"SPI/INAV",id:7,feature:"RX_SPI",hide:!0},{name:"SPI/KN",id:12,feature:"RX_SPI",hide:!0},{name:"SPI/REDPINE",id:16,feature:"RX_SPI",hide:!0},{name:"SPI/SFHSS",id:13,feature:"RX_SPI",hide:!0},{name:"SPI/SYMA X",id:2,feature:"RX_SPI",hide:!0},{name:"SPI/SYMA X5C",id:3,feature:"RX_SPI",hide:!0},{name:"SPI/SPEKTRUM",id:14,feature:"RX_SPI",hide:!0},{name:"SPI/V202 250k",id:0,feature:"RX_SPI",hide:!0},{name:"SPI/V202 1M",id:1,feature:"RX_SPI",hide:!0}],HN=[{name:"FrSky Hub",id:4,get telemetry(){return _e.gte(V.CONFIG.apiVersion,Dn)?{type:rt.UNORDERED_LIST,sensors:VN}:{type:rt.BITFIELD,mask:15991}}},{name:"FrSky S.Port",id:32,get telemetry(){return{...cr(),external:!0}}},{name:"FlySky iBUS",id:4096,telemetry:{type:rt.TOGGLE,external:!0}},{name:"Graupner HoTT",id:8,telemetry:{type:rt.TOGGLE,external:!0}},{name:"MAVLink",id:512,telemetry:{type:rt.TOGGLE,external:!0}},{name:"LTM",id:16,telemetry:{type:rt.TOGGLE,external:!0}}];var XN=ne('<option class="svelte-j1xs4u"> </option>'),YN=ne('<select id="receiver-protocol" class="svelte-j1xs4u"></select>'),zN=ne("<!> <!> <!>",1),WN=ne('<div class="svelte-j1xs4u"><!></div>'),jN=ne("<!> <!>",1);function qN(n,e){we(e,!0);let t=ft(e,"FC",15);Gt(n,{label:"receiverSelection",children:(r,i)=>{var o=jN(),s=me(o);Be(s,{children:(c,u)=>{ge(c,{id:"receiver-protocol",label:"receiverProtocol",children:(p,h)=>{var g=YN();xt(g,23,()=>Ui,f=>f.name,(f,d,_)=>{var m=Ct(),C=me(m);{var R=S=>{var F=XN(),I=W(F),T={};Ae(()=>{F.disabled=b(d).feature==="RX_SERIAL"&&!e.hasSerialRxPort,Ee(I,b(d).name),T!==(T=b(_))&&(F.value=(F.__value=b(_))??"")}),Z(S,F)};Ce(C,S=>{(!b(d).hide||e.rxProtoIndex===b(_))&&S(R)})}Z(f,m)}),vr(g,()=>e.rxProtoIndex,e.setRxProto),Z(p,g)},$$slots:{default:!0}})},$$slots:{default:!0}});var l=K(s,2);{var a=c=>{var u=WN(),p=W(u);Be(p,{label:"receiverSelectionSectionSignaling",children:(h,g)=>{var f=zN(),d=me(f);ge(d,{id:"receiver-serialrx-inverted",label:"receiverSerialInverted",tooltip:S=>{Te(S,{help:"receiverSerialInvertedHelp"})},children:(S,F)=>{ut(S,{id:"receiver-serialrx-inverted",get checked(){return t().RX_CONFIG.serialrx_inverted},set checked(I){t(t().RX_CONFIG.serialrx_inverted=I,!0)}})},$$slots:{tooltip:!0,default:!0}});var _=K(d,2);ge(_,{id:"receiver-serialrx-halfduplex",label:"receiverSerialHalfDuplex",tooltip:S=>{Te(S,{help:"receiverSerialHalfDuplexHelp"})},children:(S,F)=>{ut(S,{id:"receiver-serialrx-halfduplex",get checked(){return t().RX_CONFIG.serialrx_halfduplex},set checked(I){t(t().RX_CONFIG.serialrx_halfduplex=I,!0)}})},$$slots:{tooltip:!0,default:!0}});var m=K(_,2);{var C=R=>{ge(R,{id:"receiver-serialrx-pinswap",label:"receiverSerialPinSwap",tooltip:F=>{Te(F,{help:"receiverSerialPinSwapHelp"})},children:(F,I)=>{ut(F,{id:"receiver-serialrx-pinswap",get checked(){return t().RX_CONFIG.serialrx_pinswap},set checked(T){t(t().RX_CONFIG.serialrx_pinswap=T,!0)}})},$$slots:{tooltip:!0,default:!0}})};Ce(m,R=>{_e.gte(t().CONFIG.apiVersion,cn)&&R(C)})}Z(h,f)},$$slots:{default:!0}}),ke(3,u,()=>Ue),Z(c,u)};Ce(l,c=>{Ui[e.rxProtoIndex]?.feature==="RX_SERIAL"&&c(a)})}Z(r,o)},$$slots:{default:!0}}),Ge()}var KN=ne("<!> <!> <!>",1),QN=ne("<!> <!> <!>",1),ZN=ne('<div class="svelte-gu3lip"><!></div>'),JN=ne("<!> <!> <!>",1);function ex(n,e){we(e,!0);let t=ft(e,"FC",15),r=ue(()=>t().FEATURE_CONFIG.features.TELEMETRY),i=ue(()=>e.telemetry.proto==="crsf"&&_e.gte(t().CONFIG.apiVersion,cn));Gt(n,{label:"receiverTelemetrySettings",children:(o,s)=>{var l=JN(),a=me(l);Be(a,{children:(g,f)=>{ge(g,{id:"telemetry-enable",label:"genericEnable",children:(d,_)=>{ut(d,{id:"telemetry-enable",get checked(){return t().FEATURE_CONFIG.features.TELEMETRY},set checked(m){t(t().FEATURE_CONFIG.features.TELEMETRY=m,!0)}})},$$slots:{default:!0}})},$$slots:{default:!0}});var c=K(a,2);{var u=g=>{Be(g,{label:"receiverTelemetrySettingsSectionSignaling",children:(f,d)=>{var _=KN(),m=me(_);ge(m,{id:"telemetry-inverted",label:"receiverTelemetryInverted",children:(F,I)=>{ut(F,{id:"telemetry-inverted",get checked(){return t().TELEMETRY_CONFIG.telemetry_inverted},set checked(T){t(t().TELEMETRY_CONFIG.telemetry_inverted=T,!0)}})},$$slots:{default:!0}});var C=K(m,2);ge(C,{id:"telemetry-halfduplex",label:"receiverTelemetryHalfDuplex",children:(F,I)=>{ut(F,{id:"telemetry-halfduplex",get checked(){return t().TELEMETRY_CONFIG.telemetry_halfduplex},set checked(T){t(t().TELEMETRY_CONFIG.telemetry_halfduplex=T,!0)}})},$$slots:{default:!0}});var R=K(C,2);{var S=F=>{ge(F,{id:"telemetry-pinswap",label:"receiverTelemetryPinSwap",children:(I,T)=>{ut(I,{id:"telemetry-pinswap",get checked(){return t().TELEMETRY_CONFIG.telemetry_pinswap},set checked(P){t(t().TELEMETRY_CONFIG.telemetry_pinswap=P,!0)}})},$$slots:{default:!0}})};Ce(R,F=>{_e.gte(t().CONFIG.apiVersion,cn)&&F(S)})}Z(f,_)},$$slots:{default:!0}})};Ce(c,g=>{b(r)&&e.telemetry.external&&g(u)})}var p=K(c,2);{var h=g=>{var f=ZN(),d=W(f);Be(d,{label:"receiverTelemetrySettingsSectionCRSF",children:(_,m)=>{var C=QN(),R=me(C);ge(R,{id:"telmetry-crsf-custom",label:"receiverCrsfTelemetryMode",tooltip:T=>{Te(T,{help:"receiverHelpCrsfTelemetryMode"})},children:(T,P)=>{var y=()=>t().TELEMETRY_CONFIG.crsf_telemetry_mode,L=G=>{const U=e.telemetry;t(t().TELEMETRY_CONFIG.crsf_telemetry_mode=G,!0),e.resetTelemetry(U)};ut(T,{id:"telmetry-crsf-custom",get checked(){return y()},set checked(G){L(G)}})},$$slots:{tooltip:!0,default:!0}});var S=K(R,2);ge(S,{id:"telemetry-crsf-packet-rate",label:"receiverCrsfTelemetryRate",tooltip:T=>{Te(T,{help:"receiverHelpCrsfTelemetryRate"})},children:(T,P)=>{Oe(T,{id:"telemetry-crsf-packet-rate",min:"0",max:"1000",step:"1",get value(){return t().TELEMETRY_CONFIG.crsf_telemetry_rate},set value(y){t(t().TELEMETRY_CONFIG.crsf_telemetry_rate=y,!0)}})},$$slots:{tooltip:!0,default:!0}});var F=K(S,2);ge(F,{id:"telmetry-crsf-packet-ratio",label:"receiverCrsfTelemetryRatio",tooltip:T=>{Te(T,{help:"receiverHelpCrsfTelemetryRatio"})},children:(T,P)=>{Oe(T,{id:"telmetry-crsf-packet-ratio",min:"0",max:"1000",step:"1",get value(){return t().TELEMETRY_CONFIG.crsf_telemetry_ratio},set value(y){t(t().TELEMETRY_CONFIG.crsf_telemetry_ratio=y,!0)}})},$$slots:{tooltip:!0,default:!0}}),Z(_,C)},$$slots:{default:!0}}),ke(3,f,()=>Ue),Z(g,f)};Ce(p,g=>{b(r)&&!e.telemetry.external&&b(i)&&g(h)})}Z(o,l)},$$slots:{default:!0}}),Ge()}const li={NONE:0,HEARTBEAT:1,BATTERY:2,BATTERY_VOLTAGE:3,BATTERY_CURRENT:4,BATTERY_CONSUMPTION:5,BATTERY_CHARGE_LEVEL:6,BATTERY_CELL_COUNT:7,BATTERY_CELL_VOLTAGE:8,BATTERY_CELL_VOLTAGES:9,CONTROL:10,PITCH_CONTROL:11,ROLL_CONTROL:12,YAW_CONTROL:13,COLLECTIVE_CONTROL:14,THROTTLE_CONTROL:15,ESC1_DATA:16,ESC1_VOLTAGE:17,ESC1_CURRENT:18,ESC1_CAPACITY:19,ESC1_ERPM:20,ESC1_POWER:21,ESC1_THROTTLE:22,ESC1_TEMP1:23,ESC1_TEMP2:24,ESC1_BEC_VOLTAGE:25,ESC1_BEC_CURRENT:26,ESC1_STATUS:27,ESC1_MODEL:28,ESC2_DATA:29,ESC2_VOLTAGE:30,ESC2_CURRENT:31,ESC2_CAPACITY:32,ESC2_ERPM:33,ESC2_POWER:34,ESC2_THROTTLE:35,ESC2_TEMP1:36,ESC2_TEMP2:37,ESC2_BEC_VOLTAGE:38,ESC2_BEC_CURRENT:39,ESC2_STATUS:40,ESC2_MODEL:41,ESC_VOLTAGE:42,BEC_VOLTAGE:43,BUS_VOLTAGE:44,MCU_VOLTAGE:45,ESC_CURRENT:46,BEC_CURRENT:47,BUS_CURRENT:48,MCU_CURRENT:49,ESC_TEMP:50,BEC_TEMP:51,MCU_TEMP:52,AIR_TEMP:53,MOTOR_TEMP:54,BATTERY_TEMP:55,EXHAUST_TEMP:56,HEADING:57,ALTITUDE:58,VARIOMETER:59,HEADSPEED:60,TAILSPEED:61,MOTOR_RPM:62,TRANS_RPM:63,ATTITUDE:64,ATTITUDE_PITCH:65,ATTITUDE_ROLL:66,ATTITUDE_YAW:67,ACCEL:68,ACCEL_X:69,ACCEL_Y:70,ACCEL_Z:71,GPS:72,GPS_SATS:73,GPS_PDOP:74,GPS_HDOP:75,GPS_VDOP:76,GPS_COORD:77,GPS_ALTITUDE:78,GPS_HEADING:79,GPS_GROUNDSPEED:80,GPS_HOME_DISTANCE:81,GPS_HOME_DIRECTION:82,GPS_DATE_TIME:83,LOAD:84,CPU_LOAD:85,SYS_LOAD:86,RT_LOAD:87,MODEL_ID:88,FLIGHT_MODE:89,ARMING_FLAGS:90,ARMING_DISABLE_FLAGS:91,RESCUE_STATE:92,GOVERNOR_STATE:93,GOVERNOR_FLAGS:94,PID_PROFILE:95,RATES_PROFILE:96,BATTERY_PROFILE:97,LED_PROFILE:98,ADJFUNC:99,DEBUG_0:100,DEBUG_1:101,DEBUG_2:102,DEBUG_3:103,DEBUG_4:104,DEBUG_5:105,DEBUG_6:106,DEBUG_7:107,RPM:108,TEMP:109};for(const[n,e]of Object.entries(li))li[e]=n;var tx=ne("<!> <!>",1);function nx(n,e){we(e,!0);let t=ft(e,"value",31,()=>Rn([])),r=ue(()=>t().filter(s=>s>0));var i=Ct(),o=me(i);xt(o,17,()=>e.sensors,is,(s,l)=>{var a=tx(),c=me(a);{var u=h=>{};Ce(c,h=>{b(l).title&&h(u)})}var p=K(c,2);xt(p,17,()=>b(l).sensors,h=>h.name,(h,g)=>{const f=ue(()=>`telemetry-sensor-${b(g).name}`),d=ue(()=>`receiverTelemetrySensor_${b(g).name}`);ge(h,{get id(){return b(f)},get label(){return b(d)},children:(_,m)=>{const C=ue(()=>`telemetry-sensor-${b(g).name}`);var R=()=>t().includes(li[b(g).name]),S=F=>{const I=li[b(g).name];if(F)t([...b(r),I]);else{const T=b(r).indexOf(I);t([...b(r).slice(0,T),...b(r).slice(T+1)])}};ut(_,{get id(){return b(C)},get checked(){return R()},set checked(F){S(F)}})},$$slots:{default:!0}})}),Z(s,a)}),Z(n,i),Ge()}function rx(n,e){we(e,!0);let t=ft(e,"value",15);const r=[{name:"MODE",id:3},{name:"VOLTAGE",id:0},{name:"CURRENT",id:1},{name:"FUEL_LEVEL",id:2},{name:"USED_CAPACITY",id:20},{name:"BEC_VOLTAGE",id:26},{name:"HEADSPEED",id:27},{name:"TAILSPEED",id:28},{name:"TEMPERATURE",id:19},{name:"PITCH",id:7},{name:"ROLL",id:8},{name:"HEADING",id:9},{name:"ACC_X",id:4},{name:"ACC_Y",id:5},{name:"ACC_Z",id:6},{name:"ALTITUDE",id:10},{name:"VARIO",id:11},{name:"LAT_LONG",id:12},{name:"GROUND_SPEED",id:13},{name:"DISTANCE",id:14},{name:"ESC_CURRENT",id:15},{name:"ESC_VOLTAGE",id:16},{name:"ESC_RPM",id:17},{name:"ESC_TEMPERATURE",id:18},{name:"ADJUSTMENT",id:21},{name:"GOV_MODE",id:22},{name:"ARMING_FLAGS",id:30},{name:"PID_PROFILE",id:24},{name:"RATES_PROFILE",id:25},{name:"THROTTLE_CONTROL",id:29},{name:"MODEL_ID",id:23}];var i=Ct(),o=me(i);xt(o,17,()=>r,s=>s.id,(s,l)=>{var a=Ct(),c=me(a);{var u=p=>{const h=ue(()=>`telemetry-sensor-${b(l).name}`),g=ue(()=>`receiverTelemetrySensor_${b(l).name}`);ge(p,{get id(){return b(h)},get label(){return b(g)},children:(f,d)=>{const _=ue(()=>`telemetry-sensor-${b(l).name}`);var m=()=>bit_check(t(),b(l).id),C=R=>{t((R?bit_set:bit_clear)(t(),b(l).id))};ut(f,{get id(){return b(_)},get checked(){return m()},set checked(R){C(R)}})},$$slots:{default:!0}})};Ce(c,p=>{bit_check(e.mask,b(l).id)&&p(u)})}Z(s,a)}),Z(n,i),Ge()}var ix=(n,e)=>ce(e,!b(e)),ox=ne('<div class="content svelte-bbm9yo"><!></div>'),sx=ne('<div><div class="summary svelte-bbm9yo"><!></div> <!></div>');function ax(n,e){let t=pe(!1);var r=sx();let i;var o=W(r);o.__click=[ix,t];var s=W(o);Ot(s,()=>e.summary);var l=K(o,2);{var a=c=>{var u=ox(),p=W(u);Ot(p,()=>e.children??et),ke(3,u,()=>Ue),Z(c,u)};Ce(l,c=>{b(t)&&c(a)})}Ae(c=>i=ii(r,1,"container svelte-bbm9yo",null,i,c),[()=>({open:b(t)})]),Z(n,r)}pn(["click"]);var lx=ne('<span class="title svelte-1wm75eh"> </span> <span class="count svelte-1wm75eh"> </span>',1),cx=ne('<div class="switch-group svelte-1wm75eh"></div>'),ux=ne('<div class="content svelte-1wm75eh"></div>');function dx(n,e){we(e,!0);const[t,r]=Et(),i=()=>vt(St,"$i18n",t);let o=ft(e,"value",31,()=>Rn([])),s=ue(()=>{const p=new Set;for(const h of o())h.value!==0&&p.add(h.value);return p}),l=ue(()=>{let p=0;const h=[];for(const g of e.sensors){const f={title:g.title,sensors:[],count:0};for(const d of g.sensors){const _=d.name.match(/^ESC(\d)/),m=li[d.name],C=b(s).has(m);f.sensors.push({id:m,name:_?d.name.replace(/^ESC\d/,"ESC"):d.name,esc:_&&_[1],conflicts:d.conflicts,enabled:C}),p++,C&&f.count++}h.push(f)}return{groups:h,count:p}});function a(p){if(!p.conflicts)return!1;for(const h of p.conflicts)return b(s).has(li[h])}function c(p,h){const g=Qn(o());if(h)g.push({value:p});else{const f=g.findIndex(d=>d.value===p);g.splice(f,1)}o(g)}var u=ux();xt(u,21,()=>b(l).groups,p=>p.title,(p,h)=>{ax(p,{summary:f=>{var d=lx(),_=me(d),m=W(_),C=K(_,2),R=W(C);Ae(S=>{Ee(m,S),Ee(R,`${b(h).count??""} / ${b(h).sensors.length??""}`)},[()=>i().t(`receiverTelemetryGroup_${b(h).title}`)]),Z(f,d)},children:(f,d)=>{var _=cx();xt(_,21,()=>b(h).sensors,m=>m.id,(m,C)=>{const R=ue(()=>`telemetry-sensor-${b(C).id}`),S=ue(()=>`receiverTelemetrySensor_${b(C).name}`);ge(m,{get id(){return b(R)},get label(){return b(S)},children:(F,I)=>{const T=ue(()=>`telemetry-sensor-${b(C).id}`),P=ue(()=>a(b(C)));var y=()=>b(C).enabled,L=G=>c(b(C).id,G);ut(F,{get id(){return b(T)},get disabled(){return b(P)},get checked(){return y()},set checked(G){L(G)}})},$$slots:{default:!0}})}),Z(f,_)}})}),Z(n,u),Ge(),r()}/**!
 * Sortable 1.15.6
 * @author	RubaXa   <trash@rubaxa.org>
 * @author	owenm    <owen23355@gmail.com>
 * @license MIT
 */function Wh(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable})),t.push.apply(t,r)}return t}function rr(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Wh(Object(t),!0).forEach(function(r){fx(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Wh(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function ra(n){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?ra=function(e){return typeof e}:ra=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ra(n)}function fx(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Er(){return Er=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},Er.apply(this,arguments)}function _x(n,e){if(n==null)return{};var t={},r=Object.keys(n),i,o;for(o=0;o<r.length;o++)i=r[o],!(e.indexOf(i)>=0)&&(t[i]=n[i]);return t}function px(n,e){if(n==null)return{};var t=_x(n,e),r,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(n);for(i=0;i<o.length;i++)r=o[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(n,r)&&(t[r]=n[r])}return t}var hx="1.15.6";function gr(n){if(typeof window<"u"&&window.navigator)return!!navigator.userAgent.match(n)}var Ir=gr(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),ps=gr(/Edge/i),jh=gr(/firefox/i),Do=gr(/safari/i)&&!gr(/chrome/i)&&!gr(/android/i),sf=gr(/iP(ad|od|hone)/i),nC=gr(/chrome/i)&&gr(/android/i),rC={capture:!1,passive:!1};function Ye(n,e,t){n.addEventListener(e,t,!Ir&&rC)}function Xe(n,e,t){n.removeEventListener(e,t,!Ir&&rC)}function Ga(n,e){if(e){if(e[0]===">"&&(e=e.substring(1)),n)try{if(n.matches)return n.matches(e);if(n.msMatchesSelector)return n.msMatchesSelector(e);if(n.webkitMatchesSelector)return n.webkitMatchesSelector(e)}catch{return!1}return!1}}function iC(n){return n.host&&n!==document&&n.host.nodeType?n.host:n.parentNode}function $n(n,e,t,r){if(n){t=t||document;do{if(e!=null&&(e[0]===">"?n.parentNode===t&&Ga(n,e):Ga(n,e))||r&&n===t)return n;if(n===t)break}while(n=iC(n))}return null}var qh=/\s+/g;function sn(n,e,t){if(n&&e)if(n.classList)n.classList[t?"add":"remove"](e);else{var r=(" "+n.className+" ").replace(qh," ").replace(" "+e+" "," ");n.className=(r+(t?" "+e:"")).replace(qh," ")}}function xe(n,e,t){var r=n&&n.style;if(r){if(t===void 0)return document.defaultView&&document.defaultView.getComputedStyle?t=document.defaultView.getComputedStyle(n,""):n.currentStyle&&(t=n.currentStyle),e===void 0?t:t[e];!(e in r)&&e.indexOf("webkit")===-1&&(e="-webkit-"+e),r[e]=t+(typeof t=="string"?"":"px")}}function ji(n,e){var t="";if(typeof n=="string")t=n;else do{var r=xe(n,"transform");r&&r!=="none"&&(t=r+" "+t)}while(!e&&(n=n.parentNode));var i=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return i&&new i(t)}function oC(n,e,t){if(n){var r=n.getElementsByTagName(e),i=0,o=r.length;if(t)for(;i<o;i++)t(r[i],i);return r}return[]}function Jn(){var n=document.scrollingElement;return n||document.documentElement}function bt(n,e,t,r,i){if(!(!n.getBoundingClientRect&&n!==window)){var o,s,l,a,c,u,p;if(n!==window&&n.parentNode&&n!==Jn()?(o=n.getBoundingClientRect(),s=o.top,l=o.left,a=o.bottom,c=o.right,u=o.height,p=o.width):(s=0,l=0,a=window.innerHeight,c=window.innerWidth,u=window.innerHeight,p=window.innerWidth),(e||t)&&n!==window&&(i=i||n.parentNode,!Ir))do if(i&&i.getBoundingClientRect&&(xe(i,"transform")!=="none"||t&&xe(i,"position")!=="static")){var h=i.getBoundingClientRect();s-=h.top+parseInt(xe(i,"border-top-width")),l-=h.left+parseInt(xe(i,"border-left-width")),a=s+o.height,c=l+o.width;break}while(i=i.parentNode);if(r&&n!==window){var g=ji(i||n),f=g&&g.a,d=g&&g.d;g&&(s/=d,l/=f,p/=f,u/=d,a=s+u,c=l+p)}return{top:s,left:l,bottom:a,right:c,width:p,height:u}}}function Kh(n,e,t){for(var r=kr(n,!0),i=bt(n)[e];r;){var o=bt(r)[t],s=void 0;if(s=i>=o,!s)return r;if(r===Jn())break;r=kr(r,!1)}return!1}function Ji(n,e,t,r){for(var i=0,o=0,s=n.children;o<s.length;){if(s[o].style.display!=="none"&&s[o]!==ye.ghost&&(r||s[o]!==ye.dragged)&&$n(s[o],t.draggable,n,!1)){if(i===e)return s[o];i++}o++}return null}function af(n,e){for(var t=n.lastElementChild;t&&(t===ye.ghost||xe(t,"display")==="none"||e&&!Ga(t,e));)t=t.previousElementSibling;return t||null}function En(n,e){var t=0;if(!n||!n.parentNode)return-1;for(;n=n.previousElementSibling;)n.nodeName.toUpperCase()!=="TEMPLATE"&&n!==ye.clone&&(!e||Ga(n,e))&&t++;return t}function Qh(n){var e=0,t=0,r=Jn();if(n)do{var i=ji(n),o=i.a,s=i.d;e+=n.scrollLeft*o,t+=n.scrollTop*s}while(n!==r&&(n=n.parentNode));return[e,t]}function gx(n,e){for(var t in n)if(n.hasOwnProperty(t)){for(var r in e)if(e.hasOwnProperty(r)&&e[r]===n[t][r])return Number(t)}return-1}function kr(n,e){if(!n||!n.getBoundingClientRect)return Jn();var t=n,r=!1;do if(t.clientWidth<t.scrollWidth||t.clientHeight<t.scrollHeight){var i=xe(t);if(t.clientWidth<t.scrollWidth&&(i.overflowX=="auto"||i.overflowX=="scroll")||t.clientHeight<t.scrollHeight&&(i.overflowY=="auto"||i.overflowY=="scroll")){if(!t.getBoundingClientRect||t===document.body)return Jn();if(r||e)return t;r=!0}}while(t=t.parentNode);return Jn()}function mx(n,e){if(n&&e)for(var t in e)e.hasOwnProperty(t)&&(n[t]=e[t]);return n}function Lu(n,e){return Math.round(n.top)===Math.round(e.top)&&Math.round(n.left)===Math.round(e.left)&&Math.round(n.height)===Math.round(e.height)&&Math.round(n.width)===Math.round(e.width)}var ko;function sC(n,e){return function(){if(!ko){var t=arguments,r=this;t.length===1?n.call(r,t[0]):n.apply(r,t),ko=setTimeout(function(){ko=void 0},e)}}}function Cx(){clearTimeout(ko),ko=void 0}function aC(n,e,t){n.scrollLeft+=e,n.scrollTop+=t}function lC(n){var e=window.Polymer,t=window.jQuery||window.Zepto;return e&&e.dom?e.dom(n).cloneNode(!0):t?t(n).clone(!0)[0]:n.cloneNode(!0)}function cC(n,e,t){var r={};return Array.from(n.children).forEach(function(i){var o,s,l,a;if(!(!$n(i,e.draggable,n,!1)||i.animated||i===t)){var c=bt(i);r.left=Math.min((o=r.left)!==null&&o!==void 0?o:1/0,c.left),r.top=Math.min((s=r.top)!==null&&s!==void 0?s:1/0,c.top),r.right=Math.max((l=r.right)!==null&&l!==void 0?l:-1/0,c.right),r.bottom=Math.max((a=r.bottom)!==null&&a!==void 0?a:-1/0,c.bottom)}}),r.width=r.right-r.left,r.height=r.bottom-r.top,r.x=r.left,r.y=r.top,r}var Jt="Sortable"+new Date().getTime();function vx(){var n=[],e;return{captureAnimationState:function(){if(n=[],!!this.options.animation){var r=[].slice.call(this.el.children);r.forEach(function(i){if(!(xe(i,"display")==="none"||i===ye.ghost)){n.push({target:i,rect:bt(i)});var o=rr({},n[n.length-1].rect);if(i.thisAnimationDuration){var s=ji(i,!0);s&&(o.top-=s.f,o.left-=s.e)}i.fromRect=o}})}},addAnimationState:function(r){n.push(r)},removeAnimationState:function(r){n.splice(gx(n,{target:r}),1)},animateAll:function(r){var i=this;if(!this.options.animation){clearTimeout(e),typeof r=="function"&&r();return}var o=!1,s=0;n.forEach(function(l){var a=0,c=l.target,u=c.fromRect,p=bt(c),h=c.prevFromRect,g=c.prevToRect,f=l.rect,d=ji(c,!0);d&&(p.top-=d.f,p.left-=d.e),c.toRect=p,c.thisAnimationDuration&&Lu(h,p)&&!Lu(u,p)&&(f.top-p.top)/(f.left-p.left)===(u.top-p.top)/(u.left-p.left)&&(a=Sx(f,h,g,i.options)),Lu(p,u)||(c.prevFromRect=u,c.prevToRect=p,a||(a=i.options.animation),i.animate(c,f,p,a)),a&&(o=!0,s=Math.max(s,a),clearTimeout(c.animationResetTimer),c.animationResetTimer=setTimeout(function(){c.animationTime=0,c.prevFromRect=null,c.fromRect=null,c.prevToRect=null,c.thisAnimationDuration=null},a),c.thisAnimationDuration=a)}),clearTimeout(e),o?e=setTimeout(function(){typeof r=="function"&&r()},s):typeof r=="function"&&r(),n=[]},animate:function(r,i,o,s){if(s){xe(r,"transition",""),xe(r,"transform","");var l=ji(this.el),a=l&&l.a,c=l&&l.d,u=(i.left-o.left)/(a||1),p=(i.top-o.top)/(c||1);r.animatingX=!!u,r.animatingY=!!p,xe(r,"transform","translate3d("+u+"px,"+p+"px,0)"),this.forRepaintDummy=Ex(r),xe(r,"transition","transform "+s+"ms"+(this.options.easing?" "+this.options.easing:"")),xe(r,"transform","translate3d(0,0,0)"),typeof r.animated=="number"&&clearTimeout(r.animated),r.animated=setTimeout(function(){xe(r,"transition",""),xe(r,"transform",""),r.animated=!1,r.animatingX=!1,r.animatingY=!1},s)}}}}function Ex(n){return n.offsetWidth}function Sx(n,e,t,r){return Math.sqrt(Math.pow(e.top-n.top,2)+Math.pow(e.left-n.left,2))/Math.sqrt(Math.pow(e.top-t.top,2)+Math.pow(e.left-t.left,2))*r.animation}var wi=[],$u={initializeByDefault:!0},hs={mount:function(e){for(var t in $u)$u.hasOwnProperty(t)&&!(t in e)&&(e[t]=$u[t]);wi.forEach(function(r){if(r.pluginName===e.pluginName)throw"Sortable: Cannot mount plugin ".concat(e.pluginName," more than once")}),wi.push(e)},pluginEvent:function(e,t,r){var i=this;this.eventCanceled=!1,r.cancel=function(){i.eventCanceled=!0};var o=e+"Global";wi.forEach(function(s){t[s.pluginName]&&(t[s.pluginName][o]&&t[s.pluginName][o](rr({sortable:t},r)),t.options[s.pluginName]&&t[s.pluginName][e]&&t[s.pluginName][e](rr({sortable:t},r)))})},initializePlugins:function(e,t,r,i){wi.forEach(function(l){var a=l.pluginName;if(!(!e.options[a]&&!l.initializeByDefault)){var c=new l(e,t,e.options);c.sortable=e,c.options=e.options,e[a]=c,Er(r,c.defaults)}});for(var o in e.options)if(e.options.hasOwnProperty(o)){var s=this.modifyOption(e,o,e.options[o]);typeof s<"u"&&(e.options[o]=s)}},getEventProperties:function(e,t){var r={};return wi.forEach(function(i){typeof i.eventProperties=="function"&&Er(r,i.eventProperties.call(t[i.pluginName],e))}),r},modifyOption:function(e,t,r){var i;return wi.forEach(function(o){e[o.pluginName]&&o.optionListeners&&typeof o.optionListeners[t]=="function"&&(i=o.optionListeners[t].call(e[o.pluginName],r))}),i}};function Rx(n){var e=n.sortable,t=n.rootEl,r=n.name,i=n.targetEl,o=n.cloneEl,s=n.toEl,l=n.fromEl,a=n.oldIndex,c=n.newIndex,u=n.oldDraggableIndex,p=n.newDraggableIndex,h=n.originalEvent,g=n.putSortable,f=n.extraEventProperties;if(e=e||t&&t[Jt],!!e){var d,_=e.options,m="on"+r.charAt(0).toUpperCase()+r.substr(1);window.CustomEvent&&!Ir&&!ps?d=new CustomEvent(r,{bubbles:!0,cancelable:!0}):(d=document.createEvent("Event"),d.initEvent(r,!0,!0)),d.to=s||t,d.from=l||t,d.item=i||t,d.clone=o,d.oldIndex=a,d.newIndex=c,d.oldDraggableIndex=u,d.newDraggableIndex=p,d.originalEvent=h,d.pullMode=g?g.lastPutMode:void 0;var C=rr(rr({},f),hs.getEventProperties(r,e));for(var R in C)d[R]=C[R];t&&t.dispatchEvent(d),_[m]&&_[m].call(e,d)}}var Fx=["evt"],Qt=function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=r.evt,o=px(r,Fx);hs.pluginEvent.bind(ye)(e,t,rr({dragEl:ve,parentEl:mt,ghostEl:Le,rootEl:dt,nextEl:Kr,lastDownEl:ia,cloneEl:pt,cloneHidden:wr,dragStarted:xo,putSortable:yt,activeSortable:ye.active,originalEvent:i,oldIndex:Bi,oldDraggableIndex:Uo,newIndex:ln,newDraggableIndex:xr,hideGhostForTarget:_C,unhideGhostForTarget:pC,cloneNowHidden:function(){wr=!0},cloneNowShown:function(){wr=!1},dispatchSortableEvent:function(l){Bt({sortable:t,name:l,originalEvent:i})}},o))};function Bt(n){Rx(rr({putSortable:yt,cloneEl:pt,targetEl:ve,rootEl:dt,oldIndex:Bi,oldDraggableIndex:Uo,newIndex:ln,newDraggableIndex:xr},n))}var ve,mt,Le,dt,Kr,ia,pt,wr,Bi,ln,Uo,xr,qs,yt,Di=!1,La=!1,$a=[],jr,Gn,Du,ku,Zh,Jh,xo,Gi,Bo,Vo=!1,Ks=!1,oa,$t,Uu=[],fd=!1,Da=[],_l=typeof document<"u",Qs=sf,eg=ps||Ir?"cssFloat":"float",Ix=_l&&!nC&&!sf&&"draggable"in document.createElement("div"),uC=function(){if(_l){if(Ir)return!1;var n=document.createElement("x");return n.style.cssText="pointer-events:auto",n.style.pointerEvents==="auto"}}(),dC=function(e,t){var r=xe(e),i=parseInt(r.width)-parseInt(r.paddingLeft)-parseInt(r.paddingRight)-parseInt(r.borderLeftWidth)-parseInt(r.borderRightWidth),o=Ji(e,0,t),s=Ji(e,1,t),l=o&&xe(o),a=s&&xe(s),c=l&&parseInt(l.marginLeft)+parseInt(l.marginRight)+bt(o).width,u=a&&parseInt(a.marginLeft)+parseInt(a.marginRight)+bt(s).width;if(r.display==="flex")return r.flexDirection==="column"||r.flexDirection==="column-reverse"?"vertical":"horizontal";if(r.display==="grid")return r.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(o&&l.float&&l.float!=="none"){var p=l.float==="left"?"left":"right";return s&&(a.clear==="both"||a.clear===p)?"vertical":"horizontal"}return o&&(l.display==="block"||l.display==="flex"||l.display==="table"||l.display==="grid"||c>=i&&r[eg]==="none"||s&&r[eg]==="none"&&c+u>i)?"vertical":"horizontal"},bx=function(e,t,r){var i=r?e.left:e.top,o=r?e.right:e.bottom,s=r?e.width:e.height,l=r?t.left:t.top,a=r?t.right:t.bottom,c=r?t.width:t.height;return i===l||o===a||i+s/2===l+c/2},Tx=function(e,t){var r;return $a.some(function(i){var o=i[Jt].options.emptyInsertThreshold;if(!(!o||af(i))){var s=bt(i),l=e>=s.left-o&&e<=s.right+o,a=t>=s.top-o&&t<=s.bottom+o;if(l&&a)return r=i}}),r},fC=function(e){function t(o,s){return function(l,a,c,u){var p=l.options.group.name&&a.options.group.name&&l.options.group.name===a.options.group.name;if(o==null&&(s||p))return!0;if(o==null||o===!1)return!1;if(s&&o==="clone")return o;if(typeof o=="function")return t(o(l,a,c,u),s)(l,a,c,u);var h=(s?l:a).options.group.name;return o===!0||typeof o=="string"&&o===h||o.join&&o.indexOf(h)>-1}}var r={},i=e.group;(!i||ra(i)!="object")&&(i={name:i}),r.name=i.name,r.checkPull=t(i.pull,!0),r.checkPut=t(i.put),r.revertClone=i.revertClone,e.group=r},_C=function(){!uC&&Le&&xe(Le,"display","none")},pC=function(){!uC&&Le&&xe(Le,"display","")};_l&&!nC&&document.addEventListener("click",function(n){if(La)return n.preventDefault(),n.stopPropagation&&n.stopPropagation(),n.stopImmediatePropagation&&n.stopImmediatePropagation(),La=!1,!1},!0);var qr=function(e){if(ve){e=e.touches?e.touches[0]:e;var t=Tx(e.clientX,e.clientY);if(t){var r={};for(var i in e)e.hasOwnProperty(i)&&(r[i]=e[i]);r.target=r.rootEl=t,r.preventDefault=void 0,r.stopPropagation=void 0,t[Jt]._onDragOver(r)}}},Ox=function(e){ve&&ve.parentNode[Jt]._isOutsideThisEl(e.target)};function ye(n,e){if(!(n&&n.nodeType&&n.nodeType===1))throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(n));this.el=n,this.options=e=Er({},e),n[Jt]=this;var t={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(n.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return dC(n,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(s,l){s.setData("Text",l.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:ye.supportPointer!==!1&&"PointerEvent"in window&&(!Do||sf),emptyInsertThreshold:5};hs.initializePlugins(this,n,t);for(var r in t)!(r in e)&&(e[r]=t[r]);fC(e);for(var i in this)i.charAt(0)==="_"&&typeof this[i]=="function"&&(this[i]=this[i].bind(this));this.nativeDraggable=e.forceFallback?!1:Ix,this.nativeDraggable&&(this.options.touchStartThreshold=1),e.supportPointer?Ye(n,"pointerdown",this._onTapStart):(Ye(n,"mousedown",this._onTapStart),Ye(n,"touchstart",this._onTapStart)),this.nativeDraggable&&(Ye(n,"dragover",this),Ye(n,"dragenter",this)),$a.push(this.el),e.store&&e.store.get&&this.sort(e.store.get(this)||[]),Er(this,vx())}ye.prototype={constructor:ye,_isOutsideThisEl:function(e){!this.el.contains(e)&&e!==this.el&&(Gi=null)},_getDirection:function(e,t){return typeof this.options.direction=="function"?this.options.direction.call(this,e,t,ve):this.options.direction},_onTapStart:function(e){if(e.cancelable){var t=this,r=this.el,i=this.options,o=i.preventOnFilter,s=e.type,l=e.touches&&e.touches[0]||e.pointerType&&e.pointerType==="touch"&&e,a=(l||e).target,c=e.target.shadowRoot&&(e.path&&e.path[0]||e.composedPath&&e.composedPath()[0])||a,u=i.filter;if(Gx(r),!ve&&!(/mousedown|pointerdown/.test(s)&&e.button!==0||i.disabled)&&!c.isContentEditable&&!(!this.nativeDraggable&&Do&&a&&a.tagName.toUpperCase()==="SELECT")&&(a=$n(a,i.draggable,r,!1),!(a&&a.animated)&&ia!==a)){if(Bi=En(a),Uo=En(a,i.draggable),typeof u=="function"){if(u.call(this,e,a,this)){Bt({sortable:t,rootEl:c,name:"filter",targetEl:a,toEl:r,fromEl:r}),Qt("filter",t,{evt:e}),o&&e.preventDefault();return}}else if(u&&(u=u.split(",").some(function(p){if(p=$n(c,p.trim(),r,!1),p)return Bt({sortable:t,rootEl:p,name:"filter",targetEl:a,fromEl:r,toEl:r}),Qt("filter",t,{evt:e}),!0}),u)){o&&e.preventDefault();return}i.handle&&!$n(c,i.handle,r,!1)||this._prepareDragStart(e,l,a)}}},_prepareDragStart:function(e,t,r){var i=this,o=i.el,s=i.options,l=o.ownerDocument,a;if(r&&!ve&&r.parentNode===o){var c=bt(r);if(dt=o,ve=r,mt=ve.parentNode,Kr=ve.nextSibling,ia=r,qs=s.group,ye.dragged=ve,jr={target:ve,clientX:(t||e).clientX,clientY:(t||e).clientY},Zh=jr.clientX-c.left,Jh=jr.clientY-c.top,this._lastX=(t||e).clientX,this._lastY=(t||e).clientY,ve.style["will-change"]="all",a=function(){if(Qt("delayEnded",i,{evt:e}),ye.eventCanceled){i._onDrop();return}i._disableDelayedDragEvents(),!jh&&i.nativeDraggable&&(ve.draggable=!0),i._triggerDragStart(e,t),Bt({sortable:i,name:"choose",originalEvent:e}),sn(ve,s.chosenClass,!0)},s.ignore.split(",").forEach(function(u){oC(ve,u.trim(),Bu)}),Ye(l,"dragover",qr),Ye(l,"mousemove",qr),Ye(l,"touchmove",qr),s.supportPointer?(Ye(l,"pointerup",i._onDrop),!this.nativeDraggable&&Ye(l,"pointercancel",i._onDrop)):(Ye(l,"mouseup",i._onDrop),Ye(l,"touchend",i._onDrop),Ye(l,"touchcancel",i._onDrop)),jh&&this.nativeDraggable&&(this.options.touchStartThreshold=4,ve.draggable=!0),Qt("delayStart",this,{evt:e}),s.delay&&(!s.delayOnTouchOnly||t)&&(!this.nativeDraggable||!(ps||Ir))){if(ye.eventCanceled){this._onDrop();return}s.supportPointer?(Ye(l,"pointerup",i._disableDelayedDrag),Ye(l,"pointercancel",i._disableDelayedDrag)):(Ye(l,"mouseup",i._disableDelayedDrag),Ye(l,"touchend",i._disableDelayedDrag),Ye(l,"touchcancel",i._disableDelayedDrag)),Ye(l,"mousemove",i._delayedDragTouchMoveHandler),Ye(l,"touchmove",i._delayedDragTouchMoveHandler),s.supportPointer&&Ye(l,"pointermove",i._delayedDragTouchMoveHandler),i._dragStartTimer=setTimeout(a,s.delay)}else a()}},_delayedDragTouchMoveHandler:function(e){var t=e.touches?e.touches[0]:e;Math.max(Math.abs(t.clientX-this._lastX),Math.abs(t.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){ve&&Bu(ve),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var e=this.el.ownerDocument;Xe(e,"mouseup",this._disableDelayedDrag),Xe(e,"touchend",this._disableDelayedDrag),Xe(e,"touchcancel",this._disableDelayedDrag),Xe(e,"pointerup",this._disableDelayedDrag),Xe(e,"pointercancel",this._disableDelayedDrag),Xe(e,"mousemove",this._delayedDragTouchMoveHandler),Xe(e,"touchmove",this._delayedDragTouchMoveHandler),Xe(e,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(e,t){t=t||e.pointerType=="touch"&&e,!this.nativeDraggable||t?this.options.supportPointer?Ye(document,"pointermove",this._onTouchMove):t?Ye(document,"touchmove",this._onTouchMove):Ye(document,"mousemove",this._onTouchMove):(Ye(ve,"dragend",this),Ye(dt,"dragstart",this._onDragStart));try{document.selection?sa(function(){document.selection.empty()}):window.getSelection().removeAllRanges()}catch{}},_dragStarted:function(e,t){if(Di=!1,dt&&ve){Qt("dragStarted",this,{evt:t}),this.nativeDraggable&&Ye(document,"dragover",Ox);var r=this.options;!e&&sn(ve,r.dragClass,!1),sn(ve,r.ghostClass,!0),ye.active=this,e&&this._appendGhost(),Bt({sortable:this,name:"start",originalEvent:t})}else this._nulling()},_emulateDragOver:function(){if(Gn){this._lastX=Gn.clientX,this._lastY=Gn.clientY,_C();for(var e=document.elementFromPoint(Gn.clientX,Gn.clientY),t=e;e&&e.shadowRoot&&(e=e.shadowRoot.elementFromPoint(Gn.clientX,Gn.clientY),e!==t);)t=e;if(ve.parentNode[Jt]._isOutsideThisEl(e),t)do{if(t[Jt]){var r=void 0;if(r=t[Jt]._onDragOver({clientX:Gn.clientX,clientY:Gn.clientY,target:e,rootEl:t}),r&&!this.options.dragoverBubble)break}e=t}while(t=iC(t));pC()}},_onTouchMove:function(e){if(jr){var t=this.options,r=t.fallbackTolerance,i=t.fallbackOffset,o=e.touches?e.touches[0]:e,s=Le&&ji(Le,!0),l=Le&&s&&s.a,a=Le&&s&&s.d,c=Qs&&$t&&Qh($t),u=(o.clientX-jr.clientX+i.x)/(l||1)+(c?c[0]-Uu[0]:0)/(l||1),p=(o.clientY-jr.clientY+i.y)/(a||1)+(c?c[1]-Uu[1]:0)/(a||1);if(!ye.active&&!Di){if(r&&Math.max(Math.abs(o.clientX-this._lastX),Math.abs(o.clientY-this._lastY))<r)return;this._onDragStart(e,!0)}if(Le){s?(s.e+=u-(Du||0),s.f+=p-(ku||0)):s={a:1,b:0,c:0,d:1,e:u,f:p};var h="matrix(".concat(s.a,",").concat(s.b,",").concat(s.c,",").concat(s.d,",").concat(s.e,",").concat(s.f,")");xe(Le,"webkitTransform",h),xe(Le,"mozTransform",h),xe(Le,"msTransform",h),xe(Le,"transform",h),Du=u,ku=p,Gn=o}e.cancelable&&e.preventDefault()}},_appendGhost:function(){if(!Le){var e=this.options.fallbackOnBody?document.body:dt,t=bt(ve,!0,Qs,!0,e),r=this.options;if(Qs){for($t=e;xe($t,"position")==="static"&&xe($t,"transform")==="none"&&$t!==document;)$t=$t.parentNode;$t!==document.body&&$t!==document.documentElement?($t===document&&($t=Jn()),t.top+=$t.scrollTop,t.left+=$t.scrollLeft):$t=Jn(),Uu=Qh($t)}Le=ve.cloneNode(!0),sn(Le,r.ghostClass,!1),sn(Le,r.fallbackClass,!0),sn(Le,r.dragClass,!0),xe(Le,"transition",""),xe(Le,"transform",""),xe(Le,"box-sizing","border-box"),xe(Le,"margin",0),xe(Le,"top",t.top),xe(Le,"left",t.left),xe(Le,"width",t.width),xe(Le,"height",t.height),xe(Le,"opacity","0.8"),xe(Le,"position",Qs?"absolute":"fixed"),xe(Le,"zIndex","100000"),xe(Le,"pointerEvents","none"),ye.ghost=Le,e.appendChild(Le),xe(Le,"transform-origin",Zh/parseInt(Le.style.width)*100+"% "+Jh/parseInt(Le.style.height)*100+"%")}},_onDragStart:function(e,t){var r=this,i=e.dataTransfer,o=r.options;if(Qt("dragStart",this,{evt:e}),ye.eventCanceled){this._onDrop();return}Qt("setupClone",this),ye.eventCanceled||(pt=lC(ve),pt.removeAttribute("id"),pt.draggable=!1,pt.style["will-change"]="",this._hideClone(),sn(pt,this.options.chosenClass,!1),ye.clone=pt),r.cloneId=sa(function(){Qt("clone",r),!ye.eventCanceled&&(r.options.removeCloneOnHide||dt.insertBefore(pt,ve),r._hideClone(),Bt({sortable:r,name:"clone"}))}),!t&&sn(ve,o.dragClass,!0),t?(La=!0,r._loopId=setInterval(r._emulateDragOver,50)):(Xe(document,"mouseup",r._onDrop),Xe(document,"touchend",r._onDrop),Xe(document,"touchcancel",r._onDrop),i&&(i.effectAllowed="move",o.setData&&o.setData.call(r,i,ve)),Ye(document,"drop",r),xe(ve,"transform","translateZ(0)")),Di=!0,r._dragStartId=sa(r._dragStarted.bind(r,t,e)),Ye(document,"selectstart",r),xo=!0,window.getSelection().removeAllRanges(),Do&&xe(document.body,"user-select","none")},_onDragOver:function(e){var t=this.el,r=e.target,i,o,s,l=this.options,a=l.group,c=ye.active,u=qs===a,p=l.sort,h=yt||c,g,f=this,d=!1;if(fd)return;function _(O,D){Qt(O,f,rr({evt:e,isOwner:u,axis:g?"vertical":"horizontal",revert:s,dragRect:i,targetRect:o,canSort:p,fromSortable:h,target:r,completed:C,onMove:function(z,ee){return Zs(dt,t,ve,i,z,bt(z),e,ee)},changed:R},D))}function m(){_("dragOverAnimationCapture"),f.captureAnimationState(),f!==h&&h.captureAnimationState()}function C(O){return _("dragOverCompleted",{insertion:O}),O&&(u?c._hideClone():c._showClone(f),f!==h&&(sn(ve,yt?yt.options.ghostClass:c.options.ghostClass,!1),sn(ve,l.ghostClass,!0)),yt!==f&&f!==ye.active?yt=f:f===ye.active&&yt&&(yt=null),h===f&&(f._ignoreWhileAnimating=r),f.animateAll(function(){_("dragOverAnimationComplete"),f._ignoreWhileAnimating=null}),f!==h&&(h.animateAll(),h._ignoreWhileAnimating=null)),(r===ve&&!ve.animated||r===t&&!r.animated)&&(Gi=null),!l.dragoverBubble&&!e.rootEl&&r!==document&&(ve.parentNode[Jt]._isOutsideThisEl(e.target),!O&&qr(e)),!l.dragoverBubble&&e.stopPropagation&&e.stopPropagation(),d=!0}function R(){ln=En(ve),xr=En(ve,l.draggable),Bt({sortable:f,name:"change",toEl:t,newIndex:ln,newDraggableIndex:xr,originalEvent:e})}if(e.preventDefault!==void 0&&e.cancelable&&e.preventDefault(),r=$n(r,l.draggable,t,!0),_("dragOver"),ye.eventCanceled)return d;if(ve.contains(e.target)||r.animated&&r.animatingX&&r.animatingY||f._ignoreWhileAnimating===r)return C(!1);if(La=!1,c&&!l.disabled&&(u?p||(s=mt!==dt):yt===this||(this.lastPutMode=qs.checkPull(this,c,ve,e))&&a.checkPut(this,c,ve,e))){if(g=this._getDirection(e,r)==="vertical",i=bt(ve),_("dragOverValid"),ye.eventCanceled)return d;if(s)return mt=dt,m(),this._hideClone(),_("revert"),ye.eventCanceled||(Kr?dt.insertBefore(ve,Kr):dt.appendChild(ve)),C(!0);var S=af(t,l.draggable);if(!S||Nx(e,g,this)&&!S.animated){if(S===ve)return C(!1);if(S&&t===e.target&&(r=S),r&&(o=bt(r)),Zs(dt,t,ve,i,r,o,e,!!r)!==!1)return m(),S&&S.nextSibling?t.insertBefore(ve,S.nextSibling):t.appendChild(ve),mt=t,R(),C(!0)}else if(S&&Mx(e,g,this)){var F=Ji(t,0,l,!0);if(F===ve)return C(!1);if(r=F,o=bt(r),Zs(dt,t,ve,i,r,o,e,!1)!==!1)return m(),t.insertBefore(ve,F),mt=t,R(),C(!0)}else if(r.parentNode===t){o=bt(r);var I=0,T,P=ve.parentNode!==t,y=!bx(ve.animated&&ve.toRect||i,r.animated&&r.toRect||o,g),L=g?"top":"left",G=Kh(r,"top","top")||Kh(ve,"top","top"),U=G?G.scrollTop:void 0;Gi!==r&&(T=o[L],Vo=!1,Ks=!y&&l.invertSwap||P),I=xx(e,r,o,g,y?1:l.swapThreshold,l.invertedSwapThreshold==null?l.swapThreshold:l.invertedSwapThreshold,Ks,Gi===r);var M;if(I!==0){var N=En(ve);do N-=I,M=mt.children[N];while(M&&(xe(M,"display")==="none"||M===Le))}if(I===0||M===r)return C(!1);Gi=r,Bo=I;var w=r.nextElementSibling,x=!1;x=I===1;var k=Zs(dt,t,ve,i,r,o,e,x);if(k!==!1)return(k===1||k===-1)&&(x=k===1),fd=!0,setTimeout(Ax,30),m(),x&&!w?t.appendChild(ve):r.parentNode.insertBefore(ve,x?w:r),G&&aC(G,0,U-G.scrollTop),mt=ve.parentNode,T!==void 0&&!Ks&&(oa=Math.abs(T-bt(r)[L])),R(),C(!0)}if(t.contains(ve))return C(!1)}return!1},_ignoreWhileAnimating:null,_offMoveEvents:function(){Xe(document,"mousemove",this._onTouchMove),Xe(document,"touchmove",this._onTouchMove),Xe(document,"pointermove",this._onTouchMove),Xe(document,"dragover",qr),Xe(document,"mousemove",qr),Xe(document,"touchmove",qr)},_offUpEvents:function(){var e=this.el.ownerDocument;Xe(e,"mouseup",this._onDrop),Xe(e,"touchend",this._onDrop),Xe(e,"pointerup",this._onDrop),Xe(e,"pointercancel",this._onDrop),Xe(e,"touchcancel",this._onDrop),Xe(document,"selectstart",this)},_onDrop:function(e){var t=this.el,r=this.options;if(ln=En(ve),xr=En(ve,r.draggable),Qt("drop",this,{evt:e}),mt=ve&&ve.parentNode,ln=En(ve),xr=En(ve,r.draggable),ye.eventCanceled){this._nulling();return}Di=!1,Ks=!1,Vo=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),_d(this.cloneId),_d(this._dragStartId),this.nativeDraggable&&(Xe(document,"drop",this),Xe(t,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),Do&&xe(document.body,"user-select",""),xe(ve,"transform",""),e&&(xo&&(e.cancelable&&e.preventDefault(),!r.dropBubble&&e.stopPropagation()),Le&&Le.parentNode&&Le.parentNode.removeChild(Le),(dt===mt||yt&&yt.lastPutMode!=="clone")&&pt&&pt.parentNode&&pt.parentNode.removeChild(pt),ve&&(this.nativeDraggable&&Xe(ve,"dragend",this),Bu(ve),ve.style["will-change"]="",xo&&!Di&&sn(ve,yt?yt.options.ghostClass:this.options.ghostClass,!1),sn(ve,this.options.chosenClass,!1),Bt({sortable:this,name:"unchoose",toEl:mt,newIndex:null,newDraggableIndex:null,originalEvent:e}),dt!==mt?(ln>=0&&(Bt({rootEl:mt,name:"add",toEl:mt,fromEl:dt,originalEvent:e}),Bt({sortable:this,name:"remove",toEl:mt,originalEvent:e}),Bt({rootEl:mt,name:"sort",toEl:mt,fromEl:dt,originalEvent:e}),Bt({sortable:this,name:"sort",toEl:mt,originalEvent:e})),yt&&yt.save()):ln!==Bi&&ln>=0&&(Bt({sortable:this,name:"update",toEl:mt,originalEvent:e}),Bt({sortable:this,name:"sort",toEl:mt,originalEvent:e})),ye.active&&((ln==null||ln===-1)&&(ln=Bi,xr=Uo),Bt({sortable:this,name:"end",toEl:mt,originalEvent:e}),this.save()))),this._nulling()},_nulling:function(){Qt("nulling",this),dt=ve=mt=Le=Kr=pt=ia=wr=jr=Gn=xo=ln=xr=Bi=Uo=Gi=Bo=yt=qs=ye.dragged=ye.ghost=ye.clone=ye.active=null,Da.forEach(function(e){e.checked=!0}),Da.length=Du=ku=0},handleEvent:function(e){switch(e.type){case"drop":case"dragend":this._onDrop(e);break;case"dragenter":case"dragover":ve&&(this._onDragOver(e),Px(e));break;case"selectstart":e.preventDefault();break}},toArray:function(){for(var e=[],t,r=this.el.children,i=0,o=r.length,s=this.options;i<o;i++)t=r[i],$n(t,s.draggable,this.el,!1)&&e.push(t.getAttribute(s.dataIdAttr)||wx(t));return e},sort:function(e,t){var r={},i=this.el;this.toArray().forEach(function(o,s){var l=i.children[s];$n(l,this.options.draggable,i,!1)&&(r[o]=l)},this),t&&this.captureAnimationState(),e.forEach(function(o){r[o]&&(i.removeChild(r[o]),i.appendChild(r[o]))}),t&&this.animateAll()},save:function(){var e=this.options.store;e&&e.set&&e.set(this)},closest:function(e,t){return $n(e,t||this.options.draggable,this.el,!1)},option:function(e,t){var r=this.options;if(t===void 0)return r[e];var i=hs.modifyOption(this,e,t);typeof i<"u"?r[e]=i:r[e]=t,e==="group"&&fC(r)},destroy:function(){Qt("destroy",this);var e=this.el;e[Jt]=null,Xe(e,"mousedown",this._onTapStart),Xe(e,"touchstart",this._onTapStart),Xe(e,"pointerdown",this._onTapStart),this.nativeDraggable&&(Xe(e,"dragover",this),Xe(e,"dragenter",this)),Array.prototype.forEach.call(e.querySelectorAll("[draggable]"),function(t){t.removeAttribute("draggable")}),this._onDrop(),this._disableDelayedDragEvents(),$a.splice($a.indexOf(this.el),1),this.el=e=null},_hideClone:function(){if(!wr){if(Qt("hideClone",this),ye.eventCanceled)return;xe(pt,"display","none"),this.options.removeCloneOnHide&&pt.parentNode&&pt.parentNode.removeChild(pt),wr=!0}},_showClone:function(e){if(e.lastPutMode!=="clone"){this._hideClone();return}if(wr){if(Qt("showClone",this),ye.eventCanceled)return;ve.parentNode==dt&&!this.options.group.revertClone?dt.insertBefore(pt,ve):Kr?dt.insertBefore(pt,Kr):dt.appendChild(pt),this.options.group.revertClone&&this.animate(ve,pt),xe(pt,"display",""),wr=!1}}};function Px(n){n.dataTransfer&&(n.dataTransfer.dropEffect="move"),n.cancelable&&n.preventDefault()}function Zs(n,e,t,r,i,o,s,l){var a,c=n[Jt],u=c.options.onMove,p;return window.CustomEvent&&!Ir&&!ps?a=new CustomEvent("move",{bubbles:!0,cancelable:!0}):(a=document.createEvent("Event"),a.initEvent("move",!0,!0)),a.to=e,a.from=n,a.dragged=t,a.draggedRect=r,a.related=i||e,a.relatedRect=o||bt(e),a.willInsertAfter=l,a.originalEvent=s,n.dispatchEvent(a),u&&(p=u.call(c,a,s)),p}function Bu(n){n.draggable=!1}function Ax(){fd=!1}function Mx(n,e,t){var r=bt(Ji(t.el,0,t.options,!0)),i=cC(t.el,t.options,Le),o=10;return e?n.clientX<i.left-o||n.clientY<r.top&&n.clientX<r.right:n.clientY<i.top-o||n.clientY<r.bottom&&n.clientX<r.left}function Nx(n,e,t){var r=bt(af(t.el,t.options.draggable)),i=cC(t.el,t.options,Le),o=10;return e?n.clientX>i.right+o||n.clientY>r.bottom&&n.clientX>r.left:n.clientY>i.bottom+o||n.clientX>r.right&&n.clientY>r.top}function xx(n,e,t,r,i,o,s,l){var a=r?n.clientY:n.clientX,c=r?t.height:t.width,u=r?t.top:t.left,p=r?t.bottom:t.right,h=!1;if(!s){if(l&&oa<c*i){if(!Vo&&(Bo===1?a>u+c*o/2:a<p-c*o/2)&&(Vo=!0),Vo)h=!0;else if(Bo===1?a<u+oa:a>p-oa)return-Bo}else if(a>u+c*(1-i)/2&&a<p-c*(1-i)/2)return yx(e)}return h=h||s,h&&(a<u+c*o/2||a>p-c*o/2)?a>u+c/2?1:-1:0}function yx(n){return En(ve)<En(n)?1:-1}function wx(n){for(var e=n.tagName+n.className+n.src+n.href+n.textContent,t=e.length,r=0;t--;)r+=e.charCodeAt(t);return r.toString(36)}function Gx(n){Da.length=0;for(var e=n.getElementsByTagName("input"),t=e.length;t--;){var r=e[t];r.checked&&Da.push(r)}}function sa(n){return setTimeout(n,0)}function _d(n){return clearTimeout(n)}_l&&Ye(document,"touchmove",function(n){(ye.active||Di)&&n.cancelable&&n.preventDefault()});ye.utils={on:Ye,off:Xe,css:xe,find:oC,is:function(e,t){return!!$n(e,t,e,!1)},extend:mx,throttle:sC,closest:$n,toggleClass:sn,clone:lC,index:En,nextTick:sa,cancelNextTick:_d,detectDirection:dC,getChild:Ji,expando:Jt};ye.get=function(n){return n[Jt]};ye.mount=function(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];e[0].constructor===Array&&(e=e[0]),e.forEach(function(r){if(!r.prototype||!r.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(r));r.utils&&(ye.utils=rr(rr({},ye.utils),r.utils)),hs.mount(r)})};ye.create=function(n,e){return new ye(n,e)};ye.version=hx;var It=[],yo,pd,hd=!1,Vu,Hu,ka,wo;function Lx(){function n(){this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0};for(var e in this)e.charAt(0)==="_"&&typeof this[e]=="function"&&(this[e]=this[e].bind(this))}return n.prototype={dragStarted:function(t){var r=t.originalEvent;this.sortable.nativeDraggable?Ye(document,"dragover",this._handleAutoScroll):this.options.supportPointer?Ye(document,"pointermove",this._handleFallbackAutoScroll):r.touches?Ye(document,"touchmove",this._handleFallbackAutoScroll):Ye(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(t){var r=t.originalEvent;!this.options.dragOverBubble&&!r.rootEl&&this._handleAutoScroll(r)},drop:function(){this.sortable.nativeDraggable?Xe(document,"dragover",this._handleAutoScroll):(Xe(document,"pointermove",this._handleFallbackAutoScroll),Xe(document,"touchmove",this._handleFallbackAutoScroll),Xe(document,"mousemove",this._handleFallbackAutoScroll)),tg(),aa(),Cx()},nulling:function(){ka=pd=yo=hd=wo=Vu=Hu=null,It.length=0},_handleFallbackAutoScroll:function(t){this._handleAutoScroll(t,!0)},_handleAutoScroll:function(t,r){var i=this,o=(t.touches?t.touches[0]:t).clientX,s=(t.touches?t.touches[0]:t).clientY,l=document.elementFromPoint(o,s);if(ka=t,r||this.options.forceAutoScrollFallback||ps||Ir||Do){Xu(t,this.options,l,r);var a=kr(l,!0);hd&&(!wo||o!==Vu||s!==Hu)&&(wo&&tg(),wo=setInterval(function(){var c=kr(document.elementFromPoint(o,s),!0);c!==a&&(a=c,aa()),Xu(t,i.options,c,r)},10),Vu=o,Hu=s)}else{if(!this.options.bubbleScroll||kr(l,!0)===Jn()){aa();return}Xu(t,this.options,kr(l,!1),!1)}}},Er(n,{pluginName:"scroll",initializeByDefault:!0})}function aa(){It.forEach(function(n){clearInterval(n.pid)}),It=[]}function tg(){clearInterval(wo)}var Xu=sC(function(n,e,t,r){if(e.scroll){var i=(n.touches?n.touches[0]:n).clientX,o=(n.touches?n.touches[0]:n).clientY,s=e.scrollSensitivity,l=e.scrollSpeed,a=Jn(),c=!1,u;pd!==t&&(pd=t,aa(),yo=e.scroll,u=e.scrollFn,yo===!0&&(yo=kr(t,!0)));var p=0,h=yo;do{var g=h,f=bt(g),d=f.top,_=f.bottom,m=f.left,C=f.right,R=f.width,S=f.height,F=void 0,I=void 0,T=g.scrollWidth,P=g.scrollHeight,y=xe(g),L=g.scrollLeft,G=g.scrollTop;g===a?(F=R<T&&(y.overflowX==="auto"||y.overflowX==="scroll"||y.overflowX==="visible"),I=S<P&&(y.overflowY==="auto"||y.overflowY==="scroll"||y.overflowY==="visible")):(F=R<T&&(y.overflowX==="auto"||y.overflowX==="scroll"),I=S<P&&(y.overflowY==="auto"||y.overflowY==="scroll"));var U=F&&(Math.abs(C-i)<=s&&L+R<T)-(Math.abs(m-i)<=s&&!!L),M=I&&(Math.abs(_-o)<=s&&G+S<P)-(Math.abs(d-o)<=s&&!!G);if(!It[p])for(var N=0;N<=p;N++)It[N]||(It[N]={});(It[p].vx!=U||It[p].vy!=M||It[p].el!==g)&&(It[p].el=g,It[p].vx=U,It[p].vy=M,clearInterval(It[p].pid),(U!=0||M!=0)&&(c=!0,It[p].pid=setInterval(function(){r&&this.layer===0&&ye.active._onTouchMove(ka);var w=It[this.layer].vy?It[this.layer].vy*l:0,x=It[this.layer].vx?It[this.layer].vx*l:0;typeof u=="function"&&u.call(ye.dragged.parentNode[Jt],x,w,n,ka,It[this.layer].el)!=="continue"||aC(It[this.layer].el,x,w)}.bind({layer:p}),24))),p++}while(e.bubbleScroll&&h!==a&&(h=kr(h,!1)));hd=c}},30),hC=function(e){var t=e.originalEvent,r=e.putSortable,i=e.dragEl,o=e.activeSortable,s=e.dispatchSortableEvent,l=e.hideGhostForTarget,a=e.unhideGhostForTarget;if(t){var c=r||o;l();var u=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:t,p=document.elementFromPoint(u.clientX,u.clientY);a(),c&&!c.el.contains(p)&&(s("spill"),this.onSpill({dragEl:i,putSortable:r}))}};function lf(){}lf.prototype={startIndex:null,dragStart:function(e){var t=e.oldDraggableIndex;this.startIndex=t},onSpill:function(e){var t=e.dragEl,r=e.putSortable;this.sortable.captureAnimationState(),r&&r.captureAnimationState();var i=Ji(this.sortable.el,this.startIndex,this.options);i?this.sortable.el.insertBefore(t,i):this.sortable.el.appendChild(t),this.sortable.animateAll(),r&&r.animateAll()},drop:hC};Er(lf,{pluginName:"revertOnSpill"});function cf(){}cf.prototype={onSpill:function(e){var t=e.dragEl,r=e.putSortable,i=r||this.sortable;i.captureAnimationState(),t.parentNode&&t.parentNode.removeChild(t),i.animateAll()},drop:hC};Er(cf,{pluginName:"removeOnSpill"});ye.mount(new Lx);ye.mount(cf,lf);var $x=ne('<li class="svelte-4xucy7"><div class="index svelte-4xucy7"> </div> <span class="name svelte-4xucy7"> </span> <div class="handle svelte-4xucy7"><div class="fas fa-grip-vertical svelte-4xucy7"></div></div></li>'),Dx=ne('<ul class="svelte-4xucy7"></ul>');function kx(n,e){we(e,!0);const[t,r]=Et(),i=()=>vt(St,"$i18n",t);let o=ft(e,"value",31,()=>Rn([])),s;function l(u){return s=ye.create(u,{animation:150,handle:".handle",onUpdate(p){const{oldIndex:h,newIndex:g}=p,f=Qn(o()),d=f[h],_=g<h?-1:1;for(let m=h;m!==g;m+=_)f[m]=f[m+_];f[g]=d,o(f)}}),{destroy:()=>s.destroy()}}function a(u){const p=li[u],h=[];let g;const f=p.match(/^ESC(\d)/);return f?(h.push(`#${f[1]}`),g=p.replace(/^ESC\d/,"ESC")):g=p,h.push(i().t(`receiverTelemetrySensor_${g}`)),h.join(" ")}var c=Dx();xt(c,22,o,u=>u,(u,p,h)=>{var g=$x(),f=W(g),d=W(f),_=K(f,2),m=W(_);Ae(C=>{Ee(d,b(h)+1),Ee(m,C)},[()=>a(p.value)]),Z(u,g)}),pb(c,u=>l?.(u)),Z(n,c),Ge(),r()}var Ux=ne('<span class="svelte-1361air"> </span> <br class="svelte-1361air"/> <span class="sensor-count svelte-1361air"> </span>',1),Bx=ne('<div class="container svelte-1361air"><!> <!></div>');function Vx(n,e){we(e,!0);const[t,r]=Et(),i=()=>vt(St,"$i18n",t);let o=ft(e,"value",31,()=>Rn([]));const s=40,l={get items(){const d=[];for(let _=0;_<o().length;_++)o()[_]>0&&d.push({value:o()[_]});return d},set items(d){o(d.map(_=>_.value))}};let a=ue(()=>l.items.length);var c=Bx(),u=W(c);{var p=d=>{Um(d,{children:(_,m)=>{var C=Ux(),R=me(C),S=W(R),F=K(R,4),I=W(F);Ae(T=>{Ee(S,T),Ee(I,`${b(a)??""} / 40`)},[()=>i().t("receiverTelemetrySensorsExceededWarning",{max:s})]),Z(_,C)},$$slots:{default:!0}})};Ce(u,d=>{b(a)>s&&d(p)})}var h=K(u,2);{var g=d=>{kx(d,{get sensors(){return e.sensors},get value(){return l.items},set value(_){l.items=_}})},f=(d,_)=>{{var m=C=>{dx(C,{get sensors(){return e.sensors},get value(){return l.items},set value(R){l.items=R}})};Ce(d,C=>{e.view===1&&C(m)},_)}};Ce(h,d=>{e.view===0?d(g):d(f,!1)})}Z(n,c),Ge(),r()}var Hx=(n,e)=>ce(e,0),Xx=(n,e)=>ce(e,1),Yx=ne('<div class="grow svelte-1tnd9ix"></div> <div class="button-group svelte-1tnd9ix"><div class="slider svelte-1tnd9ix"></div> <button> </button> <button> </button></div>',1),zx=ne('<div class="header svelte-1tnd9ix"><span class="title svelte-1tnd9ix"> </span> <!></div>');function Wx(n,e){we(e,!0);const[t,r]=Et(),i=()=>vt(St,"$i18n",t);let o=ft(e,"FC",15),s=pe(1);Gt(n,{header:a=>{var c=zx(),u=W(c),p=W(u),h=K(u,2);{var g=f=>{var d=Yx(),_=K(me(d),2),m=W(_);let C;var R=K(m,2);R.__click=[Hx,s];var S=W(R),F=K(R,2);F.__click=[Xx,s];var I=W(F);Ae((T,P)=>{C=ha(m,"",C,{left:`${b(s)*50}%`}),ii(R,1,Wo({active:b(s)===0}),"svelte-1tnd9ix"),Ee(S,T),ii(F,1,Wo({active:b(s)===1}),"svelte-1tnd9ix"),Ee(I,P)},[()=>i().t("receiverTelemetrySensorsSort"),()=>i().t("receiverTelemetrySensorsSelect")]),Z(f,d)};Ce(h,f=>{e.telemetry.type===rt.ORDERED_LIST&&f(g)})}Ae(f=>Ee(p,f),[()=>i().t("receiverTelemetrySensors")]),Z(a,c)},children:(a,c)=>{Be(a,{children:(u,p)=>{var h=Ct(),g=me(h);{var f=_=>{Vx(_,{get sensors(){return e.telemetry.sensors},get view(){return b(s)},get value(){return o().TELEMETRY_CONFIG.telemetry_sensors_list},set value(m){o(o().TELEMETRY_CONFIG.telemetry_sensors_list=m,!0)}})},d=(_,m)=>{{var C=S=>{nx(S,{get sensors(){return e.telemetry.sensors},get value(){return o().TELEMETRY_CONFIG.telemetry_sensors_list},set value(F){o(o().TELEMETRY_CONFIG.telemetry_sensors_list=F,!0)}})},R=(S,F)=>{{var I=T=>{rx(T,{get mask(){return e.telemetry.mask},get value(){return o().TELEMETRY_CONFIG.telemetry_sensors},set value(P){o(o().TELEMETRY_CONFIG.telemetry_sensors=P,!0)}})};Ce(S,T=>{e.telemetry.type===rt.BITFIELD&&T(I)},F)}};Ce(_,S=>{e.telemetry.type===rt.UNORDERED_LIST?S(C):S(R,!1)},m)}};Ce(g,_=>{e.telemetry.type===rt.ORDERED_LIST?_(f):_(d,!1)})}Z(u,h)},$$slots:{default:!0}})},$$slots:{header:!0,default:!0}}),Ge(),r()}pn(["click"]);var jx=ne('<div class="svelte-1s0uaif"><!></div>'),qx=ne('<div class="svelte-1s0uaif"><!></div> <!>',1),Kx=ne('<div class="container svelte-1s0uaif"><!> <!> <!></div>');function Qx(n,e){we(e,!0);let t;function r(){return Qn({rc:V.RC_CONFIG,rx:V.RX_CONFIG,telemetry:V.TELEMETRY_CONFIG,features:V.FEATURE_CONFIG.features.bitfield})}di(()=>{t=r()}),bn(()=>{cs(t,r()).length>0&&e.onchange?.()});const i=64;let o=ue(()=>V.SERIAL_CONFIG.ports.some(R=>R.functionMask&i)),s=ue(()=>{for(const R of HN)for(const S of V.SERIAL_CONFIG.ports)if(S.functionMask&R.id)return R}),l=ue(()=>{for(const R of $d.GROUPS.RX_PROTO)if(V.FEATURE_CONFIG.features[R])return R}),a=ue(()=>{if(!b(l))return 0;for(let R=1;R<Ui.length;R++){const S=Ui[R];if(S.feature===b(l)&&!(b(l)==="RX_SERIAL"&&(S.id!==V.RX_CONFIG.serialrx_provider||!b(o)))&&!(b(l)==="RX_SPI"&&S.id!==V.RX_CONFIG.rxSpiProtocol))return R}}),c=ue(()=>Ui[b(a)]),u=ue(()=>b(s)?.telemetry??b(c)?.telemetry);const p={};function h(R){if(R&&R.type!==rt.TOGGLE&&(p[R.type]||(p[R.type]={}),p[R.type][R.proto]={telemetry_sensors:V.TELEMETRY_CONFIG.telemetry_sensors,telemetry_sensors_list:Qn(V.TELEMETRY_CONFIG.telemetry_sensors_list)}),b(u)&&b(u).type!==rt.TOGGLE){const S=p[b(u).type]?.[b(u).proto];if(S){Object.assign(V.TELEMETRY_CONFIG,S);return}}V.TELEMETRY_CONFIG.telemetry_sensors=0,V.TELEMETRY_CONFIG.telemetry_sensors_list=[]}function g(R){const S=!!b(s),F=b(c),I=Ui[R];V.FEATURE_CONFIG.features.setGroup("RX_PROTO",!1),I.feature&&V.FEATURE_CONFIG.features.setFeature(I.feature,!0),I.feature==="RX_SERIAL"?V.RX_CONFIG.serialrx_provider=I.id:I.feature==="RX_SPI"&&(V.RX_CONFIG.rxSpiProtocol=I.id),S||h(F.telemetry)}var f=Kx(),d=W(f);qN(d,{get FC(){return V},get rxProtoIndex(){return b(a)},get hasSerialRxPort(){return b(o)},setRxProto:g});var _=K(d,2);$N(_,{get FC(){return V}});var m=K(_,2);{var C=R=>{var S=qx(),F=me(S),I=W(F);ex(I,{get FC(){return V},get telemetry(){return b(u)},resetTelemetry:h});var T=K(F,2);{var P=y=>{var L=jx(),G=W(L);Wx(G,{get FC(){return V},get telemetry(){return b(u)}}),ke(7,L,()=>Ue),Z(y,L)};Ce(T,y=>{V.FEATURE_CONFIG.features.TELEMETRY&&b(u).type!==rt.TOGGLE&&y(P)})}ke(3,F,()=>Ue),Z(R,S)};Ce(m,R=>{b(u)&&R(C)})}Z(n,f),Ge()}const eo={tabName:"receiver",svelteComponent:null,isDirty:!1,needReboot:!1,bindButton:!1,stickButton:!1,saveButtons:!1,rcRPY:[0,0,0],rcmap:[0,1,2,3,4,5,6,7],rcmapSize:8,axisLetters:["A","E","R","C","T","1","2","3"],axisNames:[{value:0,text:"controlAxisRoll"},{value:1,text:"controlAxisPitch"},{value:2,text:"controlAxisYaw"},{value:3,text:"controlAxisCollective"},{value:4,text:"controlAxisThrottle"},{value:5,text:"controlAxisAux1"},{value:6,text:"controlAxisAux2"},{value:7,text:"controlAxisAux3"},{value:8,text:"controlAxisAux4"},{value:9,text:"controlAxisAux5"},{value:10,text:"controlAxisAux6"},{value:11,text:"controlAxisAux7"},{value:12,text:"controlAxisAux8"},{value:13,text:"controlAxisAux9"},{value:14,text:"controlAxisAux10"},{value:15,text:"controlAxisAux11"},{value:16,text:"controlAxisAux12"},{value:17,text:"controlAxisAux13"},{value:18,text:"controlAxisAux14"},{value:19,text:"controlAxisAux15"},{value:20,text:"controlAxisAux16"},{value:21,text:"controlAxisAux17"},{value:22,text:"controlAxisAux18"},{value:23,text:"controlAxisAux19"},{value:24,text:"controlAxisAux20"},{value:25,text:"controlAxisAux21"},{value:26,text:"controlAxisAux22"},{value:27,text:"controlAxisAux23"},{value:28,text:"controlAxisAux24"},{value:29,text:"controlAxisAux25"},{value:30,text:"controlAxisAux26"},{value:31,text:"controlAxisAux27"}],rssiOptions:[{value:0,text:"rssiOptionAUTO"},{value:1,text:"rssiOptionADC"},{value:6,text:"controlAxisAux1"},{value:7,text:"controlAxisAux2"},{value:8,text:"controlAxisAux3"},{value:9,text:"controlAxisAux4"},{value:10,text:"controlAxisAux5"},{value:11,text:"controlAxisAux6"},{value:12,text:"controlAxisAux7"},{value:13,text:"controlAxisAux8"},{value:14,text:"controlAxisAux9"},{value:15,text:"controlAxisAux10"},{value:16,text:"controlAxisAux11"},{value:17,text:"controlAxisAux12"},{value:18,text:"controlAxisAux13"},{value:19,text:"controlAxisAux14"},{value:20,text:"controlAxisAux15"},{value:21,text:"controlAxisAux16"},{value:22,text:"controlAxisAux17"},{value:23,text:"controlAxisAux18"},{value:24,text:"controlAxisAux19"},{value:25,text:"controlAxisAux20"},{value:26,text:"controlAxisAux21"},{value:27,text:"controlAxisAux22"},{value:28,text:"controlAxisAux23"},{value:29,text:"controlAxisAux24"},{value:30,text:"controlAxisAux25"},{value:31,text:"controlAxisAux26"},{value:32,text:"controlAxisAux27"}]};eo.initialize=function(n){const e=this;r(t);function t(){$("#content").load("/src/tabs/receiver.html",o)}function r(s){MSP.promise(MSPCodes.MSP_STATUS).then(()=>MSP.promise(MSPCodes.MSP_FEATURE_CONFIG)).then(()=>MSP.promise(MSPCodes.MSP_RX_CONFIG)).then(()=>MSP.promise(MSPCodes.MSP_RX_MAP)).then(()=>MSP.promise(MSPCodes.MSP_RC_CONFIG)).then(()=>MSP.promise(MSPCodes.MSP_RC_TUNING)).then(()=>MSP.promise(MSPCodes.MSP_RSSI_CONFIG)).then(()=>MSP.promise(MSPCodes.MSP_MIXER_CONFIG)).then(()=>MSP.promise(MSPCodes.MSP_SERIAL_CONFIG)).then(()=>MSP.promise(MSPCodes.MSP_TELEMETRY_CONFIG)).then(()=>MSP.promise(MSPCodes.MSP_RC)).then(s)}function i(s){Promise.resolve(!0).then(()=>MSP.promise(MSPCodes.MSP_SET_RX_MAP,mspHelper.crunch(MSPCodes.MSP_SET_RX_MAP))).then(()=>MSP.promise(MSPCodes.MSP_SET_RX_CONFIG,mspHelper.crunch(MSPCodes.MSP_SET_RX_CONFIG))).then(()=>MSP.promise(MSPCodes.MSP_SET_RC_CONFIG,mspHelper.crunch(MSPCodes.MSP_SET_RC_CONFIG))).then(()=>MSP.promise(MSPCodes.MSP_SET_RSSI_CONFIG,mspHelper.crunch(MSPCodes.MSP_SET_RSSI_CONFIG))).then(()=>MSP.promise(MSPCodes.MSP_SET_TELEMETRY_CONFIG,mspHelper.crunch(MSPCodes.MSP_SET_TELEMETRY_CONFIG))).then(()=>MSP.promise(MSPCodes.MSP_SET_FEATURE_CONFIG,mspHelper.crunch(MSPCodes.MSP_SET_FEATURE_CONFIG))).then(()=>MSP.promise(MSPCodes.MSP_EEPROM_WRITE)).then(()=>{GUI.log(i18n.getMessage("eepromSaved")),e.needReboot?(MSP.send_message(MSPCodes.MSP_SET_REBOOT),GUI.log(i18n.getMessage("deviceRebooting")),reinitialiseConnection(s)):s?.()})}function o(){e.svelteComponent=Rr(Qx,{target:document.querySelector("#svelte-receiver"),props:{onchange:()=>{e.saveButtons=!0,p(!0)}}}),$(".tab-receiver").addClass("toolbar_hidden"),i18n.localizePage(),e.isDirty=!1,e.saveButtons=!1,e.bindButton=!1,e.stickButton=!1,e.needReboot=!1;const s=$(".bind_btn"),l=$(".sticks_btn"),a=$(".save_btn"),c=$(".reboot_btn"),u=$(".revert_btn");function p(L){let G=!0;FC.TELEMETRY_CONFIG.telemetry_sensors_list.length>40&&(G=!1),L&&(e.needReboot=!0),e.saveButtons&&(e.isDirty=!0),(e.saveButtons||e.bindButton||e.stickButton)&&($(".tab-receiver").removeClass("toolbar_hidden"),s.toggle(e.bindButton),l.toggle(e.stickButton),a.toggle(!e.needReboot&&e.saveButtons&&G),c.toggle(e.needReboot&&e.saveButtons&&G),u.toggle(e.saveButtons),$(".disabled_save_reboot_btn").toggle(e.saveButtons&&!G))}function h(L,G,U){const M=$("#receiverBarTemplate tr").clone();M.find(".name").text(G);const N=M.find(".channel_select");return U?U.forEach(w=>{const x=i18n.getMessage(w.text);N.append(`<option value="${w.value}">${x}</option>`)}):N.hide(),M.find(".fill").css("width","0%"),L.append(M),M}function g(L,G,U,M){L.find(".fill").css("width",G),L.find(".label1").text(U),L.find(".label2").text(M)}e.mapChannels=FC.RC_MAP.length,e.numChannels=FC.RC.active_channels,e.barChannels=Math.min(e.numChannels,18),e.guiChannels=Math.max(e.barChannels,e.mapChannels);const f=$(".tab-receiver .channels"),d=[],_=[];for(let L=0;L<e.guiChannels;L++)if(L<e.mapChannels){const G=h(f,`CH${L+1}`,e.axisNames.slice(0,e.mapChannels));d.push(G);const U=G.find(".channel_select");_.push(U),U.change(function(){const M=parseInt(U.val()),N=e.rcmap.indexOf(L);e.rcmap[N]=e.rcmap[M],e.rcmap[M]=L,P()})}else{const G=[e.axisNames[L]],U=h(f,`CH${L+1}`,G);d.push(U),U.find(".channel_select").prop("disabled",!0)}const m=h(f,"RSSI",e.rssiOptions.slice(0,e.numChannels-3)),C=m.find(".channel_select");C.change(function(){const L=parseInt(C.val());FC.FEATURE_CONFIG.features.setFeature("RSSI_ADC",L==1),FC.RSSI_CONFIG.channel=L>5?L:0}),FC.FEATURE_CONFIG.features.isEnabled("RSSI_ADC")?C.val(1):FC.RSSI_CONFIG.channel>5?C.val(FC.RSSI_CONFIG.channel):C.val(0);function R(L,G){var U=0,M=0,N=0,w=0;if(L>4||G<750||G>2250)return 0;switch(L){case 0:case 1:U=G-FC.RC_CONFIG.rc_center,M=FC.RC_CONFIG.rc_deadband,w=FC.RC_CONFIG.rc_deflection-FC.RC_CONFIG.rc_deadband;break;case 2:U=G-FC.RC_CONFIG.rc_center,M=FC.RC_CONFIG.rc_yaw_deadband,w=FC.RC_CONFIG.rc_deflection-FC.RC_CONFIG.rc_yaw_deadband;break;case 3:U=G-FC.RC_CONFIG.rc_center,M=0,w=FC.RC_CONFIG.rc_deflection;break;case 4:U=G-FC.RC_CONFIG.rc_min_throttle,M=0,w=FC.RC_CONFIG.rc_max_throttle-FC.RC_CONFIG.rc_min_throttle;break}return U>M?N=(U-M)/w:U<-M&&(N=(U+M)/w),N}function S(L,G){return L<5?(G*100).toFixed(1)+"%":""}function F(){for(let M=0;M<e.barChannels;M++){const N=M<e.mapChannels?e.rcmap.indexOf(M):M,w=FC.RX_CHANNELS[M],x=(100*(w-750)/1500).clamp(0,100)+"%",k=R(N,w),O=S(N,k);g(d[M],x,w,O),N<3&&(e.rcRPY[N]=w?1500+500*k:0)}const U=(FC.ANALOG.rssi/1023*100).toFixed(0)+"%";g(m,U,FC.ANALOG.rssi,U)}e.resize=function(){const L=$(".meter:last",f).width(),G=$(".meter:last .label2",f).width(),U=Math.max(L-G-15,40);$(".channels .label1").css("margin-left","15px"),$(".channels .label2").css("margin-left",U+"px")},$(window).on("resize",e.resize).resize();const I=$('input[name="rcmap"]'),T=$('select[name="rcmap_preset"]');T.val(0);function P(){const L=[];for(let G=0;G<e.mapChannels;G++){const U=e.rcmap[G];L[U]=e.axisLetters[G],_[U].val(G)}I.val(L.join(""))}I.on("input",function(){const L=I.val();L.length>e.mapChannels&&I.val(L.substring(0,e.mapChannels))}),I.on("change",function(){const L=I.val();if(L.length!=e.mapChannels)return P(),!1;const G=L.split(""),U=[];for(let M=0;M<e.mapChannels;M++){const N=G[M],w=e.axisLetters.indexOf(N);if(w<0||G.slice(0,M).indexOf(N)>=0)return P(),!1;U[w]=M}return e.rcmap=U,P(),!0}),T.on("change",function(){I.val(T.val()).change(),T.val(0)}),e.rcmap=FC.RC_MAP,$("a.sticks").click(function(){const U=new URL(window.location.href);U.pathname="/src/tabs/receiver_msp.html",nw.Window.open(U.toString(),{id:"receiver_msp",always_on_top:!0,max_width:370,max_height:510},function(M){M.resizeTo(370,510),M.window.i18n=i18n,M.window.setRawRx=function(N){if(CONFIGURATOR.connectionValid&&GUI.active_tab!="cli"){const w=[];return FC.RC_MAP.forEach((x,k)=>{w[x]=N[k]}),mspHelper.setRawRx(w),!0}else return!1},DarkTheme.isDarkThemeEnabled(function(N){kF.passValue(M.window,"darkTheme",N)})})}),e.stickButton=GUI.isNWJS()&&FC.FEATURE_CONFIG.features.isEnabled("RX_MSP"),e.bindButton=bit_check(FC.CONFIG.targetCapabilities,FC.TARGET_CAPABILITIES_FLAGS.SUPPORTS_RX_BIND),p(),$("a.bind").click(function(){MSP.send_message(MSPCodes.MSP2_BETAFLIGHT_BIND),GUI.log(i18n.getMessage("receiverButtonBindMessage"))});function y(){FC.RC_MAP=e.rcmap}P(),p(),e.initModelPreview(),e.renderModel(),$(".content_wrapper").on("change",function(){e.saveButtons=!0,p(!0)}),e.save=function(L){y(),i(L)},e.revert=function(L){L?.()},$("a.save").click(function(){e.save(()=>GUI.tab_switch_reload())}),$("a.reboot").click(function(){e.save(()=>GUI.tab_switch_reload())}),$("a.revert").click(function(){e.revert(()=>GUI.tab_switch_reload())}),GUI.interval_add("receiver_pull",function(){MSP.send_message(MSPCodes.MSP_BATTERY_STATE,!1,!1,function(){MSP.send_message(MSPCodes.MSP_RX_CHANNELS,!1,!1,function(){MSP.send_message(MSPCodes.MSP_RC_COMMAND,!1,!1,F)})})},25,!1),GUI.interval_add("status_pull",function(){MSP.send_message(MSPCodes.MSP_STATUS)},250,!0),GUI.content_ready(n)}};eo.initModelPreview=function(){const n=this;try{n.model=new ir($("#canvas_wrapper"),$("#canvas")),$(window).on("resize",$.proxy(n.model.resize,n.model)),$("#canvas_wrapper .webgl-error").hide()}catch(e){console.log("Error initialising model",e),$("#canvas_wrapper .webgl-error").show()}switch(n.clock=new rg,n.rateCurve=new RateCurve2,n.keepRendering=!0,n.currentRatesType=FC.RC_TUNING.rates_type,n.currentRates={roll_rate:FC.RC_TUNING.roll_rate,pitch_rate:FC.RC_TUNING.pitch_rate,yaw_rate:FC.RC_TUNING.yaw_rate,rc_rate:FC.RC_TUNING.RC_RATE,rc_rate_yaw:FC.RC_TUNING.rcYawRate,rc_expo:FC.RC_TUNING.RC_EXPO,rc_yaw_expo:FC.RC_TUNING.RC_YAW_EXPO,rc_rate_pitch:FC.RC_TUNING.rcPitchRate,rc_pitch_expo:FC.RC_TUNING.RC_PITCH_EXPO,roll_rate_limit:FC.RC_TUNING.roll_rate_limit,pitch_rate_limit:FC.RC_TUNING.pitch_rate_limit,yaw_rate_limit:FC.RC_TUNING.yaw_rate_limit,deadband:0,yawDeadband:0,superexpo:!0},n.currentRatesType){case 2:n.currentRates.roll_rate*=100,n.currentRates.pitch_rate*=100,n.currentRates.yaw_rate*=100,n.currentRates.rc_rate*=1e3,n.currentRates.rc_rate_yaw*=1e3,n.currentRates.rc_rate_pitch*=1e3,n.currentRates.rc_expo*=100,n.currentRates.rc_yaw_expo*=100,n.currentRates.rc_pitch_expo*=100;break;case 4:n.currentRates.roll_rate*=1e3,n.currentRates.pitch_rate*=1e3,n.currentRates.yaw_rate*=1e3,n.currentRates.rc_rate*=1e3,n.currentRates.rc_rate_yaw*=1e3,n.currentRates.rc_rate_pitch*=1e3;break;case 5:n.currentRates.roll_rate*=1e3,n.currentRates.pitch_rate*=1e3,n.currentRates.yaw_rate*=1e3;break}};eo.renderModel=function(){const n=this;if(n.keepRendering&&requestAnimationFrame(n.renderModel.bind(this)),n.rcRPY[0]&&n.rcRPY[1]&&n.rcRPY[2]){const e=n.clock.getDelta(),t=e*n.rateCurve.rcCommandRawToDegreesPerSecond(n.rcRPY[0],n.currentRatesType,n.currentRates.roll_rate,n.currentRates.rc_rate,n.currentRates.rc_expo,n.currentRates.superexpo,n.currentRates.deadband,n.currentRates.roll_rate_limit),r=e*n.rateCurve.rcCommandRawToDegreesPerSecond(n.rcRPY[1],n.currentRatesType,n.currentRates.pitch_rate,n.currentRates.rc_rate_pitch,n.currentRates.rc_pitch_expo,n.currentRates.superexpo,n.currentRates.deadband,n.currentRates.pitch_rate_limit),i=e*n.rateCurve.rcCommandRawToDegreesPerSecond(n.rcRPY[2],n.currentRatesType,n.currentRates.yaw_rate,n.currentRates.rc_rate_yaw,n.currentRates.rc_yaw_expo,n.currentRates.superexpo,n.currentRates.yawDeadband,n.currentRates.yaw_rate_limit);n.model?.rotateBy(-degToRad(r),-degToRad(i),-degToRad(t))}};eo.cleanup=function(n){this.svelteComponent&&(ni(this.svelteComponent),this.svelteComponent=null),$(window).off("resize",this.resize),this.keepRendering=!1,this.model&&($(window).off("resize",$.proxy(this.model.resize,this.model)),this.model.dispose()),this.isDirty=!1,n?.()};TABS[eo.tabName]=eo;const Ua={tabName:"sensors",armingEnabled:!0};Ua.initialize=function(n){function e(){for(let f=0;f<3;f++)FC.SENSOR_DATA.accelerometer[f]=0,FC.SENSOR_DATA.gyroscope[f]=0,FC.SENSOR_DATA.magnetometer[f]=0,FC.SENSOR_DATA.sonar=0,FC.SENSOR_DATA.altitude=0,FC.SENSOR_DATA.debug[f]=0}function t(f){const d=new Array(f);for(let _=0;_<f;_++)d[_]=new Array,d[_].min=-1,d[_].max=1;return d}function r(f,d,_){for(let m=0;m<f.length;m++){const C=_[m];f[m].push([d,C]),C<f[m].min&&(f[m].min=C),C>f[m].max&&(f[m].max=C)}for(;f[0].length>300;)for(let m=0;m<f.length;m++)f[m].shift();return d+1}const i={top:20,right:10,bottom:10,left:40};function o(f){f.width=f.targetElement.width()-i.left-i.right,f.height=f.targetElement.height()-i.top-i.bottom,f.widthScale.range([0,f.width]),f.heightScale.range([f.height,0]),f.xGrid.tickSize(-f.height,0,0),f.yGrid.tickSize(-f.width,0,0)}function s(f,d,_){const m={selector:f,targetElement:$(f),dynamicHeightDomain:!_};return m.widthScale=tp().clamp(!0).domain([d-299,d]),m.heightScale=tp().clamp(!0).domain(_||[1,-1]),m.xGrid=np(),m.yGrid=rp(),o(m),m.xGrid.scale(m.widthScale).ticks(5).tickFormat(""),m.yGrid.scale(m.heightScale).ticks(5).tickFormat(""),m.xAxis=np().scale(m.widthScale).ticks(5).tickFormat(function(C){return C}),m.yAxis=rp().scale(m.heightScale).ticks(5).tickFormat(function(C){return C}),m.line=QF().x(function(C){return m.widthScale(C[0])}).y(function(C){return m.heightScale(C[1])}),m}function l(f,d,_){const m=ZF(f.selector);if(f.dynamicHeightDomain){const S=[];$.each(d,function(F,I){S.push(I.min),S.push(I.max)}),f.heightScale.domain(JF(S))}f.widthScale.domain([_-299,_]),m.select(".x.grid").call(f.xGrid),m.select(".y.grid").call(f.yGrid),m.select(".x.axis").call(f.xAxis),m.select(".y.axis").call(f.yAxis);const R=m.select("g.data").selectAll("path").data(d,function(S,F){return F});R.enter().append("path").attr("class","line"),R.attr("d",f.line)}function a(f){f?$(".wrapper.gyro").show():$(".wrapper.gyro").hide()}function c(f){f?$(".wrapper.accel").show():$(".wrapper.accel").hide()}function u(f){f?$(".wrapper.mag").show():$(".wrapper.mag").hide()}function p(f){f?$(".wrapper.altitude").show():$(".wrapper.altitude").hide()}function h(f){f?$(".wrapper.sonar").show():$(".wrapper.sonar").hide()}function g(f){f?$(".wrapper.debug").show():$(".wrapper.debug").hide()}$("#content").load("/src/tabs/sensors.html",function(){i18n.localizePage();let d=$(".tab-sensors .info .checkboxes input");if(d.parent().show(),FC.CONFIG.boardType==0||FC.CONFIG.boardType==2)have_sensor(FC.CONFIG.activeSensors,"acc")||d.eq(1).prop("disabled",!0),have_sensor(FC.CONFIG.activeSensors,"mag")||d.eq(2).prop("disabled",!0),have_sensor(FC.CONFIG.activeSensors,"baro")||have_sensor(FC.CONFIG.activeSensors,"gps")||d.eq(3).prop("disabled",!0),have_sensor(FC.CONFIG.activeSensors,"sonar")||d.eq(4).prop("disabled",!0);else for(let z=0;z<=4;z++)d.eq(z).prop("disabled",!0),d.eq(z).parent().hide();$(".tab-sensors .info .checkboxes input").change(function(){const z=$(this).prop("checked");switch($(this).parent().index()){case 0:a(z);break;case 1:c(z);break;case 2:u(z);break;case 3:p(z);break;case 4:h(z);break;case 5:g(z);break}const re=[];$(".tab-sensors .info .checkboxes input").each(function(){re.push($(this).prop("checked"))}),$(".tab-sensors .rate select:first").change(),it({graphs_enabled:re})}),e();let _=0,m=0,C=0,R=0,S=0,F=0;const I=t(3),T=t(3),P=t(3),y=t(1),L=t(1),G=[t(1),t(1),t(1),t(1)];let U=s("#gyro",_,[-2e3,2e3]),M=s("#accel",m,[-2,2]),N=s("#mag",C,[-1,1]);const w=s("#altitude",R),x=s("#sonar",S),k=[s("#debug1",F),s("#debug2",F),s("#debug3",F),s("#debug4",F)],O={x:[],y:[],z:[]};$(".plot_control .x, .plot_control .y, .plot_control .z").each(function(){const z=$(this);z.hasClass("x")?O.x.push(z):z.hasClass("y")?O.y.push(z):O.z.push(z)}),$(".tab-sensors .rate select, .tab-sensors .scale select").change(function(){const z={gyro:parseInt($('.tab-sensors select[name="gyro_refresh_rate"]').val(),10),accel:parseInt($('.tab-sensors select[name="accel_refresh_rate"]').val(),10),mag:parseInt($('.tab-sensors select[name="mag_refresh_rate"]').val(),10),altitude:parseInt($('.tab-sensors select[name="altitude_refresh_rate"]').val(),10),sonar:parseInt($('.tab-sensors select[name="sonar_refresh_rate"]').val(),10),debug:parseInt($('.tab-sensors select[name="debug_refresh_rate"]').val(),10)},ee={gyro:parseFloat($('.tab-sensors select[name="gyro_scale"]').val()),accel:parseFloat($('.tab-sensors select[name="accel_scale"]').val()),mag:parseFloat($('.tab-sensors select[name="mag_scale"]').val())},re=KF([z.gyro,z.accel,z.mag]);it({sensor_settings:{rates:z,scales:ee}}),U=s("#gyro",_,[-ee.gyro,ee.gyro]),M=s("#accel",m,[-ee.accel,ee.accel]),N=s("#mag",C,[-ee.mag,ee.mag]),d=[],$(".tab-sensors .info .checkboxes input").each(function(){d.push($(this).prop("checked"))}),GUI.interval_kill_all(["status_pull"]),(d[0]||d[1]||d[2])&&GUI.interval_add("IMU_pull",function(){MSP.send_message(MSPCodes.MSP_RAW_IMU,!1,!1,le)},re,!0),d[3]&&GUI.interval_add("altitude_pull",function(){MSP.send_message(MSPCodes.MSP_ALTITUDE,!1,!1,J)},z.altitude,!0),d[4]&&GUI.interval_add("sonar_pull",function(){MSP.send_message(MSPCodes.MSP_SONAR,!1,!1,oe)},z.sonar,!0),d[5]&&GUI.interval_add("debug_pull",function(){MSP.send_message(MSPCodes.MSP_DEBUG,!1,!1,ae)},z.debug,!0);function le(){if(d[0]&&(o(U),_=r(I,_,FC.SENSOR_DATA.gyroscope),l(U,I,_),O.x[0].text(FC.SENSOR_DATA.gyroscope[0].toFixed(2)),O.y[0].text(FC.SENSOR_DATA.gyroscope[1].toFixed(2)),O.z[0].text(FC.SENSOR_DATA.gyroscope[2].toFixed(2))),d[1]){o(M),m=r(T,m,FC.SENSOR_DATA.accelerometer),l(M,T,m);const de=FC.SENSOR_DATA.accelerometer[0].toFixed(2),ie=FC.SENSOR_DATA.accelerometer[1].toFixed(2),te=FC.SENSOR_DATA.accelerometer[2].toFixed(2),fe=Math.PI,Re=Math.round(Math.atan(ie/(Math.sqrt(Math.pow(de,2))+Math.pow(te,2)))*(180/fe)),$e=Math.round(Math.atan(de/(Math.sqrt(Math.pow(ie,2))+Math.pow(te,2)))*(180/fe));O.x[1].text(`${de} (${Re})`),O.y[1].text(`${ie} (${$e})`),O.z[1].text(`${te}`)}d[2]&&(o(N),C=r(P,C,FC.SENSOR_DATA.magnetometer),l(N,P,C),O.x[2].text(FC.SENSOR_DATA.magnetometer[0].toFixed(2)),O.y[2].text(FC.SENSOR_DATA.magnetometer[1].toFixed(2)),O.z[2].text(FC.SENSOR_DATA.magnetometer[2].toFixed(2)))}function J(){o(w),R=r(y,R,[FC.SENSOR_DATA.altitude]),l(w,y,R),O.x[3].text(FC.SENSOR_DATA.altitude.toFixed(2))}function oe(){o(x),S=r(L,S,[FC.SENSOR_DATA.sonar]),l(x,L,S),O.x[4].text(FC.SENSOR_DATA.sonar.toFixed(2))}function ae(){for(let de=0;de<4;de++)o(k[de]),r(G[de],F,[FC.SENSOR_DATA.debug[de]]),l(k[de],G[de],F),O.x[5+de].text(FC.SENSOR_DATA.debug[de]);F++}});const D=We("sensor_settings");D&&($('.tab-sensors select[name="gyro_refresh_rate"]').val(D.rates.gyro),$('.tab-sensors select[name="gyro_scale"]').val(D.scales.gyro),$('.tab-sensors select[name="accel_refresh_rate"]').val(D.rates.accel),$('.tab-sensors select[name="accel_scale"]').val(D.scales.accel),$('.tab-sensors select[name="mag_refresh_rate"]').val(D.rates.mag),$('.tab-sensors select[name="mag_scale"]').val(D.scales.mag),$('.tab-sensors select[name="altitude_refresh_rate"]').val(D.rates.altitude),$('.tab-sensors select[name="sonar_refresh_rate"]').val(D.rates.sonar),$('.tab-sensors select[name="debug_refresh_rate"]').val(D.rates.debug)),$(".tab-sensors .rate select:first").change();const Y=We("graphs_enabled");if(Y){const z=$(".tab-sensors .info .checkboxes input");for(let ee=0;ee<Y.length;ee++)z.eq(ee).not(":disabled").prop("checked",Y[ee]).change()}else $(".tab-sensors .info input:lt(4):not(:disabled)").prop("checked",!0).change();GUI.interval_add("status_pull",function(){MSP.send_message(MSPCodes.MSP_STATUS)},250,!0),GUI.content_ready(n)})};Ua.cleanup=function(n){serial.emptyOutputBuffer(),n?.()};TABS[Ua.tabName]=Ua;const Zo={tabName:"servos",isDirty:!1,needReboot:!1,MAX_SERVOS:8,OVERRIDE_OFF:2001,FLAG_REVERSE:1,FLAG_GEOCOR:2};Zo.initialize=function(n){const e=this;t(i);function t(s){MSP.promise(MSPCodes.MSP_STATUS).then(()=>MSP.promise(MSPCodes.MSP_SERVO_CONFIGURATIONS)).then(()=>MSP.promise(MSPCodes.MSP_SERVO_OVERRIDE)).then(()=>MSP.promise(MSPCodes.MSP_SERVO)).then(s)}function r(s){mspHelper.sendServoConfigurations(function(){MSP.send_message(MSPCodes.MSP_EEPROM_WRITE,!1,!1,function(){GUI.log(i18n.getMessage("eepromSaved")),e.needReboot?(MSP.send_message(MSPCodes.MSP_SET_REBOOT),GUI.log(i18n.getMessage("deviceRebooting")),reinitialiseConnection(s)):s?.()})})}function i(){$("#content").load("/src/tabs/servos.html",o)}function o(){e.prevConfig=e.cloneConfig(FC.SERVO_CONFIG),i18n.localizePage(),$(".tab-servos").addClass("toolbar_hidden"),e.isDirty=!1;function s(){e.isDirty||(e.isDirty=!0,$(".tab-servos").removeClass("toolbar_hidden"))}function l(d){e.needReboot=d,$(".content_toolbar .save_btn").toggle(!d),$(".content_toolbar .reboot_btn").toggle(d)}$(".servoValueWarning").hide(),$(".servoRateRebootNote").hide();function a(){let d=!1,_=!1,m=!1,C=!1;const R=FC.SERVO_CONFIG;for(let S=0;S<FC.CONFIG.servoCount;S++){const F=R[S];F.mid>860?(F.rate>433&&(_=!0),(F.min<-750||F.min>-300||F.max>750||F.max<300)&&(m=!0),(F.rneg<300||F.rneg>750||F.rpos<300||F.rpos>750)&&(d=!0)):(F.rate>600&&(_=!0),(F.min<-375||F.min>-150||F.max>375||F.max<150)&&(m=!0),(F.rneg<150||F.rneg>375||F.rpos<150||F.rpos>375)&&(d=!0))}FC.CONFIG.servoCount==2?((R[0].flags&e.FLAG_GEOCOR)!=(R[1].flags&e.FLAG_GEOCOR)&&(C=!0),R[0].rate!=R[1].rate&&(_=!0)):FC.CONFIG.servoCount>=3&&(((R[0].flags&e.FLAG_GEOCOR)!=(R[1].flags&e.FLAG_GEOCOR)||(R[1].flags&e.FLAG_GEOCOR)!=(R[2].flags&e.FLAG_GEOCOR)||(R[0].flags&e.FLAG_GEOCOR)!=(R[2].flags&e.FLAG_GEOCOR))&&(C=!0),(R[0].rate!=R[1].rate||R[1].rate!=R[2].rate||R[0].rate!=R[2].rate)&&(_=!0)),$(".servo-unusual-limits-warning").toggle(m),$(".servo-unusual-scales-warning").toggle(d),$(".servo-unusual-rates-warning").toggle(_),$(".servo-unusual-geometry-correction").toggle(C),$(".servoValueWarning").toggle(m||d||_||C)}function c(d){const _=$("#tab-servos-templates .servoOverrideTemplate tr").clone(),m=_.find(".servoOverrideEnable input"),C=_.find(".servoOverrideInput input");_.attr("class",`servoOverride${d}`),_.find(".servoOverrideIndex").text(`#${d+1}`);const R=Gr(_.find(".servoOverrideSlider").get(0),{exactInput:!0,range:{min:-90,max:90},start:0,step:5,behaviour:"snap-drag",pips:{mode:"values",values:[-80,-60,-40,-20,0,20,40,60,80],density:100/(160/5),stepped:!0,format:ei({decimals:0})}});function S(P){P?R.enable():R.disable()}R.on("slide",function(P){C.val(parseInt(P[0]))}),R.on("change",function(){C.trigger("change")}),C.on("change",function(){const P=getIntegerValue(this);R.set(P,!0,!0),FC.SERVO_OVERRIDE[d]=Math.round(P*1e3/50),mspHelper.sendServoOverride(d)}),m.on("change",function(){const P=$(this).prop("checked"),y=P?0:e.OVERRIDE_OFF;C.val(0),R.set(0),C.prop("disabled",!P),S(P),FC.SERVO_OVERRIDE[d]=y,mspHelper.sendServoOverride(d)});const F=FC.SERVO_OVERRIDE[d],I=F>=-2e3&&F<=2e3,T=I?Math.round(F*50/1e3):0;C.val(T),R.set(T),C.prop("disabled",!I),m.prop("checked",I),S(I),$(".servoOverride tbody").append(_)}function u(d){const _=$("#tab-servos-templates .servoConfigTemplate tr").clone(),m=FC.SERVO_CONFIG[d],C=!!(m.flags&e.FLAG_REVERSE),R=!!(m.flags&e.FLAG_GEOCOR);_.attr("class",`servoConfig${d}`),_.data("index",d),_.find("#index").text(`#${d+1}`),_.find("#mid").val(m.mid),_.find("#min").val(m.min),_.find("#max").val(m.max),_.find("#rneg").val(m.rneg),_.find("#rpos").val(m.rpos),_.find("#rate").val(m.rate),_.find("#speed").val(m.speed),_.find("#reversed").prop("checked",C),_.find("#geocor").prop("checked",R),_.find("input").change(function(){p(d),a(),s(),mspHelper.sendServoConfig(d)}),_.find("#rate").change(function(){$(".servoRateRebootNote").show(),$(this).addClass("attention"),l(!0)}),$(".servoConfig tbody").append(_)}function p(d){const _=$(`.tab-servos .servoConfig${d}`);FC.SERVO_CONFIG[d].mid=getIntegerValue($("#mid",_)),FC.SERVO_CONFIG[d].min=getIntegerValue($("#min",_)),FC.SERVO_CONFIG[d].max=getIntegerValue($("#max",_)),FC.SERVO_CONFIG[d].rneg=getIntegerValue($("#rneg",_)),FC.SERVO_CONFIG[d].rpos=getIntegerValue($("#rpos",_)),FC.SERVO_CONFIG[d].rate=getIntegerValue($("#rate",_)),FC.SERVO_CONFIG[d].speed=getIntegerValue($("#speed",_)),FC.SERVO_CONFIG[d].flags=$("#reversed",_).prop("checked")?e.FLAG_REVERSE:0,FC.SERVO_CONFIG[d].flags|=$("#geocor",_).prop("checked")?e.FLAG_GEOCOR:0}function h(){let d,_;for(let m=0;m<FC.SERVO_CONFIG.length;m++){const C=FC.SERVO_DATA[m];FC.SERVO_CONFIG[m].mid<=860?(d=375,_=1145):FC.SERVO_CONFIG[m].mid<=1060?(d=460,_=1460):(d=750,_=2250);const R=_-d,F=(100*(C-d)/R).clamp(0,100),I=100-F,T=$(`.tab-servos .servoConfig${m} .meter`);$(".meter-fill",T).css({width:`${F}%`,"margin-right":`${I}%`}),$(".meter-label",T).text(C)}}function g(){MSP.send_message(MSPCodes.MSP_SERVO,!1,!1,h)}for(let d=0;d<FC.CONFIG.servoCount;d++)u(d),c(d),FC.CONFIG.servoOverrideEnabled|=FC.SERVO_OVERRIDE[d]>=-2e3&&FC.SERVO_OVERRIDE[d]<=2e3;a(),l(!1);const f=$("#servoEnableOverrideSwitch");f.prop("checked",FC.CONFIG.servoOverrideEnabled),f.change(function(){const d=f.prop("checked");FC.CONFIG.servoOverrideEnabled=d,$(".tab-servos .override").toggle(d),$(".servoOverrideEnable input").prop("checked",d).change()}),$(".tab-servos .override").toggle(!!FC.CONFIG.servoOverrideEnabled),e.save=function(d){for(let _=0;_<FC.CONFIG.servoCount;_++)p(_);r(d)},e.revert=function(d){FC.SERVO_CONFIG=e.prevConfig,mspHelper.sendServoConfigurations(d)},$("a.save").click(function(){e.save(()=>GUI.tab_switch_reload())}),$("a.reboot").click(function(){e.save(()=>GUI.tab_switch_reload())}),$("a.revert").click(function(){e.revert(()=>GUI.tab_switch_reload())}),GUI.interval_add("servo_pull",g,100),GUI.content_ready(n)}};Zo.cleanup=function(n){this.isDirty=!1,n?.()};Zo.cloneConfig=function(n){const e=[];return n.forEach(function(t){e.push(Object.assign({},t))}),e};TABS[Zo.tabName]=Zo;const Ba={tabName:"setup"};Ba.initialize=function(n){e(t);function e(i){Promise.resolve(!0).then(()=>MSP.promise(MSPCodes.MSP_STATUS)).then(()=>MSP.promise(MSPCodes.MSP_ARMING_CONFIG)).then(()=>MSP.promise(MSPCodes.MSP_FEATURE_CONFIG)).then(()=>MSP.promise(MSPCodes.MSP_ADVANCED_CONFIG)).then(i)}function t(){$("#content").load("/src/tabs/setup.html",r)}function r(){i18n.localizePage(),CONFIGURATOR.virtualMode&&$("a.backupSettings").addClass("disabled"),have_sensor(FC.CONFIG.activeSensors,"acc")||($("a.calibrateAccel").addClass("disabled"),$("default_btn").addClass("disabled")),have_sensor(FC.CONFIG.activeSensors,"mag")||($("a.calibrateMag").addClass("disabled"),$("default_btn").addClass("disabled")),$("a.rebootBootloader").click(function(){MSP.send_message(MSPCodes.MSP_SET_REBOOT,[mspHelper.REBOOT_TYPES.BOOTLOADER],!1)}),$("a.calibrateAccel").click(function(){const o=$(this);o.hasClass("calibrating")||(o.addClass("calibrating"),GUI.interval_pause("setup_data_pull"),MSP.send_message(MSPCodes.MSP_ACC_CALIBRATION,!1,!1,function(){GUI.log(i18n.getMessage("initialSetupAccelCalibStarted")),$("#accel_calib_running").show(),$("#accel_calib_rest").hide()}),GUI.timeout_add("button_reset",function(){GUI.interval_resume("setup_data_pull"),GUI.log(i18n.getMessage("initialSetupAccelCalibEnded")),o.removeClass("calibrating"),$("#accel_calib_running").hide(),$("#accel_calib_rest").show()},2e3))}),$("a.calibrateMag").click(function(){const o=$(this);!o.hasClass("calibrating")&&!o.hasClass("disabled")&&(o.addClass("calibrating"),MSP.send_message(MSPCodes.MSP_MAG_CALIBRATION,!1,!1,function(){GUI.log(i18n.getMessage("initialSetupMagCalibStarted")),$("#mag_calib_running").show(),$("#mag_calib_rest").hide()}),GUI.timeout_add("button_reset",function(){GUI.log(i18n.getMessage("initialSetupMagCalibEnded")),o.removeClass("calibrating"),$("#mag_calib_running").hide(),$("#mag_calib_rest").show()},3e4))});const i=$(".dialogConfirmReset")[0];$("a.resetSettings").click(function(){i.showModal()}),$(".dialogConfirmReset-cancelbtn").click(function(){i.close()}),$(".dialogConfirmReset-confirmbtn").click(function(){i.close(),MSP.send_message(MSPCodes.MSP_RESET_CONF,!1,!1,function(){GUI.log(i18n.getMessage("initialSetupSettingsRestored")),GUI.tab_switch_reload()})}),$("a.saveSettings").click(function(){MSP.send_message(MSPCodes.MSP_EEPROM_WRITE,!1,!1,function(){GUI.log(i18n.getMessage("initialSetupSettingsSaved")),GUI.tab_switch_reload()})}),$("a.backupSettings").click(function(){$(this).hasClass("disabled")||configuration_backup(function(){GUI.log(i18n.getMessage("initialSetupBackupSuccess"))})}),$("a.restoreSettings").click(function(){$(this).hasClass("disabled")||configuration_restore(function(){GUI.log(i18n.getMessage("initialSetupRestoreSuccess")),GUI.tab_switch_reload()})}),$("a.rebootMsc").click(function(){const o=GUI.operating_system==="Linux"?mspHelper.REBOOT_TYPES.MSC_UTC:mspHelper.REBOOT_TYPES.MSC;MSP.send_message(MSPCodes.MSP_SET_REBOOT,[o],!1)}),$("a.rebootFirmware").click(function(){GUI.log(i18n.getMessage("deviceRebooting")),MSP.send_message(MSPCodes.MSP_SET_REBOOT,[mspHelper.REBOOT_TYPES.FIRMWARE],!1),reinitialiseConnection()}),GUI.content_ready(n)}};Ba.cleanup=function(n){n?.()};TABS[Ba.tabName]=Ba;const ci={tabName:"status",armingEnabled:!0,yaw_fix:0,axisNames:[{value:0,text:"controlAxisRoll"},{value:1,text:"controlAxisPitch"},{value:2,text:"controlAxisYaw"},{value:3,text:"controlAxisCollective"},{value:4,text:"controlAxisThrottle"},{value:5,text:"controlAxisAux1"},{value:6,text:"controlAxisAux2"},{value:7,text:"controlAxisAux3"},{value:8,text:"controlAxisAux4"},{value:9,text:"controlAxisAux5"},{value:10,text:"controlAxisAux6"},{value:11,text:"controlAxisAux7"},{value:12,text:"controlAxisAux8"},{value:13,text:"controlAxisAux9"},{value:14,text:"controlAxisAux10"},{value:15,text:"controlAxisAux11"},{value:16,text:"controlAxisAux12"},{value:17,text:"controlAxisAux13"},{value:18,text:"controlAxisAux14"},{value:19,text:"controlAxisAux15"},{value:20,text:"controlAxisAux16"},{value:21,text:"controlAxisAux17"},{value:22,text:"controlAxisAux18"},{value:23,text:"controlAxisAux19"},{value:24,text:"controlAxisAux20"},{value:25,text:"controlAxisAux21"},{value:26,text:"controlAxisAux22"},{value:27,text:"controlAxisAux23"},{value:28,text:"controlAxisAux24"},{value:29,text:"controlAxisAux25"},{value:30,text:"controlAxisAux26"},{value:31,text:"controlAxisAux27"}]};ci.getDisarmFlags=function(){return["NO_GYRO","FAILSAFE","RX_FAILSAFE","BAD_RX_RECOVERY","BOXFAILSAFE","GOVERNOR",_e.gte(FC.CONFIG.apiVersion,API_VERSION_12_8)?"RPM_SIGNAL":"CRASH","THROTTLE","ANGLE","BOOT_GRACE_TIME","NOPREARM","LOAD","CALIBRATING","CLI","CMS_MENU","BST","MSP","PARALYZE","GPS","RESC","RPMFILTER","REBOOT_REQ","DSHOT_BITBANG","ACC_CALIB","MOTOR_PROTO","ARM_SWITCH"]};ci.initialize=function(n){const e=this;r(t);function t(){$("#content").load("/src/tabs/status.html",i)}function r(o){MSP.promise(MSPCodes.MSP_STATUS).then(()=>MSP.promise(MSPCodes.MSP_FEATURE_CONFIG)).then(()=>MSP.promise(MSPCodes.MSP_MIXER_CONFIG)).then(()=>MSP.promise(MSPCodes.MSP_ACC_TRIM)).then(()=>MSP.promise(MSPCodes.MSP_NAME)).then(()=>MSP.promise(MSPCodes.MSP_RC)).then(o)}function i(){i18n.localizePage(),e.initModel(),$(".craft-name").text(FC.CONFIG.name),$(".target-name").text(FC.CONFIG.targetName),$(".board-name").text(FC.CONFIG.boardName),$("span.roll").text(i18n.getMessage("statusAttitude",[0])),$("span.pitch").text(i18n.getMessage("statusAttitude",[0])),$("span.heading").text(i18n.getMessage("statusAttitude",[0]));const o={size:90,showBox:!1,img_directory:"/images/flightindicators/"},s=$.flightIndicator("#attitude","attitude",o),l=$.flightIndicator("#heading","heading",o),a=$.flightIndicator("#altitude","altimeter",o);$("#arming-disable-flag").attr("title",i18n.getMessage("statusArmingDisableFlagsTooltip")),$("div#interactive_block > a.reset").text(i18n.getMessage("statusButtonResetZaxisValue",[e.yaw_fix])),$("div#interactive_block > a.reset").click(function(){e.yaw_fix=FC.SENSOR_DATA.kinematics[2]*-1,$(this).text(i18n.getMessage("statusButtonResetZaxisValue",[e.yaw_fix])),console.log("YAW reset to 0 deg, fix: "+e.yaw_fix+" deg")});const c=$(".arming-disable-flags"),u=$(".configState"),p=$(".bat-voltage"),h=$(".bat-mah-drawn"),g=$(".bat-mah-drawing"),f=$(".bat-charge-level"),d=$("dd.roll"),_=$("dd.pitch"),m=$("dd.heading");switch(FC.CONFIG.configurationState){case FC.CONFIGURATION_STATES.CONFIGURED:u.html(i18n.getMessage("statusConfigConfigured"));break;case FC.CONFIGURATION_STATES.DEFAULTS_CUSTOM:u.html(i18n.getMessage("statusConfigDefaults"));break;case FC.CONFIGURATION_STATES.DEFAULTS_BARE:u.html(i18n.getMessage("statusConfigBare"));break}function C(){$(".arm-danger-row").hide();const O=e.getDisarmFlags();for(let D=0;D<FC.CONFIG.armingDisableCount;D++)D<O.length?c.append('<div id="statusArmingDisableFlags'+D+'" class="cf_tip disarm-flag" title="'+i18n.getMessage("statusArmingDisableFlagsTooltip"+O[D])+'" style="display: none;">'+O[D]+"</div>"):c.append('<div id="statusArmingDisableFlags'+D+'" class="disarm-flag" style="display: none;">'+(D+1)+"</div>")}C();function R(O,D){const Y=$("#statusBarTemplate tr").clone();return Y.find(".name").text(D),Y.find(".fill").css("width","0%"),O.append(Y),Y}function S(O,D,Y,z){O.find(".fill").css("width",D),O.find(".label1").text(Y),O.find(".label2").text(z)}const F=Math.min(FC.RC.active_channels,18),I=Math.max(F,8),T=$(".tab-status .bars"),P=[];for(let O=0;O<I;O++){const D=i18n.getMessage(e.axisNames[O].text),Y=R(T,D);P.push(Y)}const y=R(T,"RSSI");e.resize=function(){const O=$(".meter:first",T).width(),D=$(".meter:first .label2",T).width(),Y=Math.max(O-D-15,40)+"px";$(".meter .label1",T).css("margin-left","15px"),$(".meter .label2",T).css("margin-left",Y)},$(window).on("resize",e.resize).resize();const L=750,G=2250;function U(){for(let O=0;O<F;O++){const D=((FC.RC.channels[O]-L)/(G-L)*100).clamp(0,100)+"%",Y=FC.RC.channels[O].toFixed(0);let z="";O<4?z=(FC.RC_COMMAND[O]/5).toFixed(1)+"%":O==4&&(z=(FC.RC_COMMAND[O]/10+50).toFixed(1)+"%"),S(P[O],D,Y,z)}}function M(){MSP.send_message(MSPCodes.MSP_STATUS,!1,!1,function(){const O=FC.CONFIG.armingDisableFlags==0;$(".arm-danger-row").toggle(O);for(let D=0;D<FC.CONFIG.armingDisableCount;D++)$("#statusArmingDisableFlags"+D).toggle((FC.CONFIG.armingDisableFlags&1<<D)!=0)}),MSP.send_message(MSPCodes.MSP_BATTERY_STATE,!1,!1,function(){p.text(i18n.getMessage("powerVoltageValue",[FC.BATTERY_STATE.voltage])),h.text(i18n.getMessage("powerMahValue",[FC.BATTERY_STATE.mAhDrawn])),g.text(i18n.getMessage("powerAmperageValue",[FC.BATTERY_STATE.amperage])),f.text(i18n.getMessage("powerChargeLevel",[FC.BATTERY_STATE.chargeLevel]))}),MSP.send_message(MSPCodes.MSP_ANALOG,!1,!1,function(){const O=(FC.ANALOG.rssi/1023*100).toFixed(0)+"%";S(y,O,FC.ANALOG.rssi,O)}),MSP.send_message(MSPCodes.MSP_ALTITUDE,!1,!1,function(){a.setAltitude(FC.SENSOR_DATA.altitude*100)})}function N(){MSP.send_message(MSPCodes.MSP_RC,!1,!1,function(){MSP.send_message(MSPCodes.MSP_RC_COMMAND,!1,!1,U)}),MSP.send_message(MSPCodes.MSP_ATTITUDE,!1,!1,function(){d.text(i18n.getMessage("statusAttitude",[FC.SENSOR_DATA.kinematics[0]])),_.text(i18n.getMessage("statusAttitude",[FC.SENSOR_DATA.kinematics[1]])),m.text(i18n.getMessage("statusAttitude",[FC.SENSOR_DATA.kinematics[2]])),e.renderModel(),s.setRoll(FC.SENSOR_DATA.kinematics[0]),s.setPitch(FC.SENSOR_DATA.kinematics[1]),l.setHeading(FC.SENSOR_DATA.kinematics[2])})}GUI.interval_add("status_data_pull_fast",N,50,!0),GUI.interval_add("status_data_pull_slow",M,250,!0);const w=$('input[id="statusEnableArming"]'),x=$(".dialogConfirmArming")[0];function k(O){FC.CONFIG.enableArmingFlag=O,w.prop("checked",O),mspHelper.setArmingEnabled(O)}w.on("change",function(){w.prop("checked")?x.showModal():k(!1)}),$(".dialogConfirmArming-cancelbtn").on("click",function(){x.close(),k(!1)}),$(".dialogConfirmArming-confirmbtn").on("click",function(){x.close(),k(!0)}),k(FC.CONFIG.enableArmingFlag),GUI.content_ready(n)}};ci.initModel=function(){try{this.model=new ir($(".model-and-info #canvas_wrapper"),$(".model-and-info #canvas")),$(window).on("resize",$.proxy(this.model.resize,this.model)),$("#canvas_wrapper .webgl-error").hide()}catch(n){console.log("Error initialising model",n),$("#canvas_wrapper .webgl-error").show()}};ci.renderModel=function(){let n=FC.SENSOR_DATA.kinematics[1]*-1*.017453292519943295,e=(FC.SENSOR_DATA.kinematics[2]*-1-this.yaw_fix)*.017453292519943295,t=FC.SENSOR_DATA.kinematics[0]*-1*.017453292519943295;this.model?.rotateTo(n,e,t)};ci.cleanup=function(n){this.model&&($(window).off("resize",$.proxy(this.model.resize,this.model)),this.model.dispose()),n?.()};TABS[ci.tabName]=ci;function Zx(n,e){we(e,!0);const t=1.8;let r=ue(()=>{const o=V.BATTERY_STATE.voltage.toFixed(2),s=V.BATTERY_STATE.voltage>t?`${V.BATTERY_STATE.cellCount}S`:"USB";return`${o}V (${s})`});var i=rb();Ae(()=>Ee(i,b(r))),Z(n,i),Ge()}var Jx=ne("<span> </span>"),ey=ne("<span> </span>"),ty=ne('<div class="logo svelte-1qi2t4y"><div class="logo-text svelte-1qi2t4y"><span> </span> <!> <!></div></div>');function gC(n,e){we(e,!0);const[t,r]=Et(),i=()=>vt(St,"$i18n",t);let o=ue(()=>V.getHardwareName());var s=ty(),l=W(s),a=W(l),c=W(a),u=K(a,2);{var p=f=>{var d=Jx(),_=W(d);Ae(m=>Ee(_,`${m??""}: ${V.CONFIG.buildVersion??""}
        ${V.CONFIG.flightControllerIdentifier??""}`),[()=>i().t("versionLabelFirmware")]),Z(f,d)};Ce(u,f=>{V.CONFIG.buildVersion&&V.CONFIG.flightControllerIdentifier&&f(p)})}var h=K(u,2);{var g=f=>{var d=ey(),_=W(d);Ae(m=>Ee(_,`${m??""}: ${b(o)??""}`),[()=>i().t("versionLabelTarget")]),Z(f,d)};Ce(h,f=>{b(o)&&f(g)})}Ae(f=>Ee(c,`${f??""}: ${CONFIGURATOR.version??""}`),[()=>i().t("versionLabelConfigurator")]),Z(n,s),Ge(),r()}var ny=ne('<span class="svelte-1n5usbn"> </span>'),ry=ne('<div class="container svelte-1n5usbn"><span class="svelte-1n5usbn"> <span class="fas fa-long-arrow-alt-down svelte-1n5usbn"></span> <span class="fas fa-long-arrow-alt-up svelte-1n5usbn"></span> </span> <span class="svelte-1n5usbn"> </span> <span class="svelte-1n5usbn"> </span> <span class="svelte-1n5usbn"> </span> <span class="svelte-1n5usbn"> </span> <span class="svelte-1n5usbn"> </span> <div class="grow svelte-1n5usbn"></div> <!> <span class="svelte-1n5usbn"> </span></div>');function iy(n,e){we(e,!0);const[t,r]=Et(),i=()=>vt(St,"$i18n",t);let o=ue(()=>V.CONFIG.buildVersion&&V.CONFIG.flightControllerIdentifier);var s=ry(),l=W(s),a=W(l),c=K(a,2),u=K(c,2),p=K(l,2),h=W(p),g=K(p,2),f=W(g),d=K(g,2),_=W(d),m=K(d,2),C=W(m),R=K(m,2),S=W(R),F=K(R,4);{var I=y=>{var L=ny(),G=W(L);Ae(U=>Ee(G,`${U??""}
      ${V.CONFIG.buildVersion??""}
      ${V.CONFIG.flightControllerIdentifier??""}`),[()=>i().t("versionLabelFirmware")]),Z(y,L)};Ce(F,y=>{b(o)&&y(I)})}var T=K(F,2),P=W(T);Ae((y,L,G,U,M,N,w,x,k)=>{Ee(a,`${y??""} `),Ee(c,` ${L??""}% `),Ee(u,` ${G??""}%`),Ee(h,`${U??""} ${Zr.packet_error??""}`),Ee(f,`${M??""} ${V.CONFIG.pidCycleTime??""}`),Ee(_,`${N??""} ${V.CONFIG.gyroCycleTime??""}`),Ee(C,`${w??""} ${V.CONFIG.rtLoad??""}%`),Ee(S,`${x??""} ${V.CONFIG.cpuLoad??""}%`),Ee(P,`${k??""}: ${qe.version??""}`)},[()=>i().t("statusbar_port_utilization"),()=>jo.down.toFixed(),()=>jo.up.toFixed(),()=>i().t("statusbar_packet_error"),()=>i().t("statusbar_pid_cycle_time"),()=>i().t("statusbar_gyro_cycle_time"),()=>i().t("statusbar_rt_load"),()=>i().t("statusbar_cpu_load"),()=>i().t("versionLabelConfigurator")]),Z(n,s),Ge(),r()}globalThis.GUI=new ct;Object.assign(globalThis,{...dT,...fT,...hT,...zT,...LT,...aO,Beepers:xb,CliAutoComplete:wt,ConfigInserter:Yg,DarkTheme:UF,FC:V,Features:$d,FirmwareCache:lT,MSP:Zr,MSPCodes:lt,Mixer:$i,MspHelper:De,PortHandler:Dt,RateCurve:as,RateCurve2:ls,ReleaseChecker:ol,STM32:KT,STM32DFU:QT,UI_PHONES:jT,getTabHelpURL:em,huffmanDecodeBuf:_T,i18n:$F,portUsage:jo,serial:Sn,usbDevices:kd});Rr(Zx,{target:document.querySelector("#battery-legend")});Rr(iy,{target:document.querySelector("#status-bar")});Rr(gC,{target:document.querySelector("#logo-desktop")});Rr(gC,{target:document.querySelector("#logo-mobile")});(async()=>{const n=await DF(()=>import("./browser_chromeapi.js"),[],import.meta.url);Object.assign(globalThis,{chrome:n})})();
